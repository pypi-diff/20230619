# Comparing `tmp/odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2-py3-none-any.whl.zip` & `tmp/odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,23 +1,23 @@
-Zip file size: 30890 bytes, number of entries: 21
--rw-r--r--  2.0 unx     3690 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/README.rst
--rw-r--r--  2.0 unx       21 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/__init__.py
--rw-r--r--  2.0 unx      528 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/__manifest__.py
--rw-r--r--  2.0 unx     3302 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/i18n/es_AR.po
--rw-r--r--  2.0 unx     2475 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/i18n/stock_picking_consolidation_priority.pot
--rw-r--r--  2.0 unx       58 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/models/__init__.py
--rw-r--r--  2.0 unx     5769 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/models/stock_move.py
--rw-r--r--  2.0 unx      854 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/models/stock_picking_type.py
--rw-r--r--  2.0 unx       78 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/readme/CONFIGURATION.rst
--rw-r--r--  2.0 unx      103 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      759 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      183 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/readme/ROADMAP.rst
--rw-r--r--  2.0 unx     9455 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/static/description/icon.png
--rw-r--r--  2.0 unx    13180 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/static/description/index.html
--rw-r--r--  2.0 unx       42 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/tests/__init__.py
--rw-r--r--  2.0 unx    12634 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/tests/test_consolidation_priority.py
--rw-r--r--  2.0 unx      495 b- defN 21-Oct-20 05:01 odoo/addons/stock_picking_consolidation_priority/views/stock_picking_type.xml
--rw-r--r--  2.0 unx     4277 b- defN 21-Oct-20 05:02 odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 21-Oct-20 05:02 odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 21-Oct-20 05:02 odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2679 b- defN 21-Oct-20 05:02 odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/RECORD
-21 files, 60679 bytes uncompressed, 26166 bytes compressed:  56.9%
+Zip file size: 31040 bytes, number of entries: 21
+-rw-r--r--  2.0 unx     3690 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/__init__.py
+-rw-r--r--  2.0 unx      528 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/__manifest__.py
+-rw-r--r--  2.0 unx     3302 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/i18n/es_AR.po
+-rw-r--r--  2.0 unx     2475 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/i18n/stock_picking_consolidation_priority.pot
+-rw-r--r--  2.0 unx       58 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/models/__init__.py
+-rw-r--r--  2.0 unx     6410 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/models/stock_move.py
+-rw-r--r--  2.0 unx      854 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/models/stock_picking_type.py
+-rw-r--r--  2.0 unx       78 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/readme/CONFIGURATION.rst
+-rw-r--r--  2.0 unx      103 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      759 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      183 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/static/description/icon.png
+-rw-r--r--  2.0 unx    13180 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/static/description/index.html
+-rw-r--r--  2.0 unx       42 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/tests/__init__.py
+-rw-r--r--  2.0 unx    13058 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/tests/test_consolidation_priority.py
+-rw-r--r--  2.0 unx      495 b- defN 23-Jun-19 13:58 odoo/addons/stock_picking_consolidation_priority/views/stock_picking_type.xml
+-rw-r--r--  2.0 unx     4272 b- defN 23-Jun-19 13:58 odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-19 13:58 odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-19 13:58 odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2659 b- defN 23-Jun-19 13:58 odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/RECORD
+21 files, 61719 bytes uncompressed, 26356 bytes compressed:  57.3%
```

## zipnote {}

```diff
@@ -45,20 +45,20 @@
 
 Filename: odoo/addons/stock_picking_consolidation_priority/tests/test_consolidation_priority.py
 Comment: 
 
 Filename: odoo/addons/stock_picking_consolidation_priority/views/stock_picking_type.xml
 Comment: 
 
-Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/METADATA
+Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/WHEEL
+Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/top_level.txt
+Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/RECORD
+Filename: odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/stock_picking_consolidation_priority/__manifest__.py

```diff
@@ -1,14 +1,14 @@
 # Copyright 2020 Camptocamp SA
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
 {
     "name": "Stock Transfers Consolidation Priority",
     "summary": "Raise priority of all transfers for a chain when started",
-    "version": "14.0.1.0.1",
+    "version": "14.0.1.1.0",
     "author": "Camptocamp, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/wms",
     "category": "Stock Management",
     "depends": ["stock"],
     "data": ["views/stock_picking_type.xml"],
     "installable": True,
     "license": "AGPL-3",
```

## odoo/addons/stock_picking_consolidation_priority/models/stock_move.py

```diff
@@ -117,8 +117,23 @@
         if not move_ids:
             return
         moves = self.search(
             expression.AND(
                 [[("id", "in", move_ids)], self._consolidate_priority_domain()]
             )
         )
-        moves.write(self._consolidate_priority_values())
+        for move in moves:
+            # Flag the move as urgent.
+            move.write(self._consolidate_priority_values())
+        for picking in moves.picking_id:
+            # Flag the picking as urgent if it only contains urgent moves.
+            picking_moves = picking.move_lines.filtered(
+                lambda m: m.state not in ("cancel", "done")
+            )
+            if (
+                all(
+                    m.priority == self._consolidate_priority_value
+                    for m in picking_moves
+                )
+                and picking.priority is not self._consolidate_priority_value
+            ):
+                picking.write(self._consolidate_priority_values())
```

## odoo/addons/stock_picking_consolidation_priority/tests/test_consolidation_priority.py

```diff
@@ -294,14 +294,24 @@
                         for move in self.all_chain_moves().sorted(
                             lambda m: (-int(m.priority), m.id)
                         )
                     ]
                 ),
             ),
         )
+        changed_pickings = changed_moves.picking_id
+        unchanged_pickings = unchanged_moves.picking_id
+        changed_ok = all(
+            picking.priority == expected_priority for picking in changed_pickings
+        )
+        unchanged_ok = all(
+            picking.priority == PROCUREMENT_PRIORITIES[0][0]
+            for picking in unchanged_pickings
+        )
+        self.assertTrue(changed_ok and unchanged_ok)
 
     def assert_default_priority(self):
         self.assert_priority(
             # nothing is changed yet
             self.env["stock.move"],
             # all moves are unchanged
             self.all_chain_moves(),
```

## Comparing `odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/METADATA` & `odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-stock-picking-consolidation-priority
-Version: 14.0.1.0.2.dev2
+Version: 14.0.1.1.0
 Summary: Raise priority of all transfers for a chain when started
 Home-page: https://github.com/OCA/wms
 Author: Camptocamp, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/RECORD` & `odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,21 +1,21 @@
 odoo/addons/stock_picking_consolidation_priority/README.rst,sha256=LHSLC43gwf32KJ7_ebDhSfWJ9qYFgRFcLyGxgUbCtAM,3690
 odoo/addons/stock_picking_consolidation_priority/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/stock_picking_consolidation_priority/__manifest__.py,sha256=s7WRgwI16nWT0rEmRad7EEhwV6LlE7AIesi8rlqK5sw,528
+odoo/addons/stock_picking_consolidation_priority/__manifest__.py,sha256=GOFUNVphybguFWNRopGeEWc5VHQTsNwES2geeEkel4M,528
 odoo/addons/stock_picking_consolidation_priority/i18n/es_AR.po,sha256=nRQgsscbFPUcYXqT6K6mbAg_GPKZeNJknTu3Syp2dUI,3302
 odoo/addons/stock_picking_consolidation_priority/i18n/stock_picking_consolidation_priority.pot,sha256=e68cCIrYSqds8P9xOsBziuaO4vKmCKkBOqJerh7VYwU,2475
 odoo/addons/stock_picking_consolidation_priority/models/__init__.py,sha256=lf5WkV2L9JQOaGhTEP4kKsFfg4EZCww0Q6kPp5IjmjI,58
-odoo/addons/stock_picking_consolidation_priority/models/stock_move.py,sha256=30tsqx46To20M3nhdr4gcNRduWhYtQzk_bmcmCn-Jyg,5769
+odoo/addons/stock_picking_consolidation_priority/models/stock_move.py,sha256=LwE1h0GFjfyROPXA78UaLruGqPEXTQDkBGaXahW0rqA,6410
 odoo/addons/stock_picking_consolidation_priority/models/stock_picking_type.py,sha256=-w5Dh1XZ_eOoKu73OwaJy9SpfCY3o35gvRnNTU_tyqU,854
 odoo/addons/stock_picking_consolidation_priority/readme/CONFIGURATION.rst,sha256=7KOoSbF7A89jb00lQ09CNOB7c3HDl_Thhtf17yunlgo,78
 odoo/addons/stock_picking_consolidation_priority/readme/CONTRIBUTORS.rst,sha256=nDQbyqP6ri7tov7-XKxcXxrJQwhET68fOevtmWYlhHE,103
 odoo/addons/stock_picking_consolidation_priority/readme/DESCRIPTION.rst,sha256=J8rm8zUbcSa2KTZZXux5f6GCrMiHEq0vHcF7EcRXXFE,759
 odoo/addons/stock_picking_consolidation_priority/readme/ROADMAP.rst,sha256=qftFRJaK_HqrFWt06QecmmrshPCegSQsW8FHLdVRtmw,183
 odoo/addons/stock_picking_consolidation_priority/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/stock_picking_consolidation_priority/static/description/index.html,sha256=Gh2cEw0cIFgUZUtffPUZEiyOqGyl9qUIbHZHft00e4k,13180
 odoo/addons/stock_picking_consolidation_priority/tests/__init__.py,sha256=8MEoE8Ya1kMiJSXe3MkjmstLy2GertqhWk3fiVH6B8w,42
-odoo/addons/stock_picking_consolidation_priority/tests/test_consolidation_priority.py,sha256=RsDSm73AVY_nzlA7j1nwQzwQ83fjE--Jt-SokN9vv7o,12634
+odoo/addons/stock_picking_consolidation_priority/tests/test_consolidation_priority.py,sha256=QZn6YYetK8heTzfsXVkROlytoTfz9Eeh1nvaz28_K38,13058
 odoo/addons/stock_picking_consolidation_priority/views/stock_picking_type.xml,sha256=wW3IlBjpUvEL7oY4trSWPv8LxCnLKSxg1SXtK2Z373o,495
-odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/METADATA,sha256=6mNSe47EwzivmtjYQ5CpQ5LWED8HepYmfNPqKBvxDZ8,4277
-odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_stock_picking_consolidation_priority-14.0.1.0.2.dev2.dist-info/RECORD,,
+odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/METADATA,sha256=Vzs3S_bJ1gutavIO76Xbj1OSRh5Uro0iMQeEUJEEEuk,4272
+odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_stock_picking_consolidation_priority-14.0.1.1.0.dist-info/RECORD,,
```

