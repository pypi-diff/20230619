# Comparing `tmp/Geoarchpy-1.0.0.tar.gz` & `tmp/Geoarchpy-1.0.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "M:\GitHub\ArchPy\dist\.tmp-qfpxr5g3\Geoarchpy-1.0.0.tar", last modified: Mon Jun 19 09:55:34 2023, max compression
+gzip compressed data, was "Geoarchpy-1.0.1.tar", last modified: Mon Jun 19 17:29:57 2023, max compression
```

## Comparing `Geoarchpy-1.0.0.tar` & `Geoarchpy-1.0.1.tar`

### file list

```diff
@@ -1,22 +1,22 @@
-drwxrwxrwx   0        0        0        0 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/
-drwxrwxrwx   0        0        0        0 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/ArchPy/
--rw-rw-rw-   0        0        0      133 2023-06-19 09:54:58.000000 Geoarchpy-1.0.0/ArchPy/__init__.py
--rw-rw-rw-   0        0        0     6198 2023-06-13 06:37:51.000000 Geoarchpy-1.0.0/ArchPy/automatic_pile.py
--rw-rw-rw-   0        0        0   279101 2023-06-16 13:52:08.000000 Geoarchpy-1.0.0/ArchPy/base.py
--rw-rw-rw-   0        0        0     3560 2023-06-13 06:37:51.000000 Geoarchpy-1.0.0/ArchPy/data_transfo.py
--rw-rw-rw-   0        0        0    24159 2023-06-13 06:37:51.000000 Geoarchpy-1.0.0/ArchPy/ineq.py
--rw-rw-rw-   0        0        0    29194 2023-06-14 09:46:54.000000 Geoarchpy-1.0.0/ArchPy/infer.py
--rw-rw-rw-   0        0        0    55067 2023-06-16 13:01:08.000000 Geoarchpy-1.0.0/ArchPy/inputs.py
--rw-rw-rw-   0        0        0    33572 2023-06-13 06:37:51.000000 Geoarchpy-1.0.0/ArchPy/tpgs.py
--rw-rw-rw-   0        0        0    28183 2023-06-13 06:37:51.000000 Geoarchpy-1.0.0/ArchPy/x_valid.py
-drwxrwxrwx   0        0        0        0 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/Geoarchpy.egg-info/
--rw-rw-rw-   0        0        0    43562 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/Geoarchpy.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      353 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/Geoarchpy.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/Geoarchpy.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0      103 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/Geoarchpy.egg-info/requires.txt
--rw-rw-rw-   0        0        0        7 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/Geoarchpy.egg-info/top_level.txt
--rw-rw-rw-   0        0        0    35823 2022-03-14 07:36:22.000000 Geoarchpy-1.0.0/LICENSE
--rw-rw-rw-   0        0        0    43562 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/PKG-INFO
--rw-rw-rw-   0        0        0     2054 2023-06-19 07:53:38.000000 Geoarchpy-1.0.0/README.md
--rw-rw-rw-   0        0        0       42 2023-06-19 09:55:34.000000 Geoarchpy-1.0.0/setup.cfg
--rw-rw-rw-   0        0        0     1089 2023-06-19 09:55:20.000000 Geoarchpy-1.0.0/setup.py
+drwxrwxrwx   0        0        0        0 2023-06-19 17:29:57.543951 Geoarchpy-1.0.1/
+drwxrwxrwx   0        0        0        0 2023-06-19 17:29:57.523933 Geoarchpy-1.0.1/ArchPy/
+-rw-rw-rw-   0        0        0      133 2023-06-19 16:27:53.000000 Geoarchpy-1.0.1/ArchPy/__init__.py
+-rw-rw-rw-   0        0        0     6198 2023-06-12 06:40:39.000000 Geoarchpy-1.0.1/ArchPy/automatic_pile.py
+-rw-rw-rw-   0        0        0   281341 2023-06-19 16:27:53.000000 Geoarchpy-1.0.1/ArchPy/base.py
+-rw-rw-rw-   0        0        0     3560 2023-06-12 06:40:39.000000 Geoarchpy-1.0.1/ArchPy/data_transfo.py
+-rw-rw-rw-   0        0        0    24159 2023-06-12 17:58:29.000000 Geoarchpy-1.0.1/ArchPy/ineq.py
+-rw-rw-rw-   0        0        0    29194 2023-06-12 17:58:29.000000 Geoarchpy-1.0.1/ArchPy/infer.py
+-rw-rw-rw-   0        0        0    55067 2023-06-19 16:27:53.000000 Geoarchpy-1.0.1/ArchPy/inputs.py
+-rw-rw-rw-   0        0        0    33572 2023-06-12 17:58:29.000000 Geoarchpy-1.0.1/ArchPy/tpgs.py
+-rw-rw-rw-   0        0        0    28199 2023-06-19 16:27:53.000000 Geoarchpy-1.0.1/ArchPy/x_valid.py
+drwxrwxrwx   0        0        0        0 2023-06-19 17:29:57.541949 Geoarchpy-1.0.1/Geoarchpy.egg-info/
+-rw-rw-rw-   0        0        0    43562 2023-06-19 17:29:57.000000 Geoarchpy-1.0.1/Geoarchpy.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      353 2023-06-19 17:29:57.000000 Geoarchpy-1.0.1/Geoarchpy.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-06-19 17:29:57.000000 Geoarchpy-1.0.1/Geoarchpy.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       89 2023-06-19 17:29:57.000000 Geoarchpy-1.0.1/Geoarchpy.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        7 2023-06-19 17:29:57.000000 Geoarchpy-1.0.1/Geoarchpy.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0    35823 2022-10-14 09:39:26.000000 Geoarchpy-1.0.1/LICENSE
+-rw-rw-rw-   0        0        0    43562 2023-06-19 17:29:57.542950 Geoarchpy-1.0.1/PKG-INFO
+-rw-rw-rw-   0        0        0     2054 2023-06-19 16:27:53.000000 Geoarchpy-1.0.1/README.md
+-rw-rw-rw-   0        0        0       42 2023-06-19 17:29:57.543951 Geoarchpy-1.0.1/setup.cfg
+-rw-rw-rw-   0        0        0     1049 2023-06-19 16:27:53.000000 Geoarchpy-1.0.1/setup.py
```

### filetype from file(1)

```diff
@@ -1 +1 @@
-POSIX tar archive (GNU)
+POSIX tar archive
```

### Comparing `Geoarchpy-1.0.0/ArchPy/automatic_pile.py` & `Geoarchpy-1.0.1/ArchPy/automatic_pile.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/ArchPy/base.py` & `Geoarchpy-1.0.1/ArchPy/base.py`

 * *Files 1% similar despite different names*

```diff
@@ -10457,6988 +10457,7128 @@
 00028d80: 4944 222c 2076 623d 3029 0d0a 2020 2020  ID", vb=0)..    
 00028d90: 2020 2020 2020 2020 2020 2020 6966 2075              if u
 00028da0: 6e69 7420 6973 206e 6f74 204e 6f6e 653a  nit is not None:
 00028db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00028dc0: 2020 2020 2020 6172 725b 6979 2c20 6978        arr[iy, ix
 00028dd0: 5d20 3d20 6d61 7470 6c6f 746c 6962 2e63  ] = matplotlib.c
 00028de0: 6f6c 6f72 732e 746f 5f72 6762 2875 6e69  olors.to_rgb(uni
-00028df0: 742e 6329 0d0a 0d0a 2020 2020 2020 2020  t.c)....        
-00028e00: 6772 6964 2e70 6f69 6e74 5f61 7272 6179  grid.point_array
-00028e10: 735b 276d 7920 706f 696e 7420 7661 6c75  s['my point valu
-00028e20: 6573 275d 203d 2061 7272 2e72 6573 6861  es'] = arr.resha
-00028e30: 7065 2828 6e78 2a6e 792c 2033 292c 6f72  pe((nx*ny, 3),or
-00028e40: 6465 723d 2246 2229 0d0a 2020 2020 2020  der="F")..      
-00028e50: 2020 0d0a 2020 2020 2020 2020 6966 2070    ..        if p
-00028e60: 6c6f 7474 6572 2069 7320 4e6f 6e65 3a0d  lotter is None:.
-00028e70: 0a20 2020 2020 2020 2020 2020 2070 203d  .            p =
-00028e80: 2070 762e 506c 6f74 7465 7228 290d 0a0d   pv.Plotter()...
-00028e90: 0a20 2020 2020 2020 2020 2020 2070 2e61  .            p.a
-00028ea0: 6464 5f6d 6573 6828 6772 6964 2c22 7265  dd_mesh(grid,"re
-00028eb0: 6422 2c73 6361 6c61 7273 3d22 6d79 2070  d",scalars="my p
-00028ec0: 6f69 6e74 2076 616c 7565 7322 2c6f 7061  oint values",opa
-00028ed0: 6369 7479 3d2e 352c 2072 6762 3d54 7275  city=.5, rgb=Tru
-00028ee0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00028ef0: 702e 6164 645f 626f 756e 6469 6e67 5f62  p.add_bounding_b
-00028f00: 6f78 2829 0d0a 2020 2020 2020 2020 2020  ox()..          
-00028f10: 2020 702e 7368 6f77 2829 0d0a 2020 2020    p.show()..    
-00028f20: 2020 2020 0d0a 2020 2020 2020 2020 656c      ..        el
-00028f30: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00028f40: 2070 6c6f 7474 6572 2e61 6464 5f6d 6573   plotter.add_mes
-00028f50: 6828 6772 6964 2c22 7265 6422 2c73 6361  h(grid,"red",sca
-00028f60: 6c61 7273 3d22 6d79 2070 6f69 6e74 2076  lars="my point v
-00028f70: 616c 7565 7322 2c6f 7061 6369 7479 3d2e  alues",opacity=.
-00028f80: 352c 2072 6762 3d54 7275 6529 0d0a 0d0a  5, rgb=True)....
-00028f90: 2020 2020 6465 6620 6765 745f 756e 6974      def get_unit
-00028fa0: 735f 646f 6d61 696e 735f 7265 616c 697a  s_domains_realiz
-00028fb0: 6174 696f 6e73 2873 656c 662c 2069 753d  ations(self, iu=
-00028fc0: 4e6f 6e65 2c20 616c 6c5f 6461 7461 3d54  None, all_data=T
-00028fd0: 7275 652c 2066 696c 6c3d 2249 4422 2c20  rue, fill="ID", 
-00028fe0: 685f 6c65 7665 6c3d 2261 6c6c 2229 3a0d  h_level="all"):.
-00028ff0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00029000: 2020 2020 2020 2020 5265 7475 726e 2061          Return a
-00029010: 206e 756d 7079 2061 7272 6179 206f 6620   numpy array of 
-00029020: 3120 6f72 2061 6c6c 2075 6e69 7473 2072  1 or all units r
-00029030: 6561 6c69 7a61 7469 6f6e 2873 292e 0d0a  ealization(s)...
-00029040: 0d0a 2020 2020 2020 2020 6975 3a20 696e  ..        iu: in
-00029050: 740d 0a20 2020 2020 2020 2020 2020 2073  t..            s
-00029060: 696d 756c 6174 696f 6e20 746f 2072 6574  imulation to ret
-00029070: 7572 6e0d 0a20 2020 2020 2020 2061 6c6c  urn..        all
-00029080: 5f64 6174 613a 2062 6f6f 6c0d 0a20 2020  _data: bool..   
-00029090: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000290a0: 616c 6c20 7468 6520 756e 6974 7320 7369  all the units si
-000290b0: 6d75 6c61 7469 6f6e 732c 0d0a 2020 2020  mulations,..    
-000290c0: 2020 2020 2020 2020 696e 2074 6861 7420          in that 
-000290d0: 6361 7365 2c20 6975 2069 7320 6967 6e6f  case, iu is igno
-000290e0: 7265 640d 0a20 2020 2020 2020 2066 696c  red..        fil
-000290f0: 6c3a 2073 7472 696e 670d 0a20 2020 2020  l: string..     
-00029100: 2020 2020 2020 2049 4420 6f72 2063 6f6c         ID or col
-00029110: 6f72 2061 7265 2070 6f73 7369 626c 652c  or are possible,
-00029120: 2074 6f20 7265 7475 726e 0d0a 2020 2020   to return..    
-00029130: 2020 2020 2020 2020 7265 616c 697a 6174          realizat
-00029140: 696f 6e73 2077 6974 6820 756e 6974 2049  ions with unit I
-00029150: 4420 6f72 2052 4742 4120 636f 6c6f 720d  D or RGBA color.
-00029160: 0a20 2020 2020 2020 2020 2020 2028 666f  .            (fo
-00029170: 7220 706c 6f74 7469 6e67 2070 7572 706f  r plotting purpo
-00029180: 7365 2065 2e67 2e20 7769 7468 2070 6c74  se e.g. with plt
-00029190: 2e69 6d73 686f 7729 0d0a 2020 2020 2020  .imshow)..      
-000291a0: 2020 685f 6c65 7665 6c3a 2073 7472 696e    h_level: strin
-000291b0: 6720 6f72 2069 6e74 0d0a 2020 2020 2020  g or int..      
-000291c0: 2020 2020 2020 6869 6572 6172 6368 6963        hierarchic
-000291d0: 616c 206c 6576 656c 2074 6f20 706c 6f74  al level to plot
-000291e0: 2e0d 0a20 2020 2020 2020 2020 2020 2041  ...            A
-000291f0: 2076 616c 7565 206f 6620 3120 696e 6469   value of 1 indi
-00029200: 6361 7465 7320 7468 6174 206f 6e6c 7920  cates that only 
-00029210: 756e 6974 206f 6620 7468 650d 0a20 2020  unit of the..   
-00029220: 2020 2020 2020 2020 206d 6173 7465 7220           master 
-00029230: 7069 6c65 2077 696c 6c20 6265 2070 6c6f  pile will be plo
-00029240: 7474 6564 2e20 2261 6c6c 2220 746f 2070  tted. "all" to p
-00029250: 6c6f 7420 616c 6c20 706f 7373 6962 6c65  lot all possible
-00029260: 2075 6e69 7473 0d0a 2020 2020 2020 2020   units..        
-00029270: 2222 220d 0a0d 0a20 2020 2020 2020 2023  """....        #
-00029280: 2069 6620 7365 6c66 2e47 656f 6c2e 756e   if self.Geol.un
-00029290: 6974 735f 646f 6d61 696e 7320 6973 204e  its_domains is N
-000292a0: 6f6e 653a 0d0a 2020 2020 2020 2020 2320  one:..        # 
-000292b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000292c0: 7272 6f72 2822 556e 6974 7320 6861 7665  rror("Units have
-000292d0: 206e 6f74 2062 6565 6e20 636f 6d70 7574   not been comput
-000292e0: 6564 2079 6574 2229 0d0a 2020 2020 2020  ed yet")..      
-000292f0: 2020 6966 2073 656c 662e 7772 6974 655f    if self.write_
-00029300: 7265 7375 6c74 733a 0d0a 2020 2020 2020  results:..      
-00029310: 2020 2020 2020 6966 2022 7564 2220 6e6f        if "ud" no
-00029320: 7420 696e 205b 692e 7370 6c69 7428 222e  t in [i.split(".
-00029330: 2229 5b2d 315d 2066 6f72 2069 2069 6e20  ")[-1] for i in 
-00029340: 6f73 2e6c 6973 7464 6972 2873 656c 662e  os.listdir(self.
-00029350: 7773 295d 3a0d 0a20 2020 2020 2020 2020  ws)]:..         
-00029360: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00029370: 7565 4572 726f 7228 2255 6e69 7473 2068  ueError("Units h
-00029380: 6176 6520 6e6f 7420 6265 656e 2063 6f6d  ave not been com
-00029390: 7075 7465 6420 7965 7422 290d 0a0d 0a20  puted yet").... 
-000293a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000293b0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000293c0: 6c66 2e47 656f 6c2e 756e 6974 735f 646f  lf.Geol.units_do
-000293d0: 6d61 696e 7320 6973 204e 6f6e 653a 0d0a  mains is None:..
-000293e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000293f0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00029400: 2822 556e 6974 7320 6861 7665 206e 6f74  ("Units have not
-00029410: 2062 6565 6e20 636f 6d70 7574 6564 2079   been computed y
-00029420: 6574 2229 0d0a 0d0a 2020 2020 2020 2020  et")....        
-00029430: 6966 2069 7369 6e73 7461 6e63 6528 6975  if isinstance(iu
-00029440: 2c20 696e 7429 3a0d 0a20 2020 2020 2020  , int):..       
-00029450: 2020 2020 2061 6c6c 5f64 6174 613d 4661       all_data=Fa
-00029460: 6c73 650d 0a0d 0a20 2020 2020 2020 206e  lse....        n
-00029470: 7265 616c 3d73 656c 662e 6e72 6561 6c5f  real=self.nreal_
-00029480: 756e 6974 730d 0a20 2020 2020 2020 206e  units..        n
-00029490: 783d 7365 6c66 2e67 6574 5f6e 7828 290d  x=self.get_nx().
-000294a0: 0a20 2020 2020 2020 206e 793d 7365 6c66  .        ny=self
-000294b0: 2e67 6574 5f6e 7928 290d 0a20 2020 2020  .get_ny()..     
-000294c0: 2020 206e 7a3d 7365 6c66 2e67 6574 5f6e     nz=self.get_n
-000294d0: 7a28 290d 0a0d 0a20 2020 2020 2020 2069  z()....        i
-000294e0: 6620 616c 6c5f 6461 7461 3a0d 0a20 2020  f all_data:..   
-000294f0: 2020 2020 2020 2020 2075 643d 6e70 2e7a           ud=np.z
-00029500: 6572 6f73 285b 6e72 6561 6c2c 206e 7a2c  eros([nreal, nz,
-00029510: 206e 792c 206e 785d 2c20 6474 7970 653d   ny, nx], dtype=
-00029520: 6e70 2e69 6e74 3829 0d0a 0d0a 2020 2020  np.int8)....    
-00029530: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00029540: 7772 6974 655f 7265 7375 6c74 733a 0d0a  write_results:..
-00029550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029560: 2320 6765 7420 616c 6c20 7265 616c 0d0a  # get all real..
-00029570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029580: 666f 7220 6972 6561 6c20 696e 2072 616e  for ireal in ran
-00029590: 6765 286e 7265 616c 293a 0d0a 2020 2020  ge(nreal):..    
-000295a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295b0: 666e 616d 653d 7365 6c66 2e6e 616d 652b  fname=self.name+
-000295c0: 225f 7b7d 2e75 6422 2e66 6f72 6d61 7428  "_{}.ud".format(
-000295d0: 6972 6561 6c29 0d0a 2020 2020 2020 2020  ireal)..        
-000295e0: 2020 2020 2020 2020 2020 2020 6670 6174              fpat
-000295f0: 683d 6f73 2e70 6174 682e 6a6f 696e 2873  h=os.path.join(s
-00029600: 656c 662e 7773 2c20 666e 616d 6529 0d0a  elf.ws, fname)..
-00029610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029620: 2020 2020 7769 7468 206f 7065 6e28 6670      with open(fp
-00029630: 6174 682c 2022 7262 2229 2061 7320 663a  ath, "rb") as f:
-00029640: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029650: 2020 2020 2020 2020 2020 7564 5b69 7265            ud[ire
-00029660: 616c 5d3d 7069 636b 6c65 2e6c 6f61 6428  al]=pickle.load(
-00029670: 6629 0d0a 2020 2020 2020 2020 2020 2020  f)..            
-00029680: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00029690: 2020 2020 2020 2075 643d 7365 6c66 2e47         ud=self.G
-000296a0: 656f 6c2e 756e 6974 735f 646f 6d61 696e  eol.units_domain
-000296b0: 732e 636f 7079 2829 0d0a 0d0a 2020 2020  s.copy()....    
-000296c0: 2020 2020 2020 2020 6966 2066 696c 6c20          if fill 
-000296d0: 3d3d 2022 4944 223a 0d0a 2020 2020 2020  == "ID":..      
-000296e0: 2020 2020 2020 2020 2020 756e 6974 735f            units_
-000296f0: 646f 6d61 696e 733d 7564 0d0a 2020 2020  domains=ud..    
-00029700: 2020 2020 2020 2020 2020 2020 6966 2068              if h
-00029710: 5f6c 6576 656c 203d 3d20 2261 6c6c 223a  _level == "all":
-00029720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029730: 2020 2020 2020 7061 7373 0d0a 0d0a 2020        pass....  
-00029740: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00029750: 6966 2069 7369 6e73 7461 6e63 6528 685f  if isinstance(h_
-00029760: 6c65 7665 6c2c 2069 6e74 2920 616e 6420  level, int) and 
-00029770: 685f 6c65 7665 6c20 3e20 303a 0d0a 2020  h_level > 0:..  
-00029780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029790: 2020 6c73 745f 4944 3d6e 702e 756e 6971    lst_ID=np.uniq
-000297a0: 7565 2875 6e69 7473 5f64 6f6d 6169 6e73  ue(units_domains
-000297b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000297c0: 2020 2020 2020 2066 6f72 2069 6478 2069         for idx i
-000297d0: 6e20 6c73 745f 4944 3a0d 0a20 2020 2020  n lst_ID:..     
-000297e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000297f0: 2020 2069 6620 6964 7820 213d 2030 3a0d     if idx != 0:.
-00029800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029810: 2020 2020 2020 2020 2020 2020 2073 3d73               s=s
-00029820: 656c 662e 6765 745f 756e 6974 2849 443d  elf.get_unit(ID=
-00029830: 6964 782c 2074 7970 653d 2249 4422 290d  idx, type="ID").
-00029840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029850: 2020 2020 2020 2020 2020 2020 2068 5f6c               h_l
-00029860: 6576 3d73 2e67 6574 5f68 5f6c 6576 656c  ev=s.get_h_level
-00029870: 2829 2020 2320 6869 6572 6172 6368 6963  ()  # hierarchic
-00029880: 616c 206c 6576 656c 206f 6620 756e 6974  al level of unit
-00029890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000298a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000298b0: 2068 5f6c 6576 203e 2068 5f6c 6576 656c   h_lev > h_level
-000298c0: 3a20 2023 2063 6f6d 7061 7265 2075 6e69  :  # compare uni
-000298d0: 7420 6c65 7665 6c20 7769 7468 206c 6576  t level with lev
-000298e0: 656c 2074 6f20 706c 6f74 0d0a 2020 2020  el to plot..    
-000298f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029900: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00029910: 6920 696e 2072 616e 6765 2868 5f6c 6576  i in range(h_lev
-00029920: 202d 2068 5f6c 6576 656c 293a 0d0a 2020   - h_level):..  
-00029930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028df0: 742e 6329 0d0a 2020 2020 2020 2020 0d0a  t.c)..        ..
+00028e00: 2020 2020 2020 2020 6966 2070 6c6f 7474          if plott
+00028e10: 6572 2069 7320 4e6f 6e65 3a0d 0a20 2020  er is None:..   
+00028e20: 2020 2020 2020 2020 2070 203d 2070 762e           p = pv.
+00028e30: 506c 6f74 7465 7228 290d 0a0d 0a20 2020  Plotter()....   
+00028e40: 2020 2020 2020 2020 2070 2e61 6464 5f6d           p.add_m
+00028e50: 6573 6828 6772 6964 2c22 7265 6422 2c20  esh(grid,"red", 
+00028e60: 7363 616c 6172 733d 6172 722e 7265 7368  scalars=arr.resh
+00028e70: 6170 6528 286e 782a 6e79 2c20 3329 2c6f  ape((nx*ny, 3),o
+00028e80: 7264 6572 3d22 4622 292c 206f 7061 6369  rder="F"), opaci
+00028e90: 7479 3d2e 352c 2072 6762 3d54 7275 6529  ty=.5, rgb=True)
+00028ea0: 0d0a 2020 2020 2020 2020 2020 2020 702e  ..            p.
+00028eb0: 6164 645f 626f 756e 6469 6e67 5f62 6f78  add_bounding_box
+00028ec0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00028ed0: 702e 7368 6f77 2829 0d0a 2020 2020 2020  p.show()..      
+00028ee0: 2020 0d0a 2020 2020 2020 2020 656c 7365    ..        else
+00028ef0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00028f00: 6c6f 7474 6572 2e61 6464 5f6d 6573 6828  lotter.add_mesh(
+00028f10: 6772 6964 2c22 7265 6422 2c73 6361 6c61  grid,"red",scala
+00028f20: 7273 3d61 7272 2e72 6573 6861 7065 2828  rs=arr.reshape((
+00028f30: 6e78 2a6e 792c 2033 292c 6f72 6465 723d  nx*ny, 3),order=
+00028f40: 2246 2229 2c20 6f70 6163 6974 793d 2e35  "F"), opacity=.5
+00028f50: 2c20 7267 623d 5472 7565 290d 0a0d 0a20  , rgb=True).... 
+00028f60: 2020 2064 6566 2067 6574 5f75 6e69 7473     def get_units
+00028f70: 5f64 6f6d 6169 6e73 5f72 6561 6c69 7a61  _domains_realiza
+00028f80: 7469 6f6e 7328 7365 6c66 2c20 6975 3d4e  tions(self, iu=N
+00028f90: 6f6e 652c 2061 6c6c 5f64 6174 613d 5472  one, all_data=Tr
+00028fa0: 7565 2c20 6669 6c6c 3d22 4944 222c 2068  ue, fill="ID", h
+00028fb0: 5f6c 6576 656c 3d22 616c 6c22 293a 0d0a  _level="all"):..
+00028fc0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00028fd0: 2020 2020 2020 2052 6574 7572 6e20 6120         Return a 
+00028fe0: 6e75 6d70 7920 6172 7261 7920 6f66 2031  numpy array of 1
+00028ff0: 206f 7220 616c 6c20 756e 6974 7320 7265   or all units re
+00029000: 616c 697a 6174 696f 6e28 7329 2e0d 0a0d  alization(s)....
+00029010: 0a20 2020 2020 2020 2069 753a 2069 6e74  .        iu: int
+00029020: 0d0a 2020 2020 2020 2020 2020 2020 7369  ..            si
+00029030: 6d75 6c61 7469 6f6e 2074 6f20 7265 7475  mulation to retu
+00029040: 726e 0d0a 2020 2020 2020 2020 616c 6c5f  rn..        all_
+00029050: 6461 7461 3a20 626f 6f6c 0d0a 2020 2020  data: bool..    
+00029060: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00029070: 6c6c 2074 6865 2075 6e69 7473 2073 696d  ll the units sim
+00029080: 756c 6174 696f 6e73 2c0d 0a20 2020 2020  ulations,..     
+00029090: 2020 2020 2020 2069 6e20 7468 6174 2063         in that c
+000290a0: 6173 652c 2069 7520 6973 2069 676e 6f72  ase, iu is ignor
+000290b0: 6564 0d0a 2020 2020 2020 2020 6669 6c6c  ed..        fill
+000290c0: 3a20 7374 7269 6e67 0d0a 2020 2020 2020  : string..      
+000290d0: 2020 2020 2020 4944 206f 7220 636f 6c6f        ID or colo
+000290e0: 7220 6172 6520 706f 7373 6962 6c65 2c20  r are possible, 
+000290f0: 746f 2072 6574 7572 6e0d 0a20 2020 2020  to return..     
+00029100: 2020 2020 2020 2072 6561 6c69 7a61 7469         realizati
+00029110: 6f6e 7320 7769 7468 2075 6e69 7420 4944  ons with unit ID
+00029120: 206f 7220 5247 4241 2063 6f6c 6f72 0d0a   or RGBA color..
+00029130: 2020 2020 2020 2020 2020 2020 2866 6f72              (for
+00029140: 2070 6c6f 7474 696e 6720 7075 7270 6f73   plotting purpos
+00029150: 6520 652e 672e 2077 6974 6820 706c 742e  e e.g. with plt.
+00029160: 696d 7368 6f77 290d 0a20 2020 2020 2020  imshow)..       
+00029170: 2068 5f6c 6576 656c 3a20 7374 7269 6e67   h_level: string
+00029180: 206f 7220 696e 740d 0a20 2020 2020 2020   or int..       
+00029190: 2020 2020 2068 6965 7261 7263 6869 6361       hierarchica
+000291a0: 6c20 6c65 7665 6c20 746f 2070 6c6f 742e  l level to plot.
+000291b0: 0d0a 2020 2020 2020 2020 2020 2020 4120  ..            A 
+000291c0: 7661 6c75 6520 6f66 2031 2069 6e64 6963  value of 1 indic
+000291d0: 6174 6573 2074 6861 7420 6f6e 6c79 2075  ates that only u
+000291e0: 6e69 7420 6f66 2074 6865 0d0a 2020 2020  nit of the..    
+000291f0: 2020 2020 2020 2020 6d61 7374 6572 2070          master p
+00029200: 696c 6520 7769 6c6c 2062 6520 706c 6f74  ile will be plot
+00029210: 7465 642e 2022 616c 6c22 2074 6f20 706c  ted. "all" to pl
+00029220: 6f74 2061 6c6c 2070 6f73 7369 626c 6520  ot all possible 
+00029230: 756e 6974 730d 0a20 2020 2020 2020 2022  units..        "
+00029240: 2222 0d0a 0d0a 2020 2020 2020 2020 2320  ""....        # 
+00029250: 6966 2073 656c 662e 4765 6f6c 2e75 6e69  if self.Geol.uni
+00029260: 7473 5f64 6f6d 6169 6e73 2069 7320 4e6f  ts_domains is No
+00029270: 6e65 3a0d 0a20 2020 2020 2020 2023 2020  ne:..        #  
+00029280: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00029290: 726f 7228 2255 6e69 7473 2068 6176 6520  ror("Units have 
+000292a0: 6e6f 7420 6265 656e 2063 6f6d 7075 7465  not been compute
+000292b0: 6420 7965 7422 290d 0a20 2020 2020 2020  d yet")..       
+000292c0: 2069 6620 7365 6c66 2e77 7269 7465 5f72   if self.write_r
+000292d0: 6573 756c 7473 3a0d 0a20 2020 2020 2020  esults:..       
+000292e0: 2020 2020 2069 6620 2275 6422 206e 6f74       if "ud" not
+000292f0: 2069 6e20 5b69 2e73 706c 6974 2822 2e22   in [i.split("."
+00029300: 295b 2d31 5d20 666f 7220 6920 696e 206f  )[-1] for i in o
+00029310: 732e 6c69 7374 6469 7228 7365 6c66 2e77  s.listdir(self.w
+00029320: 7329 5d3a 0d0a 2020 2020 2020 2020 2020  s)]:..          
+00029330: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00029340: 6545 7272 6f72 2822 556e 6974 7320 6861  eError("Units ha
+00029350: 7665 206e 6f74 2062 6565 6e20 636f 6d70  ve not been comp
+00029360: 7574 6564 2079 6574 2229 0d0a 0d0a 2020  uted yet")....  
+00029370: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00029380: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00029390: 662e 4765 6f6c 2e75 6e69 7473 5f64 6f6d  f.Geol.units_dom
+000293a0: 6169 6e73 2069 7320 4e6f 6e65 3a0d 0a20  ains is None:.. 
+000293b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000293c0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000293d0: 2255 6e69 7473 2068 6176 6520 6e6f 7420  "Units have not 
+000293e0: 6265 656e 2063 6f6d 7075 7465 6420 7965  been computed ye
+000293f0: 7422 290d 0a0d 0a20 2020 2020 2020 2069  t")....        i
+00029400: 6620 6973 696e 7374 616e 6365 2869 752c  f isinstance(iu,
+00029410: 2069 6e74 293a 0d0a 2020 2020 2020 2020   int):..        
+00029420: 2020 2020 616c 6c5f 6461 7461 3d46 616c      all_data=Fal
+00029430: 7365 0d0a 0d0a 2020 2020 2020 2020 6e72  se....        nr
+00029440: 6561 6c3d 7365 6c66 2e6e 7265 616c 5f75  eal=self.nreal_u
+00029450: 6e69 7473 0d0a 2020 2020 2020 2020 6e78  nits..        nx
+00029460: 3d73 656c 662e 6765 745f 6e78 2829 0d0a  =self.get_nx()..
+00029470: 2020 2020 2020 2020 6e79 3d73 656c 662e          ny=self.
+00029480: 6765 745f 6e79 2829 0d0a 2020 2020 2020  get_ny()..      
+00029490: 2020 6e7a 3d73 656c 662e 6765 745f 6e7a    nz=self.get_nz
+000294a0: 2829 0d0a 0d0a 2020 2020 2020 2020 6966  ()....        if
+000294b0: 2061 6c6c 5f64 6174 613a 0d0a 2020 2020   all_data:..    
+000294c0: 2020 2020 2020 2020 7564 3d6e 702e 7a65          ud=np.ze
+000294d0: 726f 7328 5b6e 7265 616c 2c20 6e7a 2c20  ros([nreal, nz, 
+000294e0: 6e79 2c20 6e78 5d2c 2064 7479 7065 3d6e  ny, nx], dtype=n
+000294f0: 702e 696e 7438 290d 0a0d 0a20 2020 2020  p.int8)....     
+00029500: 2020 2020 2020 2069 6620 7365 6c66 2e77         if self.w
+00029510: 7269 7465 5f72 6573 756c 7473 3a0d 0a20  rite_results:.. 
+00029520: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00029530: 2067 6574 2061 6c6c 2072 6561 6c0d 0a20   get all real.. 
+00029540: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00029550: 6f72 2069 7265 616c 2069 6e20 7261 6e67  or ireal in rang
+00029560: 6528 6e72 6561 6c29 3a0d 0a20 2020 2020  e(nreal):..     
+00029570: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00029580: 6e61 6d65 3d73 656c 662e 6e61 6d65 2b22  name=self.name+"
+00029590: 5f7b 7d2e 7564 222e 666f 726d 6174 2869  _{}.ud".format(i
+000295a0: 7265 616c 290d 0a20 2020 2020 2020 2020  real)..         
+000295b0: 2020 2020 2020 2020 2020 2066 7061 7468             fpath
+000295c0: 3d6f 732e 7061 7468 2e6a 6f69 6e28 7365  =os.path.join(se
+000295d0: 6c66 2e77 732c 2066 6e61 6d65 290d 0a20  lf.ws, fname).. 
+000295e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000295f0: 2020 2077 6974 6820 6f70 656e 2866 7061     with open(fpa
+00029600: 7468 2c20 2272 6222 2920 6173 2066 3a0d  th, "rb") as f:.
+00029610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029620: 2020 2020 2020 2020 2075 645b 6972 6561           ud[irea
+00029630: 6c5d 3d70 6963 6b6c 652e 6c6f 6164 2866  l]=pickle.load(f
+00029640: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00029650: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00029660: 2020 2020 2020 7564 3d73 656c 662e 4765        ud=self.Ge
+00029670: 6f6c 2e75 6e69 7473 5f64 6f6d 6169 6e73  ol.units_domains
+00029680: 2e63 6f70 7928 290d 0a0d 0a20 2020 2020  .copy()....     
+00029690: 2020 2020 2020 2069 6620 6669 6c6c 203d         if fill =
+000296a0: 3d20 2249 4422 3a0d 0a20 2020 2020 2020  = "ID":..       
+000296b0: 2020 2020 2020 2020 2075 6e69 7473 5f64           units_d
+000296c0: 6f6d 6169 6e73 3d75 640d 0a20 2020 2020  omains=ud..     
+000296d0: 2020 2020 2020 2020 2020 2069 6620 685f             if h_
+000296e0: 6c65 7665 6c20 3d3d 2022 616c 6c22 3a0d  level == "all":.
+000296f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029700: 2020 2020 2070 6173 730d 0a0d 0a20 2020       pass....   
+00029710: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00029720: 6620 6973 696e 7374 616e 6365 2868 5f6c  f isinstance(h_l
+00029730: 6576 656c 2c20 696e 7429 2061 6e64 2068  evel, int) and h
+00029740: 5f6c 6576 656c 203e 2030 3a0d 0a20 2020  _level > 0:..   
+00029750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029760: 206c 7374 5f49 443d 6e70 2e75 6e69 7175   lst_ID=np.uniqu
+00029770: 6528 756e 6974 735f 646f 6d61 696e 7329  e(units_domains)
+00029780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029790: 2020 2020 2020 666f 7220 6964 7820 696e        for idx in
+000297a0: 206c 7374 5f49 443a 0d0a 2020 2020 2020   lst_ID:..      
+000297b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297c0: 2020 6966 2069 6478 2021 3d20 303a 0d0a    if idx != 0:..
+000297d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297e0: 2020 2020 2020 2020 2020 2020 733d 7365              s=se
+000297f0: 6c66 2e67 6574 5f75 6e69 7428 4944 3d69  lf.get_unit(ID=i
+00029800: 6478 2c20 7479 7065 3d22 4944 2229 0d0a  dx, type="ID")..
+00029810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029820: 2020 2020 2020 2020 2020 2020 685f 6c65              h_le
+00029830: 763d 732e 6765 745f 685f 6c65 7665 6c28  v=s.get_h_level(
+00029840: 2920 2023 2068 6965 7261 7263 6869 6361  )  # hierarchica
+00029850: 6c20 6c65 7665 6c20 6f66 2075 6e69 740d  l level of unit.
+00029860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029870: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00029880: 685f 6c65 7620 3e20 685f 6c65 7665 6c3a  h_lev > h_level:
+00029890: 2020 2320 636f 6d70 6172 6520 756e 6974    # compare unit
+000298a0: 206c 6576 656c 2077 6974 6820 6c65 7665   level with leve
+000298b0: 6c20 746f 2070 6c6f 740d 0a20 2020 2020  l to plot..     
+000298c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000298d0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+000298e0: 2069 6e20 7261 6e67 6528 685f 6c65 7620   in range(h_lev 
+000298f0: 2d20 685f 6c65 7665 6c29 3a0d 0a20 2020  - h_level):..   
+00029900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029920: 2073 3d73 2e6d 756d 6d79 5f75 6e69 740d   s=s.mummy_unit.
+00029930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00029940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029950: 2020 733d 732e 6d75 6d6d 795f 756e 6974    s=s.mummy_unit
-00029960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029950: 2069 6620 7320 6973 204e 6f6e 653a 0d0a   if s is None:..
+00029960: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00029970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029980: 2020 6966 2073 2069 7320 4e6f 6e65 3a0d    if s is None:.
-00029990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000299a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000299b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000299c0: 4572 726f 7228 2245 7272 6f72 3a20 7061  Error("Error: pa
-000299d0: 7265 6e74 2075 6e69 7420 7265 7475 726e  rent unit return
-000299e0: 2069 7320 4e6f 6e65 2c20 6869 6572 6172   is None, hierar
-000299f0: 6368 7920 7265 6c61 7469 6f6e 7320 6172  chy relations ar
-00029a00: 6520 696e 636f 6e73 6973 7465 6e74 2077  e inconsistent w
-00029a10: 6974 6820 5069 6c65 2061 6e64 2073 696d  ith Pile and sim
-00029a20: 756c 6174 696f 6e73 2229 0d0a 2020 2020  ulations")..    
-00029a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a40: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-00029a50: 735f 646f 6d61 696e 735b 756e 6974 735f  s_domains[units_
-00029a60: 646f 6d61 696e 7320 3d3d 2069 6478 5d3d  domains == idx]=
-00029a70: 732e 4944 2020 2320 6368 616e 6765 2049  s.ID  # change I
-00029a80: 4420 7661 6c75 6573 2074 6f20 4d75 6d6d  D values to Mumm
-00029a90: 7920 4944 0d0a 2020 2020 2020 2020 2020  y ID..          
-00029aa0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00029ab0: 2020 2020 656c 6966 2066 696c 6c20 3d3d      elif fill ==
-00029ac0: 2022 636f 6c6f 7222 3a0d 0a20 2020 2020   "color":..     
-00029ad0: 2020 2020 2020 2020 2020 2075 6e69 7473             units
-00029ae0: 5f64 6f6d 6169 6e73 3d6e 702e 7a65 726f  _domains=np.zero
-00029af0: 7328 5b6e 7265 616c 2c20 6e7a 2c20 6e79  s([nreal, nz, ny
-00029b00: 2c20 6e78 2c20 345d 2c20 6474 7970 653d  , nx, 4], dtype=
-00029b10: 6e70 2e66 6c6f 6174 3332 290d 0a20 2020  np.float32)..   
-00029b20: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00029b30: 2075 6e69 7420 696e 2073 656c 662e 6765   unit in self.ge
-00029b40: 745f 616c 6c5f 756e 6974 7328 293a 0d0a  t_all_units():..
-00029b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b60: 2020 2020 6966 2075 6e69 742e 665f 6d65      if unit.f_me
-00029b70: 7468 6f64 2021 3d20 2253 7562 7069 6c65  thod != "Subpile
-00029b80: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-00029b90: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-00029ba0: 3d28 7564 203d 3d20 756e 6974 2e49 4429  =(ud == unit.ID)
-00029bb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029bc0: 2020 2020 2020 2020 2020 756e 6974 735f            units_
-00029bd0: 646f 6d61 696e 735b 6d61 736b 2c3a 205d  domains[mask,: ]
-00029be0: 3d6d 6174 706c 6f74 6c69 622e 636f 6c6f  =matplotlib.colo
-00029bf0: 7273 2e74 6f5f 7267 6261 2875 6e69 742e  rs.to_rgba(unit.
-00029c00: 6329 0d0a 0d0a 2020 2020 2020 2020 656c  c)....        el
-00029c10: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00029c20: 2069 6620 7365 6c66 2e77 7269 7465 5f72   if self.write_r
-00029c30: 6573 756c 7473 3a0d 0a20 2020 2020 2020  esults:..       
-00029c40: 2020 2020 2020 2020 2066 6e61 6d65 3d73           fname=s
-00029c50: 656c 662e 6e61 6d65 2b22 5f7b 7d2e 7564  elf.name+"_{}.ud
-00029c60: 222e 666f 726d 6174 2869 7529 0d0a 2020  ".format(iu)..  
-00029c70: 2020 2020 2020 2020 2020 2020 2020 6670                fp
-00029c80: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
-00029c90: 2873 656c 662e 7773 2c20 666e 616d 6529  (self.ws, fname)
-00029ca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029cb0: 2020 7769 7468 206f 7065 6e28 6670 6174    with open(fpat
-00029cc0: 682c 2022 7262 2229 2061 7320 663a 0d0a  h, "rb") as f:..
-00029cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ce0: 2020 2020 7564 3d70 6963 6b6c 652e 6c6f      ud=pickle.lo
-00029cf0: 6164 2866 290d 0a20 2020 2020 2020 2020  ad(f)..         
-00029d00: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00029d10: 2020 2020 2020 2020 2020 7564 3d73 656c            ud=sel
-00029d20: 662e 4765 6f6c 2e75 6e69 7473 5f64 6f6d  f.Geol.units_dom
-00029d30: 6169 6e73 2e63 6f70 7928 295b 6975 5d0d  ains.copy()[iu].
-00029d40: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-00029d50: 6620 6669 6c6c 203d 3d20 2249 4422 3a0d  f fill == "ID":.
-00029d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029d70: 2075 6e69 7473 5f64 6f6d 6169 6e73 3d75   units_domains=u
-00029d80: 640d 0a20 2020 2020 2020 2020 2020 2020  d..             
-00029d90: 2020 2069 6620 685f 6c65 7665 6c20 3d3d     if h_level ==
-00029da0: 2022 616c 6c22 3a0d 0a20 2020 2020 2020   "all":..       
-00029db0: 2020 2020 2020 2020 2020 2020 2070 6173               pas
-00029dc0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00029dd0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-00029de0: 6365 2868 5f6c 6576 656c 2c20 696e 7429  ce(h_level, int)
-00029df0: 2061 6e64 2068 5f6c 6576 656c 203e 2030   and h_level > 0
-00029e00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00029e10: 2020 2020 2020 206c 7374 5f49 443d 6e70         lst_ID=np
-00029e20: 2e75 6e69 7175 6528 756e 6974 735f 646f  .unique(units_do
-00029e30: 6d61 696e 7329 0d0a 2020 2020 2020 2020  mains)..        
-00029e40: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00029e50: 6964 7820 696e 206c 7374 5f49 443a 0d0a  idx in lst_ID:..
+00029980: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00029990: 7272 6f72 2822 4572 726f 723a 2070 6172  rror("Error: par
+000299a0: 656e 7420 756e 6974 2072 6574 7572 6e20  ent unit return 
+000299b0: 6973 204e 6f6e 652c 2068 6965 7261 7263  is None, hierarc
+000299c0: 6879 2072 656c 6174 696f 6e73 2061 7265  hy relations are
+000299d0: 2069 6e63 6f6e 7369 7374 656e 7420 7769   inconsistent wi
+000299e0: 7468 2050 696c 6520 616e 6420 7369 6d75  th Pile and simu
+000299f0: 6c61 7469 6f6e 7322 290d 0a20 2020 2020  lations")..     
+00029a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a10: 2020 2020 2020 2020 2020 2075 6e69 7473             units
+00029a20: 5f64 6f6d 6169 6e73 5b75 6e69 7473 5f64  _domains[units_d
+00029a30: 6f6d 6169 6e73 203d 3d20 6964 785d 3d73  omains == idx]=s
+00029a40: 2e49 4420 2023 2063 6861 6e67 6520 4944  .ID  # change ID
+00029a50: 2076 616c 7565 7320 746f 204d 756d 6d79   values to Mummy
+00029a60: 2049 440d 0a20 2020 2020 2020 2020 2020   ID..           
+00029a70: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00029a80: 2020 2065 6c69 6620 6669 6c6c 203d 3d20     elif fill == 
+00029a90: 2263 6f6c 6f72 223a 0d0a 2020 2020 2020  "color":..      
+00029aa0: 2020 2020 2020 2020 2020 756e 6974 735f            units_
+00029ab0: 646f 6d61 696e 733d 6e70 2e7a 6572 6f73  domains=np.zeros
+00029ac0: 285b 6e72 6561 6c2c 206e 7a2c 206e 792c  ([nreal, nz, ny,
+00029ad0: 206e 782c 2034 5d2c 2064 7479 7065 3d6e   nx, 4], dtype=n
+00029ae0: 702e 666c 6f61 7433 3229 0d0a 2020 2020  p.float32)..    
+00029af0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00029b00: 756e 6974 2069 6e20 7365 6c66 2e67 6574  unit in self.get
+00029b10: 5f61 6c6c 5f75 6e69 7473 2829 3a0d 0a20  _all_units():.. 
+00029b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029b30: 2020 2069 6620 756e 6974 2e66 5f6d 6574     if unit.f_met
+00029b40: 686f 6420 213d 2022 5375 6270 696c 6522  hod != "Subpile"
+00029b50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00029b60: 2020 2020 2020 2020 2020 206d 6173 6b3d             mask=
+00029b70: 2875 6420 3d3d 2075 6e69 742e 4944 290d  (ud == unit.ID).
+00029b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029b90: 2020 2020 2020 2020 2075 6e69 7473 5f64           units_d
+00029ba0: 6f6d 6169 6e73 5b6d 6173 6b2c 3a20 5d3d  omains[mask,: ]=
+00029bb0: 6d61 7470 6c6f 746c 6962 2e63 6f6c 6f72  matplotlib.color
+00029bc0: 732e 746f 5f72 6762 6128 756e 6974 2e63  s.to_rgba(unit.c
+00029bd0: 290d 0a0d 0a20 2020 2020 2020 2065 6c73  )....        els
+00029be0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00029bf0: 6966 2073 656c 662e 7772 6974 655f 7265  if self.write_re
+00029c00: 7375 6c74 733a 0d0a 2020 2020 2020 2020  sults:..        
+00029c10: 2020 2020 2020 2020 666e 616d 653d 7365          fname=se
+00029c20: 6c66 2e6e 616d 652b 225f 7b7d 2e75 6422  lf.name+"_{}.ud"
+00029c30: 2e66 6f72 6d61 7428 6975 290d 0a20 2020  .format(iu)..   
+00029c40: 2020 2020 2020 2020 2020 2020 2066 7061               fpa
+00029c50: 7468 3d6f 732e 7061 7468 2e6a 6f69 6e28  th=os.path.join(
+00029c60: 7365 6c66 2e77 732c 2066 6e61 6d65 290d  self.ws, fname).
+00029c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029c80: 2077 6974 6820 6f70 656e 2866 7061 7468   with open(fpath
+00029c90: 2c20 2272 6222 2920 6173 2066 3a0d 0a20  , "rb") as f:.. 
+00029ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029cb0: 2020 2075 643d 7069 636b 6c65 2e6c 6f61     ud=pickle.loa
+00029cc0: 6428 6629 0d0a 2020 2020 2020 2020 2020  d(f)..          
+00029cd0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00029ce0: 2020 2020 2020 2020 2075 643d 7365 6c66           ud=self
+00029cf0: 2e47 656f 6c2e 756e 6974 735f 646f 6d61  .Geol.units_doma
+00029d00: 696e 732e 636f 7079 2829 5b69 755d 0d0a  ins.copy()[iu]..
+00029d10: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00029d20: 2066 696c 6c20 3d3d 2022 4944 223a 0d0a   fill == "ID":..
+00029d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d40: 756e 6974 735f 646f 6d61 696e 733d 7564  units_domains=ud
+00029d50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029d60: 2020 6966 2068 5f6c 6576 656c 203d 3d20    if h_level == 
+00029d70: 2261 6c6c 223a 0d0a 2020 2020 2020 2020  "all":..        
+00029d80: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+00029d90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029da0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00029db0: 6528 685f 6c65 7665 6c2c 2069 6e74 2920  e(h_level, int) 
+00029dc0: 616e 6420 685f 6c65 7665 6c20 3e20 303a  and h_level > 0:
+00029dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029de0: 2020 2020 2020 6c73 745f 4944 3d6e 702e        lst_ID=np.
+00029df0: 756e 6971 7565 2875 6e69 7473 5f64 6f6d  unique(units_dom
+00029e00: 6169 6e73 290d 0a20 2020 2020 2020 2020  ains)..         
+00029e10: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00029e20: 6478 2069 6e20 6c73 745f 4944 3a0d 0a20  dx in lst_ID:.. 
+00029e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e40: 2020 2020 2020 2069 6620 6964 7820 213d         if idx !=
+00029e50: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
 00029e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029e70: 2020 2020 2020 2020 6966 2069 6478 2021          if idx !
-00029e80: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-00029e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ea0: 2020 733d 7365 6c66 2e67 6574 5f75 6e69    s=self.get_uni
-00029eb0: 7428 4944 3d69 6478 2c20 7479 7065 3d22  t(ID=idx, type="
-00029ec0: 4944 2229 0d0a 2020 2020 2020 2020 2020  ID")..          
-00029ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ee0: 2020 685f 6c65 763d 732e 6765 745f 685f    h_lev=s.get_h_
-00029ef0: 6c65 7665 6c28 2920 2023 2068 6965 7261  level()  # hiera
-00029f00: 7263 6869 6361 6c20 6c65 7665 6c20 6f66  rchical level of
-00029f10: 2075 6e69 740d 0a20 2020 2020 2020 2020   unit..         
-00029f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f30: 2020 2069 6620 685f 6c65 7620 3e20 685f     if h_lev > h_
-00029f40: 6c65 7665 6c3a 2020 2320 636f 6d70 6172  level:  # compar
-00029f50: 6520 756e 6974 206c 6576 656c 2077 6974  e unit level wit
-00029f60: 6820 6c65 7665 6c20 746f 2070 6c6f 740d  h level to plot.
-00029f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f90: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00029fa0: 685f 6c65 7620 2d20 685f 6c65 7665 6c29  h_lev - h_level)
-00029fb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00029e70: 2073 3d73 656c 662e 6765 745f 756e 6974   s=self.get_unit
+00029e80: 2849 443d 6964 782c 2074 7970 653d 2249  (ID=idx, type="I
+00029e90: 4422 290d 0a20 2020 2020 2020 2020 2020  D")..           
+00029ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029eb0: 2068 5f6c 6576 3d73 2e67 6574 5f68 5f6c   h_lev=s.get_h_l
+00029ec0: 6576 656c 2829 2020 2320 6869 6572 6172  evel()  # hierar
+00029ed0: 6368 6963 616c 206c 6576 656c 206f 6620  chical level of 
+00029ee0: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
+00029ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f00: 2020 6966 2068 5f6c 6576 203e 2068 5f6c    if h_lev > h_l
+00029f10: 6576 656c 3a20 2023 2063 6f6d 7061 7265  evel:  # compare
+00029f20: 2075 6e69 7420 6c65 7665 6c20 7769 7468   unit level with
+00029f30: 206c 6576 656c 2074 6f20 706c 6f74 0d0a   level to plot..
+00029f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f60: 666f 7220 6920 696e 2072 616e 6765 2868  for i in range(h
+00029f70: 5f6c 6576 202d 2068 5f6c 6576 656c 293a  _lev - h_level):
+00029f80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029fa0: 2020 2020 2020 733d 732e 6d75 6d6d 795f        s=s.mummy_
+00029fb0: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
 00029fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fd0: 2020 2020 2020 2073 3d73 2e6d 756d 6d79         s=s.mummy
-00029fe0: 5f75 6e69 740d 0a20 2020 2020 2020 2020  _unit..         
+00029fd0: 2020 2020 2020 6966 2073 2069 7320 4e6f        if s is No
+00029fe0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
 00029ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a000: 2020 2020 2020 2069 6620 7320 6973 204e         if s is N
-0002a010: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0002a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a030: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0002a040: 5661 6c75 6545 7272 6f72 2822 4572 726f  ValueError("Erro
-0002a050: 723a 2070 6172 656e 7420 756e 6974 2072  r: parent unit r
-0002a060: 6574 7572 6e20 6973 204e 6f6e 652c 2068  eturn is None, h
-0002a070: 6965 7261 7263 6879 2072 656c 6174 696f  ierarchy relatio
-0002a080: 6e73 2061 7265 2069 6e63 6f6e 7369 7374  ns are inconsist
-0002a090: 656e 7420 7769 7468 2050 696c 6520 616e  ent with Pile an
-0002a0a0: 6420 7369 6d75 6c61 7469 6f6e 7322 290d  d simulations").
-0002a0b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0d0: 2075 6e69 7473 5f64 6f6d 6169 6e73 5b75   units_domains[u
-0002a0e0: 6e69 7473 5f64 6f6d 6169 6e73 203d 3d20  nits_domains == 
-0002a0f0: 6964 785d 3d73 2e49 4420 2023 2063 6861  idx]=s.ID  # cha
-0002a100: 6e67 6520 4944 2076 616c 7565 7320 746f  nge ID values to
-0002a110: 204d 756d 6d79 2049 440d 0a0d 0a0d 0a20   Mummy ID...... 
-0002a120: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0002a130: 6669 6c6c 203d 3d20 2263 6f6c 6f72 223a  fill == "color":
-0002a140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a150: 2020 6e7a 2c20 6e79 2c20 6e78 3d75 642e    nz, ny, nx=ud.
-0002a160: 7368 6170 650d 0a20 2020 2020 2020 2020  shape..         
-0002a170: 2020 2020 2020 2075 6e69 7473 5f64 6f6d         units_dom
-0002a180: 6169 6e73 3d6e 702e 7a65 726f 7328 5b6e  ains=np.zeros([n
-0002a190: 7a2c 206e 792c 206e 782c 2034 5d29 0d0a  z, ny, nx, 4])..
-0002a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a1b0: 666f 7220 756e 6974 2069 6e20 7365 6c66  for unit in self
-0002a1c0: 2e67 6574 5f61 6c6c 5f75 6e69 7473 2829  .get_all_units()
-0002a1d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002a1e0: 2020 2020 2020 2069 6620 756e 6974 2e66         if unit.f
-0002a1f0: 5f6d 6574 686f 6420 213d 2022 5375 6270  _method != "Subp
-0002a200: 696c 6522 3a0d 0a20 2020 2020 2020 2020  ile":..         
-0002a210: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002a220: 6173 6b3d 2875 6420 3d3d 2075 6e69 742e  ask=(ud == unit.
-0002a230: 4944 290d 0a20 2020 2020 2020 2020 2020  ID)..           
-0002a240: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
-0002a250: 7473 5f64 6f6d 6169 6e73 5b6d 6173 6b2c  ts_domains[mask,
-0002a260: 3a20 5d3d 6d61 7470 6c6f 746c 6962 2e63  : ]=matplotlib.c
-0002a270: 6f6c 6f72 732e 746f 5f72 6762 6128 756e  olors.to_rgba(un
-0002a280: 6974 2e63 290d 0a0d 0a20 2020 2020 2020  it.c)....       
-0002a290: 2072 6574 7572 6e20 756e 6974 735f 646f   return units_do
-0002a2a0: 6d61 696e 730d 0a0d 0a0d 0a20 2020 2064  mains......    d
-0002a2b0: 6566 2070 6c6f 745f 756e 6974 7328 7365  ef plot_units(se
-0002a2c0: 6c66 2c20 6975 3d30 2c20 765f 6578 3d31  lf, iu=0, v_ex=1
-0002a2d0: 2c20 706c 6f74 7465 723d 4e6f 6e65 2c20  , plotter=None, 
-0002a2e0: 685f 6c65 7665 6c3d 2261 6c6c 222c 2073  h_level="all", s
-0002a2f0: 6c69 6365 783d 4e6f 6e65 2c20 736c 6963  licex=None, slic
-0002a300: 6579 3d4e 6f6e 652c 2073 6c69 6365 7a3d  ey=None, slicez=
-0002a310: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-0002a320: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
-0002a330: 696e 675f 7661 6c75 653d 4e6f 6e65 2c20  ing_value=None, 
-0002a340: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
-0002a350: 733d 4e6f 6e65 2c20 7368 6f77 5f73 6361  s=None, show_sca
-0002a360: 6c61 725f 6261 723d 5472 7565 293a 0d0a  lar_bar=True):..
-0002a370: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0002a380: 2020 2020 2020 2070 6c6f 7420 756e 6974         plot unit
-0002a390: 7320 646f 6d61 696e 2066 6f72 2061 2073  s domain for a s
-0002a3a0: 7065 6369 6669 6320 7265 616c 697a 6174  pecific realizat
-0002a3b0: 696f 6e20 6975 0d0a 0d0a 2020 2020 2020  ion iu....      
-0002a3c0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0002a3d0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0002a3e0: 0d0a 2020 2020 2020 2020 6975 3a20 696e  ..        iu: in
-0002a3f0: 740d 0a20 2020 2020 2020 2020 2020 2075  t..            u
-0002a400: 6e69 7420 696e 6465 7820 746f 2070 6c6f  nit index to plo
-0002a410: 740d 0a20 2020 2020 2020 2076 5f65 783a  t..        v_ex:
-0002a420: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
-0002a430: 2020 2020 7665 7274 6963 616c 2065 7861      vertical exa
-0002a440: 6765 7261 7469 6f6e 0d0a 2020 2020 2020  geration..      
-0002a450: 2020 706c 6f74 7465 723a 2070 7976 6973    plotter: pyvis
-0002a460: 7461 2e50 6c6f 7474 6572 0d0a 2020 2020  ta.Plotter..    
-0002a470: 2020 2020 2020 2020 7079 7669 7374 612e          pyvista.
-0002a480: 506c 6f74 7465 7220 6f62 6a65 6374 2074  Plotter object t
-0002a490: 6f20 706c 6f74 206f 6e0d 0a20 2020 2020  o plot on..     
-0002a4a0: 2020 2068 5f6c 6576 656c 3a20 7374 7269     h_level: stri
-0002a4b0: 6e67 206f 7220 696e 740d 0a20 2020 2020  ng or int..     
-0002a4c0: 2020 2020 2020 2068 6965 7261 7263 6869         hierarchi
-0002a4d0: 6361 6c20 6c65 7665 6c20 746f 2070 6c6f  cal level to plo
-0002a4e0: 742e 0d0a 2020 2020 2020 2020 2020 2020  t...            
-0002a4f0: 4120 7661 6c75 6520 6f66 2031 2069 6e64  A value of 1 ind
-0002a500: 6963 6174 6573 2074 6861 7420 6f6e 6c79  icates that only
-0002a510: 2075 6e69 7420 6f66 2074 6865 0d0a 2020   unit of the..  
-0002a520: 2020 2020 2020 2020 2020 6d61 7374 6572            master
-0002a530: 2070 696c 6520 7769 6c6c 2062 6520 706c   pile will be pl
-0002a540: 6f74 7465 642e 2022 616c 6c22 2074 6f20  otted. "all" to 
-0002a550: 706c 6f74 2061 6c6c 2070 6f73 7369 626c  plot all possibl
-0002a560: 6520 756e 6974 730d 0a20 2020 2020 2020  e units..       
-0002a570: 2073 6c69 6365 783a 2066 6c6f 6174 206f   slicex: float o
-0002a580: 7220 7365 7175 656e 6365 206f 6620 666c  r sequence of fl
-0002a590: 6f61 7473 0d0a 2020 2020 2020 2020 2020  oats..          
-0002a5a0: 2020 6672 6163 7469 6f6e 206f 6620 7820    fraction of x 
-0002a5b0: 6178 6973 2077 6865 7265 2074 6f20 736c  axis where to sl
-0002a5c0: 6963 650d 0a20 2020 2020 2020 2073 6c69  ice..        sli
-0002a5d0: 6365 793a 2066 6c6f 6174 206f 7220 7365  cey: float or se
-0002a5e0: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
-0002a5f0: 0d0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
-0002a600: 6163 7469 6f6e 206f 6620 7920 6178 6973  action of y axis
-0002a610: 2077 6865 7265 2074 6f20 736c 6963 650d   where to slice.
-0002a620: 0a20 2020 2020 2020 2073 6c69 6365 7a3a  .        slicez:
-0002a630: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
-0002a640: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
-0002a650: 2020 2020 2020 2020 2020 6672 6163 7469            fracti
-0002a660: 6f6e 206f 6620 7a20 6178 6973 2077 6865  on of z axis whe
-0002a670: 7265 2074 6f20 736c 6963 650d 0a20 2020  re to slice..   
-0002a680: 2020 2020 2066 696c 7465 7269 6e67 5f76       filtering_v
-0002a690: 616c 7565 3a20 666c 6f61 740d 0a20 2020  alue: float..   
-0002a6a0: 2020 2020 2020 2020 2076 616c 7565 2074           value t
-0002a6b0: 6f20 6669 6c74 6572 206f 6e0d 0a20 2020  o filter on..   
-0002a6c0: 2020 2020 2073 6361 6c61 725f 6261 725f       scalar_bar_
-0002a6d0: 6b77 6172 6773 3a20 6469 6374 0d0a 2020  kwargs: dict..  
-0002a6e0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0002a6f0: 2074 6f20 7061 7373 2074 6f20 7468 6520   to pass to the 
-0002a700: 7363 616c 6172 2062 6172 0d0a 2020 2020  scalar bar..    
-0002a710: 2020 2020 7368 6f77 5f73 6361 6c61 725f      show_scalar_
-0002a720: 6261 723a 2062 6f6f 6c0d 0a20 2020 2020  bar: bool..     
-0002a730: 2020 2020 2020 2073 686f 7720 7363 616c         show scal
-0002a740: 6172 2062 6172 206f 7220 6e6f 7420 2020  ar bar or not   
-0002a750: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0002a760: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
-0002a770: 2365 6e73 7572 6520 6869 6572 6172 6368  #ensure hierarch
-0002a780: 795f 7265 6c61 7469 6f6e 7320 6861 7665  y_relations have
-0002a790: 2062 6565 6e20 7365 740d 0a20 2020 2020   been set..     
-0002a7a0: 2020 2073 656c 662e 6869 6572 6172 6368     self.hierarch
-0002a7b0: 795f 7265 6c61 7469 6f6e 7328 7662 3d30  y_relations(vb=0
-0002a7c0: 290d 0a0d 0a20 2020 2020 2020 2063 6f6c  )....        col
-0002a7d0: 6f72 733d 5b5d 0d0a 2020 2020 2020 2020  ors=[]..        
-0002a7e0: 643d 7b7d 0d0a 2020 2020 2020 2020 6e78  d={}..        nx
-0002a7f0: 3d73 656c 662e 6765 745f 6e78 2829 0d0a  =self.get_nx()..
-0002a800: 2020 2020 2020 2020 6e79 3d73 656c 662e          ny=self.
-0002a810: 6765 745f 6e79 2829 0d0a 2020 2020 2020  get_ny()..      
-0002a820: 2020 6e7a 3d73 656c 662e 6765 745f 6e7a    nz=self.get_nz
-0002a830: 2829 0d0a 2020 2020 2020 2020 7378 3d73  ()..        sx=s
-0002a840: 656c 662e 6765 745f 7378 2829 0d0a 2020  elf.get_sx()..  
-0002a850: 2020 2020 2020 7379 3d73 656c 662e 6765        sy=self.ge
-0002a860: 745f 7379 2829 0d0a 2020 2020 2020 2020  t_sy()..        
-0002a870: 737a 3d73 656c 662e 6765 745f 737a 2829  sz=self.get_sz()
-0002a880: 0d0a 2020 2020 2020 2020 7830 3d73 656c  ..        x0=sel
-0002a890: 662e 6765 745f 6f78 2829 0d0a 2020 2020  f.get_ox()..    
-0002a8a0: 2020 2020 7930 3d73 656c 662e 6765 745f      y0=self.get_
-0002a8b0: 6f79 2829 0d0a 2020 2020 2020 2020 7a30  oy()..        z0
-0002a8c0: 3d73 656c 662e 6765 745f 6f7a 2829 0d0a  =self.get_oz()..
-0002a8d0: 0d0a 2020 2020 2020 2020 7374 7261 7469  ..        strati
-0002a8e0: 735f 646f 6d61 696e 3d73 656c 662e 6765  s_domain=self.ge
-0002a8f0: 745f 756e 6974 735f 646f 6d61 696e 735f  t_units_domains_
-0002a900: 7265 616c 697a 6174 696f 6e73 2869 753d  realizations(iu=
-0002a910: 6975 2c20 6669 6c6c 3d22 4944 222c 2068  iu, fill="ID", h
-0002a920: 5f6c 6576 656c 3d68 5f6c 6576 656c 292e  _level=h_level).
-0002a930: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-0002a940: 3229 0d0a 2020 2020 2020 2020 6c73 745f  2)..        lst_
-0002a950: 4944 3d6e 702e 756e 6971 7565 2873 7472  ID=np.unique(str
-0002a960: 6174 6973 5f64 6f6d 6169 6e29 0d0a 0d0a  atis_domain)....
-0002a970: 2020 2020 2020 2020 2323 2063 6861 6e67          ## chang
-0002a980: 6520 7661 6c75 6573 0d0a 2020 2020 2020  e values..      
-0002a990: 2020 6e65 775f 6964 3d31 0d0a 2020 2020    new_id=1..    
-0002a9a0: 2020 2020 666f 7220 6920 696e 206c 7374      for i in lst
-0002a9b0: 5f49 443a 0d0a 2020 2020 2020 2020 2020  _ID:..          
-0002a9c0: 2020 6966 2069 2021 3d20 303a 0d0a 2020    if i != 0:..  
-0002a9d0: 2020 2020 2020 2020 2020 2020 2020 733d                s=
-0002a9e0: 7365 6c66 2e67 6574 5f75 6e69 7428 4944  self.get_unit(ID
-0002a9f0: 3d69 2c20 7479 7065 3d22 4944 2229 0d0a  =i, type="ID")..
-0002aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa10: 7374 7261 7469 735f 646f 6d61 696e 5b73  stratis_domain[s
-0002aa20: 7472 6174 6973 5f64 6f6d 6169 6e20 3d3d  tratis_domain ==
-0002aa30: 2069 5d3d 6e65 775f 6964 0d0a 2020 2020   i]=new_id..    
-0002aa40: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
-0002aa50: 7273 2e61 7070 656e 6428 732e 6329 0d0a  rs.append(s.c)..
-0002aa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa70: 645b 6e65 775f 6964 202b 302e 355d 3d73  d[new_id +0.5]=s
-0002aa80: 2e6e 616d 650d 0a20 2020 2020 2020 2020  .name..         
-0002aa90: 2020 2020 2020 206e 6577 5f69 6420 2b3d         new_id +=
-0002aaa0: 2031 0d0a 0d0a 2020 2020 2020 2020 2370   1....        #p
-0002aab0: 6c6f 740d 0a20 2020 2020 2020 2073 7472  lot..        str
-0002aac0: 6174 6973 5f64 6f6d 6169 6e5b 7374 7261  atis_domain[stra
-0002aad0: 7469 735f 646f 6d61 696e 3d3d 305d 3d6e  tis_domain==0]=n
-0002aae0: 702e 6e61 6e20 2023 2072 656d 6f76 6520  p.nan  # remove 
-0002aaf0: 7768 6572 6520 6e6f 2066 6f72 6d61 7469  where no formati
-0002ab00: 6f6e 7320 6172 6520 7072 6573 656e 740d  ons are present.
-0002ab10: 0a20 2020 2020 2020 2069 6620 706c 6f74  .        if plot
-0002ab20: 7465 7220 6973 204e 6f6e 653a 0d0a 2020  ter is None:..  
-0002ab30: 2020 2020 2020 2020 2020 703d 7076 2e50            p=pv.P
-0002ab40: 6c6f 7474 6572 2829 0d0a 2020 2020 2020  lotter()..      
-0002ab50: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0002ab60: 2020 2020 2070 3d70 6c6f 7474 6572 0d0a       p=plotter..
-0002ab70: 0d0a 2020 2020 2020 2020 696d 3d67 656f  ..        im=geo
-0002ab80: 6e65 2e69 6d67 2e49 6d67 286e 782c 206e  ne.img.Img(nx, n
-0002ab90: 792c 206e 7a2c 2073 782c 2073 792c 2073  y, nz, sx, sy, s
-0002aba0: 7a2a 765f 6578 2c20 7830 2c20 7930 2c20  z*v_ex, x0, y0, 
-0002abb0: 7a30 2c20 6e76 3d31 2c20 7661 6c3d 7374  z0, nv=1, val=st
-0002abc0: 7261 7469 735f 646f 6d61 696e 2c20 7661  ratis_domain, va
-0002abd0: 726e 616d 653d 2255 6e69 7473 2229 0d0a  rname="Units")..
-0002abe0: 0d0a 2020 2020 2020 2020 6966 2073 6c69  ..        if sli
-0002abf0: 6365 7820 6973 206e 6f74 204e 6f6e 653a  cex is not None:
-0002ac00: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-0002ac10: 6963 6578 3d6e 702e 6172 7261 7928 736c  icex=np.array(sl
-0002ac20: 6963 6578 290d 0a20 2020 2020 2020 2020  icex)..         
-0002ac30: 2020 2073 6c69 6365 785b 736c 6963 6578     slicex[slicex
-0002ac40: 3c30 5d3d 300d 0a20 2020 2020 2020 2020  <0]=0..         
-0002ac50: 2020 2073 6c69 6365 785b 736c 6963 6578     slicex[slicex
-0002ac60: 3e31 5d3d 310d 0a20 2020 2020 2020 2020  >1]=1..         
-0002ac70: 2020 2063 783d 696d 2e6f 7820 2b20 736c     cx=im.ox + sl
-0002ac80: 6963 6578 202a 2069 6d2e 6e78 202a 2069  icex * im.nx * i
-0002ac90: 6d2e 7378 2020 2320 6365 6e74 6572 2061  m.sx  # center a
-0002aca0: 6c6f 6e67 2078 0d0a 2020 2020 2020 2020  long x..        
-0002acb0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0002acc0: 2020 2063 783d 4e6f 6e65 0d0a 2020 2020     cx=None..    
-0002acd0: 2020 2020 6966 2073 6c69 6365 7920 6973      if slicey is
-0002ace0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0002acf0: 2020 2020 2020 2020 736c 6963 6579 3d6e          slicey=n
-0002ad00: 702e 6172 7261 7928 736c 6963 6579 290d  p.array(slicey).
-0002ad10: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
-0002ad20: 6365 795b 736c 6963 6579 3c30 5d3d 300d  cey[slicey<0]=0.
-0002ad30: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
-0002ad40: 6365 795b 736c 6963 6579 3e31 5d3d 310d  cey[slicey>1]=1.
-0002ad50: 0a20 2020 2020 2020 2020 2020 2063 793d  .            cy=
-0002ad60: 696d 2e6f 7920 2b20 736c 6963 6579 202a  im.oy + slicey *
-0002ad70: 2069 6d2e 6e79 202a 2069 6d2e 7379 2020   im.ny * im.sy  
-0002ad80: 2320 6365 6e74 6572 2061 6c6f 6e67 2078  # center along x
-0002ad90: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0002ada0: 0a20 2020 2020 2020 2020 2020 2063 793d  .            cy=
-0002adb0: 4e6f 6e65 0d0a 2020 2020 2020 2020 6966  None..        if
-0002adc0: 2073 6c69 6365 7a20 6973 206e 6f74 204e   slicez is not N
-0002add0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0002ade0: 2020 736c 6963 657a 3d6e 702e 6172 7261    slicez=np.arra
-0002adf0: 7928 736c 6963 657a 290d 0a20 2020 2020  y(slicez)..     
-0002ae00: 2020 2020 2020 2073 6c69 6365 7a5b 736c         slicez[sl
-0002ae10: 6963 657a 3c30 5d3d 300d 0a20 2020 2020  icez<0]=0..     
-0002ae20: 2020 2020 2020 2073 6c69 6365 7a5b 736c         slicez[sl
-0002ae30: 6963 657a 3e31 5d3d 310d 0a20 2020 2020  icez>1]=1..     
-0002ae40: 2020 2020 2020 2063 7a3d 696d 2e6f 7a20         cz=im.oz 
-0002ae50: 2b20 736c 6963 657a 202a 2069 6d2e 6e7a  + slicez * im.nz
-0002ae60: 202a 2069 6d2e 737a 2020 2320 6365 6e74   * im.sz  # cent
-0002ae70: 6572 2061 6c6f 6e67 2078 0d0a 2020 2020  er along x..    
-0002ae80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0002ae90: 2020 2020 2020 2063 7a3d 4e6f 6e65 0d0a         cz=None..
-0002aea0: 0d0a 2020 2020 2020 2020 6966 2073 6c69  ..        if sli
-0002aeb0: 6365 7820 6973 206e 6f74 204e 6f6e 6520  cex is not None 
-0002aec0: 6f72 2073 6c69 6365 7920 6973 206e 6f74  or slicey is not
-0002aed0: 204e 6f6e 6520 6f72 2073 6c69 6365 7a20   None or slicez 
-0002aee0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0002aef0: 2020 2020 2020 2020 2020 696d 6770 6c74            imgplt
-0002af00: 332e 6472 6177 496d 6167 6533 445f 736c  3.drawImage3D_sl
-0002af10: 6963 6528 696d 2c20 706c 6f74 7465 723d  ice(im, plotter=
-0002af20: 702c 2073 6c69 6365 5f6e 6f72 6d61 6c5f  p, slice_normal_
-0002af30: 783d 6378 2c20 736c 6963 655f 6e6f 726d  x=cx, slice_norm
-0002af40: 616c 5f79 3d63 792c 2073 6c69 6365 5f6e  al_y=cy, slice_n
-0002af50: 6f72 6d61 6c5f 7a3d 637a 2c0d 0a20 2020  ormal_z=cz,..   
-0002af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002af80: 2063 7573 746f 6d5f 7363 616c 6172 5f62   custom_scalar_b
-0002af90: 6172 5f66 6f72 5f65 7175 6964 6973 7461  ar_for_equidista
-0002afa0: 6e74 5f63 6174 6567 6f72 6965 733d 5472  nt_categories=Tr
-0002afb0: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
-0002afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002afd0: 2020 2020 2020 2020 2063 7573 746f 6d5f           custom_
-0002afe0: 636f 6c6f 7273 3d63 6f6c 6f72 732c 2073  colors=colors, s
-0002aff0: 6361 6c61 725f 6261 725f 616e 6e6f 7461  calar_bar_annota
-0002b000: 7469 6f6e 733d 642c 2066 696c 7465 7269  tions=d, filteri
-0002b010: 6e67 5f76 616c 7565 3d66 696c 7465 7269  ng_value=filteri
-0002b020: 6e67 5f76 616c 7565 2c0d 0a20 2020 2020  ng_value,..     
-0002b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b040: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002b050: 6361 6c61 725f 6261 725f 6b77 6172 6773  calar_bar_kwargs
-0002b060: 3d73 6361 6c61 725f 6261 725f 6b77 6172  =scalar_bar_kwar
-0002b070: 6773 2c20 7368 6f77 5f73 6361 6c61 725f  gs, show_scalar_
-0002b080: 6261 7220 3d20 7368 6f77 5f73 6361 6c61  bar = show_scala
-0002b090: 725f 6261 7229 0d0a 2020 2020 2020 2020  r_bar)..        
-0002b0a0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0002b0b0: 2020 2069 6d67 706c 7433 2e64 7261 7749     imgplt3.drawI
-0002b0c0: 6d61 6765 3344 5f73 7572 6661 6365 2869  mage3D_surface(i
-0002b0d0: 6d2c 2070 6c6f 7474 6572 3d70 2c20 6375  m, plotter=p, cu
-0002b0e0: 7374 6f6d 5f73 6361 6c61 725f 6261 725f  stom_scalar_bar_
-0002b0f0: 666f 725f 6571 7569 6469 7374 616e 745f  for_equidistant_
-0002b100: 6361 7465 676f 7269 6573 3d54 7275 652c  categories=True,
-0002b110: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b140: 2020 6375 7374 6f6d 5f63 6f6c 6f72 733d    custom_colors=
-0002b150: 636f 6c6f 7273 2c20 7363 616c 6172 5f62  colors, scalar_b
-0002b160: 6172 5f61 6e6e 6f74 6174 696f 6e73 3d64  ar_annotations=d
-0002b170: 2c20 6669 6c74 6572 696e 675f 7661 6c75  , filtering_valu
-0002b180: 653d 6669 6c74 6572 696e 675f 7661 6c75  e=filtering_valu
-0002b190: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-0002b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b1c0: 2020 2020 7363 616c 6172 5f62 6172 5f6b      scalar_bar_k
-0002b1d0: 7761 7267 733d 7363 616c 6172 5f62 6172  wargs=scalar_bar
-0002b1e0: 5f6b 7761 7267 732c 2073 686f 775f 7363  _kwargs, show_sc
-0002b1f0: 616c 6172 5f62 6172 203d 2073 686f 775f  alar_bar = show_
-0002b200: 7363 616c 6172 5f62 6172 290d 0a0d 0a20  scalar_bar).... 
-0002b210: 2020 2020 2020 2069 6620 706c 6f74 7465         if plotte
-0002b220: 7220 6973 204e 6f6e 653a 0d0a 2020 2020  r is None:..    
-0002b230: 2020 2020 2020 2020 702e 6164 645f 626f          p.add_bo
-0002b240: 756e 6469 6e67 5f62 6f78 2829 0d0a 2020  unding_box()..  
-0002b250: 2020 2020 2020 2020 2020 702e 7368 6f77            p.show
-0002b260: 5f61 7865 7328 290d 0a20 2020 2020 2020  _axes()..       
-0002b270: 2020 2020 2070 2e73 686f 7728 290d 0a0d       p.show()...
-0002b280: 0a0d 0a20 2020 2064 6566 2070 6c6f 745f  ...    def plot_
-0002b290: 7072 6f62 6128 7365 6c66 2c20 6f62 6a2c  proba(self, obj,
-0002b2a0: 2076 5f65 783d 312c 2070 6c6f 7474 6572   v_ex=1, plotter
-0002b2b0: 3d4e 6f6e 652c 2073 6c69 6365 783d 4e6f  =None, slicex=No
-0002b2c0: 6e65 2c20 736c 6963 6579 3d4e 6f6e 652c  ne, slicey=None,
-0002b2d0: 2073 6c69 6365 7a3d 4e6f 6e65 2c20 6669   slicez=None, fi
-0002b2e0: 6c74 6572 696e 675f 696e 7465 7276 616c  ltering_interval
-0002b2f0: 3d5b 302e 3031 2c20 315d 2c20 7363 616c  =[0.01, 1], scal
-0002b300: 6172 5f62 6172 5f6b 7761 7267 733d 4e6f  ar_bar_kwargs=No
-0002b310: 6e65 293a 0d0a 0d0a 2020 2020 2020 2020  ne):....        
-0002b320: 2222 220d 0a20 2020 2020 2020 2050 6c6f  """..        Plo
-0002b330: 7420 7468 6520 7072 6f62 6162 696c 6974  t the probabilit
-0002b340: 7920 6f66 206f 6363 7572 656e 6365 206f  y of occurence o
-0002b350: 6620 6120 7370 6563 6966 6963 2075 6e69  f a specific uni
-0002b360: 7420 6f72 2066 6163 6965 730d 0a20 2020  t or facies..   
-0002b370: 2020 2020 2028 6361 6e20 6265 2070 6173       (can be pas
-0002b380: 7365 6420 6279 2061 206e 616d 6520 6f72  sed by a name or
-0002b390: 2074 6865 206f 626a 6563 7420 6469 7265   the object dire
-0002b3a0: 6374 6c79 290d 0a0d 0a20 2020 2020 2020  ctly)....       
-0002b3b0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0002b3c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0002b3d0: 0a20 2020 2020 2020 206f 626a 3a20 3a63  .        obj: :c
-0002b3e0: 6c61 7373 3a60 556e 6974 6020 6f72 203a  lass:`Unit` or :
-0002b3f0: 636c 6173 733a 6046 6163 6965 7360 206f  class:`Facies` o
-0002b400: 7220 7374 720d 0a20 2020 2020 2020 2020  r str..         
-0002b410: 2020 2075 6e69 7420 6f72 2066 6163 6965     unit or facie
-0002b420: 7320 6f62 6a65 6374 206f 7220 7374 7269  s object or stri
-0002b430: 6e67 206e 616d 6520 6f66 2074 6865 2075  ng name of the u
-0002b440: 6e69 742f 6661 6369 6573 0d0a 2020 2020  nit/facies..    
-0002b450: 2020 2020 2020 2020 746f 2070 6c6f 7420          to plot 
-0002b460: 7468 6520 7072 6f62 6162 696c 6974 7920  the probability 
-0002b470: 6f66 206f 6363 7572 656e 6365 0d0a 2020  of occurence..  
-0002b480: 2020 2020 2020 765f 6578 3a20 666c 6f61        v_ex: floa
-0002b490: 740d 0a20 2020 2020 2020 2020 2020 2076  t..            v
-0002b4a0: 6572 7469 6361 6c20 6578 6167 6572 6174  ertical exagerat
-0002b4b0: 696f 6e2c 2064 6566 6175 6c74 2069 7320  ion, default is 
-0002b4c0: 310d 0a20 2020 2020 2020 2070 6c6f 7474  1..        plott
-0002b4d0: 6572 3a20 7079 7669 7374 612e 506c 6f74  er: pyvista.Plot
-0002b4e0: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
-0002b4f0: 2070 7976 6973 7461 2e50 6c6f 7474 6572   pyvista.Plotter
-0002b500: 206f 626a 6563 7420 746f 2070 6c6f 7420   object to plot 
-0002b510: 6f6e 0d0a 2020 2020 2020 2020 736c 6963  on..        slic
-0002b520: 6578 3a20 666c 6f61 7420 6f72 2073 6571  ex: float or seq
-0002b530: 7565 6e63 6520 6f66 2066 6c6f 6174 730d  uence of floats.
-0002b540: 0a20 2020 2020 2020 2020 2020 2066 7261  .            fra
-0002b550: 6374 696f 6e20 6f66 2078 2061 7869 7320  ction of x axis 
-0002b560: 7768 6572 6520 746f 2073 6c69 6365 0d0a  where to slice..
-0002b570: 2020 2020 2020 2020 736c 6963 6579 3a20          slicey: 
-0002b580: 666c 6f61 7420 6f72 2073 6571 7565 6e63  float or sequenc
-0002b590: 6520 6f66 2066 6c6f 6174 730d 0a20 2020  e of floats..   
-0002b5a0: 2020 2020 2020 2020 2066 7261 6374 696f           fractio
-0002b5b0: 6e20 6f66 2079 2061 7869 7320 7768 6572  n of y axis wher
-0002b5c0: 6520 746f 2073 6c69 6365 0d0a 2020 2020  e to slice..    
-0002b5d0: 2020 2020 736c 6963 657a 3a20 666c 6f61      slicez: floa
-0002b5e0: 7420 6f72 2073 6571 7565 6e63 6520 6f66  t or sequence of
-0002b5f0: 2066 6c6f 6174 730d 0a20 2020 2020 2020   floats..       
-0002b600: 2020 2020 2066 7261 6374 696f 6e20 6f66       fraction of
-0002b610: 207a 2061 7869 7320 7768 6572 6520 746f   z axis where to
-0002b620: 2073 6c69 6365 0d0a 2020 2020 2020 2020   slice..        
-0002b630: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
-0002b640: 616c 3a20 7365 7175 656e 6365 206f 6620  al: sequence of 
-0002b650: 666c 6f61 7473 0d0a 2020 2020 2020 2020  floats..        
-0002b660: 2020 2020 696e 7465 7276 616c 206f 6620      interval of 
-0002b670: 7661 6c75 6573 2074 6f20 706c 6f74 0d0a  values to plot..
-0002b680: 2020 2020 2020 2020 7363 616c 6172 5f62          scalar_b
-0002b690: 6172 5f6b 7761 7267 733a 2064 6963 740d  ar_kwargs: dict.
-0002b6a0: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
-0002b6b0: 7267 7320 746f 2070 6173 7320 746f 2074  rgs to pass to t
-0002b6c0: 6865 2073 6361 6c61 7220 6261 720d 0a0d  he scalar bar...
-0002b6d0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-0002b6e0: 2020 2020 2020 2020 6e78 3d73 656c 662e          nx=self.
-0002b6f0: 6765 745f 6e78 2829 0d0a 2020 2020 2020  get_nx()..      
-0002b700: 2020 6e79 3d73 656c 662e 6765 745f 6e79    ny=self.get_ny
-0002b710: 2829 0d0a 2020 2020 2020 2020 6e7a 3d73  ()..        nz=s
-0002b720: 656c 662e 6765 745f 6e7a 2829 0d0a 2020  elf.get_nz()..  
-0002b730: 2020 2020 2020 7378 3d73 656c 662e 6765        sx=self.ge
-0002b740: 745f 7378 2829 0d0a 2020 2020 2020 2020  t_sx()..        
-0002b750: 7379 3d73 656c 662e 6765 745f 7379 2829  sy=self.get_sy()
-0002b760: 0d0a 2020 2020 2020 2020 737a 3d73 656c  ..        sz=sel
-0002b770: 662e 6765 745f 737a 2829 0d0a 2020 2020  f.get_sz()..    
-0002b780: 2020 2020 7830 3d73 656c 662e 6765 745f      x0=self.get_
-0002b790: 6f78 2829 0d0a 2020 2020 2020 2020 7930  ox()..        y0
-0002b7a0: 3d73 656c 662e 6765 745f 6f79 2829 0d0a  =self.get_oy()..
-0002b7b0: 2020 2020 2020 2020 7a30 3d73 656c 662e          z0=self.
-0002b7c0: 6765 745f 6f7a 2829 0d0a 0d0a 2020 2020  get_oz()....    
-0002b7d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0002b7e0: 6528 6f62 6a2c 2073 7472 293a 0d0a 2020  e(obj, str):..  
-0002b7f0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002b800: 662e 6765 745f 756e 6974 286f 626a 2c20  f.get_unit(obj, 
-0002b810: 7662 3d30 2920 6973 206e 6f74 204e 6f6e  vb=0) is not Non
-0002b820: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002b830: 2020 2020 753d 7365 6c66 2e67 6574 5f75      u=self.get_u
-0002b840: 6e69 7428 6f62 6a29 0d0a 2020 2020 2020  nit(obj)..      
-0002b850: 2020 2020 2020 2020 2020 693d 752e 4944            i=u.ID
-0002b860: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002b870: 2020 686c 3d75 2e67 6574 5f68 5f6c 6576    hl=u.get_h_lev
-0002b880: 656c 2829 0d0a 2020 2020 2020 2020 2020  el()..          
-0002b890: 2020 2020 2020 7479 703d 2275 6e69 7422        typ="unit"
-0002b8a0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0002b8b0: 6966 2073 656c 662e 6765 745f 6661 6369  if self.get_faci
-0002b8c0: 6573 5f6f 626a 286f 626a 2c20 7662 3d30  es_obj(obj, vb=0
-0002b8d0: 2920 6973 206e 6f74 204e 6f6e 653a 0d0a  ) is not None:..
-0002b8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b8f0: 6661 3d73 656c 662e 6765 745f 6661 6369  fa=self.get_faci
-0002b900: 6573 5f6f 626a 286f 626a 290d 0a20 2020  es_obj(obj)..   
-0002b910: 2020 2020 2020 2020 2020 2020 2069 3d66               i=f
-0002b920: 612e 4944 0d0a 2020 2020 2020 2020 2020  a.ID..          
-0002b930: 2020 2020 2020 7479 703d 2266 6163 6965        typ="facie
-0002b940: 7322 0d0a 2020 2020 2020 2020 656c 6966  s"..        elif
-0002b950: 2069 7369 6e73 7461 6e63 6528 6f62 6a2c   isinstance(obj,
-0002b960: 2055 6e69 7429 3a0d 0a20 2020 2020 2020   Unit):..       
-0002b970: 2020 2020 2069 3d6f 626a 2e49 440d 0a20       i=obj.ID.. 
-0002b980: 2020 2020 2020 2020 2020 2068 6c3d 6f62             hl=ob
-0002b990: 6a2e 6765 745f 685f 6c65 7665 6c28 290d  j.get_h_level().
-0002b9a0: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
-0002b9b0: 3d22 756e 6974 220d 0a20 2020 2020 2020  ="unit"..       
-0002b9c0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-0002b9d0: 286f 626a 2c20 4661 6369 6573 293a 0d0a  (obj, Facies):..
-0002b9e0: 2020 2020 2020 2020 2020 2020 693d 6f62              i=ob
-0002b9f0: 6a2e 4944 0d0a 2020 2020 2020 2020 2020  j.ID..          
-0002ba00: 2020 7479 703d 2266 6163 6965 7322 0d0a    typ="facies"..
-0002ba10: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0002ba20: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002ba30: 2056 616c 7565 4572 726f 7220 2822 756e   ValueError ("un
-0002ba40: 6974 2f66 6163 6965 7320 6d75 7374 2062  it/facies must b
-0002ba50: 6520 6120 7374 7269 6e67 206e 616d 6520  e a string name 
-0002ba60: 6f66 2061 2075 6e69 7420 6f72 2061 2075  of a unit or a u
-0002ba70: 6e69 7420 6f62 6a65 6374 2074 6861 7420  nit object that 
-0002ba80: 6973 2063 6f6e 7461 696e 6564 2069 6e73  is contained ins
-0002ba90: 6964 6520 7468 6520 4d61 7374 6572 2050  ide the Master P
-0002baa0: 696c 6522 290d 0a0d 0a20 2020 2020 2020  ile")....       
-0002bab0: 2069 6620 7479 7020 3d3d 2022 756e 6974   if typ == "unit
-0002bac0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0002bad0: 6172 723d 6e70 2e7a 6572 6f73 285b 7365  arr=np.zeros([se
-0002bae0: 6c66 2e6e 7a2c 2073 656c 662e 6e79 2c20  lf.nz, self.ny, 
-0002baf0: 7365 6c66 2e6e 785d 290d 0a20 2020 2020  self.nx])..     
-0002bb00: 2020 2020 2020 2023 2063 6f6d 7075 7465         # compute
-0002bb10: 2070 726f 6261 6269 6c69 7469 6573 0d0a   probabilities..
-0002bb20: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0002bb30: 6975 2069 6e20 7261 6e67 6528 7365 6c66  iu in range(self
-0002bb40: 2e6e 7265 616c 5f75 6e69 7473 293a 0d0a  .nreal_units):..
-0002bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb60: 756e 6974 733d 7365 6c66 2e67 6574 5f75  units=self.get_u
-0002bb70: 6e69 7473 5f64 6f6d 6169 6e73 5f72 6561  nits_domains_rea
-0002bb80: 6c69 7a61 7469 6f6e 7328 6975 3d69 752c  lizations(iu=iu,
-0002bb90: 2068 5f6c 6576 656c 3d68 6c2c 2061 6c6c   h_level=hl, all
-0002bba0: 5f64 6174 613d 4661 6c73 6529 0d0a 2020  _data=False)..  
-0002bbb0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-0002bbc0: 722b 3d28 756e 6974 7320 3d3d 2069 290d  r+=(units == i).
-0002bbd0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-0002bbe0: 2f3d 7365 6c66 2e6e 7265 616c 5f75 6e69  /=self.nreal_uni
-0002bbf0: 7473 0d0a 0d0a 2020 2020 2020 2020 656c  ts....        el
-0002bc00: 6966 2074 7970 203d 3d20 2266 6163 6965  if typ == "facie
-0002bc10: 7322 3a0d 0a20 2020 2020 2020 2020 2020  s":..           
-0002bc20: 2061 7272 3d6e 702e 7a65 726f 7328 5b73   arr=np.zeros([s
-0002bc30: 656c 662e 6e7a 2c20 7365 6c66 2e6e 792c  elf.nz, self.ny,
-0002bc40: 2073 656c 662e 6e78 5d29 0d0a 2020 2020   self.nx])..    
-0002bc50: 2020 2020 2020 2020 2320 636f 6d70 7574          # comput
-0002bc60: 6520 7072 6f62 6162 696c 6974 6965 730d  e probabilities.
-0002bc70: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0002bc80: 2069 7520 696e 2072 616e 6765 2873 656c   iu in range(sel
-0002bc90: 662e 6e72 6561 6c5f 756e 6974 7329 3a0d  f.nreal_units):.
-0002bca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002bcb0: 2066 6f72 2069 6661 2069 6e20 7261 6e67   for ifa in rang
-0002bcc0: 6528 7365 6c66 2e6e 7265 616c 5f66 6129  e(self.nreal_fa)
-0002bcd0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002bce0: 2020 2020 2020 2066 6163 6965 733d 7365         facies=se
-0002bcf0: 6c66 2e67 6574 5f66 6163 6965 7328 6975  lf.get_facies(iu
-0002bd00: 3d69 752c 2069 6661 3d69 6661 2c20 616c  =iu, ifa=ifa, al
-0002bd10: 6c5f 6461 7461 3d46 616c 7365 290d 0a20  l_data=False).. 
-0002bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd30: 2020 2061 7272 2b3d 2866 6163 6965 7320     arr+=(facies 
-0002bd40: 3d3d 2069 290d 0a20 2020 2020 2020 2020  == i)..         
-0002bd50: 2020 2061 7272 2f3d 2873 656c 662e 6e72     arr/=(self.nr
-0002bd60: 6561 6c5f 756e 6974 732a 7365 6c66 2e6e  eal_units*self.n
-0002bd70: 7265 616c 5f66 6129 0d0a 2020 2020 2020  real_fa)..      
-0002bd80: 2020 696d 3d67 656f 6e65 2e69 6d67 2e49    im=geone.img.I
-0002bd90: 6d67 286e 782c 206e 792c 206e 7a2c 2073  mg(nx, ny, nz, s
-0002bda0: 782c 2073 792c 2073 7a2a 765f 6578 2c20  x, sy, sz*v_ex, 
-0002bdb0: 7830 2c20 7930 2c20 7a30 2c20 6e76 3d31  x0, y0, z0, nv=1
-0002bdc0: 2c20 7661 6c3d 6172 722c 2076 6172 6e61  , val=arr, varna
-0002bdd0: 6d65 3d22 5020 5b2d 5d22 2920 2363 7265  me="P [-]") #cre
-0002bde0: 6174 6520 696d 6720 6f62 6a65 6374 0d0a  ate img object..
-0002bdf0: 0d0a 2020 2020 2020 2020 2363 7265 6174  ..        #creat
-0002be00: 6520 736c 6963 6573 0d0a 2020 2020 2020  e slices..      
-0002be10: 2020 6966 2073 6c69 6365 7820 6973 206e    if slicex is n
-0002be20: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-0002be30: 2020 2020 2020 736c 6963 6578 3d6e 702e        slicex=np.
-0002be40: 6172 7261 7928 736c 6963 6578 290d 0a20  array(slicex).. 
-0002be50: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-0002be60: 785b 736c 6963 6578 3c30 5d3d 300d 0a20  x[slicex<0]=0.. 
-0002be70: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-0002be80: 785b 736c 6963 6578 3e31 5d3d 310d 0a20  x[slicex>1]=1.. 
-0002be90: 2020 2020 2020 2020 2020 2063 783d 696d             cx=im
-0002bea0: 2e6f 7820 2b20 736c 6963 6578 202a 2069  .ox + slicex * i
-0002beb0: 6d2e 6e78 202a 2069 6d2e 7378 2020 2320  m.nx * im.sx  # 
-0002bec0: 6365 6e74 6572 2061 6c6f 6e67 2078 0d0a  center along x..
-0002bed0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0002bee0: 2020 2020 2020 2020 2020 2063 783d 4e6f             cx=No
-0002bef0: 6e65 0d0a 2020 2020 2020 2020 6966 2073  ne..        if s
-0002bf00: 6c69 6365 7920 6973 206e 6f74 204e 6f6e  licey is not Non
-0002bf10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002bf20: 736c 6963 6579 3d6e 702e 6172 7261 7928  slicey=np.array(
-0002bf30: 736c 6963 6579 290d 0a20 2020 2020 2020  slicey)..       
-0002bf40: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
-0002bf50: 6579 3c30 5d3d 300d 0a20 2020 2020 2020  ey<0]=0..       
-0002bf60: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
-0002bf70: 6579 3e31 5d3d 310d 0a20 2020 2020 2020  ey>1]=1..       
-0002bf80: 2020 2020 2063 793d 696d 2e6f 7920 2b20       cy=im.oy + 
-0002bf90: 736c 6963 6579 202a 2069 6d2e 6e79 202a  slicey * im.ny *
-0002bfa0: 2069 6d2e 7379 2020 2320 6365 6e74 6572   im.sy  # center
-0002bfb0: 2061 6c6f 6e67 2079 0d0a 2020 2020 2020   along y..      
-0002bfc0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0002bfd0: 2020 2020 2063 793d 4e6f 6e65 0d0a 2020       cy=None..  
-0002bfe0: 2020 2020 2020 6966 2073 6c69 6365 7a20        if slicez 
-0002bff0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0002c000: 2020 2020 2020 2020 2020 736c 6963 657a            slicez
-0002c010: 3d6e 702e 6172 7261 7928 736c 6963 657a  =np.array(slicez
-0002c020: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0002c030: 6c69 6365 7a5b 736c 6963 657a 3c30 5d3d  licez[slicez<0]=
-0002c040: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
-0002c050: 6c69 6365 7a5b 736c 6963 657a 3e31 5d3d  licez[slicez>1]=
-0002c060: 310d 0a20 2020 2020 2020 2020 2020 2063  1..            c
-0002c070: 7a3d 696d 2e6f 7a20 2b20 736c 6963 657a  z=im.oz + slicez
-0002c080: 202a 2069 6d2e 6e7a 202a 2069 6d2e 737a   * im.nz * im.sz
-0002c090: 2020 2320 6365 6e74 6572 2061 6c6f 6e67    # center along
-0002c0a0: 207a 0d0a 2020 2020 2020 2020 656c 7365   z..        else
-0002c0b0: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
-0002c0c0: 7a3d 4e6f 6e65 0d0a 0d0a 2020 2020 2020  z=None....      
-0002c0d0: 2020 6966 2061 7272 2e61 6e79 2829 3a20    if arr.any(): 
-0002c0e0: 2369 6620 7661 6c75 6573 2061 7265 2066  #if values are f
-0002c0f0: 6f75 6e64 0d0a 2020 2020 2020 2020 2020  ound..          
-0002c100: 2020 6966 2070 6c6f 7474 6572 2069 7320    if plotter is 
-0002c110: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0002c120: 2020 2020 2020 2070 3d70 762e 506c 6f74         p=pv.Plot
-0002c130: 7465 7228 290d 0a20 2020 2020 2020 2020  ter()..         
-0002c140: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0002c150: 2020 2020 2020 2020 2020 703d 706c 6f74            p=plot
-0002c160: 7465 720d 0a0d 0a20 2020 2020 2020 2020  ter....         
-0002c170: 2020 2069 6620 736c 6963 6578 2069 7320     if slicex is 
-0002c180: 6e6f 7420 4e6f 6e65 206f 7220 736c 6963  not None or slic
-0002c190: 6579 2069 7320 6e6f 7420 4e6f 6e65 206f  ey is not None o
-0002c1a0: 7220 736c 6963 657a 2069 7320 6e6f 7420  r slicez is not 
-0002c1b0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0002c1c0: 2020 2020 2020 2069 6d67 706c 7433 2e64         imgplt3.d
-0002c1d0: 7261 7749 6d61 6765 3344 5f73 6c69 6365  rawImage3D_slice
-0002c1e0: 2869 6d2c 2070 6c6f 7474 6572 3d70 2c20  (im, plotter=p, 
-0002c1f0: 736c 6963 655f 6e6f 726d 616c 5f78 3d63  slice_normal_x=c
-0002c200: 782c 2073 6c69 6365 5f6e 6f72 6d61 6c5f  x, slice_normal_
-0002c210: 793d 6379 2c20 736c 6963 655f 6e6f 726d  y=cy, slice_norm
-0002c220: 616c 5f7a 3d63 7a2c 2066 696c 7465 7269  al_z=cz, filteri
-0002c230: 6e67 5f69 6e74 6572 7661 6c3d 6669 6c74  ng_interval=filt
-0002c240: 6572 696e 675f 696e 7465 7276 616c 2c20  ering_interval, 
-0002c250: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
-0002c260: 733d 7363 616c 6172 5f62 6172 5f6b 7761  s=scalar_bar_kwa
-0002c270: 7267 7329 0d0a 2020 2020 2020 2020 2020  rgs)..          
-0002c280: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0002c290: 2020 2020 2020 2020 2069 6d67 706c 7433           imgplt3
-0002c2a0: 2e64 7261 7749 6d61 6765 3344 5f73 7572  .drawImage3D_sur
-0002c2b0: 6661 6365 2869 6d2c 2070 6c6f 7474 6572  face(im, plotter
-0002c2c0: 3d70 2c20 6669 6c74 6572 696e 675f 696e  =p, filtering_in
-0002c2d0: 7465 7276 616c 3d66 696c 7465 7269 6e67  terval=filtering
-0002c2e0: 5f69 6e74 6572 7661 6c2c 2073 6361 6c61  _interval, scala
-0002c2f0: 725f 6261 725f 6b77 6172 6773 3d73 6361  r_bar_kwargs=sca
-0002c300: 6c61 725f 6261 725f 6b77 6172 6773 290d  lar_bar_kwargs).
-0002c310: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-0002c320: 6620 706c 6f74 7465 7220 6973 204e 6f6e  f plotter is Non
-0002c330: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002c340: 2020 2020 702e 6164 645f 626f 756e 6469      p.add_boundi
-0002c350: 6e67 5f62 6f78 2829 0d0a 2020 2020 2020  ng_box()..      
-0002c360: 2020 2020 2020 2020 2020 702e 7368 6f77            p.show
-0002c370: 5f61 7865 7328 290d 0a20 2020 2020 2020  _axes()..       
-0002c380: 2020 2020 2020 2020 2070 2e73 686f 7728           p.show(
-0002c390: 290d 0a0d 0a20 2020 2020 2020 2065 6c73  )....        els
-0002c3a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002c3b0: 7072 696e 7428 224e 6f20 7661 6c75 6573  print("No values
-0002c3c0: 2066 6f75 6e64 2066 6f72 2074 6869 7320   found for this 
-0002c3d0: 756e 6974 2229 0d0a 0d0a 0d0a 2020 2020  unit")......    
-0002c3e0: 6465 6620 706c 6f74 5f66 6163 6965 7328  def plot_facies(
-0002c3f0: 7365 6c66 2c20 6975 3d30 2c20 6966 613d  self, iu=0, ifa=
-0002c400: 302c 2076 5f65 783d 312c 2069 6e73 6964  0, v_ex=1, insid
-0002c410: 655f 756e 6974 733d 4e6f 6e65 2c0d 0a20  e_units=None,.. 
-0002c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c430: 2020 2070 6c6f 7474 6572 3d4e 6f6e 652c     plotter=None,
-0002c440: 2073 6c69 6365 783d 4e6f 6e65 2c20 736c   slicex=None, sl
-0002c450: 6963 6579 3d4e 6f6e 652c 2073 6c69 6365  icey=None, slice
-0002c460: 7a3d 4e6f 6e65 2c20 6669 6c74 6572 696e  z=None, filterin
-0002c470: 675f 7661 6c75 653d 4e6f 6e65 2c0d 0a20  g_value=None,.. 
+0002a000: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002a010: 616c 7565 4572 726f 7228 2245 7272 6f72  alueError("Error
+0002a020: 3a20 7061 7265 6e74 2075 6e69 7420 7265  : parent unit re
+0002a030: 7475 726e 2069 7320 4e6f 6e65 2c20 6869  turn is None, hi
+0002a040: 6572 6172 6368 7920 7265 6c61 7469 6f6e  erarchy relation
+0002a050: 7320 6172 6520 696e 636f 6e73 6973 7465  s are inconsiste
+0002a060: 6e74 2077 6974 6820 5069 6c65 2061 6e64  nt with Pile and
+0002a070: 2073 696d 756c 6174 696f 6e73 2229 0d0a   simulations")..
+0002a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a0a0: 756e 6974 735f 646f 6d61 696e 735b 756e  units_domains[un
+0002a0b0: 6974 735f 646f 6d61 696e 7320 3d3d 2069  its_domains == i
+0002a0c0: 6478 5d3d 732e 4944 2020 2320 6368 616e  dx]=s.ID  # chan
+0002a0d0: 6765 2049 4420 7661 6c75 6573 2074 6f20  ge ID values to 
+0002a0e0: 4d75 6d6d 7920 4944 0d0a 0d0a 0d0a 2020  Mummy ID......  
+0002a0f0: 2020 2020 2020 2020 2020 656c 6966 2066            elif f
+0002a100: 696c 6c20 3d3d 2022 636f 6c6f 7222 3a0d  ill == "color":.
+0002a110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a120: 206e 7a2c 206e 792c 206e 783d 7564 2e73   nz, ny, nx=ud.s
+0002a130: 6861 7065 0d0a 2020 2020 2020 2020 2020  hape..          
+0002a140: 2020 2020 2020 756e 6974 735f 646f 6d61        units_doma
+0002a150: 696e 733d 6e70 2e7a 6572 6f73 285b 6e7a  ins=np.zeros([nz
+0002a160: 2c20 6e79 2c20 6e78 2c20 345d 290d 0a20  , ny, nx, 4]).. 
+0002a170: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002a180: 6f72 2075 6e69 7420 696e 2073 656c 662e  or unit in self.
+0002a190: 6765 745f 616c 6c5f 756e 6974 7328 293a  get_all_units():
+0002a1a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002a1b0: 2020 2020 2020 6966 2075 6e69 742e 665f        if unit.f_
+0002a1c0: 6d65 7468 6f64 2021 3d20 2253 7562 7069  method != "Subpi
+0002a1d0: 6c65 223a 0d0a 2020 2020 2020 2020 2020  le":..          
+0002a1e0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0002a1f0: 736b 3d28 7564 203d 3d20 756e 6974 2e49  sk=(ud == unit.I
+0002a200: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
+0002a210: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+0002a220: 735f 646f 6d61 696e 735b 6d61 736b 2c3a  s_domains[mask,:
+0002a230: 205d 3d6d 6174 706c 6f74 6c69 622e 636f   ]=matplotlib.co
+0002a240: 6c6f 7273 2e74 6f5f 7267 6261 2875 6e69  lors.to_rgba(uni
+0002a250: 742e 6329 0d0a 0d0a 2020 2020 2020 2020  t.c)....        
+0002a260: 7265 7475 726e 2075 6e69 7473 5f64 6f6d  return units_dom
+0002a270: 6169 6e73 0d0a 0d0a 0d0a 2020 2020 6465  ains......    de
+0002a280: 6620 706c 6f74 5f75 6e69 7473 2873 656c  f plot_units(sel
+0002a290: 662c 2069 753d 302c 2076 5f65 783d 312c  f, iu=0, v_ex=1,
+0002a2a0: 2070 6c6f 7474 6572 3d4e 6f6e 652c 2068   plotter=None, h
+0002a2b0: 5f6c 6576 656c 3d22 616c 6c22 2c20 736c  _level="all", sl
+0002a2c0: 6963 6578 3d4e 6f6e 652c 2073 6c69 6365  icex=None, slice
+0002a2d0: 793d 4e6f 6e65 2c20 736c 6963 657a 3d4e  y=None, slicez=N
+0002a2e0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+0002a2f0: 2020 2020 2020 2020 2065 7863 6c75 6465           exclude
+0002a300: 6456 616c 3d4e 6f6e 652c 0d0a 2020 2020  dVal=None,..    
+0002a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a320: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
+0002a330: 733d 4e6f 6e65 2c20 7368 6f77 5f73 6361  s=None, show_sca
+0002a340: 6c61 725f 6261 723d 5472 7565 2c20 2a2a  lar_bar=True, **
+0002a350: 6b77 6172 6773 293a 0d0a 0d0a 2020 2020  kwargs):....    
+0002a360: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0002a370: 2070 6c6f 7420 756e 6974 7320 646f 6d61   plot units doma
+0002a380: 696e 2066 6f72 2061 2073 7065 6369 6669  in for a specifi
+0002a390: 6320 7265 616c 697a 6174 696f 6e20 6975  c realization iu
+0002a3a0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+0002a3b0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+0002a3c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0002a3d0: 2020 2020 6975 3a20 696e 740d 0a20 2020      iu: int..   
+0002a3e0: 2020 2020 2020 2020 2075 6e69 7420 696e           unit in
+0002a3f0: 6465 7820 746f 2070 6c6f 740d 0a20 2020  dex to plot..   
+0002a400: 2020 2020 2076 5f65 783a 2066 6c6f 6174       v_ex: float
+0002a410: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+0002a420: 7274 6963 616c 2065 7861 6765 7261 7469  rtical exagerati
+0002a430: 6f6e 0d0a 2020 2020 2020 2020 706c 6f74  on..        plot
+0002a440: 7465 723a 2070 7976 6973 7461 2e50 6c6f  ter: pyvista.Plo
+0002a450: 7474 6572 0d0a 2020 2020 2020 2020 2020  tter..          
+0002a460: 2020 7079 7669 7374 612e 506c 6f74 7465    pyvista.Plotte
+0002a470: 7220 6f62 6a65 6374 2074 6f20 706c 6f74  r object to plot
+0002a480: 206f 6e0d 0a20 2020 2020 2020 2068 5f6c   on..        h_l
+0002a490: 6576 656c 3a20 7374 7269 6e67 206f 7220  evel: string or 
+0002a4a0: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
+0002a4b0: 2068 6965 7261 7263 6869 6361 6c20 6c65   hierarchical le
+0002a4c0: 7665 6c20 746f 2070 6c6f 742e 0d0a 2020  vel to plot...  
+0002a4d0: 2020 2020 2020 2020 2020 4120 7661 6c75            A valu
+0002a4e0: 6520 6f66 2031 2069 6e64 6963 6174 6573  e of 1 indicates
+0002a4f0: 2074 6861 7420 6f6e 6c79 2075 6e69 7420   that only unit 
+0002a500: 6f66 2074 6865 0d0a 2020 2020 2020 2020  of the..        
+0002a510: 2020 2020 6d61 7374 6572 2070 696c 6520      master pile 
+0002a520: 7769 6c6c 2062 6520 706c 6f74 7465 642e  will be plotted.
+0002a530: 2022 616c 6c22 2074 6f20 706c 6f74 2061   "all" to plot a
+0002a540: 6c6c 2070 6f73 7369 626c 6520 756e 6974  ll possible unit
+0002a550: 730d 0a20 2020 2020 2020 2073 6c69 6365  s..        slice
+0002a560: 783a 2066 6c6f 6174 206f 7220 7365 7175  x: float or sequ
+0002a570: 656e 6365 206f 6620 666c 6f61 7473 0d0a  ence of floats..
+0002a580: 2020 2020 2020 2020 2020 2020 6672 6163              frac
+0002a590: 7469 6f6e 206f 6620 7820 6178 6973 2077  tion of x axis w
+0002a5a0: 6865 7265 2074 6f20 736c 6963 650d 0a20  here to slice.. 
+0002a5b0: 2020 2020 2020 2073 6c69 6365 793a 2066         slicey: f
+0002a5c0: 6c6f 6174 206f 7220 7365 7175 656e 6365  loat or sequence
+0002a5d0: 206f 6620 666c 6f61 7473 0d0a 2020 2020   of floats..    
+0002a5e0: 2020 2020 2020 2020 6672 6163 7469 6f6e          fraction
+0002a5f0: 206f 6620 7920 6178 6973 2077 6865 7265   of y axis where
+0002a600: 2074 6f20 736c 6963 650d 0a20 2020 2020   to slice..     
+0002a610: 2020 2073 6c69 6365 7a3a 2066 6c6f 6174     slicez: float
+0002a620: 206f 7220 7365 7175 656e 6365 206f 6620   or sequence of 
+0002a630: 666c 6f61 7473 0d0a 2020 2020 2020 2020  floats..        
+0002a640: 2020 2020 6672 6163 7469 6f6e 206f 6620      fraction of 
+0002a650: 7a20 6178 6973 2077 6865 7265 2074 6f20  z axis where to 
+0002a660: 736c 6963 650d 0a20 2020 2020 2020 2073  slice..        s
+0002a670: 6361 6c61 725f 6261 725f 6b77 6172 6773  calar_bar_kwargs
+0002a680: 3a20 6469 6374 0d0a 2020 2020 2020 2020  : dict..        
+0002a690: 2020 2020 6b77 6172 6773 2074 6f20 7061      kwargs to pa
+0002a6a0: 7373 2074 6f20 7468 6520 7363 616c 6172  ss to the scalar
+0002a6b0: 2062 6172 0d0a 2020 2020 2020 2020 7368   bar..        sh
+0002a6c0: 6f77 5f73 6361 6c61 725f 6261 723a 2062  ow_scalar_bar: b
+0002a6d0: 6f6f 6c0d 0a20 2020 2020 2020 2020 2020  ool..           
+0002a6e0: 2073 686f 7720 7363 616c 6172 2062 6172   show scalar bar
+0002a6f0: 206f 7220 6e6f 7420 0d0a 2020 2020 2020   or not ..      
+0002a700: 2020 6b77 6172 6773 3a64 6963 740d 0a20    kwargs:dict.. 
+0002a710: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
+0002a720: 7320 746f 2070 6173 7320 746f 2067 656f  s to pass to geo
+0002a730: 6e65 2e69 6d67 706c 6f74 2e64 7261 7749  ne.imgplot.drawI
+0002a740: 6d61 6765 3344 5f73 6c69 6365 206f 7220  mage3D_slice or 
+0002a750: 6765 6f6e 652e 696d 6770 6c6f 742e 6472  geone.imgplot.dr
+0002a760: 6177 496d 6167 6533 445f 7375 7266 6163  awImage3D_surfac
+0002a770: 6520 2020 2020 2020 2020 0d0a 2020 2020  e         ..    
+0002a780: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+0002a790: 2020 2023 656e 7375 7265 2068 6965 7261     #ensure hiera
+0002a7a0: 7263 6879 5f72 656c 6174 696f 6e73 2068  rchy_relations h
+0002a7b0: 6176 6520 6265 656e 2073 6574 0d0a 2020  ave been set..  
+0002a7c0: 2020 2020 2020 7365 6c66 2e68 6965 7261        self.hiera
+0002a7d0: 7263 6879 5f72 656c 6174 696f 6e73 2876  rchy_relations(v
+0002a7e0: 623d 3029 0d0a 0d0a 2020 2020 2020 2020  b=0)....        
+0002a7f0: 636f 6c6f 7273 3d5b 5d0d 0a20 2020 2020  colors=[]..     
+0002a800: 2020 2064 3d7b 7d0d 0a20 2020 2020 2020     d={}..       
+0002a810: 206e 783d 7365 6c66 2e67 6574 5f6e 7828   nx=self.get_nx(
+0002a820: 290d 0a20 2020 2020 2020 206e 793d 7365  )..        ny=se
+0002a830: 6c66 2e67 6574 5f6e 7928 290d 0a20 2020  lf.get_ny()..   
+0002a840: 2020 2020 206e 7a3d 7365 6c66 2e67 6574       nz=self.get
+0002a850: 5f6e 7a28 290d 0a20 2020 2020 2020 2073  _nz()..        s
+0002a860: 783d 7365 6c66 2e67 6574 5f73 7828 290d  x=self.get_sx().
+0002a870: 0a20 2020 2020 2020 2073 793d 7365 6c66  .        sy=self
+0002a880: 2e67 6574 5f73 7928 290d 0a20 2020 2020  .get_sy()..     
+0002a890: 2020 2073 7a3d 7365 6c66 2e67 6574 5f73     sz=self.get_s
+0002a8a0: 7a28 290d 0a20 2020 2020 2020 2078 303d  z()..        x0=
+0002a8b0: 7365 6c66 2e67 6574 5f6f 7828 290d 0a20  self.get_ox().. 
+0002a8c0: 2020 2020 2020 2079 303d 7365 6c66 2e67         y0=self.g
+0002a8d0: 6574 5f6f 7928 290d 0a20 2020 2020 2020  et_oy()..       
+0002a8e0: 207a 303d 7365 6c66 2e67 6574 5f6f 7a28   z0=self.get_oz(
+0002a8f0: 290d 0a0d 0a20 2020 2020 2020 2073 7472  )....        str
+0002a900: 6174 6973 5f64 6f6d 6169 6e3d 7365 6c66  atis_domain=self
+0002a910: 2e67 6574 5f75 6e69 7473 5f64 6f6d 6169  .get_units_domai
+0002a920: 6e73 5f72 6561 6c69 7a61 7469 6f6e 7328  ns_realizations(
+0002a930: 6975 3d69 752c 2066 696c 6c3d 2249 4422  iu=iu, fill="ID"
+0002a940: 2c20 685f 6c65 7665 6c3d 685f 6c65 7665  , h_level=h_leve
+0002a950: 6c29 2e61 7374 7970 6528 6e70 2e66 6c6f  l).astype(np.flo
+0002a960: 6174 3332 290d 0a20 2020 2020 2020 206c  at32)..        l
+0002a970: 7374 5f49 443d 6e70 2e75 6e69 7175 6528  st_ID=np.unique(
+0002a980: 7374 7261 7469 735f 646f 6d61 696e 290d  stratis_domain).
+0002a990: 0a20 2020 2020 2020 206e 6577 5f6c 7374  .        new_lst
+0002a9a0: 5f49 4420 3d20 5b5d 0d0a 2020 2020 2020  _ID = []..      
+0002a9b0: 2020 6966 2065 7863 6c75 6465 6456 616c    if excludedVal
+0002a9c0: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+0002a9d0: 2020 2020 2020 2065 7863 6c75 6465 6456         excludedV
+0002a9e0: 616c 3d5b 5d0d 0a20 2020 2020 2020 2069  al=[]..        i
+0002a9f0: 6620 6973 696e 7374 616e 6365 2865 7863  f isinstance(exc
+0002aa00: 6c75 6465 6456 616c 2c20 696e 7429 3a0d  ludedVal, int):.
+0002aa10: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+0002aa20: 6c75 6465 6456 616c 3d5b 6578 636c 7564  ludedVal=[exclud
+0002aa30: 6564 5661 6c5d 0d0a 0d0a 2020 2020 2020  edVal]....      
+0002aa40: 2020 2323 2063 6861 6e67 6520 7661 6c75    ## change valu
+0002aa50: 6573 0d0a 2020 2020 2020 2020 6e65 775f  es..        new_
+0002aa60: 6964 3d31 0d0a 2020 2020 2020 2020 666f  id=1..        fo
+0002aa70: 7220 6920 696e 206c 7374 5f49 443a 0d0a  r i in lst_ID:..
+0002aa80: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002aa90: 2021 3d20 303a 0d0a 2020 2020 2020 2020   != 0:..        
+0002aaa0: 2020 2020 2020 2020 6966 2069 206e 6f74          if i not
+0002aab0: 2069 6e20 6578 636c 7564 6564 5661 6c3a   in excludedVal:
+0002aac0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002aad0: 2020 2020 2020 733d 7365 6c66 2e67 6574        s=self.get
+0002aae0: 5f75 6e69 7428 4944 3d69 2c20 7479 7065  _unit(ID=i, type
+0002aaf0: 3d22 4944 2229 0d0a 2020 2020 2020 2020  ="ID")..        
+0002ab00: 2020 2020 2320 2020 2020 2020 2020 7374      #         st
+0002ab10: 7261 7469 735f 646f 6d61 696e 5b73 7472  ratis_domain[str
+0002ab20: 6174 6973 5f64 6f6d 6169 6e20 3d3d 2069  atis_domain == i
+0002ab30: 5d3d 6e65 775f 6964 0d0a 2020 2020 2020  ]=new_id..      
+0002ab40: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0002ab50: 6c6f 7273 2e61 7070 656e 6428 732e 6329  lors.append(s.c)
+0002ab60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002ab70: 2020 2020 2020 645b 6e65 775f 6964 202d        d[new_id -
+0002ab80: 2030 2e35 5d3d 732e 6e61 6d65 0d0a 2020   0.5]=s.name..  
+0002ab90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aba0: 2020 6e65 775f 6964 202b 3d20 310d 0a20    new_id += 1.. 
+0002abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002abc0: 2020 206e 6577 5f6c 7374 5f49 442e 6170     new_lst_ID.ap
+0002abd0: 7065 6e64 2869 290d 0a0d 0a20 2020 2020  pend(i)....     
+0002abe0: 2020 2023 706c 6f74 0d0a 2020 2020 2020     #plot..      
+0002abf0: 2020 7374 7261 7469 735f 646f 6d61 696e    stratis_domain
+0002ac00: 5b73 7472 6174 6973 5f64 6f6d 6169 6e3d  [stratis_domain=
+0002ac10: 3d30 5d3d 6e70 2e6e 616e 2020 2320 7265  =0]=np.nan  # re
+0002ac20: 6d6f 7665 2077 6865 7265 206e 6f20 666f  move where no fo
+0002ac30: 726d 6174 696f 6e73 2061 7265 2070 7265  rmations are pre
+0002ac40: 7365 6e74 0d0a 2020 2020 2020 2020 6966  sent..        if
+0002ac50: 2070 6c6f 7474 6572 2069 7320 4e6f 6e65   plotter is None
+0002ac60: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+0002ac70: 3d70 762e 506c 6f74 7465 7228 290d 0a20  =pv.Plotter().. 
+0002ac80: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0002ac90: 2020 2020 2020 2020 2020 703d 706c 6f74            p=plot
+0002aca0: 7465 720d 0a0d 0a20 2020 2020 2020 2069  ter....        i
+0002acb0: 6d3d 6765 6f6e 652e 696d 672e 496d 6728  m=geone.img.Img(
+0002acc0: 6e78 2c20 6e79 2c20 6e7a 2c20 7378 2c20  nx, ny, nz, sx, 
+0002acd0: 7379 2c20 737a 2a76 5f65 782c 2078 302c  sy, sz*v_ex, x0,
+0002ace0: 2079 302c 207a 302c 206e 763d 312c 2076   y0, z0, nv=1, v
+0002acf0: 616c 3d73 7472 6174 6973 5f64 6f6d 6169  al=stratis_domai
+0002ad00: 6e2c 2076 6172 6e61 6d65 3d22 556e 6974  n, varname="Unit
+0002ad10: 7322 290d 0a0d 0a20 2020 2020 2020 2069  s")....        i
+0002ad20: 6620 736c 6963 6578 2069 7320 6e6f 7420  f slicex is not 
+0002ad30: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0002ad40: 2020 2073 6c69 6365 783d 6e70 2e61 7272     slicex=np.arr
+0002ad50: 6179 2873 6c69 6365 7829 0d0a 2020 2020  ay(slicex)..    
+0002ad60: 2020 2020 2020 2020 736c 6963 6578 5b73          slicex[s
+0002ad70: 6c69 6365 783c 305d 3d30 0d0a 2020 2020  licex<0]=0..    
+0002ad80: 2020 2020 2020 2020 736c 6963 6578 5b73          slicex[s
+0002ad90: 6c69 6365 783e 315d 3d31 0d0a 2020 2020  licex>1]=1..    
+0002ada0: 2020 2020 2020 2020 6378 3d69 6d2e 6f78          cx=im.ox
+0002adb0: 202b 2073 6c69 6365 7820 2a20 696d 2e6e   + slicex * im.n
+0002adc0: 7820 2a20 696d 2e73 7820 2023 2063 656e  x * im.sx  # cen
+0002add0: 7465 7220 616c 6f6e 6720 780d 0a20 2020  ter along x..   
+0002ade0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0002adf0: 2020 2020 2020 2020 6378 3d4e 6f6e 650d          cx=None.
+0002ae00: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
+0002ae10: 6579 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ey is not None:.
+0002ae20: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
+0002ae30: 6365 793d 6e70 2e61 7272 6179 2873 6c69  cey=np.array(sli
+0002ae40: 6365 7929 0d0a 2020 2020 2020 2020 2020  cey)..          
+0002ae50: 2020 736c 6963 6579 5b73 6c69 6365 793c    slicey[slicey<
+0002ae60: 305d 3d30 0d0a 2020 2020 2020 2020 2020  0]=0..          
+0002ae70: 2020 736c 6963 6579 5b73 6c69 6365 793e    slicey[slicey>
+0002ae80: 315d 3d31 0d0a 2020 2020 2020 2020 2020  1]=1..          
+0002ae90: 2020 6379 3d69 6d2e 6f79 202b 2073 6c69    cy=im.oy + sli
+0002aea0: 6365 7920 2a20 696d 2e6e 7920 2a20 696d  cey * im.ny * im
+0002aeb0: 2e73 7920 2023 2063 656e 7465 7220 616c  .sy  # center al
+0002aec0: 6f6e 6720 780d 0a20 2020 2020 2020 2065  ong x..        e
+0002aed0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0002aee0: 2020 6379 3d4e 6f6e 650d 0a20 2020 2020    cy=None..     
+0002aef0: 2020 2069 6620 736c 6963 657a 2069 7320     if slicez is 
+0002af00: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+0002af10: 2020 2020 2020 2073 6c69 6365 7a3d 6e70         slicez=np
+0002af20: 2e61 7272 6179 2873 6c69 6365 7a29 0d0a  .array(slicez)..
+0002af30: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+0002af40: 657a 5b73 6c69 6365 7a3c 305d 3d30 0d0a  ez[slicez<0]=0..
+0002af50: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+0002af60: 657a 5b73 6c69 6365 7a3e 315d 3d31 0d0a  ez[slicez>1]=1..
+0002af70: 2020 2020 2020 2020 2020 2020 637a 3d69              cz=i
+0002af80: 6d2e 6f7a 202b 2073 6c69 6365 7a20 2a20  m.oz + slicez * 
+0002af90: 696d 2e6e 7a20 2a20 696d 2e73 7a20 2023  im.nz * im.sz  #
+0002afa0: 2063 656e 7465 7220 616c 6f6e 6720 780d   center along x.
+0002afb0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0002afc0: 2020 2020 2020 2020 2020 2020 637a 3d4e              cz=N
+0002afd0: 6f6e 650d 0a0d 0a20 2020 2020 2020 2069  one....        i
+0002afe0: 6620 736c 6963 6578 2069 7320 6e6f 7420  f slicex is not 
+0002aff0: 4e6f 6e65 206f 7220 736c 6963 6579 2069  None or slicey i
+0002b000: 7320 6e6f 7420 4e6f 6e65 206f 7220 736c  s not None or sl
+0002b010: 6963 657a 2069 7320 6e6f 7420 4e6f 6e65  icez is not None
+0002b020: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+0002b030: 6d67 706c 7433 2e64 7261 7749 6d61 6765  mgplt3.drawImage
+0002b040: 3344 5f73 6c69 6365 2869 6d2c 2070 6c6f  3D_slice(im, plo
+0002b050: 7474 6572 3d70 2c20 736c 6963 655f 6e6f  tter=p, slice_no
+0002b060: 726d 616c 5f78 3d63 782c 2073 6c69 6365  rmal_x=cx, slice
+0002b070: 5f6e 6f72 6d61 6c5f 793d 6379 2c20 736c  _normal_y=cy, sl
+0002b080: 6963 655f 6e6f 726d 616c 5f7a 3d63 7a2c  ice_normal_z=cz,
+0002b090: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0b0: 2020 2020 2020 6361 7465 673d 5472 7565        categ=True
+0002b0c0: 2c20 6361 7465 6756 616c 3d6e 6577 5f6c  , categVal=new_l
+0002b0d0: 7374 5f49 442c 2063 6174 6567 436f 6c3d  st_ID, categCol=
+0002b0e0: 636f 6c6f 7273 2c20 7363 616c 6172 5f62  colors, scalar_b
+0002b0f0: 6172 5f61 6e6e 6f74 6174 696f 6e73 3d64  ar_annotations=d
+0002b100: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0002b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b120: 2020 2020 2020 2073 6361 6c61 725f 6261         scalar_ba
+0002b130: 725f 6b77 6172 6773 3d73 6361 6c61 725f  r_kwargs=scalar_
+0002b140: 6261 725f 6b77 6172 6773 2c20 7368 6f77  bar_kwargs, show
+0002b150: 5f73 6361 6c61 725f 6261 7220 3d20 7368  _scalar_bar = sh
+0002b160: 6f77 5f73 6361 6c61 725f 6261 722c 202a  ow_scalar_bar, *
+0002b170: 2a6b 7761 7267 7329 0d0a 2020 2020 2020  *kwargs)..      
+0002b180: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0002b190: 2020 2020 2069 6d67 706c 7433 2e64 7261       imgplt3.dra
+0002b1a0: 7749 6d61 6765 3344 5f73 7572 6661 6365  wImage3D_surface
+0002b1b0: 2869 6d2c 2070 6c6f 7474 6572 3d70 2c20  (im, plotter=p, 
+0002b1c0: 6361 7465 673d 5472 7565 2c20 6361 7465  categ=True, cate
+0002b1d0: 6756 616c 3d6e 6577 5f6c 7374 5f49 442c  gVal=new_lst_ID,
+0002b1e0: 2063 6174 6567 436f 6c3d 636f 6c6f 7273   categCol=colors
+0002b1f0: 2c20 7363 616c 6172 5f62 6172 5f61 6e6e  , scalar_bar_ann
+0002b200: 6f74 6174 696f 6e73 3d64 2c0d 0a20 2020  otations=d,..   
+0002b210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b230: 2020 2020 2073 6361 6c61 725f 6261 725f       scalar_bar_
+0002b240: 6b77 6172 6773 3d73 6361 6c61 725f 6261  kwargs=scalar_ba
+0002b250: 725f 6b77 6172 6773 2c20 7368 6f77 5f73  r_kwargs, show_s
+0002b260: 6361 6c61 725f 6261 7220 3d20 7368 6f77  calar_bar = show
+0002b270: 5f73 6361 6c61 725f 6261 722c 202a 2a6b  _scalar_bar, **k
+0002b280: 7761 7267 7329 0d0a 0d0a 2020 2020 2020  wargs)....      
+0002b290: 2020 6966 2070 6c6f 7474 6572 2069 7320    if plotter is 
+0002b2a0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0002b2b0: 2020 2070 2e61 6464 5f62 6f75 6e64 696e     p.add_boundin
+0002b2c0: 675f 626f 7828 290d 0a20 2020 2020 2020  g_box()..       
+0002b2d0: 2020 2020 2070 2e73 686f 775f 6178 6573       p.show_axes
+0002b2e0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0002b2f0: 702e 7368 6f77 2829 0d0a 0d0a 0d0a 2020  p.show()......  
+0002b300: 2020 6465 6620 706c 6f74 5f70 726f 6261    def plot_proba
+0002b310: 2873 656c 662c 206f 626a 2c20 765f 6578  (self, obj, v_ex
+0002b320: 3d31 2c20 706c 6f74 7465 723d 4e6f 6e65  =1, plotter=None
+0002b330: 2c20 6669 6c74 6572 696e 675f 696e 7465  , filtering_inte
+0002b340: 7276 616c 3d5b 302e 3031 2c20 312e 3030  rval=[0.01, 1.00
+0002b350: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+0002b360: 2020 2020 2020 2073 6c69 6365 783d 4e6f         slicex=No
+0002b370: 6e65 2c20 736c 6963 6579 3d4e 6f6e 652c  ne, slicey=None,
+0002b380: 2073 6c69 6365 7a3d 4e6f 6e65 2c0d 0a20   slicez=None,.. 
+0002b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b3a0: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
+0002b3b0: 7267 733d 4e6f 6e65 2c20 6578 636c 7564  rgs=None, exclud
+0002b3c0: 6564 5661 6c3d 4e6f 6e65 2c20 2a2a 6b77  edVal=None, **kw
+0002b3d0: 6172 6773 293a 0d0a 0d0a 2020 2020 2020  args):....      
+0002b3e0: 2020 2222 220d 0a20 2020 2020 2020 2050    """..        P
+0002b3f0: 6c6f 7420 7468 6520 7072 6f62 6162 696c  lot the probabil
+0002b400: 6974 7920 6f66 206f 6363 7572 656e 6365  ity of occurence
+0002b410: 206f 6620 6120 7370 6563 6966 6963 2075   of a specific u
+0002b420: 6e69 7420 6f72 2066 6163 6965 730d 0a20  nit or facies.. 
+0002b430: 2020 2020 2020 2028 6361 6e20 6265 2070         (can be p
+0002b440: 6173 7365 6420 6279 2061 206e 616d 6520  assed by a name 
+0002b450: 6f72 2074 6865 206f 626a 6563 7420 6469  or the object di
+0002b460: 7265 6374 6c79 290d 0a0d 0a20 2020 2020  rectly)....     
+0002b470: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0002b480: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002b490: 2d0d 0a20 2020 2020 2020 206f 626a 3a20  -..        obj: 
+0002b4a0: 3a63 6c61 7373 3a60 556e 6974 6020 6f72  :class:`Unit` or
+0002b4b0: 203a 636c 6173 733a 6046 6163 6965 7360   :class:`Facies`
+0002b4c0: 206f 7220 7374 720d 0a20 2020 2020 2020   or str..       
+0002b4d0: 2020 2020 2075 6e69 7420 6f72 2066 6163       unit or fac
+0002b4e0: 6965 7320 6f62 6a65 6374 206f 7220 7374  ies object or st
+0002b4f0: 7269 6e67 206e 616d 6520 6f66 2074 6865  ring name of the
+0002b500: 2075 6e69 742f 6661 6369 6573 0d0a 2020   unit/facies..  
+0002b510: 2020 2020 2020 2020 2020 746f 2070 6c6f            to plo
+0002b520: 7420 7468 6520 7072 6f62 6162 696c 6974  t the probabilit
+0002b530: 7920 6f66 206f 6363 7572 656e 6365 0d0a  y of occurence..
+0002b540: 2020 2020 2020 2020 765f 6578 3a20 666c          v_ex: fl
+0002b550: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
+0002b560: 2076 6572 7469 6361 6c20 6578 6167 6572   vertical exager
+0002b570: 6174 696f 6e2c 2064 6566 6175 6c74 2069  ation, default i
+0002b580: 7320 310d 0a20 2020 2020 2020 2070 6c6f  s 1..        plo
+0002b590: 7474 6572 3a20 7079 7669 7374 612e 506c  tter: pyvista.Pl
+0002b5a0: 6f74 7465 720d 0a20 2020 2020 2020 2020  otter..         
+0002b5b0: 2020 2070 7976 6973 7461 2e50 6c6f 7474     pyvista.Plott
+0002b5c0: 6572 206f 626a 6563 7420 746f 2070 6c6f  er object to plo
+0002b5d0: 7420 6f6e 0d0a 2020 2020 2020 2020 736c  t on..        sl
+0002b5e0: 6963 6578 3a20 666c 6f61 7420 6f72 2073  icex: float or s
+0002b5f0: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
+0002b600: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
+0002b610: 7261 6374 696f 6e20 6f66 2078 2061 7869  raction of x axi
+0002b620: 7320 7768 6572 6520 746f 2073 6c69 6365  s where to slice
+0002b630: 0d0a 2020 2020 2020 2020 736c 6963 6579  ..        slicey
+0002b640: 3a20 666c 6f61 7420 6f72 2073 6571 7565  : float or seque
+0002b650: 6e63 6520 6f66 2066 6c6f 6174 730d 0a20  nce of floats.. 
+0002b660: 2020 2020 2020 2020 2020 2066 7261 6374             fract
+0002b670: 696f 6e20 6f66 2079 2061 7869 7320 7768  ion of y axis wh
+0002b680: 6572 6520 746f 2073 6c69 6365 0d0a 2020  ere to slice..  
+0002b690: 2020 2020 2020 736c 6963 657a 3a20 666c        slicez: fl
+0002b6a0: 6f61 7420 6f72 2073 6571 7565 6e63 6520  oat or sequence 
+0002b6b0: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
+0002b6c0: 2020 2020 2020 2066 7261 6374 696f 6e20         fraction 
+0002b6d0: 6f66 207a 2061 7869 7320 7768 6572 6520  of z axis where 
+0002b6e0: 746f 2073 6c69 6365 0d0a 2020 2020 2020  to slice..      
+0002b6f0: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
+0002b700: 7267 733a 2064 6963 740d 0a20 2020 2020  rgs: dict..     
+0002b710: 2020 2020 2020 206b 7761 7267 7320 746f         kwargs to
+0002b720: 2070 6173 7320 746f 2074 6865 2073 6361   pass to the sca
+0002b730: 6c61 7220 6261 720d 0a20 2020 2020 2020  lar bar..       
+0002b740: 2065 7863 6c75 6465 6456 616c 3a20 666c   excludedVal: fl
+0002b750: 6f61 7420 6f72 2073 6571 7565 6e63 6520  oat or sequence 
+0002b760: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
+0002b770: 2020 2020 2020 2076 616c 7565 7320 746f         values to
+0002b780: 2065 7863 6c75 6465 2066 726f 6d20 7468   exclude from th
+0002b790: 6520 706c 6f74 0d0a 2020 2020 2020 2020  e plot..        
+0002b7a0: 6b77 6172 6773 3a64 6963 740d 0a20 2020  kwargs:dict..   
+0002b7b0: 2020 2020 2020 2020 206b 7761 7267 7320           kwargs 
+0002b7c0: 746f 2070 6173 7320 746f 2067 656f 6e65  to pass to geone
+0002b7d0: 2e69 6d67 706c 6f74 2e64 7261 7749 6d61  .imgplot.drawIma
+0002b7e0: 6765 3344 5f73 6c69 6365 206f 7220 6765  ge3D_slice or ge
+0002b7f0: 6f6e 652e 696d 6770 6c6f 742e 6472 6177  one.imgplot.draw
+0002b800: 496d 6167 6533 445f 7375 7266 6163 650d  Image3D_surface.
+0002b810: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+0002b820: 2020 2020 2020 2020 6e78 3d73 656c 662e          nx=self.
+0002b830: 6765 745f 6e78 2829 0d0a 2020 2020 2020  get_nx()..      
+0002b840: 2020 6e79 3d73 656c 662e 6765 745f 6e79    ny=self.get_ny
+0002b850: 2829 0d0a 2020 2020 2020 2020 6e7a 3d73  ()..        nz=s
+0002b860: 656c 662e 6765 745f 6e7a 2829 0d0a 2020  elf.get_nz()..  
+0002b870: 2020 2020 2020 7378 3d73 656c 662e 6765        sx=self.ge
+0002b880: 745f 7378 2829 0d0a 2020 2020 2020 2020  t_sx()..        
+0002b890: 7379 3d73 656c 662e 6765 745f 7379 2829  sy=self.get_sy()
+0002b8a0: 0d0a 2020 2020 2020 2020 737a 3d73 656c  ..        sz=sel
+0002b8b0: 662e 6765 745f 737a 2829 0d0a 2020 2020  f.get_sz()..    
+0002b8c0: 2020 2020 7830 3d73 656c 662e 6765 745f      x0=self.get_
+0002b8d0: 6f78 2829 0d0a 2020 2020 2020 2020 7930  ox()..        y0
+0002b8e0: 3d73 656c 662e 6765 745f 6f79 2829 0d0a  =self.get_oy()..
+0002b8f0: 2020 2020 2020 2020 7a30 3d73 656c 662e          z0=self.
+0002b900: 6765 745f 6f7a 2829 0d0a 0d0a 2020 2020  get_oz()....    
+0002b910: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0002b920: 6528 6f62 6a2c 2073 7472 293a 0d0a 2020  e(obj, str):..  
+0002b930: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0002b940: 662e 6765 745f 756e 6974 286f 626a 2c20  f.get_unit(obj, 
+0002b950: 7662 3d30 2920 6973 206e 6f74 204e 6f6e  vb=0) is not Non
+0002b960: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002b970: 2020 2020 753d 7365 6c66 2e67 6574 5f75      u=self.get_u
+0002b980: 6e69 7428 6f62 6a29 0d0a 2020 2020 2020  nit(obj)..      
+0002b990: 2020 2020 2020 2020 2020 693d 752e 4944            i=u.ID
+0002b9a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002b9b0: 2020 686c 3d75 2e67 6574 5f68 5f6c 6576    hl=u.get_h_lev
+0002b9c0: 656c 2829 0d0a 2020 2020 2020 2020 2020  el()..          
+0002b9d0: 2020 2020 2020 7479 703d 2275 6e69 7422        typ="unit"
+0002b9e0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0002b9f0: 6966 2073 656c 662e 6765 745f 6661 6369  if self.get_faci
+0002ba00: 6573 5f6f 626a 286f 626a 2c20 7662 3d30  es_obj(obj, vb=0
+0002ba10: 2920 6973 206e 6f74 204e 6f6e 653a 0d0a  ) is not None:..
+0002ba20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba30: 6661 3d73 656c 662e 6765 745f 6661 6369  fa=self.get_faci
+0002ba40: 6573 5f6f 626a 286f 626a 290d 0a20 2020  es_obj(obj)..   
+0002ba50: 2020 2020 2020 2020 2020 2020 2069 3d66               i=f
+0002ba60: 612e 4944 0d0a 2020 2020 2020 2020 2020  a.ID..          
+0002ba70: 2020 2020 2020 7479 703d 2266 6163 6965        typ="facie
+0002ba80: 7322 0d0a 2020 2020 2020 2020 656c 6966  s"..        elif
+0002ba90: 2069 7369 6e73 7461 6e63 6528 6f62 6a2c   isinstance(obj,
+0002baa0: 2055 6e69 7429 3a0d 0a20 2020 2020 2020   Unit):..       
+0002bab0: 2020 2020 2069 3d6f 626a 2e49 440d 0a20       i=obj.ID.. 
+0002bac0: 2020 2020 2020 2020 2020 2068 6c3d 6f62             hl=ob
+0002bad0: 6a2e 6765 745f 685f 6c65 7665 6c28 290d  j.get_h_level().
+0002bae0: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
+0002baf0: 3d22 756e 6974 220d 0a20 2020 2020 2020  ="unit"..       
+0002bb00: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0002bb10: 286f 626a 2c20 4661 6369 6573 293a 0d0a  (obj, Facies):..
+0002bb20: 2020 2020 2020 2020 2020 2020 693d 6f62              i=ob
+0002bb30: 6a2e 4944 0d0a 2020 2020 2020 2020 2020  j.ID..          
+0002bb40: 2020 7479 703d 2266 6163 6965 7322 0d0a    typ="facies"..
+0002bb50: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0002bb60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002bb70: 2056 616c 7565 4572 726f 7220 2822 756e   ValueError ("un
+0002bb80: 6974 2f66 6163 6965 7320 6d75 7374 2062  it/facies must b
+0002bb90: 6520 6120 7374 7269 6e67 206e 616d 6520  e a string name 
+0002bba0: 6f66 2061 2075 6e69 7420 6f72 2061 2075  of a unit or a u
+0002bbb0: 6e69 7420 6f62 6a65 6374 2074 6861 7420  nit object that 
+0002bbc0: 6973 2063 6f6e 7461 696e 6564 2069 6e73  is contained ins
+0002bbd0: 6964 6520 7468 6520 4d61 7374 6572 2050  ide the Master P
+0002bbe0: 696c 6522 290d 0a0d 0a20 2020 2020 2020  ile")....       
+0002bbf0: 2069 6620 7479 7020 3d3d 2022 756e 6974   if typ == "unit
+0002bc00: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+0002bc10: 6172 723d 6e70 2e7a 6572 6f73 285b 7365  arr=np.zeros([se
+0002bc20: 6c66 2e6e 7a2c 2073 656c 662e 6e79 2c20  lf.nz, self.ny, 
+0002bc30: 7365 6c66 2e6e 785d 290d 0a20 2020 2020  self.nx])..     
+0002bc40: 2020 2020 2020 2023 2063 6f6d 7075 7465         # compute
+0002bc50: 2070 726f 6261 6269 6c69 7469 6573 0d0a   probabilities..
+0002bc60: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002bc70: 6975 2069 6e20 7261 6e67 6528 7365 6c66  iu in range(self
+0002bc80: 2e6e 7265 616c 5f75 6e69 7473 293a 0d0a  .nreal_units):..
+0002bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bca0: 756e 6974 733d 7365 6c66 2e67 6574 5f75  units=self.get_u
+0002bcb0: 6e69 7473 5f64 6f6d 6169 6e73 5f72 6561  nits_domains_rea
+0002bcc0: 6c69 7a61 7469 6f6e 7328 6975 3d69 752c  lizations(iu=iu,
+0002bcd0: 2068 5f6c 6576 656c 3d68 6c2c 2061 6c6c   h_level=hl, all
+0002bce0: 5f64 6174 613d 4661 6c73 6529 0d0a 2020  _data=False)..  
+0002bcf0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+0002bd00: 722b 3d28 756e 6974 7320 3d3d 2069 290d  r+=(units == i).
+0002bd10: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+0002bd20: 2f3d 7365 6c66 2e6e 7265 616c 5f75 6e69  /=self.nreal_uni
+0002bd30: 7473 0d0a 0d0a 2020 2020 2020 2020 656c  ts....        el
+0002bd40: 6966 2074 7970 203d 3d20 2266 6163 6965  if typ == "facie
+0002bd50: 7322 3a0d 0a20 2020 2020 2020 2020 2020  s":..           
+0002bd60: 2061 7272 3d6e 702e 7a65 726f 7328 5b73   arr=np.zeros([s
+0002bd70: 656c 662e 6e7a 2c20 7365 6c66 2e6e 792c  elf.nz, self.ny,
+0002bd80: 2073 656c 662e 6e78 5d29 0d0a 2020 2020   self.nx])..    
+0002bd90: 2020 2020 2020 2020 2320 636f 6d70 7574          # comput
+0002bda0: 6520 7072 6f62 6162 696c 6974 6965 730d  e probabilities.
+0002bdb0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0002bdc0: 2069 7520 696e 2072 616e 6765 2873 656c   iu in range(sel
+0002bdd0: 662e 6e72 6561 6c5f 756e 6974 7329 3a0d  f.nreal_units):.
+0002bde0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002bdf0: 2066 6f72 2069 6661 2069 6e20 7261 6e67   for ifa in rang
+0002be00: 6528 7365 6c66 2e6e 7265 616c 5f66 6129  e(self.nreal_fa)
+0002be10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002be20: 2020 2020 2020 2066 6163 6965 733d 7365         facies=se
+0002be30: 6c66 2e67 6574 5f66 6163 6965 7328 6975  lf.get_facies(iu
+0002be40: 3d69 752c 2069 6661 3d69 6661 2c20 616c  =iu, ifa=ifa, al
+0002be50: 6c5f 6461 7461 3d46 616c 7365 290d 0a20  l_data=False).. 
+0002be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002be70: 2020 2061 7272 2b3d 2866 6163 6965 7320     arr+=(facies 
+0002be80: 3d3d 2069 290d 0a20 2020 2020 2020 2020  == i)..         
+0002be90: 2020 2061 7272 2f3d 2873 656c 662e 6e72     arr/=(self.nr
+0002bea0: 6561 6c5f 756e 6974 732a 7365 6c66 2e6e  eal_units*self.n
+0002beb0: 7265 616c 5f66 6129 0d0a 2020 2020 2020  real_fa)..      
+0002bec0: 2020 696d 3d67 656f 6e65 2e69 6d67 2e49    im=geone.img.I
+0002bed0: 6d67 286e 782c 206e 792c 206e 7a2c 2073  mg(nx, ny, nz, s
+0002bee0: 782c 2073 792c 2073 7a2a 765f 6578 2c20  x, sy, sz*v_ex, 
+0002bef0: 7830 2c20 7930 2c20 7a30 2c20 6e76 3d31  x0, y0, z0, nv=1
+0002bf00: 2c20 7661 6c3d 6172 722c 2076 6172 6e61  , val=arr, varna
+0002bf10: 6d65 3d22 5020 5b2d 5d22 2920 2363 7265  me="P [-]") #cre
+0002bf20: 6174 6520 696d 6720 6f62 6a65 6374 0d0a  ate img object..
+0002bf30: 0d0a 2020 2020 2020 2020 2363 7265 6174  ..        #creat
+0002bf40: 6520 736c 6963 6573 0d0a 2020 2020 2020  e slices..      
+0002bf50: 2020 6966 2073 6c69 6365 7820 6973 206e    if slicex is n
+0002bf60: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0002bf70: 2020 2020 2020 736c 6963 6578 3d6e 702e        slicex=np.
+0002bf80: 6172 7261 7928 736c 6963 6578 290d 0a20  array(slicex).. 
+0002bf90: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+0002bfa0: 785b 736c 6963 6578 3c30 5d3d 300d 0a20  x[slicex<0]=0.. 
+0002bfb0: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+0002bfc0: 785b 736c 6963 6578 3e31 5d3d 310d 0a20  x[slicex>1]=1.. 
+0002bfd0: 2020 2020 2020 2020 2020 2063 783d 696d             cx=im
+0002bfe0: 2e6f 7820 2b20 736c 6963 6578 202a 2069  .ox + slicex * i
+0002bff0: 6d2e 6e78 202a 2069 6d2e 7378 2020 2320  m.nx * im.sx  # 
+0002c000: 6365 6e74 6572 2061 6c6f 6e67 2078 0d0a  center along x..
+0002c010: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0002c020: 2020 2020 2020 2020 2020 2063 783d 4e6f             cx=No
+0002c030: 6e65 0d0a 2020 2020 2020 2020 6966 2073  ne..        if s
+0002c040: 6c69 6365 7920 6973 206e 6f74 204e 6f6e  licey is not Non
+0002c050: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002c060: 736c 6963 6579 3d6e 702e 6172 7261 7928  slicey=np.array(
+0002c070: 736c 6963 6579 290d 0a20 2020 2020 2020  slicey)..       
+0002c080: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
+0002c090: 6579 3c30 5d3d 300d 0a20 2020 2020 2020  ey<0]=0..       
+0002c0a0: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
+0002c0b0: 6579 3e31 5d3d 310d 0a20 2020 2020 2020  ey>1]=1..       
+0002c0c0: 2020 2020 2063 793d 696d 2e6f 7920 2b20       cy=im.oy + 
+0002c0d0: 736c 6963 6579 202a 2069 6d2e 6e79 202a  slicey * im.ny *
+0002c0e0: 2069 6d2e 7379 2020 2320 6365 6e74 6572   im.sy  # center
+0002c0f0: 2061 6c6f 6e67 2079 0d0a 2020 2020 2020   along y..      
+0002c100: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0002c110: 2020 2020 2063 793d 4e6f 6e65 0d0a 2020       cy=None..  
+0002c120: 2020 2020 2020 6966 2073 6c69 6365 7a20        if slicez 
+0002c130: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+0002c140: 2020 2020 2020 2020 2020 736c 6963 657a            slicez
+0002c150: 3d6e 702e 6172 7261 7928 736c 6963 657a  =np.array(slicez
+0002c160: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0002c170: 6c69 6365 7a5b 736c 6963 657a 3c30 5d3d  licez[slicez<0]=
+0002c180: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
+0002c190: 6c69 6365 7a5b 736c 6963 657a 3e31 5d3d  licez[slicez>1]=
+0002c1a0: 310d 0a20 2020 2020 2020 2020 2020 2063  1..            c
+0002c1b0: 7a3d 696d 2e6f 7a20 2b20 736c 6963 657a  z=im.oz + slicez
+0002c1c0: 202a 2069 6d2e 6e7a 202a 2069 6d2e 737a   * im.nz * im.sz
+0002c1d0: 2020 2320 6365 6e74 6572 2061 6c6f 6e67    # center along
+0002c1e0: 207a 0d0a 2020 2020 2020 2020 656c 7365   z..        else
+0002c1f0: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+0002c200: 7a3d 4e6f 6e65 0d0a 0d0a 2020 2020 2020  z=None....      
+0002c210: 2020 6966 2061 7272 2e61 6e79 2829 3a20    if arr.any(): 
+0002c220: 2369 6620 7661 6c75 6573 2061 7265 2066  #if values are f
+0002c230: 6f75 6e64 0d0a 2020 2020 2020 2020 2020  ound..          
+0002c240: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0002c250: 2320 6669 6c74 6572 2076 616c 7565 730d  # filter values.
+0002c260: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002c270: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+0002c280: 616c 2069 7320 6e6f 7420 4e6f 6e65 3a0d  al is not None:.
+0002c290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c2a0: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+0002c2b0: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
+0002c2c0: 6c2c 206c 6973 7429 3a0d 0a20 2020 2020  l, list):..     
+0002c2d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002c2e0: 6620 6c65 6e28 6669 6c74 6572 696e 675f  f len(filtering_
+0002c2f0: 696e 7465 7276 616c 2920 3d3d 2032 3a0d  interval) == 2:.
+0002c300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c310: 2020 2020 2020 2020 2069 6620 6669 6c74           if filt
+0002c320: 6572 696e 675f 696e 7465 7276 616c 5b30  ering_interval[0
+0002c330: 5d20 3c20 6669 6c74 6572 696e 675f 696e  ] < filtering_in
+0002c340: 7465 7276 616c 5b31 5d3a 0d0a 2020 2020  terval[1]:..    
+0002c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c360: 2020 2020 2020 2020 6172 725b 6172 7220          arr[arr 
+0002c370: 3c20 6669 6c74 6572 696e 675f 696e 7465  < filtering_inte
+0002c380: 7276 616c 5b30 5d5d 203d 206e 702e 6e61  rval[0]] = np.na
+0002c390: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+0002c3a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002c3b0: 7272 5b61 7272 203e 2066 696c 7465 7269  rr[arr > filteri
+0002c3c0: 6e67 5f69 6e74 6572 7661 6c5b 315d 5d20  ng_interval[1]] 
+0002c3d0: 3d20 6e70 2e6e 616e 0d0a 2020 2020 2020  = np.nan..      
+0002c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c3f0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0002c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c410: 2020 2020 2070 7269 6e74 2822 6669 6c74       print("filt
+0002c420: 6572 696e 675f 696e 7465 7276 616c 5b30  ering_interval[0
+0002c430: 5d20 6d75 7374 2062 6520 736d 616c 6c65  ] must be smalle
+0002c440: 7220 7468 616e 2066 696c 7465 7269 6e67  r than filtering
+0002c450: 5f69 6e74 6572 7661 6c5b 315d 2229 0d0a  _interval[1]")..
+0002c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c470: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
 0002c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c490: 2020 2073 6361 6c61 725f 6261 725f 6b77     scalar_bar_kw
-0002c4a0: 6172 6773 3d4e 6f6e 652c 2073 686f 775f  args=None, show_
-0002c4b0: 7363 616c 6172 5f62 6172 3d54 7275 6529  scalar_bar=True)
-0002c4c0: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-0002c4d0: 0d0a 2020 2020 2020 2020 506c 6f74 2074  ..        Plot t
-0002c4e0: 6865 2066 6163 6965 7320 7265 616c 697a  he facies realiz
-0002c4f0: 6174 696f 6e73 206f 7665 7220 7468 6520  ations over the 
-0002c500: 646f 6d61 696e 2077 6974 6820 7468 6520  domain with the 
-0002c510: 636f 6c6f 7273 2061 7474 7269 6275 7465  colors attribute
-0002c520: 6420 746f 2066 6163 6965 730d 0a0d 0a20  d to facies.... 
-0002c530: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0002c540: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0002c550: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2069  -----..        i
-0002c560: 753a 2069 6e74 0d0a 2020 2020 2020 2020  u: int..        
-0002c570: 2020 2020 696e 6469 6365 206f 6620 756e      indice of un
-0002c580: 6974 7320 7265 616c 697a 6174 696f 6e0d  its realization.
-0002c590: 0a20 2020 2020 2020 2069 6661 3a20 696e  .        ifa: in
-0002c5a0: 740d 0a20 2020 2020 2020 2020 2020 2069  t..            i
-0002c5b0: 6e64 6963 6520 6f66 2066 6163 6965 7320  ndice of facies 
-0002c5c0: 7265 616c 7a69 6174 696f 6e0d 0a20 2020  realziation..   
-0002c5d0: 2020 2020 2076 5f65 783a 2069 6e74 206f       v_ex: int o
-0002c5e0: 7220 666c 6f61 740d 0a20 2020 2020 2020  r float..       
-0002c5f0: 2020 2020 2076 6572 7469 6361 6c20 6578       vertical ex
-0002c600: 6167 6572 6174 696f 6e0d 0a20 2020 2020  ageration..     
-0002c610: 2020 2069 6e73 6964 655f 756e 6974 733a     inside_units:
-0002c620: 2061 7272 6179 2d6c 696b 6520 6f66 203a   array-like of :
-0002c630: 636c 6173 733a 6055 6e69 7460 206f 626a  class:`Unit` obj
-0002c640: 6563 7473 0d0a 2020 2020 2020 2020 2020  ects..          
-0002c650: 2020 6c69 7374 206f 6620 756e 6974 7320    list of units 
-0002c660: 696e 7369 6465 2077 6869 6368 2077 6520  inside which we 
-0002c670: 7761 6e74 2074 6f20 6861 7665 2074 6865  want to have the
-0002c680: 2070 6c6f 742e 0d0a 2020 2020 2020 2020   plot...        
-0002c690: 2020 2020 6966 204e 6f6e 6520 2d2d 3e20      if None --> 
-0002c6a0: 616c 6c0d 0a20 2020 2020 2020 2070 6c6f  all..        plo
-0002c6b0: 7474 6572 3a20 7079 7669 7374 6120 706c  tter: pyvista pl
-0002c6c0: 6f74 7465 7220 6966 2077 616e 7465 640d  otter if wanted.
-0002c6d0: 0a20 2020 2020 2020 2073 6c69 6365 783a  .        slicex:
-0002c6e0: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
-0002c6f0: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
-0002c700: 2020 2020 2020 2020 2020 6672 6163 7469            fracti
-0002c710: 6f6e 206f 6620 7820 6178 6973 2077 6865  on of x axis whe
-0002c720: 7265 2074 6f20 736c 6963 650d 0a20 2020  re to slice..   
-0002c730: 2020 2020 2073 6c69 6365 793a 2066 6c6f       slicey: flo
-0002c740: 6174 206f 7220 7365 7175 656e 6365 206f  at or sequence o
-0002c750: 6620 666c 6f61 7473 0d0a 2020 2020 2020  f floats..      
-0002c760: 2020 2020 2020 6672 6163 7469 6f6e 206f        fraction o
-0002c770: 6620 7920 6178 6973 2077 6865 7265 2074  f y axis where t
-0002c780: 6f20 736c 6963 650d 0a20 2020 2020 2020  o slice..       
-0002c790: 2073 6c69 6365 7a3a 2066 6c6f 6174 206f   slicez: float o
-0002c7a0: 7220 7365 7175 656e 6365 206f 6620 666c  r sequence of fl
-0002c7b0: 6f61 7473 0d0a 2020 2020 2020 2020 2020  oats..          
-0002c7c0: 2020 6672 6163 7469 6f6e 206f 6620 7a20    fraction of z 
-0002c7d0: 6178 6973 2077 6865 7265 2074 6f20 736c  axis where to sl
-0002c7e0: 6963 650d 0a20 2020 2020 2020 2066 696c  ice..        fil
-0002c7f0: 7465 7269 6e67 5f76 616c 7565 3a20 6172  tering_value: ar
-0002c800: 7261 792d 6c69 6b65 0d0a 2020 2020 2020  ray-like..      
-0002c810: 2020 2020 2020 7661 6c75 6573 2074 6f20        values to 
-0002c820: 706c 6f74 2c20 7468 6573 6520 7661 6c75  plot, these valu
-0002c830: 6573 2044 4f45 5320 4e4f 5420 636f 7272  es DOES NOT corr
-0002c840: 6573 706f 6e64 2074 6f20 6661 6369 6573  espond to facies
-0002c850: 2049 4473 0d0a 2020 2020 2020 2020 7363   IDs..        sc
-0002c860: 616c 6172 5f62 6172 5f6b 7761 7267 733a  alar_bar_kwargs:
-0002c870: 2064 6963 740d 0a20 2020 2020 2020 2020   dict..         
-0002c880: 2020 206b 7761 7267 7320 666f 7220 7468     kwargs for th
-0002c890: 6520 7363 616c 6172 2062 6172 0d0a 2020  e scalar bar..  
-0002c8a0: 2020 2020 2020 7368 6f77 5f73 6361 6c61        show_scala
-0002c8b0: 725f 6261 723a 2062 6f6f 6c0d 0a20 2020  r_bar: bool..   
-0002c8c0: 2020 2020 2020 2020 2069 6620 5472 7565           if True
-0002c8d0: 2c20 7368 6f77 2074 6865 2073 6361 6c61  , show the scala
-0002c8e0: 7220 6261 720d 0a0d 0a20 2020 2020 2020  r bar....       
-0002c8f0: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
-0002c900: 6661 5f64 6f6d 6169 6e73 3d73 656c 662e  fa_domains=self.
-0002c910: 6765 745f 6661 6369 6573 2869 752c 2069  get_facies(iu, i
-0002c920: 6661 2c20 616c 6c5f 6461 7461 3d46 616c  fa, all_data=Fal
-0002c930: 7365 292e 6173 7479 7065 286e 702e 666c  se).astype(np.fl
-0002c940: 6f61 7433 3229 0d0a 0d0a 2020 2020 2020  oat32)....      
-0002c950: 2020 236b 6565 7020 6661 6369 6573 2069    #keep facies i
-0002c960: 6e20 6f6e 6c79 2077 616e 7465 6420 756e  n only wanted un
-0002c970: 6974 730d 0a20 2020 2020 2020 2069 6620  its..        if 
-0002c980: 696e 7369 6465 5f75 6e69 7473 2069 7320  inside_units is 
-0002c990: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-0002c9a0: 2020 2020 2020 206d 6173 6b5f 616c 6c3d         mask_all=
-0002c9b0: 6e70 2e7a 6572 6f73 285b 7365 6c66 2e67  np.zeros([self.g
-0002c9c0: 6574 5f6e 7a28 292c 2073 656c 662e 6765  et_nz(), self.ge
-0002c9d0: 745f 6e79 2829 2c20 7365 6c66 2e67 6574  t_ny(), self.get
-0002c9e0: 5f6e 7828 295d 290d 0a20 2020 2020 2020  _nx()])..       
-0002c9f0: 2020 2020 2066 6f72 2075 2069 6e20 696e       for u in in
-0002ca00: 7369 6465 5f75 6e69 7473 3a0d 0a20 2020  side_units:..   
-0002ca10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002ca20: 6973 696e 7374 616e 6365 2875 2c20 7374  isinstance(u, st
-0002ca30: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
-0002ca40: 2020 2020 2020 2020 206d 6173 6b3d 7365           mask=se
-0002ca50: 6c66 2e75 6e69 745f 6d61 736b 2875 2c20  lf.unit_mask(u, 
-0002ca60: 6975 3d20 6975 290d 0a20 2020 2020 2020  iu= iu)..       
-0002ca70: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
-0002ca80: 696e 7374 616e 6365 2875 2c20 556e 6974  instance(u, Unit
-0002ca90: 2920 616e 6420 7520 696e 2073 656c 662e  ) and u in self.
-0002caa0: 6765 745f 616c 6c5f 756e 6974 7328 293a  get_all_units():
-0002cab0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002cac0: 2020 2020 2020 6d61 736b 3d73 656c 662e        mask=self.
-0002cad0: 756e 6974 5f6d 6173 6b28 752e 6e61 6d65  unit_mask(u.name
-0002cae0: 2c20 6975 3d20 6975 290d 0a20 2020 2020  , iu= iu)..     
-0002caf0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0002cb00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002cb10: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002cb20: 6545 7272 6f72 2028 2255 6e69 7420 7061  eError ("Unit pa
-0002cb30: 7373 6564 2069 6e20 696e 7369 6465 5f75  ssed in inside_u
-0002cb40: 6e69 7473 206d 7573 7420 6265 2061 2075  nits must be a u
-0002cb50: 6e69 7420 6e61 6d65 206f 7220 6120 756e  nit name or a un
-0002cb60: 6974 206f 626a 6563 7420 636f 6e74 6169  it object contai
-0002cb70: 6e65 6420 696e 2074 6865 2041 7263 6854  ned in the ArchT
-0002cb80: 6162 6c65 2229 0d0a 2020 2020 2020 2020  able")..        
-0002cb90: 2020 2020 2020 2020 6d61 736b 5f61 6c6c          mask_all
-0002cba0: 5b6d 6173 6b20 3d3d 2031 5d3d 310d 0a0d  [mask == 1]=1...
-0002cbb0: 0a20 2020 2020 2020 2020 2020 2066 615f  .            fa_
-0002cbc0: 646f 6d61 696e 735b 6d61 736b 5f61 6c6c  domains[mask_all
-0002cbd0: 2021 3d20 315d 3d30 0d0a 0d0a 2020 2020   != 1]=0....    
-0002cbe0: 2020 2020 643d 7b7d 0d0a 2020 2020 2020      d={}..      
-0002cbf0: 2020 645f 4944 3d7b 7d20 2320 6469 6320    d_ID={} # dic 
-0002cc00: 6f66 2076 616c 7565 7320 6769 7665 6e20  of values given 
-0002cc10: 4944 0d0a 2020 2020 2020 2020 636f 6c6f  ID..        colo
-0002cc20: 7273 3d5b 5d0d 0a20 2020 2020 2020 206e  rs=[]..        n
-0002cc30: 783d 7365 6c66 2e67 6574 5f6e 7828 290d  x=self.get_nx().
-0002cc40: 0a20 2020 2020 2020 206e 793d 7365 6c66  .        ny=self
-0002cc50: 2e67 6574 5f6e 7928 290d 0a20 2020 2020  .get_ny()..     
-0002cc60: 2020 206e 7a3d 7365 6c66 2e67 6574 5f6e     nz=self.get_n
-0002cc70: 7a28 290d 0a20 2020 2020 2020 2073 783d  z()..        sx=
-0002cc80: 7365 6c66 2e67 6574 5f73 7828 290d 0a20  self.get_sx().. 
-0002cc90: 2020 2020 2020 2073 793d 7365 6c66 2e67         sy=self.g
-0002cca0: 6574 5f73 7928 290d 0a20 2020 2020 2020  et_sy()..       
-0002ccb0: 2073 7a3d 7365 6c66 2e67 6574 5f73 7a28   sz=self.get_sz(
-0002ccc0: 290d 0a20 2020 2020 2020 2078 303d 7365  )..        x0=se
-0002ccd0: 6c66 2e67 6574 5f6f 7828 290d 0a20 2020  lf.get_ox()..   
-0002cce0: 2020 2020 2079 303d 7365 6c66 2e67 6574       y0=self.get
-0002ccf0: 5f6f 7928 290d 0a20 2020 2020 2020 207a  _oy()..        z
-0002cd00: 303d 7365 6c66 2e67 6574 5f6f 7a28 290d  0=self.get_oz().
-0002cd10: 0a20 2020 2020 2020 206c 7374 5f49 443d  .        lst_ID=
-0002cd20: 6e70 2e75 6e69 7175 6528 6661 5f64 6f6d  np.unique(fa_dom
-0002cd30: 6169 6e73 290d 0a0d 0a20 2020 2020 2020  ains)....       
-0002cd40: 206e 6577 5f69 643d 310d 0a20 2020 2020   new_id=1..     
-0002cd50: 2020 2066 6f72 2069 2069 6e20 6c73 745f     for i in lst_
-0002cd60: 4944 3a0d 0a20 2020 2020 2020 2020 2020  ID:..           
-0002cd70: 2069 6620 6920 213d 2030 3a0d 0a20 2020   if i != 0:..   
-0002cd80: 2020 2020 2020 2020 2020 2020 2066 613d               fa=
-0002cd90: 7365 6c66 2e67 6574 5f66 6163 6965 735f  self.get_facies_
-0002cda0: 6f62 6a28 4944 3d69 2c20 7479 7065 3d22  obj(ID=i, type="
-0002cdb0: 4944 2229 0d0a 2020 2020 2020 2020 2020  ID")..          
-0002cdc0: 2020 2020 2020 6661 5f64 6f6d 6169 6e73        fa_domains
-0002cdd0: 5b66 615f 646f 6d61 696e 7320 3d3d 2066  [fa_domains == f
-0002cde0: 612e 4944 5d3d 6e65 775f 6964 0d0a 2020  a.ID]=new_id..  
-0002cdf0: 2020 2020 2020 2020 2020 2020 2020 645f                d_
-0002ce00: 4944 5b66 612e 4944 5d3d 6e65 775f 6964  ID[fa.ID]=new_id
-0002ce10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002ce20: 2020 636f 6c6f 7273 2e61 7070 656e 6428    colors.append(
-0002ce30: 6661 2e63 290d 0a20 2020 2020 2020 2020  fa.c)..         
-0002ce40: 2020 2020 2020 2064 5b6e 6577 5f69 6420         d[new_id 
-0002ce50: 2b20 302e 355d 3d66 612e 6e61 6d65 0d0a  + 0.5]=fa.name..
-0002ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce70: 6e65 775f 6964 202b 3d20 310d 0a0d 0a20  new_id += 1.... 
-0002ce80: 2020 2020 2020 2023 7265 6d6f 7665 2030         #remove 0
-0002ce90: 206f 6363 7572 656e 6365 2028 7768 6572   occurence (wher
-0002cea0: 6520 6e6f 2066 6163 6965 7320 6172 6520  e no facies are 
-0002ceb0: 7072 6573 656e 7429 0d0a 2020 2020 2020  present)..      
-0002cec0: 2020 6661 5f64 6f6d 6169 6e73 5b66 615f    fa_domains[fa_
-0002ced0: 646f 6d61 696e 733d 3d30 5d3d 6e70 2e6e  domains==0]=np.n
-0002cee0: 616e 0d0a 0d0a 2020 2020 2020 2020 6966  an....        if
-0002cef0: 2070 6c6f 7474 6572 2069 7320 4e6f 6e65   plotter is None
-0002cf00: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-0002cf10: 3d70 762e 506c 6f74 7465 7228 290d 0a20  =pv.Plotter().. 
-0002cf20: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0002cf30: 2020 2020 2020 2020 2020 703d 706c 6f74            p=plot
-0002cf40: 7465 720d 0a20 2020 2020 2020 2069 6d3d  ter..        im=
-0002cf50: 6765 6f6e 652e 696d 672e 496d 6728 6e78  geone.img.Img(nx
-0002cf60: 2c20 6e79 2c20 6e7a 2c20 7378 2c20 7379  , ny, nz, sx, sy
-0002cf70: 2c20 737a 2a76 5f65 782c 2078 302c 2079  , sz*v_ex, x0, y
-0002cf80: 302c 207a 302c 206e 763d 312c 2076 616c  0, z0, nv=1, val
-0002cf90: 3d66 615f 646f 6d61 696e 732c 2076 6172  =fa_domains, var
-0002cfa0: 6e61 6d65 3d22 4c69 7468 6f6c 6f67 6965  name="Lithologie
-0002cfb0: 7322 290d 0a0d 0a20 2020 2020 2020 2069  s")....        i
-0002cfc0: 6620 736c 6963 6578 2069 7320 6e6f 7420  f slicex is not 
-0002cfd0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0002cfe0: 2020 2073 6c69 6365 783d 6e70 2e61 7272     slicex=np.arr
-0002cff0: 6179 2873 6c69 6365 7829 0d0a 2020 2020  ay(slicex)..    
-0002d000: 2020 2020 2020 2020 736c 6963 6578 5b73          slicex[s
-0002d010: 6c69 6365 783c 305d 3d30 0d0a 2020 2020  licex<0]=0..    
-0002d020: 2020 2020 2020 2020 736c 6963 6578 5b73          slicex[s
-0002d030: 6c69 6365 783e 315d 3d31 0d0a 2020 2020  licex>1]=1..    
-0002d040: 2020 2020 2020 2020 6378 3d69 6d2e 6f78          cx=im.ox
-0002d050: 202b 2073 6c69 6365 7820 2a20 696d 2e6e   + slicex * im.n
-0002d060: 7820 2a20 696d 2e73 7820 2023 2063 656e  x * im.sx  # cen
-0002d070: 7465 7220 616c 6f6e 6720 780d 0a20 2020  ter along x..   
-0002d080: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0002d090: 2020 2020 2020 2020 6378 3d4e 6f6e 650d          cx=None.
-0002d0a0: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
-0002d0b0: 6579 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ey is not None:.
-0002d0c0: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
-0002d0d0: 6365 793d 6e70 2e61 7272 6179 2873 6c69  cey=np.array(sli
-0002d0e0: 6365 7929 0d0a 2020 2020 2020 2020 2020  cey)..          
-0002d0f0: 2020 736c 6963 6579 5b73 6c69 6365 793c    slicey[slicey<
-0002d100: 305d 3d30 0d0a 2020 2020 2020 2020 2020  0]=0..          
-0002d110: 2020 736c 6963 6579 5b73 6c69 6365 793e    slicey[slicey>
-0002d120: 315d 3d31 0d0a 2020 2020 2020 2020 2020  1]=1..          
-0002d130: 2020 6379 3d69 6d2e 6f79 202b 2073 6c69    cy=im.oy + sli
-0002d140: 6365 7920 2a20 696d 2e6e 7920 2a20 696d  cey * im.ny * im
-0002d150: 2e73 7920 2023 2063 656e 7465 7220 616c  .sy  # center al
-0002d160: 6f6e 6720 790d 0a20 2020 2020 2020 2065  ong y..        e
-0002d170: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0002d180: 2020 6379 3d4e 6f6e 650d 0a20 2020 2020    cy=None..     
-0002d190: 2020 2069 6620 736c 6963 657a 2069 7320     if slicez is 
-0002d1a0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-0002d1b0: 2020 2020 2020 2073 6c69 6365 7a3d 6e70         slicez=np
-0002d1c0: 2e61 7272 6179 2873 6c69 6365 7a29 0d0a  .array(slicez)..
-0002d1d0: 2020 2020 2020 2020 2020 2020 736c 6963              slic
-0002d1e0: 657a 5b73 6c69 6365 7a3c 305d 3d30 0d0a  ez[slicez<0]=0..
-0002d1f0: 2020 2020 2020 2020 2020 2020 736c 6963              slic
-0002d200: 657a 5b73 6c69 6365 7a3e 315d 3d31 0d0a  ez[slicez>1]=1..
-0002d210: 2020 2020 2020 2020 2020 2020 637a 3d69              cz=i
-0002d220: 6d2e 6f7a 202b 2073 6c69 6365 7a20 2a20  m.oz + slicez * 
-0002d230: 696d 2e6e 7a20 2a20 696d 2e73 7a20 2023  im.nz * im.sz  #
-0002d240: 2063 656e 7465 7220 616c 6f6e 6720 7a0d   center along z.
-0002d250: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0002d260: 2020 2020 2020 2020 2020 2020 637a 3d4e              cz=N
-0002d270: 6f6e 650d 0a0d 0a20 2020 2020 2020 2023  one....        #
-0002d280: 6669 6c74 6572 696e 6720 7661 6c75 6573  filtering values
-0002d290: 2c20 6368 616e 6765 2076 616c 7565 7320  , change values 
-0002d2a0: 746f 2068 6176 6520 7269 6768 7420 6e75  to have right nu
-0002d2b0: 6d62 6572 730d 0a20 2020 2020 2020 2069  mbers..        i
-0002d2c0: 6620 6669 6c74 6572 696e 675f 7661 6c75  f filtering_valu
-0002d2d0: 6520 6973 206e 6f74 204e 6f6e 653a 0d0a  e is not None:..
-0002d2e0: 2020 2020 2020 2020 2020 2020 6674 5f76              ft_v
-0002d2f0: 616c 3d5b 645f 4944 5b69 5d20 666f 7220  al=[d_ID[i] for 
-0002d300: 6920 696e 2066 696c 7465 7269 6e67 5f76  i in filtering_v
-0002d310: 616c 7565 5d0d 0a20 2020 2020 2020 2065  alue]..        e
-0002d320: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0002d330: 2020 6674 5f76 616c 3d4e 6f6e 650d 0a0d    ft_val=None...
-0002d340: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
-0002d350: 6578 2069 7320 6e6f 7420 4e6f 6e65 206f  ex is not None o
-0002d360: 7220 736c 6963 6579 2069 7320 6e6f 7420  r slicey is not 
-0002d370: 4e6f 6e65 206f 7220 736c 6963 657a 2069  None or slicez i
-0002d380: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0002d390: 2020 2020 2020 2020 2069 6d67 706c 7433           imgplt3
-0002d3a0: 2e64 7261 7749 6d61 6765 3344 5f73 6c69  .drawImage3D_sli
-0002d3b0: 6365 2869 6d2c 2070 6c6f 7474 6572 3d70  ce(im, plotter=p
-0002d3c0: 2c20 736c 6963 655f 6e6f 726d 616c 5f78  , slice_normal_x
-0002d3d0: 3d63 782c 2073 6c69 6365 5f6e 6f72 6d61  =cx, slice_norma
-0002d3e0: 6c5f 793d 6379 2c20 736c 6963 655f 6e6f  l_y=cy, slice_no
-0002d3f0: 726d 616c 5f7a 3d63 7a2c 0d0a 2020 2020  rmal_z=cz,..    
-0002d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d420: 6375 7374 6f6d 5f73 6361 6c61 725f 6261  custom_scalar_ba
-0002d430: 725f 666f 725f 6571 7569 6469 7374 616e  r_for_equidistan
-0002d440: 745f 6361 7465 676f 7269 6573 3d54 7275  t_categories=Tru
-0002d450: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-0002d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d470: 2020 2020 2020 2020 6375 7374 6f6d 5f63          custom_c
-0002d480: 6f6c 6f72 733d 636f 6c6f 7273 2c20 7363  olors=colors, sc
-0002d490: 616c 6172 5f62 6172 5f61 6e6e 6f74 6174  alar_bar_annotat
-0002d4a0: 696f 6e73 3d64 2c20 6669 6c74 6572 696e  ions=d, filterin
-0002d4b0: 675f 7661 6c75 653d 6674 5f76 616c 2c0d  g_value=ft_val,.
-0002d4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4e0: 2020 2020 2073 6361 6c61 725f 6261 725f       scalar_bar_
-0002d4f0: 6b77 6172 6773 3d73 6361 6c61 725f 6261  kwargs=scalar_ba
-0002d500: 725f 6b77 6172 6773 2c20 7368 6f77 5f73  r_kwargs, show_s
-0002d510: 6361 6c61 725f 6261 7220 3d20 7368 6f77  calar_bar = show
-0002d520: 5f73 6361 6c61 725f 6261 7229 0d0a 2020  _scalar_bar)..  
-0002d530: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0002d540: 2020 2020 2020 2020 2069 6d67 706c 7433           imgplt3
-0002d550: 2e64 7261 7749 6d61 6765 3344 5f73 7572  .drawImage3D_sur
-0002d560: 6661 6365 2869 6d2c 2070 6c6f 7474 6572  face(im, plotter
-0002d570: 3d70 2c20 6375 7374 6f6d 5f73 6361 6c61  =p, custom_scala
-0002d580: 725f 6261 725f 666f 725f 6571 7569 6469  r_bar_for_equidi
-0002d590: 7374 616e 745f 6361 7465 676f 7269 6573  stant_categories
-0002d5a0: 3d54 7275 652c 0d0a 2020 2020 2020 2020  =True,..        
-0002d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d5c0: 2020 2020 2020 2020 2020 2020 6375 7374              cust
-0002d5d0: 6f6d 5f63 6f6c 6f72 733d 636f 6c6f 7273  om_colors=colors
-0002d5e0: 2c20 7363 616c 6172 5f62 6172 5f61 6e6e  , scalar_bar_ann
-0002d5f0: 6f74 6174 696f 6e73 3d64 2c20 6669 6c74  otations=d, filt
-0002d600: 6572 696e 675f 7661 6c75 653d 6674 5f76  ering_value=ft_v
-0002d610: 616c 2c0d 0a20 2020 2020 2020 2020 2020  al,..           
-0002d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d630: 2020 2020 2020 2020 2073 6361 6c61 725f           scalar_
-0002d640: 6261 725f 6b77 6172 6773 3d73 6361 6c61  bar_kwargs=scala
-0002d650: 725f 6261 725f 6b77 6172 6773 2c20 7368  r_bar_kwargs, sh
-0002d660: 6f77 5f73 6361 6c61 725f 6261 7220 3d20  ow_scalar_bar = 
-0002d670: 7368 6f77 5f73 6361 6c61 725f 6261 7229  show_scalar_bar)
-0002d680: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
-0002d690: 6c6f 7474 6572 2069 7320 4e6f 6e65 3a0d  lotter is None:.
-0002d6a0: 0a20 2020 2020 2020 2020 2020 2070 2e61  .            p.a
-0002d6b0: 6464 5f62 6f75 6e64 696e 675f 626f 7828  dd_bounding_box(
-0002d6c0: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-0002d6d0: 2e73 686f 775f 6178 6573 2829 0d0a 2020  .show_axes()..  
-0002d6e0: 2020 2020 2020 2020 2020 702e 7368 6f77            p.show
-0002d6f0: 2829 0d0a 0d0a 0d0a 2020 2020 6465 6620  ()......    def 
-0002d700: 706c 6f74 5f70 726f 7028 7365 6c66 2c20  plot_prop(self, 
-0002d710: 7072 6f70 6572 7479 2c20 6975 3d30 2c20  property, iu=0, 
-0002d720: 6966 613d 302c 2069 703d 302c 2076 5f65  ifa=0, ip=0, v_e
-0002d730: 783d 312c 2069 6e73 6964 655f 756e 6974  x=1, inside_unit
-0002d740: 733d 4e6f 6e65 2c20 696e 7369 6465 5f66  s=None, inside_f
-0002d750: 6163 6965 733d 4e6f 6e65 2c0d 0a20 2020  acies=None,..   
-0002d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d770: 2070 6c6f 7474 6572 3d4e 6f6e 652c 2073   plotter=None, s
-0002d780: 6c69 6365 783d 4e6f 6e65 2c20 736c 6963  licex=None, slic
-0002d790: 6579 3d4e 6f6e 652c 2073 6c69 6365 7a3d  ey=None, slicez=
-0002d7a0: 4e6f 6e65 2c20 636d 696e 3d4e 6f6e 652c  None, cmin=None,
-0002d7b0: 2063 6d61 783d 4e6f 6e65 2c20 6669 6c74   cmax=None, filt
-0002d7c0: 6572 696e 675f 696e 7465 7276 616c 3d4e  ering_interval=N
-0002d7d0: 6f6e 652c 2073 6361 6c61 725f 6261 725f  one, scalar_bar_
-0002d7e0: 6b77 6172 6773 3d4e 6f6e 6529 3a0d 0a0d  kwargs=None):...
-0002d7f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0002d800: 2020 2020 2020 506c 6f74 2074 6865 2066        Plot the f
-0002d810: 6163 6965 7320 7265 616c 697a 6174 696f  acies realizatio
-0002d820: 6e73 206f 7665 7220 7468 6520 646f 6d61  ns over the doma
-0002d830: 696e 2077 6974 6820 7468 6520 636f 6c6f  in with the colo
-0002d840: 7273 2061 7474 7269 6275 7465 6420 746f  rs attributed to
-0002d850: 2066 6163 6965 730d 0a0d 0a20 2020 2020   facies....     
-0002d860: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0002d870: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0002d880: 2d0d 0a20 2020 2020 2020 2069 753a 696e  -..        iu:in
-0002d890: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-0002d8a0: 696e 6469 6365 206f 6620 756e 6974 7320  indice of units 
-0002d8b0: 7265 616c 697a 6174 696f 6e0d 0a20 2020  realization..   
-0002d8c0: 2020 2020 2069 6661 3a69 6e74 0d0a 2020       ifa:int..  
-0002d8d0: 2020 2020 2020 2020 2020 696e 6469 6365            indice
-0002d8e0: 206f 6620 6661 6369 6573 2072 6561 6c69   of facies reali
-0002d8f0: 7a61 7469 6f6e 0d0a 2020 2020 2020 2020  zation..        
-0002d900: 6970 3a69 6e74 0d0a 2020 2020 2020 2020  ip:int..        
-0002d910: 2020 2020 696e 6469 6365 206f 6620 7072      indice of pr
-0002d920: 6f70 6572 7479 2072 6561 6c69 7a61 7469  operty realizati
-0002d930: 6f6e 0d0a 2020 2020 2020 2020 765f 6578  on..        v_ex
-0002d940: 3a69 6e74 206f 7220 666c 6f61 740d 0a20  :int or float.. 
-0002d950: 2020 2020 2020 2020 2020 2076 6572 7469             verti
-0002d960: 6361 6c20 6578 6167 6572 6174 696f 6e0d  cal exageration.
-0002d970: 0a20 2020 2020 2020 2069 6e73 6964 655f  .        inside_
-0002d980: 756e 6974 733a 6172 7261 792d 6c69 6b65  units:array-like
-0002d990: 206f 6620 3a63 6c61 7373 3a60 556e 6974   of :class:`Unit
-0002d9a0: 6020 6f62 6a65 6374 7320 6f72 2075 6e69  ` objects or uni
-0002d9b0: 7420 6e61 6d65 7320 2873 7472 696e 6729  t names (string)
-0002d9c0: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
-0002d9d0: 7374 206f 6620 756e 6974 7320 696e 7369  st of units insi
-0002d9e0: 6465 2077 6869 6368 2077 6520 7761 6e74  de which we want
-0002d9f0: 2074 6f20 6861 7665 2074 6865 2070 6c6f   to have the plo
-0002da00: 742e 2042 7920 6465 6661 756c 7420 616c  t. By default al
-0002da10: 6c0d 0a20 2020 2020 2020 2069 6e73 6964  l..        insid
-0002da20: 655f 6661 6369 6573 3a61 7272 6179 2d6c  e_facies:array-l
-0002da30: 696b 6520 6f66 203a 636c 6173 733a 6046  ike of :class:`F
-0002da40: 6163 6965 7360 206f 626a 6563 7473 206f  acies` objects o
-0002da50: 7220 6661 6369 6573 206e 616d 6573 2028  r facies names (
-0002da60: 7374 7269 6e67 290d 0a20 2020 2020 2020  string)..       
-0002da70: 2020 2020 206c 6973 7420 6f66 2066 6163       list of fac
-0002da80: 6965 7320 696e 7369 6465 2077 6869 6368  ies inside which
-0002da90: 2077 6520 7761 6e74 2074 6f20 6861 7665   we want to have
-0002daa0: 2074 6865 2070 6c6f 742e 2042 7920 6465   the plot. By de
-0002dab0: 6661 756c 7420 616c 6c0d 0a20 2020 2020  fault all..     
-0002dac0: 2020 2070 6c6f 7474 6572 3a70 7976 6973     plotter:pyvis
-0002dad0: 7461 2070 6c6f 7474 6572 2069 6620 7761  ta plotter if wa
-0002dae0: 6e74 6564 0d0a 2020 2020 2020 2020 736c  nted..        sl
-0002daf0: 6963 6578 2c20 736c 6963 6579 2c20 736c  icex, slicey, sl
-0002db00: 6963 657a 3a20 666c 6f61 7420 6f72 2073  icez: float or s
-0002db10: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
-0002db20: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
-0002db30: 7261 6374 696f 6e20 696e 2078 2c20 7920  raction in x, y 
-0002db40: 6f72 207a 2064 6972 6563 7469 6f6e 2077  or z direction w
-0002db50: 6865 7265 2074 6865 2073 6c69 6365 2069  here the slice i
-0002db60: 7320 646f 6e65 0d0a 2020 2020 2020 2020  s done..        
-0002db70: 636d 696e 2c20 636d 6178 3a66 6c6f 6174  cmin, cmax:float
-0002db80: 0d0a 2020 2020 2020 2020 2020 2020 6d69  ..            mi
-0002db90: 6e20 616e 6420 6d61 7820 7661 6c75 6520  n and max value 
-0002dba0: 6f66 2074 6865 2063 6f6c 6f72 6261 720d  of the colorbar.
-0002dbb0: 0a20 2020 2020 2020 2066 696c 7465 7269  .        filteri
-0002dbc0: 6e67 5f69 6e74 6572 7661 6c3a 7475 706c  ng_interval:tupl
-0002dbd0: 6520 6f66 2066 6c6f 6174 0d0a 2020 2020  e of float..    
-0002dbe0: 2020 2020 2020 2020 696e 7465 7276 616c          interval
-0002dbf0: 206f 6620 7661 6c75 6573 2074 6f20 6265   of values to be
-0002dc00: 2070 6c6f 7474 6564 0d0a 2020 2020 2020   plotted..      
-0002dc10: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
-0002dc20: 7267 733a 6469 6374 0d0a 2020 2020 2020  rgs:dict..      
-0002dc30: 2020 2020 2020 6b77 6172 6773 2066 6f72        kwargs for
-0002dc40: 2074 6865 2073 6361 6c61 7220 6261 720d   the scalar bar.
-0002dc50: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-0002dc60: 2020 2020 2020 2020 7072 6f70 3d73 656c          prop=sel
-0002dc70: 662e 6765 7470 726f 7028 7072 6f70 6572  f.getprop(proper
-0002dc80: 7479 2c20 6975 2c20 6966 612c 2069 702c  ty, iu, ifa, ip,
-0002dc90: 2061 6c6c 5f64 6174 613d 4661 6c73 6529   all_data=False)
-0002dca0: 0d0a 2020 2020 2020 2020 6661 6369 6573  ..        facies
-0002dcb0: 3d73 656c 662e 6765 745f 6661 6369 6573  =self.get_facies
-0002dcc0: 2869 752c 2069 6661 2c20 616c 6c5f 6461  (iu, ifa, all_da
-0002dcd0: 7461 3d46 616c 7365 290d 0a0d 0a20 2020  ta=False)....   
-0002dce0: 2020 2020 2023 6b65 6570 2076 616c 7565       #keep value
-0002dcf0: 7320 696e 206f 6e6c 7920 7761 6e74 6564  s in only wanted
-0002dd00: 2075 6e69 7473 0d0a 2020 2020 2020 2020   units..        
-0002dd10: 6966 2069 6e73 6964 655f 756e 6974 7320  if inside_units 
-0002dd20: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0002dd30: 2020 2020 2020 2020 2020 6d61 736b 5f61            mask_a
-0002dd40: 6c6c 3d6e 702e 7a65 726f 7328 5b73 656c  ll=np.zeros([sel
-0002dd50: 662e 6765 745f 6e7a 2829 2c20 7365 6c66  f.get_nz(), self
-0002dd60: 2e67 6574 5f6e 7928 292c 2073 656c 662e  .get_ny(), self.
-0002dd70: 6765 745f 6e78 2829 5d29 0d0a 2020 2020  get_nx()])..    
-0002dd80: 2020 2020 2020 2020 666f 7220 7520 696e          for u in
-0002dd90: 2069 6e73 6964 655f 756e 6974 733a 0d0a   inside_units:..
-0002dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ddb0: 6966 2069 7369 6e73 7461 6e63 6528 752c  if isinstance(u,
-0002ddc0: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
-0002ddd0: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-0002dde0: 3d73 656c 662e 756e 6974 5f6d 6173 6b28  =self.unit_mask(
-0002ddf0: 752c 2069 753d 6975 290d 0a20 2020 2020  u, iu=iu)..     
-0002de00: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0002de10: 6973 696e 7374 616e 6365 2875 2c20 556e  isinstance(u, Un
-0002de20: 6974 2920 616e 6420 7520 696e 2073 656c  it) and u in sel
-0002de30: 662e 6765 745f 616c 6c5f 756e 6974 7328  f.get_all_units(
-0002de40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0002de50: 2020 2020 2020 2020 6d61 736b 3d73 656c          mask=sel
-0002de60: 662e 756e 6974 5f6d 6173 6b28 752e 6e61  f.unit_mask(u.na
-0002de70: 6d65 2c20 6975 3d69 7529 0d0a 2020 2020  me, iu=iu)..    
-0002de80: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002de90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002dea0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002deb0: 7565 4572 726f 7220 2822 556e 6974 2070  ueError ("Unit p
-0002dec0: 6173 7365 6420 696e 2069 6e73 6964 655f  assed in inside_
-0002ded0: 756e 6974 7320 6d75 7374 2062 6520 6120  units must be a 
-0002dee0: 756e 6974 206e 616d 6520 6f72 2061 2075  unit name or a u
-0002def0: 6e69 7420 6f62 6a65 6374 2063 6f6e 7461  nit object conta
-0002df00: 696e 6564 2069 6e20 7468 6520 4172 6368  ined in the Arch
-0002df10: 5461 626c 6522 290d 0a20 2020 2020 2020  Table")..       
-0002df20: 2020 2020 2020 2020 206d 6173 6b5f 616c           mask_al
-0002df30: 6c5b 6d61 736b 203d 3d20 315d 3d31 0d0a  l[mask == 1]=1..
-0002df40: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0002df50: 6f70 5b6d 6173 6b5f 616c 6c20 213d 2031  op[mask_all != 1
-0002df60: 5d3d 6e70 2e6e 616e 0d0a 0d0a 2020 2020  ]=np.nan....    
-0002df70: 2020 2020 236b 6565 7020 7661 6c75 6573      #keep values
-0002df80: 2069 6e20 6f6e 6c79 2077 616e 7465 6420   in only wanted 
-0002df90: 6661 6369 6573 0d0a 2020 2020 2020 2020  facies..        
-0002dfa0: 6966 2069 6e73 6964 655f 6661 6369 6573  if inside_facies
-0002dfb0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-0002dfc0: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-0002dfd0: 616c 6c3d 6e70 2e7a 6572 6f73 285b 7365  all=np.zeros([se
-0002dfe0: 6c66 2e67 6574 5f6e 7a28 292c 2073 656c  lf.get_nz(), sel
-0002dff0: 662e 6765 745f 6e79 2829 2c20 7365 6c66  f.get_ny(), self
-0002e000: 2e67 6574 5f6e 7828 295d 290d 0a20 2020  .get_nx()])..   
-0002e010: 2020 2020 2020 2020 2066 6f72 2066 6120           for fa 
-0002e020: 696e 2069 6e73 6964 655f 6661 6369 6573  in inside_facies
-0002e030: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002e040: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002e050: 2866 612c 2073 7472 293a 0d0a 2020 2020  (fa, str):..    
-0002e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e070: 6d61 736b 3d28 6661 6369 6573 203d 3d20  mask=(facies == 
-0002e080: 7365 6c66 2e67 6574 5f66 6163 6965 735f  self.get_facies_
-0002e090: 6f62 6a28 6661 292e 4944 290d 0a20 2020  obj(fa).ID)..   
-0002e0a0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0002e0b0: 6620 6973 696e 7374 616e 6365 2866 612c  f isinstance(fa,
-0002e0c0: 2046 6163 6965 7329 2061 6e64 2066 6120   Facies) and fa 
-0002e0d0: 696e 2073 656c 662e 6765 745f 616c 6c5f  in self.get_all_
-0002e0e0: 6661 6369 6573 2829 3a0d 0a20 2020 2020  facies():..     
-0002e0f0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002e100: 6173 6b3d 2866 6163 6965 7320 3d3d 2066  ask=(facies == f
-0002e110: 612e 4944 290d 0a20 2020 2020 2020 2020  a.ID)..         
-0002e120: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0002e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e140: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002e150: 6f72 2028 2255 6e69 7420 7061 7373 6564  or ("Unit passed
-0002e160: 2069 6e20 696e 7369 6465 5f75 6e69 7473   in inside_units
-0002e170: 206d 7573 7420 6265 2061 2075 6e69 7420   must be a unit 
-0002e180: 6e61 6d65 206f 7220 6120 756e 6974 206f  name or a unit o
-0002e190: 626a 6563 7420 636f 6e74 6169 6e65 6420  bject contained 
-0002e1a0: 696e 2074 6865 2041 7263 6854 6162 6c65  in the ArchTable
-0002e1b0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-0002e1c0: 2020 2020 6d61 736b 5f61 6c6c 5b6d 6173      mask_all[mas
-0002e1d0: 6b20 3d3d 2031 5d3d 310d 0a0d 0a20 2020  k == 1]=1....   
-0002e1e0: 2020 2020 2020 2020 2070 726f 705b 6d61           prop[ma
-0002e1f0: 736b 5f61 6c6c 2021 3d20 315d 3d6e 702e  sk_all != 1]=np.
-0002e200: 6e61 6e0d 0a0d 0a20 2020 2020 2020 2069  nan....        i
-0002e210: 6620 7e70 726f 702e 616e 7928 293a 0d0a  f ~prop.any():..
-0002e220: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002e230: 6520 5661 6c75 6545 7272 6f72 2028 2245  e ValueError ("E
-0002e240: 7272 6f72 3a20 4e6f 2076 616c 7565 7320  rror: No values 
-0002e250: 666f 756e 6422 290d 0a0d 0a20 2020 2020  found")....     
-0002e260: 2020 206e 783d 7365 6c66 2e67 6574 5f6e     nx=self.get_n
-0002e270: 7828 290d 0a20 2020 2020 2020 206e 793d  x()..        ny=
-0002e280: 7365 6c66 2e67 6574 5f6e 7928 290d 0a20  self.get_ny().. 
-0002e290: 2020 2020 2020 206e 7a3d 7365 6c66 2e67         nz=self.g
-0002e2a0: 6574 5f6e 7a28 290d 0a20 2020 2020 2020  et_nz()..       
-0002e2b0: 2073 783d 7365 6c66 2e67 6574 5f73 7828   sx=self.get_sx(
-0002e2c0: 290d 0a20 2020 2020 2020 2073 793d 7365  )..        sy=se
-0002e2d0: 6c66 2e67 6574 5f73 7928 290d 0a20 2020  lf.get_sy()..   
-0002e2e0: 2020 2020 2073 7a3d 7365 6c66 2e67 6574       sz=self.get
-0002e2f0: 5f73 7a28 290d 0a20 2020 2020 2020 2078  _sz()..        x
-0002e300: 303d 7365 6c66 2e67 6574 5f6f 7828 290d  0=self.get_ox().
-0002e310: 0a20 2020 2020 2020 2079 303d 7365 6c66  .        y0=self
-0002e320: 2e67 6574 5f6f 7928 290d 0a20 2020 2020  .get_oy()..     
-0002e330: 2020 207a 303d 7365 6c66 2e67 6574 5f6f     z0=self.get_o
-0002e340: 7a28 290d 0a0d 0a20 2020 2020 2020 2069  z()....        i
-0002e350: 6620 706c 6f74 7465 7220 6973 204e 6f6e  f plotter is Non
-0002e360: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002e370: 703d 7076 2e50 6c6f 7474 6572 2829 0d0a  p=pv.Plotter()..
-0002e380: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0002e390: 2020 2020 2020 2020 2020 2070 3d70 6c6f             p=plo
-0002e3a0: 7474 6572 0d0a 2020 2020 2020 2020 696d  tter..        im
-0002e3b0: 3d67 656f 6e65 2e69 6d67 2e49 6d67 286e  =geone.img.Img(n
-0002e3c0: 782c 206e 792c 206e 7a2c 2073 782c 2073  x, ny, nz, sx, s
-0002e3d0: 792c 2073 7a2a 765f 6578 2c20 7830 2c20  y, sz*v_ex, x0, 
-0002e3e0: 7930 2c20 7a30 2c20 6e76 3d31 2c20 7661  y0, z0, nv=1, va
-0002e3f0: 6c3d 7072 6f70 2c20 7661 726e 616d 653d  l=prop, varname=
-0002e400: 7072 6f70 6572 7479 290d 0a0d 0a20 2020  property)....   
-0002e410: 2020 2020 2069 6620 736c 6963 6578 2069       if slicex i
-0002e420: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0002e430: 2020 2020 2020 2020 2073 6c69 6365 783d           slicex=
-0002e440: 6e70 2e61 7272 6179 2873 6c69 6365 7829  np.array(slicex)
-0002e450: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-0002e460: 6963 6578 5b73 6c69 6365 783c 305d 3d30  icex[slicex<0]=0
-0002e470: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-0002e480: 6963 6578 5b73 6c69 6365 783e 315d 3d31  icex[slicex>1]=1
-0002e490: 0d0a 2020 2020 2020 2020 2020 2020 6378  ..            cx
-0002e4a0: 3d69 6d2e 6f78 202b 2073 6c69 6365 7820  =im.ox + slicex 
-0002e4b0: 2a20 696d 2e6e 7820 2a20 696d 2e73 7820  * im.nx * im.sx 
-0002e4c0: 2023 2063 656e 7465 7220 616c 6f6e 6720   # center along 
-0002e4d0: 780d 0a20 2020 2020 2020 2065 6c73 653a  x..        else:
-0002e4e0: 0d0a 2020 2020 2020 2020 2020 2020 6378  ..            cx
-0002e4f0: 3d4e 6f6e 650d 0a20 2020 2020 2020 2069  =None..        i
-0002e500: 6620 736c 6963 6579 2069 7320 6e6f 7420  f slicey is not 
-0002e510: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0002e520: 2020 2073 6c69 6365 793d 6e70 2e61 7272     slicey=np.arr
-0002e530: 6179 2873 6c69 6365 7929 0d0a 2020 2020  ay(slicey)..    
-0002e540: 2020 2020 2020 2020 736c 6963 6579 5b73          slicey[s
-0002e550: 6c69 6365 793c 305d 3d30 0d0a 2020 2020  licey<0]=0..    
-0002e560: 2020 2020 2020 2020 736c 6963 6579 5b73          slicey[s
-0002e570: 6c69 6365 793e 315d 3d31 0d0a 2020 2020  licey>1]=1..    
-0002e580: 2020 2020 2020 2020 6379 3d69 6d2e 6f79          cy=im.oy
-0002e590: 202b 2073 6c69 6365 7920 2a20 696d 2e6e   + slicey * im.n
-0002e5a0: 7920 2a20 696d 2e73 7920 2023 2063 656e  y * im.sy  # cen
-0002e5b0: 7465 7220 616c 6f6e 6720 790d 0a20 2020  ter along y..   
-0002e5c0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0002e5d0: 2020 2020 2020 2020 6379 3d4e 6f6e 650d          cy=None.
-0002e5e0: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
-0002e5f0: 657a 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ez is not None:.
-0002e600: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
-0002e610: 6365 7a3d 6e70 2e61 7272 6179 2873 6c69  cez=np.array(sli
-0002e620: 6365 7a29 0d0a 2020 2020 2020 2020 2020  cez)..          
-0002e630: 2020 736c 6963 657a 5b73 6c69 6365 7a3c    slicez[slicez<
-0002e640: 305d 3d30 0d0a 2020 2020 2020 2020 2020  0]=0..          
-0002e650: 2020 736c 6963 657a 5b73 6c69 6365 7a3e    slicez[slicez>
-0002e660: 315d 3d31 0d0a 2020 2020 2020 2020 2020  1]=1..          
-0002e670: 2020 637a 3d69 6d2e 6f7a 202b 2073 6c69    cz=im.oz + sli
-0002e680: 6365 7a20 2a20 696d 2e6e 7a20 2a20 696d  cez * im.nz * im
-0002e690: 2e73 7a20 2023 2063 656e 7465 7220 616c  .sz  # center al
-0002e6a0: 6f6e 6720 7a0d 0a20 2020 2020 2020 2065  ong z..        e
-0002e6b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0002e6c0: 2020 637a 3d4e 6f6e 650d 0a0d 0a0d 0a20    cz=None...... 
-0002e6d0: 2020 2020 2020 2069 6620 736c 6963 6578         if slicex
-0002e6e0: 2069 7320 6e6f 7420 4e6f 6e65 206f 7220   is not None or 
-0002e6f0: 736c 6963 6579 2069 7320 6e6f 7420 4e6f  slicey is not No
-0002e700: 6e65 206f 7220 736c 6963 657a 2069 7320  ne or slicez is 
-0002e710: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-0002e720: 2020 2020 2020 2069 6d67 706c 7433 2e64         imgplt3.d
-0002e730: 7261 7749 6d61 6765 3344 5f73 6c69 6365  rawImage3D_slice
-0002e740: 2869 6d2c 2070 6c6f 7474 6572 3d70 2c20  (im, plotter=p, 
-0002e750: 736c 6963 655f 6e6f 726d 616c 5f78 3d63  slice_normal_x=c
-0002e760: 782c 2073 6c69 6365 5f6e 6f72 6d61 6c5f  x, slice_normal_
-0002e770: 793d 6379 2c20 736c 6963 655f 6e6f 726d  y=cy, slice_norm
-0002e780: 616c 5f7a 3d63 7a2c 2063 6d69 6e3d 636d  al_z=cz, cmin=cm
-0002e790: 696e 2c20 636d 6178 3d63 6d61 782c 0d0a  in, cmax=cmax,..
-0002e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e7c0: 2020 2020 6669 6c74 6572 696e 675f 696e      filtering_in
-0002e7d0: 7465 7276 616c 3d66 696c 7465 7269 6e67  terval=filtering
-0002e7e0: 5f69 6e74 6572 7661 6c2c 2073 6361 6c61  _interval, scala
-0002e7f0: 725f 6261 725f 6b77 6172 6773 3d73 6361  r_bar_kwargs=sca
-0002e800: 6c61 725f 6261 725f 6b77 6172 6773 290d  lar_bar_kwargs).
-0002e810: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0002e820: 2020 2020 2020 2020 2020 2020 696d 6770              imgp
-0002e830: 6c74 332e 6472 6177 496d 6167 6533 445f  lt3.drawImage3D_
-0002e840: 7375 7266 6163 6528 696d 2c20 706c 6f74  surface(im, plot
-0002e850: 7465 723d 702c 2063 6d69 6e3d 636d 696e  ter=p, cmin=cmin
-0002e860: 2c20 636d 6178 3d63 6d61 782c 0d0a 2020  , cmax=cmax,..  
-0002e870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e890: 2020 6669 6c74 6572 696e 675f 696e 7465    filtering_inte
-0002e8a0: 7276 616c 3d66 696c 7465 7269 6e67 5f69  rval=filtering_i
-0002e8b0: 6e74 6572 7661 6c2c 2073 6361 6c61 725f  nterval, scalar_
-0002e8c0: 6261 725f 6b77 6172 6773 3d73 6361 6c61  bar_kwargs=scala
-0002e8d0: 725f 6261 725f 6b77 6172 6773 290d 0a0d  r_bar_kwargs)...
-0002e8e0: 0a20 2020 2020 2020 2069 6620 706c 6f74  .        if plot
-0002e8f0: 7465 7220 6973 204e 6f6e 653a 0d0a 2020  ter is None:..  
-0002e900: 2020 2020 2020 2020 2020 702e 6164 645f            p.add_
-0002e910: 626f 756e 6469 6e67 5f62 6f78 2829 0d0a  bounding_box()..
-0002e920: 2020 2020 2020 2020 2020 2020 702e 7368              p.sh
-0002e930: 6f77 5f61 7865 7328 290d 0a20 2020 2020  ow_axes()..     
-0002e940: 2020 2020 2020 2070 2e73 686f 7728 290d         p.show().
-0002e950: 0a0d 0a0d 0a20 2020 2064 6566 2070 6c6f  .....    def plo
-0002e960: 745f 6d65 616e 5f70 726f 7028 7365 6c66  t_mean_prop(self
-0002e970: 2c20 7072 6f70 6572 7479 2c20 7479 7065  , property, type
-0002e980: 3d22 6172 6974 686d 6574 6963 222c 2076  ="arithmetic", v
-0002e990: 5f65 783d 312c 2069 6e73 6964 655f 756e  _ex=1, inside_un
-0002e9a0: 6974 733d 4e6f 6e65 2c20 696e 7369 6465  its=None, inside
-0002e9b0: 5f66 6163 6965 733d 4e6f 6e65 2c0d 0a20  _facies=None,.. 
-0002e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9d0: 2020 2070 6c6f 7474 6572 3d4e 6f6e 652c     plotter=None,
-0002e9e0: 2073 6c69 6365 783d 4e6f 6e65 2c20 736c   slicex=None, sl
-0002e9f0: 6963 6579 3d4e 6f6e 652c 2073 6c69 6365  icey=None, slice
-0002ea00: 7a3d 4e6f 6e65 2c20 636d 696e 3d4e 6f6e  z=None, cmin=Non
-0002ea10: 652c 2063 6d61 783d 4e6f 6e65 2c20 6669  e, cmax=None, fi
-0002ea20: 6c74 6572 696e 675f 696e 7465 7276 616c  ltering_interval
-0002ea30: 3d4e 6f6e 652c 2073 6361 6c61 725f 6261  =None, scalar_ba
-0002ea40: 725f 6b77 6172 6773 3d4e 6f6e 6529 3a0d  r_kwargs=None):.
-0002ea50: 0a0d 0a20 2020 2020 2020 2023 544f 2044  ...        #TO D
-0002ea60: 4f20 2d2d 3e20 746f 206f 7074 696d 697a  O --> to optimiz
-0002ea70: 650d 0a20 2020 2020 2020 2022 2222 0d0a  e..        """..
-0002ea80: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-0002ea90: 2074 6861 7420 706c 6f74 7320 7468 6520   that plots the 
-0002eaa0: 6172 6974 686d 6574 6963 206d 6561 6e20  arithmetic mean 
-0002eab0: 6f66 2061 2070 726f 7065 7274 7920 6174  of a property at
-0002eac0: 2065 7665 7279 2063 656c 6c73 0d0a 2020   every cells..  
-0002ead0: 2020 2020 2020 6f66 2074 6865 2073 696d        of the sim
-0002eae0: 756c 6174 696f 6e20 646f 6d61 696e 2067  ulation domain g
-0002eaf0: 6976 656e 2061 6c6c 2074 6865 2070 726f  iven all the pro
-0002eb00: 7065 7274 7920 7369 6d75 6c61 7469 6f6e  perty simulation
-0002eb10: 730d 0a0d 0a20 2020 2020 2020 2050 6172  s....        Par
-0002eb20: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0002eb30: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0002eb40: 2020 2020 2070 726f 7065 7274 793a 2073       property: s
-0002eb50: 7472 696e 670d 0a20 2020 2020 2020 2020  tring..         
-0002eb60: 2020 206e 616d 6520 6f66 2074 6865 2070     name of the p
-0002eb70: 726f 7065 7274 7920 746f 2070 6c6f 740d  roperty to plot.
-0002eb80: 0a20 2020 2020 2020 2074 7970 653a 2073  .        type: s
-0002eb90: 7472 696e 670d 0a20 2020 2020 2020 2020  tring..         
-0002eba0: 2020 2074 7970 6520 6f66 206d 6561 6e20     type of mean 
-0002ebb0: 746f 2070 6c6f 743a 0d0a 2020 2020 2020  to plot:..      
-0002ebc0: 2020 2020 2020 2d20 2261 7269 7468 6d65        - "arithme
-0002ebd0: 7469 6322 2066 6f72 2061 7269 7468 6d65  tic" for arithme
-0002ebe0: 7469 6320 6d65 616e 0d0a 2020 2020 2020  tic mean..      
-0002ebf0: 2020 2020 2020 2d20 2273 7464 2220 666f        - "std" fo
-0002ec00: 7220 7374 616e 6461 7264 2064 6576 6961  r standard devia
-0002ec10: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
-0002ec20: 2020 2d20 226d 6564 6961 6e22 2066 6f72    - "median" for
-0002ec30: 206d 6564 6961 6e20 7661 6c75 650d 0a20   median value.. 
-0002ec40: 2020 2020 2020 2076 5f65 783a 2066 6c6f         v_ex: flo
-0002ec50: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
-0002ec60: 7665 7274 6963 616c 2065 7861 6767 6572  vertical exagger
-0002ec70: 6174 696f 6e0d 0a20 2020 2020 2020 2069  ation..        i
-0002ec80: 6e73 6964 655f 756e 6974 733a 206c 6973  nside_units: lis
-0002ec90: 7420 6f66 2073 7472 696e 6720 6f72 203a  t of string or :
-0002eca0: 636c 6173 733a 6055 6e69 7460 206f 626a  class:`Unit` obj
-0002ecb0: 6563 7473 0d0a 2020 2020 2020 2020 2020  ects..          
-0002ecc0: 2020 6c69 7374 206f 6620 756e 6974 7320    list of units 
-0002ecd0: 746f 2063 6f6e 7369 6465 7220 666f 7220  to consider for 
-0002ece0: 7468 6520 6d65 616e 0d0a 2020 2020 2020  the mean..      
-0002ecf0: 2020 2020 2020 2273 7464 2220 666f 7220        "std" for 
-0002ed00: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
-0002ed10: 6f6e 2c20 226d 6564 6961 6e22 2066 6f72  on, "median" for
-0002ed20: 206d 6564 6961 6e20 7661 6c75 650d 0a20   median value.. 
-0002ed30: 2020 2020 2020 2069 6e73 6964 655f 6661         inside_fa
-0002ed40: 6369 6573 3a20 6c69 7374 206f 6620 7374  cies: list of st
-0002ed50: 7269 6e67 206f 7220 3a63 6c61 7373 3a60  ring or :class:`
-0002ed60: 4661 6369 6573 6020 6f62 6a65 6374 730d  Facies` objects.
-0002ed70: 0a20 2020 2020 2020 2020 2020 206c 6973  .            lis
-0002ed80: 7420 6f66 2066 6163 6965 7320 746f 2063  t of facies to c
-0002ed90: 6f6e 7369 6465 7220 666f 7220 7468 6520  onsider for the 
-0002eda0: 6d65 616e 0d0a 2020 2020 2020 2020 706c  mean..        pl
-0002edb0: 6f74 7465 723a 2070 7976 6973 7461 2e50  otter: pyvista.P
-0002edc0: 6c6f 7474 6572 0d0a 2020 2020 2020 2020  lotter..        
-0002edd0: 2020 2020 7079 7669 7374 6120 706c 6f74      pyvista plot
-0002ede0: 7465 7220 746f 2070 6c6f 7420 6f6e 0d0a  ter to plot on..
-0002edf0: 2020 2020 2020 2020 736c 6963 6578 3a20          slicex: 
-0002ee00: 666c 6f61 7420 6f72 2073 6571 7565 6e63  float or sequenc
-0002ee10: 6520 6f66 2066 6c6f 6174 730d 0a20 2020  e of floats..   
-0002ee20: 2020 2020 2020 2020 2066 7261 6374 696f           fractio
-0002ee30: 6e20 6f66 2074 6865 2078 2061 7869 7320  n of the x axis 
-0002ee40: 746f 2070 6c6f 740d 0a20 2020 2020 2020  to plot..       
-0002ee50: 2073 6c69 6365 793a 2066 6c6f 6174 206f   slicey: float o
-0002ee60: 7220 7365 7175 656e 6365 206f 6620 666c  r sequence of fl
-0002ee70: 6f61 7473 0d0a 2020 2020 2020 2020 2020  oats..          
-0002ee80: 2020 6672 6163 7469 6f6e 206f 6620 7468    fraction of th
-0002ee90: 6520 7920 6178 6973 2074 6f20 706c 6f74  e y axis to plot
-0002eea0: 0d0a 2020 2020 2020 2020 736c 6963 657a  ..        slicez
-0002eeb0: 3a20 666c 6f61 7420 6f72 2073 6571 7565  : float or seque
-0002eec0: 6e63 6520 6f66 2066 6c6f 6174 730d 0a20  nce of floats.. 
-0002eed0: 2020 2020 2020 2020 2020 2066 7261 6374             fract
-0002eee0: 696f 6e20 6f66 2074 6865 207a 2061 7869  ion of the z axi
-0002eef0: 7320 746f 2070 6c6f 740d 0a20 2020 2020  s to plot..     
-0002ef00: 2020 2063 6d69 6e3a 2066 6c6f 6174 0d0a     cmin: float..
-0002ef10: 2020 2020 2020 2020 2020 2020 6d69 6e69              mini
-0002ef20: 6d75 6d20 7661 6c75 6520 666f 7220 7468  mum value for th
-0002ef30: 6520 636f 6c6f 7262 6172 0d0a 2020 2020  e colorbar..    
-0002ef40: 2020 2020 636d 6178 3a20 666c 6f61 740d      cmax: float.
-0002ef50: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
-0002ef60: 696d 756d 2076 616c 7565 2066 6f72 2074  imum value for t
-0002ef70: 6865 2063 6f6c 6f72 6261 720d 0a20 2020  he colorbar..   
-0002ef80: 2020 2020 2066 696c 7465 7269 6e67 5f69       filtering_i
-0002ef90: 6e74 6572 7661 6c3a 2066 6c6f 6174 0d0a  nterval: float..
-0002efa0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-0002efb0: 7276 616c 2074 6f20 6669 6c74 6572 2074  rval to filter t
-0002efc0: 6865 2064 6174 610d 0a20 2020 2020 2020  he data..       
-0002efd0: 2073 6361 6c61 725f 6261 725f 6b77 6172   scalar_bar_kwar
-0002efe0: 6773 3a20 6469 6374 0d0a 2020 2020 2020  gs: dict..      
-0002eff0: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-0002f000: 206f 6620 6172 6775 6d65 6e74 7320 746f   of arguments to
-0002f010: 2070 6173 7320 746f 2074 6865 2070 7976   pass to the pyv
-0002f020: 6973 7461 2073 6361 6c61 7220 6261 720d  ista scalar bar.
-0002f030: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-0002f040: 0d0a 2020 2020 2020 2020 236c 6f61 6420  ..        #load 
-0002f050: 7072 6f70 6572 7479 2061 7272 6179 2061  property array a
-0002f060: 6e64 2066 6163 6965 7320 6172 7261 790d  nd facies array.
-0002f070: 0a20 2020 2020 2020 2070 726f 703d 7365  .        prop=se
-0002f080: 6c66 2e67 6574 7072 6f70 2870 726f 7065  lf.getprop(prope
-0002f090: 7274 7929 2020 2320 746f 206d 6f64 6966  rty)  # to modif
-0002f0a0: 790d 0a20 2020 2020 2020 2070 726f 705f  y..        prop_
-0002f0b0: 7368 6170 653d 7072 6f70 2e73 6861 7065  shape=prop.shape
-0002f0c0: 0d0a 2020 2020 2020 2020 6661 6369 6573  ..        facies
-0002f0d0: 3d73 656c 662e 6765 745f 6661 6369 6573  =self.get_facies
-0002f0e0: 2829 0d0a 2020 2020 2020 2020 6661 6369  ()..        faci
-0002f0f0: 6573 5f73 6861 7065 3d66 6163 6965 732e  es_shape=facies.
-0002f100: 7368 6170 650d 0a0d 0a20 2020 2020 2020  shape....       
-0002f110: 2023 6b65 6570 2076 616c 7565 7320 696e   #keep values in
-0002f120: 206f 6e6c 7920 7761 6e74 6564 2075 6e69   only wanted uni
-0002f130: 7473 0d0a 2020 2020 2020 2020 6966 2069  ts..        if i
-0002f140: 6e73 6964 655f 756e 6974 7320 6973 206e  nside_units is n
-0002f150: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-0002f160: 2020 2020 2020 6e72 6561 6c5f 756e 6974        nreal_unit
-0002f170: 733d 7365 6c66 2e6e 7265 616c 5f75 6e69  s=self.nreal_uni
-0002f180: 7473 2020 2320 6e75 6d62 6572 206f 6620  ts  # number of 
-0002f190: 756e 6974 7320 7265 616c 0d0a 2020 2020  units real..    
-0002f1a0: 2020 2020 2020 2020 6d61 736b 5f61 6c6c          mask_all
-0002f1b0: 3d6e 702e 7a65 726f 7328 7072 6f70 5f73  =np.zeros(prop_s
-0002f1c0: 6861 7065 290d 0a20 2020 2020 2020 2020  hape)..         
-0002f1d0: 2020 2066 6f72 2069 7520 696e 2072 616e     for iu in ran
-0002f1e0: 6765 286e 7265 616c 5f75 6e69 7473 293a  ge(nreal_units):
-0002f1f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f200: 2020 666f 7220 7520 696e 2069 6e73 6964    for u in insid
-0002f210: 655f 756e 6974 733a 0d0a 2020 2020 2020  e_units:..      
-0002f220: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002f230: 2069 7369 6e73 7461 6e63 6528 752c 2073   isinstance(u, s
-0002f240: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
-0002f250: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-0002f260: 736b 3d73 656c 662e 756e 6974 5f6d 6173  sk=self.unit_mas
-0002f270: 6b28 752c 2069 753d 6975 290d 0a20 2020  k(u, iu=iu)..   
-0002f280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f290: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-0002f2a0: 2875 2c20 556e 6974 2920 616e 6420 7520  (u, Unit) and u 
-0002f2b0: 696e 2073 656c 662e 6765 745f 616c 6c5f  in self.get_all_
-0002f2c0: 756e 6974 7328 293a 0d0a 2020 2020 2020  units():..      
-0002f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f2e0: 2020 6d61 736b 3d73 656c 662e 756e 6974    mask=self.unit
-0002f2f0: 5f6d 6173 6b28 752e 6e61 6d65 2c20 6975  _mask(u.name, iu
-0002f300: 3d69 7529 0d0a 2020 2020 2020 2020 2020  =iu)..          
-0002f310: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0002f320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f330: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0002f340: 616c 7565 4572 726f 7220 2822 556e 6974  alueError ("Unit
-0002f350: 2070 6173 7365 6420 696e 2069 6e73 6964   passed in insid
-0002f360: 655f 756e 6974 7320 6d75 7374 2062 6520  e_units must be 
-0002f370: 6120 756e 6974 206e 616d 6520 6f72 2061  a unit name or a
-0002f380: 2075 6e69 7420 6f62 6a65 6374 2063 6f6e   unit object con
-0002f390: 7461 696e 6564 2069 6e20 7468 6520 4172  tained in the Ar
-0002f3a0: 6368 5461 626c 6522 290d 0a20 2020 2020  chTable")..     
-0002f3b0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002f3c0: 6173 6b5f 616c 6c5b 6975 2c3a 2c3a 2c6d  ask_all[iu,:,:,m
-0002f3d0: 6173 6b20 3d3d 2031 5d3d 310d 0a0d 0a20  ask == 1]=1.... 
-0002f3e0: 2020 2020 2020 2020 2020 2070 726f 705b             prop[
-0002f3f0: 6d61 736b 5f61 6c6c 2021 3d20 315d 3d6e  mask_all != 1]=n
-0002f400: 702e 6e61 6e0d 0a0d 0a20 2020 2020 2020  p.nan....       
-0002f410: 2023 6b65 6570 2076 616c 7565 7320 696e   #keep values in
-0002f420: 206f 6e6c 7920 7761 6e74 6564 2066 6163   only wanted fac
-0002f430: 6965 730d 0a20 2020 2020 2020 2069 6620  ies..        if 
-0002f440: 696e 7369 6465 5f66 6163 6965 7320 6973  inside_facies is
-0002f450: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0002f460: 2020 2020 2020 2020 6d61 736b 5f61 6c6c          mask_all
-0002f470: 3d6e 702e 7a65 726f 7328 7072 6f70 5f73  =np.zeros(prop_s
-0002f480: 6861 7065 290d 0a20 2020 2020 2020 2020  hape)..         
-0002f490: 2020 2066 6f72 2069 7520 696e 2072 616e     for iu in ran
-0002f4a0: 6765 286e 7265 616c 5f75 6e69 7473 293a  ge(nreal_units):
-0002f4b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f4c0: 2020 666f 7220 6966 6120 696e 2072 616e    for ifa in ran
-0002f4d0: 6765 2873 656c 662e 6e72 6561 6c5f 6661  ge(self.nreal_fa
-0002f4e0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0002f4f0: 2020 2020 2020 2020 666f 7220 6661 2069          for fa i
-0002f500: 6e20 696e 7369 6465 5f66 6163 6965 733a  n inside_facies:
-0002f510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f520: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0002f530: 6e73 7461 6e63 6528 6661 2c20 7374 7229  nstance(fa, str)
-0002f540: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002f550: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002f560: 6173 6b3d 2866 6163 6965 735b 6975 2c69  ask=(facies[iu,i
-0002f570: 6661 5d20 3d3d 2073 656c 662e 6765 745f  fa] == self.get_
-0002f580: 6661 6369 6573 5f6f 626a 2866 6129 2e49  facies_obj(fa).I
-0002f590: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
-0002f5a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0002f5b0: 2069 7369 6e73 7461 6e63 6528 6661 2c20   isinstance(fa, 
-0002f5c0: 4661 6369 6573 2920 616e 6420 6661 2069  Facies) and fa i
-0002f5d0: 6e20 7365 6c66 2e67 6574 5f61 6c6c 5f66  n self.get_all_f
-0002f5e0: 6163 6965 7328 293a 0d0a 2020 2020 2020  acies():..      
-0002f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f600: 2020 2020 2020 6d61 736b 3d28 6661 6369        mask=(faci
-0002f610: 6573 5b69 752c 6966 615d 203d 3d20 6661  es[iu,ifa] == fa
-0002f620: 2e49 4429 0d0a 2020 2020 2020 2020 2020  .ID)..          
-0002f630: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0002f640: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0002f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f660: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002f670: 7220 2822 556e 6974 2070 6173 7365 6420  r ("Unit passed 
-0002f680: 696e 2069 6e73 6964 655f 756e 6974 7320  in inside_units 
-0002f690: 6d75 7374 2062 6520 6120 756e 6974 206e  must be a unit n
-0002f6a0: 616d 6520 6f72 2061 2075 6e69 7420 6f62  ame or a unit ob
-0002f6b0: 6a65 6374 2063 6f6e 7461 696e 6564 2069  ject contained i
-0002f6c0: 6e20 7468 6520 4172 6368 5461 626c 6522  n the ArchTable"
-0002f6d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002f6e0: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-0002f6f0: 616c 6c5b 6975 2c69 6661 2c3a 2c6d 6173  all[iu,ifa,:,mas
-0002f700: 6b20 3d3d 2031 5d3d 310d 0a0d 0a20 2020  k == 1]=1....   
-0002f710: 2020 2020 2020 2020 2070 726f 705b 6d61           prop[ma
-0002f720: 736b 5f61 6c6c 2021 3d20 315d 3d6e 702e  sk_all != 1]=np.
-0002f730: 6e61 6e0d 0a0d 0a20 2020 2020 2020 2069  nan....        i
-0002f740: 6620 7e70 726f 702e 616e 7928 293a 0d0a  f ~prop.any():..
-0002f750: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002f760: 6520 5661 6c75 6545 7272 6f72 2028 2245  e ValueError ("E
-0002f770: 7272 6f72 3a20 4e6f 2076 616c 7565 7320  rror: No values 
-0002f780: 666f 756e 6422 290d 0a0d 0a20 2020 2020  found")....     
-0002f790: 2020 2069 6620 7479 7065 203d 3d20 2261     if type == "a
-0002f7a0: 7269 7468 6d65 7469 6322 3a0d 0a20 2020  rithmetic":..   
-0002f7b0: 2020 2020 2020 2020 2061 7272 3d6e 702e           arr=np.
-0002f7c0: 6e61 6e6d 6561 6e28 7072 6f70 2e72 6573  nanmean(prop.res
-0002f7d0: 6861 7065 282d 312c 7365 6c66 2e67 6574  hape(-1,self.get
-0002f7e0: 5f6e 7a28 292c 7365 6c66 2e67 6574 5f6e  _nz(),self.get_n
-0002f7f0: 7928 292c 7365 6c66 2e67 6574 5f6e 7828  y(),self.get_nx(
-0002f800: 2929 2c61 7869 733d 3029 0d0a 0d0a 2020  )),axis=0)....  
-0002f810: 2020 2020 2020 656c 6966 2074 7970 6520        elif type 
-0002f820: 3d3d 2022 7374 6422 3a0d 0a20 2020 2020  == "std":..     
-0002f830: 2020 2020 2020 2061 7272 3d6e 702e 6e61         arr=np.na
-0002f840: 6e73 7464 2870 726f 702e 7265 7368 6170  nstd(prop.reshap
-0002f850: 6528 2d31 2c73 656c 662e 6765 745f 6e7a  e(-1,self.get_nz
-0002f860: 2829 2c73 656c 662e 6765 745f 6e79 2829  (),self.get_ny()
-0002f870: 2c73 656c 662e 6765 745f 6e78 2829 292c  ,self.get_nx()),
-0002f880: 6178 6973 3d30 290d 0a0d 0a20 2020 2020  axis=0)....     
-0002f890: 2020 2065 6c69 6620 7479 7065 203d 3d20     elif type == 
-0002f8a0: 226d 6564 6961 6e22 3a0d 0a20 2020 2020  "median":..     
-0002f8b0: 2020 2020 2020 2061 7272 3d6e 702e 6e61         arr=np.na
-0002f8c0: 6e6d 6564 6961 6e28 7072 6f70 2e72 6573  nmedian(prop.res
-0002f8d0: 6861 7065 282d 312c 7365 6c66 2e67 6574  hape(-1,self.get
-0002f8e0: 5f6e 7a28 292c 7365 6c66 2e67 6574 5f6e  _nz(),self.get_n
-0002f8f0: 7928 292c 7365 6c66 2e67 6574 5f6e 7828  y(),self.get_nx(
-0002f900: 2929 2c61 7869 733d 3029 0d0a 0d0a 2020  )),axis=0)....  
-0002f910: 2020 2020 2020 7365 6c66 2e70 6c6f 745f        self.plot_
-0002f920: 6172 7228 6172 722c 7072 6f70 6572 7479  arr(arr,property
-0002f930: 2c76 5f65 783d 765f 6578 2c20 706c 6f74  ,v_ex=v_ex, plot
-0002f940: 7465 723d 706c 6f74 7465 722c 2073 6c69  ter=plotter, sli
-0002f950: 6365 783d 736c 6963 6578 2c20 736c 6963  cex=slicex, slic
-0002f960: 6579 3d73 6c69 6365 792c 2073 6c69 6365  ey=slicey, slice
-0002f970: 7a3d 736c 6963 657a 2c0d 0a20 2020 2020  z=slicez,..     
+0002c490: 2020 2070 7269 6e74 2822 6669 6c74 6572     print("filter
+0002c4a0: 696e 675f 696e 7465 7276 616c 206d 7573  ing_interval mus
+0002c4b0: 7420 6265 2061 206c 6973 7420 6f66 2074  t be a list of t
+0002c4c0: 776f 2076 616c 7565 7322 290d 0a20 2020  wo values")..   
+0002c4d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0002c4e0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002c4f0: 2020 2020 2020 2020 7072 696e 7428 2266          print("f
+0002c500: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
+0002c510: 6c20 6d75 7374 2062 6520 6120 6c69 7374  l must be a list
+0002c520: 206f 6620 7477 6f20 7661 6c75 6573 2229   of two values")
+0002c530: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0002c540: 6966 2070 6c6f 7474 6572 2069 7320 4e6f  if plotter is No
+0002c550: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002c560: 2020 2020 2070 3d70 762e 506c 6f74 7465       p=pv.Plotte
+0002c570: 7228 290d 0a20 2020 2020 2020 2020 2020  r()..           
+0002c580: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0002c590: 2020 2020 2020 2020 703d 706c 6f74 7465          p=plotte
+0002c5a0: 720d 0a0d 0a20 2020 2020 2020 2020 2020  r....           
+0002c5b0: 2069 6620 736c 6963 6578 2069 7320 6e6f   if slicex is no
+0002c5c0: 7420 4e6f 6e65 206f 7220 736c 6963 6579  t None or slicey
+0002c5d0: 2069 7320 6e6f 7420 4e6f 6e65 206f 7220   is not None or 
+0002c5e0: 736c 6963 657a 2069 7320 6e6f 7420 4e6f  slicez is not No
+0002c5f0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002c600: 2020 2020 2069 6d67 706c 7433 2e64 7261       imgplt3.dra
+0002c610: 7749 6d61 6765 3344 5f73 6c69 6365 2869  wImage3D_slice(i
+0002c620: 6d2c 2070 6c6f 7474 6572 3d70 2c20 736c  m, plotter=p, sl
+0002c630: 6963 655f 6e6f 726d 616c 5f78 3d63 782c  ice_normal_x=cx,
+0002c640: 2073 6c69 6365 5f6e 6f72 6d61 6c5f 793d   slice_normal_y=
+0002c650: 6379 2c20 736c 6963 655f 6e6f 726d 616c  cy, slice_normal
+0002c660: 5f7a 3d63 7a2c 2073 6361 6c61 725f 6261  _z=cz, scalar_ba
+0002c670: 725f 6b77 6172 6773 3d73 6361 6c61 725f  r_kwargs=scalar_
+0002c680: 6261 725f 6b77 6172 6773 2c20 6578 636c  bar_kwargs, excl
+0002c690: 7564 6564 5661 6c3d 6578 636c 7564 6564  udedVal=excluded
+0002c6a0: 5661 6c2c 202a 2a6b 7761 7267 7329 0d0a  Val, **kwargs)..
+0002c6b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0002c6c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002c6d0: 2020 2069 6d67 706c 7433 2e64 7261 7749     imgplt3.drawI
+0002c6e0: 6d61 6765 3344 5f73 7572 6661 6365 2869  mage3D_surface(i
+0002c6f0: 6d2c 2070 6c6f 7474 6572 3d70 2c20 7363  m, plotter=p, sc
+0002c700: 616c 6172 5f62 6172 5f6b 7761 7267 733d  alar_bar_kwargs=
+0002c710: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
+0002c720: 732c 2065 7863 6c75 6465 6456 616c 3d65  s, excludedVal=e
+0002c730: 7863 6c75 6465 6456 616c 2c20 202a 2a6b  xcludedVal,  **k
+0002c740: 7761 7267 7329 0d0a 0d0a 2020 2020 2020  wargs)....      
+0002c750: 2020 2020 2020 6966 2070 6c6f 7474 6572        if plotter
+0002c760: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+0002c770: 2020 2020 2020 2020 2020 2070 2e61 6464             p.add
+0002c780: 5f62 6f75 6e64 696e 675f 626f 7828 290d  _bounding_box().
+0002c790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c7a0: 2070 2e73 686f 775f 6178 6573 2829 0d0a   p.show_axes()..
+0002c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7c0: 702e 7368 6f77 2829 0d0a 0d0a 2020 2020  p.show()....    
+0002c7d0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0002c7e0: 2020 2020 2020 2070 7269 6e74 2822 4e6f         print("No
+0002c7f0: 2076 616c 7565 7320 666f 756e 6420 666f   values found fo
+0002c800: 7220 7468 6973 2075 6e69 7422 290d 0a0d  r this unit")...
+0002c810: 0a0d 0a20 2020 2064 6566 2070 6c6f 745f  ...    def plot_
+0002c820: 6661 6369 6573 2873 656c 662c 2069 753d  facies(self, iu=
+0002c830: 302c 2069 6661 3d30 2c20 765f 6578 3d31  0, ifa=0, v_ex=1
+0002c840: 2c20 696e 7369 6465 5f75 6e69 7473 3d4e  , inside_units=N
+0002c850: 6f6e 652c 2065 7863 6c75 6465 6456 616c  one, excludedVal
+0002c860: 3d4e 6f6e 652c 0d0a 2020 2020 2020 2020  =None,..        
+0002c870: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
+0002c880: 7465 723d 4e6f 6e65 2c20 736c 6963 6578  ter=None, slicex
+0002c890: 3d4e 6f6e 652c 2073 6c69 6365 793d 4e6f  =None, slicey=No
+0002c8a0: 6e65 2c20 736c 6963 657a 3d4e 6f6e 652c  ne, slicez=None,
+0002c8b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002c8c0: 2020 2020 2020 7363 616c 6172 5f62 6172        scalar_bar
+0002c8d0: 5f6b 7761 7267 733d 4e6f 6e65 2c20 7368  _kwargs=None, sh
+0002c8e0: 6f77 5f73 6361 6c61 725f 6261 723d 5472  ow_scalar_bar=Tr
+0002c8f0: 7565 2c20 2a2a 6b77 6172 6773 293a 0d0a  ue, **kwargs):..
+0002c900: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0002c910: 2020 2020 2020 2050 6c6f 7420 7468 6520         Plot the 
+0002c920: 6661 6369 6573 2072 6561 6c69 7a61 7469  facies realizati
+0002c930: 6f6e 7320 6f76 6572 2074 6865 2064 6f6d  ons over the dom
+0002c940: 6169 6e20 7769 7468 2074 6865 2063 6f6c  ain with the col
+0002c950: 6f72 7320 6174 7472 6962 7574 6564 2074  ors attributed t
+0002c960: 6f20 6661 6369 6573 0d0a 0d0a 2020 2020  o facies....    
+0002c970: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+0002c980: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002c990: 2d2d 0d0a 2020 2020 2020 2020 6975 3a20  --..        iu: 
+0002c9a0: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
+0002c9b0: 2069 6e64 6963 6520 6f66 2075 6e69 7473   indice of units
+0002c9c0: 2072 6561 6c69 7a61 7469 6f6e 0d0a 2020   realization..  
+0002c9d0: 2020 2020 2020 6966 613a 2069 6e74 0d0a        ifa: int..
+0002c9e0: 2020 2020 2020 2020 2020 2020 696e 6469              indi
+0002c9f0: 6365 206f 6620 6661 6369 6573 2072 6561  ce of facies rea
+0002ca00: 6c7a 6961 7469 6f6e 0d0a 2020 2020 2020  lziation..      
+0002ca10: 2020 765f 6578 3a20 696e 7420 6f72 2066    v_ex: int or f
+0002ca20: 6c6f 6174 0d0a 2020 2020 2020 2020 2020  loat..          
+0002ca30: 2020 7665 7274 6963 616c 2065 7861 6765    vertical exage
+0002ca40: 7261 7469 6f6e 0d0a 2020 2020 2020 2020  ration..        
+0002ca50: 696e 7369 6465 5f75 6e69 7473 3a20 6172  inside_units: ar
+0002ca60: 7261 792d 6c69 6b65 206f 6620 3a63 6c61  ray-like of :cla
+0002ca70: 7373 3a60 556e 6974 6020 6f62 6a65 6374  ss:`Unit` object
+0002ca80: 730d 0a20 2020 2020 2020 2020 2020 206c  s..            l
+0002ca90: 6973 7420 6f66 2075 6e69 7473 2069 6e73  ist of units ins
+0002caa0: 6964 6520 7768 6963 6820 7765 2077 616e  ide which we wan
+0002cab0: 7420 746f 2068 6176 6520 7468 6520 706c  t to have the pl
+0002cac0: 6f74 2e0d 0a20 2020 2020 2020 2020 2020  ot...           
+0002cad0: 2069 6620 4e6f 6e65 202d 2d3e 2061 6c6c   if None --> all
+0002cae0: 0d0a 2020 2020 2020 2020 706c 6f74 7465  ..        plotte
+0002caf0: 723a 2070 7976 6973 7461 2070 6c6f 7474  r: pyvista plott
+0002cb00: 6572 2069 6620 7761 6e74 6564 0d0a 2020  er if wanted..  
+0002cb10: 2020 2020 2020 736c 6963 6578 3a20 666c        slicex: fl
+0002cb20: 6f61 7420 6f72 2073 6571 7565 6e63 6520  oat or sequence 
+0002cb30: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
+0002cb40: 2020 2020 2020 2066 7261 6374 696f 6e20         fraction 
+0002cb50: 6f66 2078 2061 7869 7320 7768 6572 6520  of x axis where 
+0002cb60: 746f 2073 6c69 6365 0d0a 2020 2020 2020  to slice..      
+0002cb70: 2020 736c 6963 6579 3a20 666c 6f61 7420    slicey: float 
+0002cb80: 6f72 2073 6571 7565 6e63 6520 6f66 2066  or sequence of f
+0002cb90: 6c6f 6174 730d 0a20 2020 2020 2020 2020  loats..         
+0002cba0: 2020 2066 7261 6374 696f 6e20 6f66 2079     fraction of y
+0002cbb0: 2061 7869 7320 7768 6572 6520 746f 2073   axis where to s
+0002cbc0: 6c69 6365 0d0a 2020 2020 2020 2020 736c  lice..        sl
+0002cbd0: 6963 657a 3a20 666c 6f61 7420 6f72 2073  icez: float or s
+0002cbe0: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
+0002cbf0: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
+0002cc00: 7261 6374 696f 6e20 6f66 207a 2061 7869  raction of z axi
+0002cc10: 7320 7768 6572 6520 746f 2073 6c69 6365  s where to slice
+0002cc20: 0d0a 2020 2020 2020 2020 7363 616c 6172  ..        scalar
+0002cc30: 5f62 6172 5f6b 7761 7267 733a 2064 6963  _bar_kwargs: dic
+0002cc40: 740d 0a20 2020 2020 2020 2020 2020 206b  t..            k
+0002cc50: 7761 7267 7320 666f 7220 7468 6520 7363  wargs for the sc
+0002cc60: 616c 6172 2062 6172 0d0a 2020 2020 2020  alar bar..      
+0002cc70: 2020 7368 6f77 5f73 6361 6c61 725f 6261    show_scalar_ba
+0002cc80: 723a 2062 6f6f 6c0d 0a20 2020 2020 2020  r: bool..       
+0002cc90: 2020 2020 2069 6620 5472 7565 2c20 7368       if True, sh
+0002cca0: 6f77 2074 6865 2073 6361 6c61 7220 6261  ow the scalar ba
+0002ccb0: 720d 0a20 2020 2020 2020 206b 7761 7267  r..        kwarg
+0002ccc0: 733a 6469 6374 0d0a 2020 2020 2020 2020  s:dict..        
+0002ccd0: 2020 2020 6b77 6172 6773 2074 6f20 7061      kwargs to pa
+0002cce0: 7373 2074 6f20 6765 6f6e 652e 696d 6770  ss to geone.imgp
+0002ccf0: 6c6f 742e 6472 6177 496d 6167 6533 445f  lot.drawImage3D_
+0002cd00: 736c 6963 6520 6f72 2067 656f 6e65 2e69  slice or geone.i
+0002cd10: 6d67 706c 6f74 2e64 7261 7749 6d61 6765  mgplot.drawImage
+0002cd20: 3344 5f73 7572 6661 6365 0d0a 2020 2020  3D_surface..    
+0002cd30: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+0002cd40: 2020 2066 615f 646f 6d61 696e 733d 7365     fa_domains=se
+0002cd50: 6c66 2e67 6574 5f66 6163 6965 7328 6975  lf.get_facies(iu
+0002cd60: 2c20 6966 612c 2061 6c6c 5f64 6174 613d  , ifa, all_data=
+0002cd70: 4661 6c73 6529 2e61 7374 7970 6528 6e70  False).astype(np
+0002cd80: 2e66 6c6f 6174 3332 290d 0a0d 0a20 2020  .float32)....   
+0002cd90: 2020 2020 2023 6b65 6570 2066 6163 6965       #keep facie
+0002cda0: 7320 696e 206f 6e6c 7920 7761 6e74 6564  s in only wanted
+0002cdb0: 2075 6e69 7473 0d0a 2020 2020 2020 2020   units..        
+0002cdc0: 6966 2069 6e73 6964 655f 756e 6974 7320  if inside_units 
+0002cdd0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+0002cde0: 2020 2020 2020 2020 2020 6d61 736b 5f61            mask_a
+0002cdf0: 6c6c 3d6e 702e 7a65 726f 7328 5b73 656c  ll=np.zeros([sel
+0002ce00: 662e 6765 745f 6e7a 2829 2c20 7365 6c66  f.get_nz(), self
+0002ce10: 2e67 6574 5f6e 7928 292c 2073 656c 662e  .get_ny(), self.
+0002ce20: 6765 745f 6e78 2829 5d29 0d0a 2020 2020  get_nx()])..    
+0002ce30: 2020 2020 2020 2020 666f 7220 7520 696e          for u in
+0002ce40: 2069 6e73 6964 655f 756e 6974 733a 0d0a   inside_units:..
+0002ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce60: 6966 2069 7369 6e73 7461 6e63 6528 752c  if isinstance(u,
+0002ce70: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
+0002ce80: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
+0002ce90: 3d73 656c 662e 756e 6974 5f6d 6173 6b28  =self.unit_mask(
+0002cea0: 752c 2069 753d 2069 7529 0d0a 2020 2020  u, iu= iu)..    
+0002ceb0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0002cec0: 2069 7369 6e73 7461 6e63 6528 752c 2055   isinstance(u, U
+0002ced0: 6e69 7429 2061 6e64 2075 2069 6e20 7365  nit) and u in se
+0002cee0: 6c66 2e67 6574 5f61 6c6c 5f75 6e69 7473  lf.get_all_units
+0002cef0: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+0002cf00: 2020 2020 2020 2020 206d 6173 6b3d 7365           mask=se
+0002cf10: 6c66 2e75 6e69 745f 6d61 736b 2875 2e6e  lf.unit_mask(u.n
+0002cf20: 616d 652c 2069 753d 2069 7529 0d0a 2020  ame, iu= iu)..  
+0002cf30: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0002cf40: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0002cf50: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002cf60: 616c 7565 4572 726f 7220 2822 556e 6974  alueError ("Unit
+0002cf70: 2070 6173 7365 6420 696e 2069 6e73 6964   passed in insid
+0002cf80: 655f 756e 6974 7320 6d75 7374 2062 6520  e_units must be 
+0002cf90: 6120 756e 6974 206e 616d 6520 6f72 2061  a unit name or a
+0002cfa0: 2075 6e69 7420 6f62 6a65 6374 2063 6f6e   unit object con
+0002cfb0: 7461 696e 6564 2069 6e20 7468 6520 4172  tained in the Ar
+0002cfc0: 6368 5461 626c 6522 290d 0a20 2020 2020  chTable")..     
+0002cfd0: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+0002cfe0: 616c 6c5b 6d61 736b 203d 3d20 315d 3d31  all[mask == 1]=1
+0002cff0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0002d000: 6661 5f64 6f6d 6169 6e73 5b6d 6173 6b5f  fa_domains[mask_
+0002d010: 616c 6c20 213d 2031 5d3d 300d 0a0d 0a20  all != 1]=0.... 
+0002d020: 2020 2020 2020 2064 3d7b 7d0d 0a20 2020         d={}..   
+0002d030: 2020 2020 2063 6f6c 6f72 733d 5b5d 0d0a       colors=[]..
+0002d040: 2020 2020 2020 2020 6e78 3d73 656c 662e          nx=self.
+0002d050: 6765 745f 6e78 2829 0d0a 2020 2020 2020  get_nx()..      
+0002d060: 2020 6e79 3d73 656c 662e 6765 745f 6e79    ny=self.get_ny
+0002d070: 2829 0d0a 2020 2020 2020 2020 6e7a 3d73  ()..        nz=s
+0002d080: 656c 662e 6765 745f 6e7a 2829 0d0a 2020  elf.get_nz()..  
+0002d090: 2020 2020 2020 7378 3d73 656c 662e 6765        sx=self.ge
+0002d0a0: 745f 7378 2829 0d0a 2020 2020 2020 2020  t_sx()..        
+0002d0b0: 7379 3d73 656c 662e 6765 745f 7379 2829  sy=self.get_sy()
+0002d0c0: 0d0a 2020 2020 2020 2020 737a 3d73 656c  ..        sz=sel
+0002d0d0: 662e 6765 745f 737a 2829 0d0a 2020 2020  f.get_sz()..    
+0002d0e0: 2020 2020 7830 3d73 656c 662e 6765 745f      x0=self.get_
+0002d0f0: 6f78 2829 0d0a 2020 2020 2020 2020 7930  ox()..        y0
+0002d100: 3d73 656c 662e 6765 745f 6f79 2829 0d0a  =self.get_oy()..
+0002d110: 2020 2020 2020 2020 7a30 3d73 656c 662e          z0=self.
+0002d120: 6765 745f 6f7a 2829 0d0a 2020 2020 2020  get_oz()..      
+0002d130: 2020 6c73 745f 4944 3d6e 702e 756e 6971    lst_ID=np.uniq
+0002d140: 7565 2866 615f 646f 6d61 696e 7329 0d0a  ue(fa_domains)..
+0002d150: 2020 2020 2020 2020 6e65 775f 6c73 745f          new_lst_
+0002d160: 4944 203d 205b 5d0d 0a20 2020 2020 2020  ID = []..       
+0002d170: 2069 6620 6578 636c 7564 6564 5661 6c20   if excludedVal 
+0002d180: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+0002d190: 2020 2020 2020 6578 636c 7564 6564 5661        excludedVa
+0002d1a0: 6c3d 5b5d 0d0a 2020 2020 2020 2020 6966  l=[]..        if
+0002d1b0: 2069 7369 6e73 7461 6e63 6528 6578 636c   isinstance(excl
+0002d1c0: 7564 6564 5661 6c2c 2069 6e74 293a 0d0a  udedVal, int):..
+0002d1d0: 2020 2020 2020 2020 2020 2020 6578 636c              excl
+0002d1e0: 7564 6564 5661 6c3d 5b65 7863 6c75 6465  udedVal=[exclude
+0002d1f0: 6456 616c 5d0d 0a0d 0a20 2020 2020 2020  dVal]....       
+0002d200: 2023 2320 6372 6561 7465 2061 2064 6963   ## create a dic
+0002d210: 7469 6f6e 6e61 7279 2074 6f20 6d61 7020  tionnary to map 
+0002d220: 7468 6520 6661 6369 6573 2049 4420 746f  the facies ID to
+0002d230: 2074 6865 2066 6163 6965 7320 6e61 6d65   the facies name
+0002d240: 0d0a 2020 2020 2020 2020 6e65 775f 6964  ..        new_id
+0002d250: 3d31 0d0a 2020 2020 2020 2020 666f 7220  =1..        for 
+0002d260: 6920 696e 206c 7374 5f49 443a 0d0a 2020  i in lst_ID:..  
+0002d270: 2020 2020 2020 2020 2020 6966 2069 2021            if i !
+0002d280: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+0002d290: 2020 2020 2020 6966 2069 206e 6f74 2069        if i not i
+0002d2a0: 6e20 6578 636c 7564 6564 5661 6c3a 0d0a  n excludedVal:..
+0002d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2c0: 2020 2020 6661 3d73 656c 662e 6765 745f      fa=self.get_
+0002d2d0: 6661 6369 6573 5f6f 626a 2849 443d 692c  facies_obj(ID=i,
+0002d2e0: 2074 7970 653d 2249 4422 290d 0a20 2020   type="ID")..   
+0002d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d300: 2023 2066 615f 646f 6d61 696e 735b 6661   # fa_domains[fa
+0002d310: 5f64 6f6d 6169 6e73 203d 3d20 6661 2e49  _domains == fa.I
+0002d320: 445d 3d6e 6577 5f69 640d 0a20 2020 2020  D]=new_id..     
+0002d330: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0002d340: 6f6c 6f72 732e 6170 7065 6e64 2866 612e  olors.append(fa.
+0002d350: 6329 0d0a 2020 2020 2020 2020 2020 2020  c)..            
+0002d360: 2020 2020 2020 2020 645b 6e65 775f 6964          d[new_id
+0002d370: 202b 2030 2e35 5d3d 6661 2e6e 616d 650d   + 0.5]=fa.name.
+0002d380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d390: 2020 2020 206e 6577 5f69 6420 2b3d 2031       new_id += 1
+0002d3a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d3b0: 2020 2020 2020 6e65 775f 6c73 745f 4944        new_lst_ID
+0002d3c0: 2e61 7070 656e 6428 6929 0d0a 0d0a 2020  .append(i)....  
+0002d3d0: 2020 2020 2020 2372 656d 6f76 6520 3020        #remove 0 
+0002d3e0: 6f63 6375 7265 6e63 6520 2877 6865 7265  occurence (where
+0002d3f0: 206e 6f20 6661 6369 6573 2061 7265 2070   no facies are p
+0002d400: 7265 7365 6e74 290d 0a20 2020 2020 2020  resent)..       
+0002d410: 2066 615f 646f 6d61 696e 735b 6661 5f64   fa_domains[fa_d
+0002d420: 6f6d 6169 6e73 3d3d 305d 3d6e 702e 6e61  omains==0]=np.na
+0002d430: 6e0d 0a0d 0a20 2020 2020 2020 2069 6620  n....        if 
+0002d440: 706c 6f74 7465 7220 6973 204e 6f6e 653a  plotter is None:
+0002d450: 0d0a 2020 2020 2020 2020 2020 2020 703d  ..            p=
+0002d460: 7076 2e50 6c6f 7474 6572 2829 0d0a 2020  pv.Plotter()..  
+0002d470: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0002d480: 2020 2020 2020 2020 2070 3d70 6c6f 7474           p=plott
+0002d490: 6572 0d0a 2020 2020 2020 2020 696d 3d67  er..        im=g
+0002d4a0: 656f 6e65 2e69 6d67 2e49 6d67 286e 782c  eone.img.Img(nx,
+0002d4b0: 206e 792c 206e 7a2c 2073 782c 2073 792c   ny, nz, sx, sy,
+0002d4c0: 2073 7a2a 765f 6578 2c20 7830 2c20 7930   sz*v_ex, x0, y0
+0002d4d0: 2c20 7a30 2c20 6e76 3d31 2c20 7661 6c3d  , z0, nv=1, val=
+0002d4e0: 6661 5f64 6f6d 6169 6e73 2c20 7661 726e  fa_domains, varn
+0002d4f0: 616d 653d 224c 6974 686f 6c6f 6769 6573  ame="Lithologies
+0002d500: 2229 0d0a 0d0a 2020 2020 2020 2020 6966  ")....        if
+0002d510: 2073 6c69 6365 7820 6973 206e 6f74 204e   slicex is not N
+0002d520: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+0002d530: 2020 736c 6963 6578 3d6e 702e 6172 7261    slicex=np.arra
+0002d540: 7928 736c 6963 6578 290d 0a20 2020 2020  y(slicex)..     
+0002d550: 2020 2020 2020 2073 6c69 6365 785b 736c         slicex[sl
+0002d560: 6963 6578 3c30 5d3d 300d 0a20 2020 2020  icex<0]=0..     
+0002d570: 2020 2020 2020 2073 6c69 6365 785b 736c         slicex[sl
+0002d580: 6963 6578 3e31 5d3d 310d 0a20 2020 2020  icex>1]=1..     
+0002d590: 2020 2020 2020 2063 783d 696d 2e6f 7820         cx=im.ox 
+0002d5a0: 2b20 736c 6963 6578 202a 2069 6d2e 6e78  + slicex * im.nx
+0002d5b0: 202a 2069 6d2e 7378 2020 2320 6365 6e74   * im.sx  # cent
+0002d5c0: 6572 2061 6c6f 6e67 2078 0d0a 2020 2020  er along x..    
+0002d5d0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0002d5e0: 2020 2020 2020 2063 783d 4e6f 6e65 0d0a         cx=None..
+0002d5f0: 2020 2020 2020 2020 6966 2073 6c69 6365          if slice
+0002d600: 7920 6973 206e 6f74 204e 6f6e 653a 0d0a  y is not None:..
+0002d610: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+0002d620: 6579 3d6e 702e 6172 7261 7928 736c 6963  ey=np.array(slic
+0002d630: 6579 290d 0a20 2020 2020 2020 2020 2020  ey)..           
+0002d640: 2073 6c69 6365 795b 736c 6963 6579 3c30   slicey[slicey<0
+0002d650: 5d3d 300d 0a20 2020 2020 2020 2020 2020  ]=0..           
+0002d660: 2073 6c69 6365 795b 736c 6963 6579 3e31   slicey[slicey>1
+0002d670: 5d3d 310d 0a20 2020 2020 2020 2020 2020  ]=1..           
+0002d680: 2063 793d 696d 2e6f 7920 2b20 736c 6963   cy=im.oy + slic
+0002d690: 6579 202a 2069 6d2e 6e79 202a 2069 6d2e  ey * im.ny * im.
+0002d6a0: 7379 2020 2320 6365 6e74 6572 2061 6c6f  sy  # center alo
+0002d6b0: 6e67 2079 0d0a 2020 2020 2020 2020 656c  ng y..        el
+0002d6c0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0002d6d0: 2063 793d 4e6f 6e65 0d0a 2020 2020 2020   cy=None..      
+0002d6e0: 2020 6966 2073 6c69 6365 7a20 6973 206e    if slicez is n
+0002d6f0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0002d700: 2020 2020 2020 736c 6963 657a 3d6e 702e        slicez=np.
+0002d710: 6172 7261 7928 736c 6963 657a 290d 0a20  array(slicez).. 
+0002d720: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+0002d730: 7a5b 736c 6963 657a 3c30 5d3d 300d 0a20  z[slicez<0]=0.. 
+0002d740: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+0002d750: 7a5b 736c 6963 657a 3e31 5d3d 310d 0a20  z[slicez>1]=1.. 
+0002d760: 2020 2020 2020 2020 2020 2063 7a3d 696d             cz=im
+0002d770: 2e6f 7a20 2b20 736c 6963 657a 202a 2069  .oz + slicez * i
+0002d780: 6d2e 6e7a 202a 2069 6d2e 737a 2020 2320  m.nz * im.sz  # 
+0002d790: 6365 6e74 6572 2061 6c6f 6e67 207a 0d0a  center along z..
+0002d7a0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0002d7b0: 2020 2020 2020 2020 2020 2063 7a3d 4e6f             cz=No
+0002d7c0: 6e65 0d0a 0d0a 0d0a 2020 2020 2020 2020  ne......        
+0002d7d0: 6966 2073 6c69 6365 7820 6973 206e 6f74  if slicex is not
+0002d7e0: 204e 6f6e 6520 6f72 2073 6c69 6365 7920   None or slicey 
+0002d7f0: 6973 206e 6f74 204e 6f6e 6520 6f72 2073  is not None or s
+0002d800: 6c69 6365 7a20 6973 206e 6f74 204e 6f6e  licez is not Non
+0002d810: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002d820: 696d 6770 6c74 332e 6472 6177 496d 6167  imgplt3.drawImag
+0002d830: 6533 445f 736c 6963 6528 696d 2c20 706c  e3D_slice(im, pl
+0002d840: 6f74 7465 723d 702c 2073 6c69 6365 5f6e  otter=p, slice_n
+0002d850: 6f72 6d61 6c5f 783d 6378 2c20 736c 6963  ormal_x=cx, slic
+0002d860: 655f 6e6f 726d 616c 5f79 3d63 792c 2073  e_normal_y=cy, s
+0002d870: 6c69 6365 5f6e 6f72 6d61 6c5f 7a3d 637a  lice_normal_z=cz
+0002d880: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0002d890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d8a0: 2020 2020 2020 2063 6174 6567 3d54 7275         categ=Tru
+0002d8b0: 652c 2063 6174 6567 5661 6c3d 6e65 775f  e, categVal=new_
+0002d8c0: 6c73 745f 4944 2c20 6578 636c 7564 6564  lst_ID, excluded
+0002d8d0: 5661 6c3d 6578 636c 7564 6564 5661 6c2c  Val=excludedVal,
+0002d8e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d900: 2020 2020 2020 6361 7465 6743 6f6c 3d63        categCol=c
+0002d910: 6f6c 6f72 732c 2073 6361 6c61 725f 6261  olors, scalar_ba
+0002d920: 725f 616e 6e6f 7461 7469 6f6e 733d 642c  r_annotations=d,
+0002d930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d950: 2020 2020 2020 7363 616c 6172 5f62 6172        scalar_bar
+0002d960: 5f6b 7761 7267 733d 7363 616c 6172 5f62  _kwargs=scalar_b
+0002d970: 6172 5f6b 7761 7267 732c 2073 686f 775f  ar_kwargs, show_
+0002d980: 7363 616c 6172 5f62 6172 203d 2073 686f  scalar_bar = sho
+0002d990: 775f 7363 616c 6172 5f62 6172 2c20 2a2a  w_scalar_bar, **
+0002d9a0: 6b77 6172 6773 290d 0a20 2020 2020 2020  kwargs)..       
+0002d9b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0002d9c0: 2020 2020 696d 6770 6c74 332e 6472 6177      imgplt3.draw
+0002d9d0: 496d 6167 6533 445f 7375 7266 6163 6528  Image3D_surface(
+0002d9e0: 696d 2c20 706c 6f74 7465 723d 702c 2063  im, plotter=p, c
+0002d9f0: 6174 6567 3d54 7275 652c 2063 6174 6567  ateg=True, categ
+0002da00: 5661 6c3d 6e65 775f 6c73 745f 4944 2c20  Val=new_lst_ID, 
+0002da10: 6578 636c 7564 6564 5661 6c3d 6578 636c  excludedVal=excl
+0002da20: 7564 6564 5661 6c2c 0d0a 2020 2020 2020  udedVal,..      
+0002da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da40: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+0002da50: 7465 6743 6f6c 3d63 6f6c 6f72 732c 2073  tegCol=colors, s
+0002da60: 6361 6c61 725f 6261 725f 616e 6e6f 7461  calar_bar_annota
+0002da70: 7469 6f6e 733d 642c 0d0a 2020 2020 2020  tions=d,..      
+0002da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da90: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0002daa0: 616c 6172 5f62 6172 5f6b 7761 7267 733d  alar_bar_kwargs=
+0002dab0: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
+0002dac0: 732c 2073 686f 775f 7363 616c 6172 5f62  s, show_scalar_b
+0002dad0: 6172 203d 2073 686f 775f 7363 616c 6172  ar = show_scalar
+0002dae0: 5f62 6172 2c20 2a2a 6b77 6172 6773 290d  _bar, **kwargs).
+0002daf0: 0a0d 0a20 2020 2020 2020 2069 6620 706c  ...        if pl
+0002db00: 6f74 7465 7220 6973 204e 6f6e 653a 0d0a  otter is None:..
+0002db10: 2020 2020 2020 2020 2020 2020 702e 6164              p.ad
+0002db20: 645f 626f 756e 6469 6e67 5f62 6f78 2829  d_bounding_box()
+0002db30: 0d0a 2020 2020 2020 2020 2020 2020 702e  ..            p.
+0002db40: 7368 6f77 5f61 7865 7328 290d 0a20 2020  show_axes()..   
+0002db50: 2020 2020 2020 2020 2070 2e73 686f 7728           p.show(
+0002db60: 290d 0a0d 0a0d 0a20 2020 2064 6566 2070  )......    def p
+0002db70: 6c6f 745f 7072 6f70 2873 656c 662c 2070  lot_prop(self, p
+0002db80: 726f 7065 7274 792c 2069 753d 302c 2069  roperty, iu=0, i
+0002db90: 6661 3d30 2c20 6970 3d30 2c20 765f 6578  fa=0, ip=0, v_ex
+0002dba0: 3d31 2c20 696e 7369 6465 5f75 6e69 7473  =1, inside_units
+0002dbb0: 3d4e 6f6e 652c 2069 6e73 6964 655f 6661  =None, inside_fa
+0002dbc0: 6369 6573 3d4e 6f6e 652c 2066 696c 7465  cies=None, filte
+0002dbd0: 7269 6e67 5f69 6e74 6572 7661 6c3d 4e6f  ring_interval=No
+0002dbe0: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
+0002dbf0: 2020 2020 2020 2020 2070 6c6f 7474 6572           plotter
+0002dc00: 3d4e 6f6e 652c 2073 6c69 6365 783d 4e6f  =None, slicex=No
+0002dc10: 6e65 2c20 736c 6963 6579 3d4e 6f6e 652c  ne, slicey=None,
+0002dc20: 2073 6c69 6365 7a3d 4e6f 6e65 2c20 636d   slicez=None, cm
+0002dc30: 696e 3d4e 6f6e 652c 2063 6d61 783d 4e6f  in=None, cmax=No
+0002dc40: 6e65 2c20 7363 616c 6172 5f62 6172 5f6b  ne, scalar_bar_k
+0002dc50: 7761 7267 733d 4e6f 6e65 2c20 2a2a 6b77  wargs=None, **kw
+0002dc60: 6172 6773 293a 0d0a 0d0a 2020 2020 2020  args):....      
+0002dc70: 2020 2222 220d 0a20 2020 2020 2020 2050    """..        P
+0002dc80: 6c6f 7420 7468 6520 6661 6369 6573 2072  lot the facies r
+0002dc90: 6561 6c69 7a61 7469 6f6e 7320 6f76 6572  ealizations over
+0002dca0: 2074 6865 2064 6f6d 6169 6e20 7769 7468   the domain with
+0002dcb0: 2074 6865 2063 6f6c 6f72 7320 6174 7472   the colors attr
+0002dcc0: 6962 7574 6564 2074 6f20 6661 6369 6573  ibuted to facies
+0002dcd0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+0002dce0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+0002dcf0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0002dd00: 2020 2020 6975 3a69 6e74 200d 0a20 2020      iu:int ..   
+0002dd10: 2020 2020 2020 2020 2069 6e64 6963 6520           indice 
+0002dd20: 6f66 2075 6e69 7473 2072 6561 6c69 7a61  of units realiza
+0002dd30: 7469 6f6e 0d0a 2020 2020 2020 2020 6966  tion..        if
+0002dd40: 613a 696e 740d 0a20 2020 2020 2020 2020  a:int..         
+0002dd50: 2020 2069 6e64 6963 6520 6f66 2066 6163     indice of fac
+0002dd60: 6965 7320 7265 616c 697a 6174 696f 6e0d  ies realization.
+0002dd70: 0a20 2020 2020 2020 2069 703a 696e 740d  .        ip:int.
+0002dd80: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+0002dd90: 6963 6520 6f66 2070 726f 7065 7274 7920  ice of property 
+0002dda0: 7265 616c 697a 6174 696f 6e0d 0a20 2020  realization..   
+0002ddb0: 2020 2020 2076 5f65 783a 696e 7420 6f72       v_ex:int or
+0002ddc0: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
+0002ddd0: 2020 2020 7665 7274 6963 616c 2065 7861      vertical exa
+0002dde0: 6765 7261 7469 6f6e 0d0a 2020 2020 2020  geration..      
+0002ddf0: 2020 696e 7369 6465 5f75 6e69 7473 3a61    inside_units:a
+0002de00: 7272 6179 2d6c 696b 6520 6f66 203a 636c  rray-like of :cl
+0002de10: 6173 733a 6055 6e69 7460 206f 626a 6563  ass:`Unit` objec
+0002de20: 7473 206f 7220 756e 6974 206e 616d 6573  ts or unit names
+0002de30: 2028 7374 7269 6e67 290d 0a20 2020 2020   (string)..     
+0002de40: 2020 2020 2020 206c 6973 7420 6f66 2075         list of u
+0002de50: 6e69 7473 2069 6e73 6964 6520 7768 6963  nits inside whic
+0002de60: 6820 7765 2077 616e 7420 746f 2068 6176  h we want to hav
+0002de70: 6520 7468 6520 706c 6f74 2e20 4279 2064  e the plot. By d
+0002de80: 6566 6175 6c74 2061 6c6c 0d0a 2020 2020  efault all..    
+0002de90: 2020 2020 696e 7369 6465 5f66 6163 6965      inside_facie
+0002dea0: 733a 6172 7261 792d 6c69 6b65 206f 6620  s:array-like of 
+0002deb0: 3a63 6c61 7373 3a60 4661 6369 6573 6020  :class:`Facies` 
+0002dec0: 6f62 6a65 6374 7320 6f72 2066 6163 6965  objects or facie
+0002ded0: 7320 6e61 6d65 7320 2873 7472 696e 6729  s names (string)
+0002dee0: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
+0002def0: 7374 206f 6620 6661 6369 6573 2069 6e73  st of facies ins
+0002df00: 6964 6520 7768 6963 6820 7765 2077 616e  ide which we wan
+0002df10: 7420 746f 2068 6176 6520 7468 6520 706c  t to have the pl
+0002df20: 6f74 2e20 4279 2064 6566 6175 6c74 2061  ot. By default a
+0002df30: 6c6c 0d0a 2020 2020 2020 2020 706c 6f74  ll..        plot
+0002df40: 7465 723a 7079 7669 7374 6120 706c 6f74  ter:pyvista plot
+0002df50: 7465 7220 6966 2077 616e 7465 640d 0a20  ter if wanted.. 
+0002df60: 2020 2020 2020 2073 6c69 6365 782c 2073         slicex, s
+0002df70: 6c69 6365 792c 2073 6c69 6365 7a3a 2066  licey, slicez: f
+0002df80: 6c6f 6174 206f 7220 7365 7175 656e 6365  loat or sequence
+0002df90: 206f 6620 666c 6f61 7473 0d0a 2020 2020   of floats..    
+0002dfa0: 2020 2020 2020 2020 6672 6163 7469 6f6e          fraction
+0002dfb0: 2069 6e20 782c 2079 206f 7220 7a20 6469   in x, y or z di
+0002dfc0: 7265 6374 696f 6e20 7768 6572 6520 7468  rection where th
+0002dfd0: 6520 736c 6963 6520 6973 2064 6f6e 650d  e slice is done.
+0002dfe0: 0a20 2020 2020 2020 2063 6d69 6e2c 2063  .        cmin, c
+0002dff0: 6d61 783a 666c 6f61 740d 0a20 2020 2020  max:float..     
+0002e000: 2020 2020 2020 206d 696e 2061 6e64 206d         min and m
+0002e010: 6178 2076 616c 7565 206f 6620 7468 6520  ax value of the 
+0002e020: 636f 6c6f 7262 6172 0d0a 2020 2020 2020  colorbar..      
+0002e030: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
+0002e040: 7267 733a 6469 6374 0d0a 2020 2020 2020  rgs:dict..      
+0002e050: 2020 2020 2020 6b77 6172 6773 2066 6f72        kwargs for
+0002e060: 2074 6865 2073 6361 6c61 7220 6261 720d   the scalar bar.
+0002e070: 0a20 2020 2020 2020 206b 7761 7267 733a  .        kwargs:
+0002e080: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
+0002e090: 2020 6b77 6172 6773 2074 6f20 7061 7373    kwargs to pass
+0002e0a0: 2074 6f20 6765 6f6e 652e 696d 6770 6c6f   to geone.imgplo
+0002e0b0: 742e 6472 6177 496d 6167 6533 445f 736c  t.drawImage3D_sl
+0002e0c0: 6963 6520 6f72 2067 656f 6e65 2e69 6d67  ice or geone.img
+0002e0d0: 706c 6f74 2e64 7261 7749 6d61 6765 3344  plot.drawImage3D
+0002e0e0: 5f73 7572 6661 6365 0d0a 2020 2020 2020  _surface..      
+0002e0f0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0002e100: 2070 726f 703d 7365 6c66 2e67 6574 7072   prop=self.getpr
+0002e110: 6f70 2870 726f 7065 7274 792c 2069 752c  op(property, iu,
+0002e120: 2069 6661 2c20 6970 2c20 616c 6c5f 6461   ifa, ip, all_da
+0002e130: 7461 3d46 616c 7365 290d 0a20 2020 2020  ta=False)..     
+0002e140: 2020 2066 6163 6965 733d 7365 6c66 2e67     facies=self.g
+0002e150: 6574 5f66 6163 6965 7328 6975 2c20 6966  et_facies(iu, if
+0002e160: 612c 2061 6c6c 5f64 6174 613d 4661 6c73  a, all_data=Fals
+0002e170: 6529 0d0a 0d0a 2020 2020 2020 2020 236b  e)....        #k
+0002e180: 6565 7020 7661 6c75 6573 2069 6e20 6f6e  eep values in on
+0002e190: 6c79 2077 616e 7465 6420 756e 6974 730d  ly wanted units.
+0002e1a0: 0a20 2020 2020 2020 2069 6620 696e 7369  .        if insi
+0002e1b0: 6465 5f75 6e69 7473 2069 7320 6e6f 7420  de_units is not 
+0002e1c0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0002e1d0: 2020 206d 6173 6b5f 616c 6c3d 6e70 2e7a     mask_all=np.z
+0002e1e0: 6572 6f73 285b 7365 6c66 2e67 6574 5f6e  eros([self.get_n
+0002e1f0: 7a28 292c 2073 656c 662e 6765 745f 6e79  z(), self.get_ny
+0002e200: 2829 2c20 7365 6c66 2e67 6574 5f6e 7828  (), self.get_nx(
+0002e210: 295d 290d 0a20 2020 2020 2020 2020 2020  )])..           
+0002e220: 2066 6f72 2075 2069 6e20 696e 7369 6465   for u in inside
+0002e230: 5f75 6e69 7473 3a0d 0a20 2020 2020 2020  _units:..       
+0002e240: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+0002e250: 7374 616e 6365 2875 2c20 7374 7229 3a0d  stance(u, str):.
+0002e260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e270: 2020 2020 206d 6173 6b3d 7365 6c66 2e75       mask=self.u
+0002e280: 6e69 745f 6d61 736b 2875 2c20 6975 3d69  nit_mask(u, iu=i
+0002e290: 7529 0d0a 2020 2020 2020 2020 2020 2020  u)..            
+0002e2a0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+0002e2b0: 6e63 6528 752c 2055 6e69 7429 2061 6e64  nce(u, Unit) and
+0002e2c0: 2075 2069 6e20 7365 6c66 2e67 6574 5f61   u in self.get_a
+0002e2d0: 6c6c 5f75 6e69 7473 2829 3a0d 0a20 2020  ll_units():..   
+0002e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e2f0: 206d 6173 6b3d 7365 6c66 2e75 6e69 745f   mask=self.unit_
+0002e300: 6d61 736b 2875 2e6e 616d 652c 2069 753d  mask(u.name, iu=
+0002e310: 6975 290d 0a20 2020 2020 2020 2020 2020  iu)..           
+0002e320: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0002e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e340: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002e350: 2028 2255 6e69 7420 7061 7373 6564 2069   ("Unit passed i
+0002e360: 6e20 696e 7369 6465 5f75 6e69 7473 206d  n inside_units m
+0002e370: 7573 7420 6265 2061 2075 6e69 7420 6e61  ust be a unit na
+0002e380: 6d65 206f 7220 6120 756e 6974 206f 626a  me or a unit obj
+0002e390: 6563 7420 636f 6e74 6169 6e65 6420 696e  ect contained in
+0002e3a0: 2074 6865 2041 7263 6854 6162 6c65 2229   the ArchTable")
+0002e3b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002e3c0: 2020 6d61 736b 5f61 6c6c 5b6d 6173 6b20    mask_all[mask 
+0002e3d0: 3d3d 2031 5d3d 310d 0a0d 0a20 2020 2020  == 1]=1....     
+0002e3e0: 2020 2020 2020 2070 726f 705b 6d61 736b         prop[mask
+0002e3f0: 5f61 6c6c 2021 3d20 315d 3d6e 702e 6e61  _all != 1]=np.na
+0002e400: 6e0d 0a0d 0a20 2020 2020 2020 2023 6b65  n....        #ke
+0002e410: 6570 2076 616c 7565 7320 696e 206f 6e6c  ep values in onl
+0002e420: 7920 7761 6e74 6564 2066 6163 6965 730d  y wanted facies.
+0002e430: 0a20 2020 2020 2020 2069 6620 696e 7369  .        if insi
+0002e440: 6465 5f66 6163 6965 7320 6973 206e 6f74  de_facies is not
+0002e450: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0002e460: 2020 2020 6d61 736b 5f61 6c6c 3d6e 702e      mask_all=np.
+0002e470: 7a65 726f 7328 5b73 656c 662e 6765 745f  zeros([self.get_
+0002e480: 6e7a 2829 2c20 7365 6c66 2e67 6574 5f6e  nz(), self.get_n
+0002e490: 7928 292c 2073 656c 662e 6765 745f 6e78  y(), self.get_nx
+0002e4a0: 2829 5d29 0d0a 2020 2020 2020 2020 2020  ()])..          
+0002e4b0: 2020 666f 7220 6661 2069 6e20 696e 7369    for fa in insi
+0002e4c0: 6465 5f66 6163 6965 733a 0d0a 2020 2020  de_facies:..    
+0002e4d0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002e4e0: 7369 6e73 7461 6e63 6528 6661 2c20 7374  sinstance(fa, st
+0002e4f0: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
+0002e500: 2020 2020 2020 2020 206d 6173 6b3d 2866           mask=(f
+0002e510: 6163 6965 7320 3d3d 2073 656c 662e 6765  acies == self.ge
+0002e520: 745f 6661 6369 6573 5f6f 626a 2866 6129  t_facies_obj(fa)
+0002e530: 2e49 4429 0d0a 2020 2020 2020 2020 2020  .ID)..          
+0002e540: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+0002e550: 7461 6e63 6528 6661 2c20 4661 6369 6573  tance(fa, Facies
+0002e560: 2920 616e 6420 6661 2069 6e20 7365 6c66  ) and fa in self
+0002e570: 2e67 6574 5f61 6c6c 5f66 6163 6965 7328  .get_all_facies(
+0002e580: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0002e590: 2020 2020 2020 2020 6d61 736b 3d28 6661          mask=(fa
+0002e5a0: 6369 6573 203d 3d20 6661 2e49 4429 0d0a  cies == fa.ID)..
+0002e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e5c0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0002e5d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002e5e0: 2056 616c 7565 4572 726f 7220 2822 556e   ValueError ("Un
+0002e5f0: 6974 2070 6173 7365 6420 696e 2069 6e73  it passed in ins
+0002e600: 6964 655f 756e 6974 7320 6d75 7374 2062  ide_units must b
+0002e610: 6520 6120 756e 6974 206e 616d 6520 6f72  e a unit name or
+0002e620: 2061 2075 6e69 7420 6f62 6a65 6374 2063   a unit object c
+0002e630: 6f6e 7461 696e 6564 2069 6e20 7468 6520  ontained in the 
+0002e640: 4172 6368 5461 626c 6522 290d 0a20 2020  ArchTable")..   
+0002e650: 2020 2020 2020 2020 2020 2020 206d 6173               mas
+0002e660: 6b5f 616c 6c5b 6d61 736b 203d 3d20 315d  k_all[mask == 1]
+0002e670: 3d31 0d0a 0d0a 2020 2020 2020 2020 2020  =1....          
+0002e680: 2020 7072 6f70 5b6d 6173 6b5f 616c 6c20    prop[mask_all 
+0002e690: 213d 2031 5d3d 6e70 2e6e 616e 0d0a 0d0a  != 1]=np.nan....
+0002e6a0: 2020 2020 2020 2020 6966 207e 7072 6f70          if ~prop
+0002e6b0: 2e61 6e79 2829 3a0d 0a20 2020 2020 2020  .any():..       
+0002e6c0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0002e6d0: 4572 726f 7220 2822 4572 726f 723a 204e  Error ("Error: N
+0002e6e0: 6f20 7661 6c75 6573 2066 6f75 6e64 2229  o values found")
+0002e6f0: 0d0a 0d0a 2020 2020 2020 2020 6e78 3d73  ....        nx=s
+0002e700: 656c 662e 6765 745f 6e78 2829 0d0a 2020  elf.get_nx()..  
+0002e710: 2020 2020 2020 6e79 3d73 656c 662e 6765        ny=self.ge
+0002e720: 745f 6e79 2829 0d0a 2020 2020 2020 2020  t_ny()..        
+0002e730: 6e7a 3d73 656c 662e 6765 745f 6e7a 2829  nz=self.get_nz()
+0002e740: 0d0a 2020 2020 2020 2020 7378 3d73 656c  ..        sx=sel
+0002e750: 662e 6765 745f 7378 2829 0d0a 2020 2020  f.get_sx()..    
+0002e760: 2020 2020 7379 3d73 656c 662e 6765 745f      sy=self.get_
+0002e770: 7379 2829 0d0a 2020 2020 2020 2020 737a  sy()..        sz
+0002e780: 3d73 656c 662e 6765 745f 737a 2829 0d0a  =self.get_sz()..
+0002e790: 2020 2020 2020 2020 7830 3d73 656c 662e          x0=self.
+0002e7a0: 6765 745f 6f78 2829 0d0a 2020 2020 2020  get_ox()..      
+0002e7b0: 2020 7930 3d73 656c 662e 6765 745f 6f79    y0=self.get_oy
+0002e7c0: 2829 0d0a 2020 2020 2020 2020 7a30 3d73  ()..        z0=s
+0002e7d0: 656c 662e 6765 745f 6f7a 2829 0d0a 0d0a  elf.get_oz()....
+0002e7e0: 2020 2020 2020 2020 2320 6669 6c74 6572          # filter
+0002e7f0: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
+0002e800: 2069 6620 6669 6c74 6572 696e 675f 696e   if filtering_in
+0002e810: 7465 7276 616c 2069 7320 6e6f 7420 4e6f  terval is not No
+0002e820: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002e830: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+0002e840: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
+0002e850: 6c2c 206c 6973 7429 3a0d 0a20 2020 2020  l, list):..     
+0002e860: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0002e870: 6e28 6669 6c74 6572 696e 675f 696e 7465  n(filtering_inte
+0002e880: 7276 616c 2920 3d3d 2032 3a0d 0a20 2020  rval) == 2:..   
+0002e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e8a0: 2069 6620 6669 6c74 6572 696e 675f 696e   if filtering_in
+0002e8b0: 7465 7276 616c 5b30 5d20 3c20 6669 6c74  terval[0] < filt
+0002e8c0: 6572 696e 675f 696e 7465 7276 616c 5b31  ering_interval[1
+0002e8d0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+0002e8e0: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
+0002e8f0: 5b70 726f 7020 3c20 6669 6c74 6572 696e  [prop < filterin
+0002e900: 675f 696e 7465 7276 616c 5b30 5d5d 203d  g_interval[0]] =
+0002e910: 206e 702e 6e61 6e0d 0a20 2020 2020 2020   np.nan..       
+0002e920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e930: 2070 726f 705b 7072 6f70 203e 2066 696c   prop[prop > fil
+0002e940: 7465 7269 6e67 5f69 6e74 6572 7661 6c5b  tering_interval[
+0002e950: 315d 5d20 3d20 6e70 2e6e 616e 0d0a 2020  1]] = np.nan..  
+0002e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e970: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0002e980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e990: 2070 7269 6e74 2822 6669 6c74 6572 696e   print("filterin
+0002e9a0: 675f 696e 7465 7276 616c 5b30 5d20 6d75  g_interval[0] mu
+0002e9b0: 7374 2062 6520 736d 616c 6c65 7220 7468  st be smaller th
+0002e9c0: 616e 2066 696c 7465 7269 6e67 5f69 6e74  an filtering_int
+0002e9d0: 6572 7661 6c5b 315d 2229 0d0a 2020 2020  erval[1]")..    
+0002e9e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0002e9f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002ea00: 2020 2020 2020 2070 7269 6e74 2822 6669         print("fi
+0002ea10: 6c74 6572 696e 675f 696e 7465 7276 616c  ltering_interval
+0002ea20: 206d 7573 7420 6265 2061 206c 6973 7420   must be a list 
+0002ea30: 6f66 2074 776f 2076 616c 7565 7322 290d  of two values").
+0002ea40: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0002ea50: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002ea60: 2020 2020 7072 696e 7428 2266 696c 7465      print("filte
+0002ea70: 7269 6e67 5f69 6e74 6572 7661 6c20 6d75  ring_interval mu
+0002ea80: 7374 2062 6520 6120 6c69 7374 206f 6620  st be a list of 
+0002ea90: 7477 6f20 7661 6c75 6573 2229 0d0a 0d0a  two values")....
+0002eaa0: 2020 2020 2020 2020 6966 2070 6c6f 7474          if plott
+0002eab0: 6572 2069 7320 4e6f 6e65 3a0d 0a20 2020  er is None:..   
+0002eac0: 2020 2020 2020 2020 2070 3d70 762e 506c           p=pv.Pl
+0002ead0: 6f74 7465 7228 290d 0a20 2020 2020 2020  otter()..       
+0002eae0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0002eaf0: 2020 2020 703d 706c 6f74 7465 720d 0a20      p=plotter.. 
+0002eb00: 2020 2020 2020 2069 6d3d 6765 6f6e 652e         im=geone.
+0002eb10: 696d 672e 496d 6728 6e78 2c20 6e79 2c20  img.Img(nx, ny, 
+0002eb20: 6e7a 2c20 7378 2c20 7379 2c20 737a 2a76  nz, sx, sy, sz*v
+0002eb30: 5f65 782c 2078 302c 2079 302c 207a 302c  _ex, x0, y0, z0,
+0002eb40: 206e 763d 312c 2076 616c 3d70 726f 702c   nv=1, val=prop,
+0002eb50: 2076 6172 6e61 6d65 3d70 726f 7065 7274   varname=propert
+0002eb60: 7929 0d0a 0d0a 2020 2020 2020 2020 6966  y)....        if
+0002eb70: 2073 6c69 6365 7820 6973 206e 6f74 204e   slicex is not N
+0002eb80: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+0002eb90: 2020 736c 6963 6578 3d6e 702e 6172 7261    slicex=np.arra
+0002eba0: 7928 736c 6963 6578 290d 0a20 2020 2020  y(slicex)..     
+0002ebb0: 2020 2020 2020 2073 6c69 6365 785b 736c         slicex[sl
+0002ebc0: 6963 6578 3c30 5d3d 300d 0a20 2020 2020  icex<0]=0..     
+0002ebd0: 2020 2020 2020 2073 6c69 6365 785b 736c         slicex[sl
+0002ebe0: 6963 6578 3e31 5d3d 310d 0a20 2020 2020  icex>1]=1..     
+0002ebf0: 2020 2020 2020 2063 783d 696d 2e6f 7820         cx=im.ox 
+0002ec00: 2b20 736c 6963 6578 202a 2069 6d2e 6e78  + slicex * im.nx
+0002ec10: 202a 2069 6d2e 7378 2020 2320 6365 6e74   * im.sx  # cent
+0002ec20: 6572 2061 6c6f 6e67 2078 0d0a 2020 2020  er along x..    
+0002ec30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0002ec40: 2020 2020 2020 2063 783d 4e6f 6e65 0d0a         cx=None..
+0002ec50: 2020 2020 2020 2020 6966 2073 6c69 6365          if slice
+0002ec60: 7920 6973 206e 6f74 204e 6f6e 653a 0d0a  y is not None:..
+0002ec70: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+0002ec80: 6579 3d6e 702e 6172 7261 7928 736c 6963  ey=np.array(slic
+0002ec90: 6579 290d 0a20 2020 2020 2020 2020 2020  ey)..           
+0002eca0: 2073 6c69 6365 795b 736c 6963 6579 3c30   slicey[slicey<0
+0002ecb0: 5d3d 300d 0a20 2020 2020 2020 2020 2020  ]=0..           
+0002ecc0: 2073 6c69 6365 795b 736c 6963 6579 3e31   slicey[slicey>1
+0002ecd0: 5d3d 310d 0a20 2020 2020 2020 2020 2020  ]=1..           
+0002ece0: 2063 793d 696d 2e6f 7920 2b20 736c 6963   cy=im.oy + slic
+0002ecf0: 6579 202a 2069 6d2e 6e79 202a 2069 6d2e  ey * im.ny * im.
+0002ed00: 7379 2020 2320 6365 6e74 6572 2061 6c6f  sy  # center alo
+0002ed10: 6e67 2079 0d0a 2020 2020 2020 2020 656c  ng y..        el
+0002ed20: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0002ed30: 2063 793d 4e6f 6e65 0d0a 2020 2020 2020   cy=None..      
+0002ed40: 2020 6966 2073 6c69 6365 7a20 6973 206e    if slicez is n
+0002ed50: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0002ed60: 2020 2020 2020 736c 6963 657a 3d6e 702e        slicez=np.
+0002ed70: 6172 7261 7928 736c 6963 657a 290d 0a20  array(slicez).. 
+0002ed80: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+0002ed90: 7a5b 736c 6963 657a 3c30 5d3d 300d 0a20  z[slicez<0]=0.. 
+0002eda0: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+0002edb0: 7a5b 736c 6963 657a 3e31 5d3d 310d 0a20  z[slicez>1]=1.. 
+0002edc0: 2020 2020 2020 2020 2020 2063 7a3d 696d             cz=im
+0002edd0: 2e6f 7a20 2b20 736c 6963 657a 202a 2069  .oz + slicez * i
+0002ede0: 6d2e 6e7a 202a 2069 6d2e 737a 2020 2320  m.nz * im.sz  # 
+0002edf0: 6365 6e74 6572 2061 6c6f 6e67 207a 0d0a  center along z..
+0002ee00: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0002ee10: 2020 2020 2020 2020 2020 2063 7a3d 4e6f             cz=No
+0002ee20: 6e65 0d0a 0d0a 2020 2020 2020 2020 6966  ne....        if
+0002ee30: 2073 6c69 6365 7820 6973 206e 6f74 204e   slicex is not N
+0002ee40: 6f6e 6520 6f72 2073 6c69 6365 7920 6973  one or slicey is
+0002ee50: 206e 6f74 204e 6f6e 6520 6f72 2073 6c69   not None or sli
+0002ee60: 6365 7a20 6973 206e 6f74 204e 6f6e 653a  cez is not None:
+0002ee70: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
+0002ee80: 6770 6c74 332e 6472 6177 496d 6167 6533  gplt3.drawImage3
+0002ee90: 445f 736c 6963 6528 696d 2c20 706c 6f74  D_slice(im, plot
+0002eea0: 7465 723d 702c 2073 6c69 6365 5f6e 6f72  ter=p, slice_nor
+0002eeb0: 6d61 6c5f 783d 6378 2c20 736c 6963 655f  mal_x=cx, slice_
+0002eec0: 6e6f 726d 616c 5f79 3d63 792c 2073 6c69  normal_y=cy, sli
+0002eed0: 6365 5f6e 6f72 6d61 6c5f 7a3d 637a 2c20  ce_normal_z=cz, 
+0002eee0: 636d 696e 3d63 6d69 6e2c 2063 6d61 783d  cmin=cmin, cmax=
+0002eef0: 636d 6178 2c0d 0a20 2020 2020 2020 2020  cmax,..         
+0002ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef10: 2020 2020 2020 2020 2020 2020 7363 616c              scal
+0002ef20: 6172 5f62 6172 5f6b 7761 7267 733d 7363  ar_bar_kwargs=sc
+0002ef30: 616c 6172 5f62 6172 5f6b 7761 7267 732c  alar_bar_kwargs,
+0002ef40: 202a 2a6b 7761 7267 7329 0d0a 2020 2020   **kwargs)..    
+0002ef50: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0002ef60: 2020 2020 2020 2069 6d67 706c 7433 2e64         imgplt3.d
+0002ef70: 7261 7749 6d61 6765 3344 5f73 7572 6661  rawImage3D_surfa
+0002ef80: 6365 2869 6d2c 2070 6c6f 7474 6572 3d70  ce(im, plotter=p
+0002ef90: 2c20 636d 696e 3d63 6d69 6e2c 2063 6d61  , cmin=cmin, cma
+0002efa0: 783d 636d 6178 2c0d 0a20 2020 2020 2020  x=cmax,..       
+0002efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002efc0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0002efd0: 616c 6172 5f62 6172 5f6b 7761 7267 733d  alar_bar_kwargs=
+0002efe0: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
+0002eff0: 732c 202a 2a6b 7761 7267 7329 0d0a 0d0a  s, **kwargs)....
+0002f000: 2020 2020 2020 2020 6966 2070 6c6f 7474          if plott
+0002f010: 6572 2069 7320 4e6f 6e65 3a0d 0a20 2020  er is None:..   
+0002f020: 2020 2020 2020 2020 2070 2e61 6464 5f62           p.add_b
+0002f030: 6f75 6e64 696e 675f 626f 7828 290d 0a20  ounding_box().. 
+0002f040: 2020 2020 2020 2020 2020 2070 2e73 686f             p.sho
+0002f050: 775f 6178 6573 2829 0d0a 2020 2020 2020  w_axes()..      
+0002f060: 2020 2020 2020 702e 7368 6f77 2829 0d0a        p.show()..
+0002f070: 0d0a 0d0a 2020 2020 6465 6620 706c 6f74  ....    def plot
+0002f080: 5f6d 6561 6e5f 7072 6f70 2873 656c 662c  _mean_prop(self,
+0002f090: 2070 726f 7065 7274 792c 2074 7970 653d   property, type=
+0002f0a0: 2261 7269 7468 6d65 7469 6322 2c20 765f  "arithmetic", v_
+0002f0b0: 6578 3d31 2c20 696e 7369 6465 5f75 6e69  ex=1, inside_uni
+0002f0c0: 7473 3d4e 6f6e 652c 2069 6e73 6964 655f  ts=None, inside_
+0002f0d0: 6661 6369 6573 3d4e 6f6e 652c 2066 696c  facies=None, fil
+0002f0e0: 7465 7269 6e67 5f69 6e74 6572 7661 6c3d  tering_interval=
+0002f0f0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+0002f100: 2020 2020 2020 2020 2020 2070 6c6f 7474             plott
+0002f110: 6572 3d4e 6f6e 652c 2073 6c69 6365 783d  er=None, slicex=
+0002f120: 4e6f 6e65 2c20 736c 6963 6579 3d4e 6f6e  None, slicey=Non
+0002f130: 652c 2073 6c69 6365 7a3d 4e6f 6e65 2c20  e, slicez=None, 
+0002f140: 636d 696e 3d4e 6f6e 652c 2063 6d61 783d  cmin=None, cmax=
+0002f150: 4e6f 6e65 2c20 7363 616c 6172 5f62 6172  None, scalar_bar
+0002f160: 5f6b 7761 7267 733d 4e6f 6e65 2c20 2a2a  _kwargs=None, **
+0002f170: 6b77 6172 6773 293a 0d0a 0d0a 2020 2020  kwargs):....    
+0002f180: 2020 2020 2354 4f20 444f 202d 2d3e 2074      #TO DO --> t
+0002f190: 6f20 6f70 7469 6d69 7a65 0d0a 2020 2020  o optimize..    
+0002f1a0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0002f1b0: 2046 756e 6374 696f 6e20 7468 6174 2070   Function that p
+0002f1c0: 6c6f 7473 2074 6865 2061 7269 7468 6d65  lots the arithme
+0002f1d0: 7469 6320 6d65 616e 206f 6620 6120 7072  tic mean of a pr
+0002f1e0: 6f70 6572 7479 2061 7420 6576 6572 7920  operty at every 
+0002f1f0: 6365 6c6c 730d 0a20 2020 2020 2020 206f  cells..        o
+0002f200: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
+0002f210: 2064 6f6d 6169 6e20 6769 7665 6e20 616c   domain given al
+0002f220: 6c20 7468 6520 7072 6f70 6572 7479 2073  l the property s
+0002f230: 696d 756c 6174 696f 6e73 0d0a 0d0a 2020  imulations....  
+0002f240: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0002f250: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0002f260: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7072  ----..        pr
+0002f270: 6f70 6572 7479 3a20 7374 7269 6e67 0d0a  operty: string..
+0002f280: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0002f290: 206f 6620 7468 6520 7072 6f70 6572 7479   of the property
+0002f2a0: 2074 6f20 706c 6f74 0d0a 2020 2020 2020   to plot..      
+0002f2b0: 2020 7479 7065 3a20 7374 7269 6e67 0d0a    type: string..
+0002f2c0: 2020 2020 2020 2020 2020 2020 7479 7065              type
+0002f2d0: 206f 6620 6d65 616e 2074 6f20 706c 6f74   of mean to plot
+0002f2e0: 3a0d 0a20 2020 2020 2020 2020 2020 202d  :..            -
+0002f2f0: 2022 6172 6974 686d 6574 6963 2220 666f   "arithmetic" fo
+0002f300: 7220 6172 6974 686d 6574 6963 206d 6561  r arithmetic mea
+0002f310: 6e0d 0a20 2020 2020 2020 2020 2020 202d  n..            -
+0002f320: 2022 7374 6422 2066 6f72 2073 7461 6e64   "std" for stand
+0002f330: 6172 6420 6465 7669 6174 696f 6e0d 0a20  ard deviation.. 
+0002f340: 2020 2020 2020 2020 2020 202d 2022 6d65             - "me
+0002f350: 6469 616e 2220 666f 7220 6d65 6469 616e  dian" for median
+0002f360: 2076 616c 7565 0d0a 2020 2020 2020 2020   value..        
+0002f370: 765f 6578 3a20 666c 6f61 740d 0a20 2020  v_ex: float..   
+0002f380: 2020 2020 2020 2020 2076 6572 7469 6361           vertica
+0002f390: 6c20 6578 6167 6765 7261 7469 6f6e 0d0a  l exaggeration..
+0002f3a0: 2020 2020 2020 2020 696e 7369 6465 5f75          inside_u
+0002f3b0: 6e69 7473 3a20 6c69 7374 206f 6620 7374  nits: list of st
+0002f3c0: 7269 6e67 206f 7220 3a63 6c61 7373 3a60  ring or :class:`
+0002f3d0: 556e 6974 6020 6f62 6a65 6374 730d 0a20  Unit` objects.. 
+0002f3e0: 2020 2020 2020 2020 2020 206c 6973 7420             list 
+0002f3f0: 6f66 2075 6e69 7473 2074 6f20 636f 6e73  of units to cons
+0002f400: 6964 6572 2066 6f72 2074 6865 206d 6561  ider for the mea
+0002f410: 6e0d 0a20 2020 2020 2020 2020 2020 2022  n..            "
+0002f420: 7374 6422 2066 6f72 2073 7461 6e64 6172  std" for standar
+0002f430: 6420 6465 7669 6174 696f 6e2c 2022 6d65  d deviation, "me
+0002f440: 6469 616e 2220 666f 7220 6d65 6469 616e  dian" for median
+0002f450: 2076 616c 7565 0d0a 2020 2020 2020 2020   value..        
+0002f460: 696e 7369 6465 5f66 6163 6965 733a 206c  inside_facies: l
+0002f470: 6973 7420 6f66 2073 7472 696e 6720 6f72  ist of string or
+0002f480: 203a 636c 6173 733a 6046 6163 6965 7360   :class:`Facies`
+0002f490: 206f 626a 6563 7473 0d0a 2020 2020 2020   objects..      
+0002f4a0: 2020 2020 2020 6c69 7374 206f 6620 6661        list of fa
+0002f4b0: 6369 6573 2074 6f20 636f 6e73 6964 6572  cies to consider
+0002f4c0: 2066 6f72 2074 6865 206d 6561 6e0d 0a20   for the mean.. 
+0002f4d0: 2020 2020 2020 2066 696c 7465 7269 6e67         filtering
+0002f4e0: 5f69 6e74 6572 7661 6c3a 206c 6973 7420  _interval: list 
+0002f4f0: 6f66 2074 776f 2066 6c6f 6174 730d 0a20  of two floats.. 
+0002f500: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+0002f510: 7661 6c20 6f66 2076 616c 7565 7320 746f  val of values to
+0002f520: 206b 6565 700d 0a20 2020 2020 2020 2070   keep..        p
+0002f530: 6c6f 7474 6572 3a20 7079 7669 7374 612e  lotter: pyvista.
+0002f540: 506c 6f74 7465 720d 0a20 2020 2020 2020  Plotter..       
+0002f550: 2020 2020 2070 7976 6973 7461 2070 6c6f       pyvista plo
+0002f560: 7474 6572 2074 6f20 706c 6f74 206f 6e0d  tter to plot on.
+0002f570: 0a20 2020 2020 2020 2073 6c69 6365 783a  .        slicex:
+0002f580: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
+0002f590: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
+0002f5a0: 2020 2020 2020 2020 2020 6672 6163 7469            fracti
+0002f5b0: 6f6e 206f 6620 7468 6520 7820 6178 6973  on of the x axis
+0002f5c0: 2074 6f20 706c 6f74 0d0a 2020 2020 2020   to plot..      
+0002f5d0: 2020 736c 6963 6579 3a20 666c 6f61 7420    slicey: float 
+0002f5e0: 6f72 2073 6571 7565 6e63 6520 6f66 2066  or sequence of f
+0002f5f0: 6c6f 6174 730d 0a20 2020 2020 2020 2020  loats..         
+0002f600: 2020 2066 7261 6374 696f 6e20 6f66 2074     fraction of t
+0002f610: 6865 2079 2061 7869 7320 746f 2070 6c6f  he y axis to plo
+0002f620: 740d 0a20 2020 2020 2020 2073 6c69 6365  t..        slice
+0002f630: 7a3a 2066 6c6f 6174 206f 7220 7365 7175  z: float or sequ
+0002f640: 656e 6365 206f 6620 666c 6f61 7473 0d0a  ence of floats..
+0002f650: 2020 2020 2020 2020 2020 2020 6672 6163              frac
+0002f660: 7469 6f6e 206f 6620 7468 6520 7a20 6178  tion of the z ax
+0002f670: 6973 2074 6f20 706c 6f74 0d0a 2020 2020  is to plot..    
+0002f680: 2020 2020 636d 696e 3a20 666c 6f61 740d      cmin: float.
+0002f690: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
+0002f6a0: 696d 756d 2076 616c 7565 2066 6f72 2074  imum value for t
+0002f6b0: 6865 2063 6f6c 6f72 6261 720d 0a20 2020  he colorbar..   
+0002f6c0: 2020 2020 2063 6d61 783a 2066 6c6f 6174       cmax: float
+0002f6d0: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+0002f6e0: 7869 6d75 6d20 7661 6c75 6520 666f 7220  ximum value for 
+0002f6f0: 7468 6520 636f 6c6f 7262 6172 0d0a 2020  the colorbar..  
+0002f700: 2020 2020 2020 7363 616c 6172 5f62 6172        scalar_bar
+0002f710: 5f6b 7761 7267 733a 2064 6963 740d 0a20  _kwargs: dict.. 
+0002f720: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
+0002f730: 6f6e 6172 7920 6f66 2061 7267 756d 656e  onary of argumen
+0002f740: 7473 2074 6f20 7061 7373 2074 6f20 7468  ts to pass to th
+0002f750: 6520 7079 7669 7374 6120 7363 616c 6172  e pyvista scalar
+0002f760: 2062 6172 0d0a 0d0a 2020 2020 2020 2020   bar....        
+0002f770: 2222 220d 0a0d 0a20 2020 2020 2020 2023  """....        #
+0002f780: 6c6f 6164 2070 726f 7065 7274 7920 6172  load property ar
+0002f790: 7261 7920 616e 6420 6661 6369 6573 2061  ray and facies a
+0002f7a0: 7272 6179 0d0a 2020 2020 2020 2020 7072  rray..        pr
+0002f7b0: 6f70 3d73 656c 662e 6765 7470 726f 7028  op=self.getprop(
+0002f7c0: 7072 6f70 6572 7479 2920 2023 2074 6f20  property)  # to 
+0002f7d0: 6d6f 6469 6679 0d0a 2020 2020 2020 2020  modify..        
+0002f7e0: 7072 6f70 5f73 6861 7065 3d70 726f 702e  prop_shape=prop.
+0002f7f0: 7368 6170 650d 0a20 2020 2020 2020 2066  shape..        f
+0002f800: 6163 6965 733d 7365 6c66 2e67 6574 5f66  acies=self.get_f
+0002f810: 6163 6965 7328 290d 0a20 2020 2020 2020  acies()..       
+0002f820: 2066 6163 6965 735f 7368 6170 653d 6661   facies_shape=fa
+0002f830: 6369 6573 2e73 6861 7065 0d0a 0d0a 2020  cies.shape....  
+0002f840: 2020 2020 2020 236b 6565 7020 7661 6c75        #keep valu
+0002f850: 6573 2069 6e20 6f6e 6c79 2077 616e 7465  es in only wante
+0002f860: 6420 756e 6974 730d 0a20 2020 2020 2020  d units..       
+0002f870: 2069 6620 696e 7369 6465 5f75 6e69 7473   if inside_units
+0002f880: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+0002f890: 2020 2020 2020 2020 2020 206e 7265 616c             nreal
+0002f8a0: 5f75 6e69 7473 3d73 656c 662e 6e72 6561  _units=self.nrea
+0002f8b0: 6c5f 756e 6974 7320 2023 206e 756d 6265  l_units  # numbe
+0002f8c0: 7220 6f66 2075 6e69 7473 2072 6561 6c0d  r of units real.
+0002f8d0: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+0002f8e0: 6b5f 616c 6c3d 6e70 2e7a 6572 6f73 2870  k_all=np.zeros(p
+0002f8f0: 726f 705f 7368 6170 6529 0d0a 2020 2020  rop_shape)..    
+0002f900: 2020 2020 2020 2020 666f 7220 6975 2069          for iu i
+0002f910: 6e20 7261 6e67 6528 6e72 6561 6c5f 756e  n range(nreal_un
+0002f920: 6974 7329 3a0d 0a20 2020 2020 2020 2020  its):..         
+0002f930: 2020 2020 2020 2066 6f72 2075 2069 6e20         for u in 
+0002f940: 696e 7369 6465 5f75 6e69 7473 3a0d 0a20  inside_units:.. 
+0002f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f960: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002f970: 2875 2c20 7374 7229 3a0d 0a20 2020 2020  (u, str):..     
 0002f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f990: 2063 6d69 6e3d 636d 696e 2c20 636d 6178   cmin=cmin, cmax
-0002f9a0: 3d63 6d61 782c 2066 696c 7465 7269 6e67  =cmax, filtering
-0002f9b0: 5f69 6e74 6572 7661 6c3d 6669 6c74 6572  _interval=filter
-0002f9c0: 696e 675f 696e 7465 7276 616c 2c20 6669  ing_interval, fi
-0002f9d0: 6c74 6572 696e 675f 7661 6c75 653d 4e6f  ltering_value=No
-0002f9e0: 6e65 2c20 7363 616c 6172 5f62 6172 5f6b  ne, scalar_bar_k
-0002f9f0: 7761 7267 733d 7363 616c 6172 5f62 6172  wargs=scalar_bar
-0002fa00: 5f6b 7761 7267 7329 0d0a 0d0a 0d0a 2020  _kwargs)......  
-0002fa10: 2020 6465 6620 706c 6f74 5f61 7272 2873    def plot_arr(s
-0002fa20: 656c 662c 6172 722c 7661 725f 6e61 6d65  elf,arr,var_name
-0002fa30: 203d 2256 3022 2c76 5f65 783d 312c 2070   ="V0",v_ex=1, p
-0002fa40: 6c6f 7474 6572 3d4e 6f6e 652c 2073 6c69  lotter=None, sli
-0002fa50: 6365 783d 4e6f 6e65 2c20 736c 6963 6579  cex=None, slicey
-0002fa60: 3d4e 6f6e 652c 2073 6c69 6365 7a3d 4e6f  =None, slicez=No
-0002fa70: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-0002fa80: 2020 2020 2020 636d 696e 3d4e 6f6e 652c        cmin=None,
-0002fa90: 2063 6d61 783d 4e6f 6e65 2c20 6669 6c74   cmax=None, filt
-0002faa0: 6572 696e 675f 696e 7465 7276 616c 3d4e  ering_interval=N
-0002fab0: 6f6e 652c 2066 696c 7465 7269 6e67 5f76  one, filtering_v
-0002fac0: 616c 7565 3d4e 6f6e 652c 2073 6361 6c61  alue=None, scala
-0002fad0: 725f 6261 725f 6b77 6172 6773 3d4e 6f6e  r_bar_kwargs=Non
-0002fae0: 6529 3a0d 0a0d 0a20 2020 2020 2020 2022  e):....        "
-0002faf0: 2222 0d0a 2020 2020 2020 2020 5468 6973  ""..        This
-0002fb00: 2066 756e 6374 696f 6e20 706c 6f74 2061   function plot a
-0002fb10: 2033 4420 6172 7261 7920 7769 7468 2074   3D array with t
-0002fb20: 6865 2073 616d 6520 7369 7a65 206f 6620  he same size of 
-0002fb30: 7468 6520 7369 6d75 6c61 7469 6f6e 2064  the simulation d
-0002fb40: 6f6d 6169 6e0d 0a0d 0a20 2020 2020 2020  omain....       
-0002fb50: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0002fb60: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0002fb70: 0a20 2020 2020 2020 2061 7272 3a20 3344  .        arr: 3D
-0002fb80: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
-0002fb90: 2020 2020 6172 7261 7920 746f 2070 6c6f      array to plo
-0002fba0: 742e 2053 697a 6520 6f66 2074 6865 2073  t. Size of the s
-0002fbb0: 696d 756c 6174 696f 6e20 646f 6d61 696e  imulation domain
-0002fbc0: 2028 6e78 2c20 6e79 2c20 6e7a 2920 2020   (nx, ny, nz)   
-0002fbd0: 0d0a 2020 2020 2020 2020 7661 725f 6e61  ..        var_na
-0002fbe0: 6d65 3a20 7374 720d 0a20 2020 2020 2020  me: str..       
-0002fbf0: 2020 2020 2076 6172 6961 626c 6520 6e61       variable na
-0002fc00: 6d65 7320 746f 2070 6c6f 7420 616e 6420  mes to plot and 
-0002fc10: 746f 2073 686f 7720 696e 2074 6865 2070  to show in the p
-0002fc20: 7976 6973 7461 2070 6c6f 740d 0a20 2020  yvista plot..   
-0002fc30: 2020 2020 2076 5f65 783a 2066 6c6f 6174       v_ex: float
-0002fc40: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
-0002fc50: 7274 6963 616c 2065 7861 6767 6572 6174  rtical exaggerat
-0002fc60: 696f 6e0d 0a20 2020 2020 2020 2070 6c6f  ion..        plo
-0002fc70: 7474 6572 3a20 7079 7669 7374 612e 506c  tter: pyvista.Pl
-0002fc80: 6f74 7465 720d 0a20 2020 2020 2020 2020  otter..         
-0002fc90: 2020 2070 7976 6973 7461 2070 6c6f 7474     pyvista plott
-0002fca0: 6572 2074 6f20 706c 6f74 206f 6e0d 0a20  er to plot on.. 
-0002fcb0: 2020 2020 2020 2073 6c69 6365 783a 2066         slicex: f
-0002fcc0: 6c6f 6174 206f 7220 7365 7175 656e 6365  loat or sequence
-0002fcd0: 206f 6620 666c 6f61 7473 0d0a 2020 2020   of floats..    
-0002fce0: 2020 2020 2020 2020 6672 6163 7469 6f6e          fraction
-0002fcf0: 206f 6620 7468 6520 7820 6178 6973 2074   of the x axis t
-0002fd00: 6f20 706c 6f74 0d0a 2020 2020 2020 2020  o plot..        
-0002fd10: 736c 6963 6579 3a20 666c 6f61 7420 6f72  slicey: float or
-0002fd20: 2073 6571 7565 6e63 6520 6f66 2066 6c6f   sequence of flo
-0002fd30: 6174 730d 0a20 2020 2020 2020 2020 2020  ats..           
-0002fd40: 2066 7261 6374 696f 6e20 6f66 2074 6865   fraction of the
-0002fd50: 2079 2061 7869 7320 746f 2070 6c6f 740d   y axis to plot.
-0002fd60: 0a20 2020 2020 2020 2073 6c69 6365 7a3a  .        slicez:
-0002fd70: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
-0002fd80: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
-0002fd90: 2020 2020 2020 2020 2020 6672 6163 7469            fracti
-0002fda0: 6f6e 206f 6620 7468 6520 7a20 6178 6973  on of the z axis
-0002fdb0: 2074 6f20 706c 6f74 0d0a 2020 2020 2020   to plot..      
-0002fdc0: 2020 636d 696e 3a20 666c 6f61 740d 0a20    cmin: float.. 
-0002fdd0: 2020 2020 2020 2020 2020 206d 696e 696d             minim
-0002fde0: 756d 2076 616c 7565 2066 6f72 2074 6865  um value for the
-0002fdf0: 2063 6f6c 6f72 6261 720d 0a20 2020 2020   colorbar..     
-0002fe00: 2020 2063 6d61 783a 2066 6c6f 6174 0d0a     cmax: float..
-0002fe10: 2020 2020 2020 2020 2020 2020 6d61 7869              maxi
-0002fe20: 6d75 6d20 7661 6c75 6520 666f 7220 7468  mum value for th
-0002fe30: 6520 636f 6c6f 7262 6172 0d0a 2020 2020  e colorbar..    
-0002fe40: 2020 2020 6669 6c74 6572 696e 675f 696e      filtering_in
-0002fe50: 7465 7276 616c 3a20 666c 6f61 740d 0a20  terval: float.. 
-0002fe60: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-0002fe70: 7661 6c20 7661 6c75 6573 2074 6f20 6669  val values to fi
-0002fe80: 6c74 6572 2074 6865 2064 6174 6120 746f  lter the data to
-0002fe90: 2073 686f 770d 0a20 2020 2020 2020 2066   show..        f
-0002fea0: 696c 7465 7269 6e67 5f76 616c 7565 3a20  iltering_value: 
-0002feb0: 666c 6f61 740d 0a20 2020 2020 2020 2020  float..         
-0002fec0: 2020 2076 616c 7565 7320 746f 2066 696c     values to fil
-0002fed0: 7465 722e 204f 6e6c 7920 7468 6573 6520  ter. Only these 
-0002fee0: 7661 6c75 6573 2077 696c 6c20 6265 2073  values will be s
-0002fef0: 686f 776e 0d0a 2020 2020 2020 2020 7363  hown..        sc
-0002ff00: 616c 6172 5f62 6172 5f6b 7761 7267 733a  alar_bar_kwargs:
-0002ff10: 2064 6963 740d 0a20 2020 2020 2020 2020   dict..         
-0002ff20: 2020 2064 6963 7469 6f6e 6172 7920 6f66     dictionary of
-0002ff30: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
-0002ff40: 7373 2074 6f20 7468 6520 7079 7669 7374  ss to the pyvist
-0002ff50: 6120 7363 616c 6172 2062 6172 0d0a 0d0a  a scalar bar....
-0002ff60: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-0002ff70: 2020 2020 2020 206e 783d 7365 6c66 2e67         nx=self.g
-0002ff80: 6574 5f6e 7828 290d 0a20 2020 2020 2020  et_nx()..       
-0002ff90: 206e 793d 7365 6c66 2e67 6574 5f6e 7928   ny=self.get_ny(
-0002ffa0: 290d 0a20 2020 2020 2020 206e 7a3d 7365  )..        nz=se
-0002ffb0: 6c66 2e67 6574 5f6e 7a28 290d 0a20 2020  lf.get_nz()..   
-0002ffc0: 2020 2020 2073 783d 7365 6c66 2e67 6574       sx=self.get
-0002ffd0: 5f73 7828 290d 0a20 2020 2020 2020 2073  _sx()..        s
-0002ffe0: 793d 7365 6c66 2e67 6574 5f73 7928 290d  y=self.get_sy().
-0002fff0: 0a20 2020 2020 2020 2073 7a3d 7365 6c66  .        sz=self
-00030000: 2e67 6574 5f73 7a28 290d 0a20 2020 2020  .get_sz()..     
-00030010: 2020 2078 303d 7365 6c66 2e67 6574 5f6f     x0=self.get_o
-00030020: 7828 290d 0a20 2020 2020 2020 2079 303d  x()..        y0=
-00030030: 7365 6c66 2e67 6574 5f6f 7928 290d 0a20  self.get_oy().. 
-00030040: 2020 2020 2020 207a 303d 7365 6c66 2e67         z0=self.g
-00030050: 6574 5f6f 7a28 290d 0a0d 0a20 2020 2020  et_oz()....     
-00030060: 2020 2061 7373 6572 7420 6172 722e 7368     assert arr.sh
-00030070: 6170 6520 3d3d 2028 6e7a 2c20 6e79 2c20  ape == (nz, ny, 
-00030080: 6e78 292c 2022 496e 7661 6c69 6420 7368  nx), "Invalid sh
-00030090: 6170 6520 666f 7220 6172 7261 792c 206d  ape for array, m
-000300a0: 7573 7420 6265 2065 7175 616c 2074 6f20  ust be equal to 
-000300b0: 7b7d 222e 666f 726d 6174 286e 7a2c 206e  {}".format(nz, n
-000300c0: 792c 206e 7829 0d0a 0d0a 2020 2020 2020  y, nx)....      
-000300d0: 2020 6966 2070 6c6f 7474 6572 2069 7320    if plotter is 
-000300e0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-000300f0: 2020 2070 3d70 762e 506c 6f74 7465 7228     p=pv.Plotter(
-00030100: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00030110: 0d0a 2020 2020 2020 2020 2020 2020 703d  ..            p=
-00030120: 706c 6f74 7465 720d 0a20 2020 2020 2020  plotter..       
-00030130: 2069 6d3d 6765 6f6e 652e 696d 672e 496d   im=geone.img.Im
-00030140: 6728 6e78 2c20 6e79 2c20 6e7a 2c20 7378  g(nx, ny, nz, sx
-00030150: 2c20 7379 2c20 737a 2a76 5f65 782c 2078  , sy, sz*v_ex, x
-00030160: 302c 2079 302c 207a 302c 206e 763d 312c  0, y0, z0, nv=1,
-00030170: 2076 616c 3d61 7272 2c20 7661 726e 616d   val=arr, varnam
-00030180: 653d 7661 725f 6e61 6d65 290d 0a0d 0a20  e=var_name).... 
-00030190: 2020 2020 2020 2069 6620 736c 6963 6578         if slicex
-000301a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-000301b0: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-000301c0: 783d 6e70 2e61 7272 6179 2873 6c69 6365  x=np.array(slice
-000301d0: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
-000301e0: 736c 6963 6578 5b73 6c69 6365 783c 305d  slicex[slicex<0]
-000301f0: 3d30 0d0a 2020 2020 2020 2020 2020 2020  =0..            
-00030200: 736c 6963 6578 5b73 6c69 6365 783e 315d  slicex[slicex>1]
-00030210: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
-00030220: 6378 3d69 6d2e 6f78 202b 2073 6c69 6365  cx=im.ox + slice
-00030230: 7820 2a20 696d 2e6e 7820 2a20 696d 2e73  x * im.nx * im.s
-00030240: 7820 2023 2063 656e 7465 7220 616c 6f6e  x  # center alon
-00030250: 6720 780d 0a20 2020 2020 2020 2065 6c73  g x..        els
-00030260: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00030270: 6378 3d4e 6f6e 650d 0a20 2020 2020 2020  cx=None..       
-00030280: 2069 6620 736c 6963 6579 2069 7320 6e6f   if slicey is no
-00030290: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-000302a0: 2020 2020 2073 6c69 6365 793d 6e70 2e61       slicey=np.a
-000302b0: 7272 6179 2873 6c69 6365 7929 0d0a 2020  rray(slicey)..  
-000302c0: 2020 2020 2020 2020 2020 736c 6963 6579            slicey
-000302d0: 5b73 6c69 6365 793c 305d 3d30 0d0a 2020  [slicey<0]=0..  
-000302e0: 2020 2020 2020 2020 2020 736c 6963 6579            slicey
-000302f0: 5b73 6c69 6365 793e 315d 3d31 0d0a 2020  [slicey>1]=1..  
-00030300: 2020 2020 2020 2020 2020 6379 3d69 6d2e            cy=im.
-00030310: 6f79 202b 2073 6c69 6365 7920 2a20 696d  oy + slicey * im
-00030320: 2e6e 7920 2a20 696d 2e73 7920 2023 2063  .ny * im.sy  # c
-00030330: 656e 7465 7220 616c 6f6e 6720 790d 0a20  enter along y.. 
-00030340: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00030350: 2020 2020 2020 2020 2020 6379 3d4e 6f6e            cy=Non
-00030360: 650d 0a20 2020 2020 2020 2069 6620 736c  e..        if sl
-00030370: 6963 657a 2069 7320 6e6f 7420 4e6f 6e65  icez is not None
-00030380: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00030390: 6c69 6365 7a3d 6e70 2e61 7272 6179 2873  licez=np.array(s
-000303a0: 6c69 6365 7a29 0d0a 2020 2020 2020 2020  licez)..        
-000303b0: 2020 2020 736c 6963 657a 5b73 6c69 6365      slicez[slice
-000303c0: 7a3c 305d 3d30 0d0a 2020 2020 2020 2020  z<0]=0..        
-000303d0: 2020 2020 736c 6963 657a 5b73 6c69 6365      slicez[slice
-000303e0: 7a3e 315d 3d31 0d0a 2020 2020 2020 2020  z>1]=1..        
-000303f0: 2020 2020 637a 3d69 6d2e 6f7a 202b 2073      cz=im.oz + s
-00030400: 6c69 6365 7a20 2a20 696d 2e6e 7a20 2a20  licez * im.nz * 
-00030410: 696d 2e73 7a20 2023 2063 656e 7465 7220  im.sz  # center 
-00030420: 616c 6f6e 6720 7a0d 0a20 2020 2020 2020  along z..       
-00030430: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00030440: 2020 2020 637a 3d4e 6f6e 650d 0a0d 0a0d      cz=None.....
-00030450: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
-00030460: 6578 2069 7320 6e6f 7420 4e6f 6e65 206f  ex is not None o
-00030470: 7220 736c 6963 6579 2069 7320 6e6f 7420  r slicey is not 
-00030480: 4e6f 6e65 206f 7220 736c 6963 657a 2069  None or slicez i
-00030490: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-000304a0: 2020 2020 2020 2020 2069 6d67 706c 7433           imgplt3
-000304b0: 2e64 7261 7749 6d61 6765 3344 5f73 6c69  .drawImage3D_sli
-000304c0: 6365 2869 6d2c 2070 6c6f 7474 6572 3d70  ce(im, plotter=p
-000304d0: 2c20 736c 6963 655f 6e6f 726d 616c 5f78  , slice_normal_x
-000304e0: 3d63 782c 2073 6c69 6365 5f6e 6f72 6d61  =cx, slice_norma
-000304f0: 6c5f 793d 6379 2c20 736c 6963 655f 6e6f  l_y=cy, slice_no
-00030500: 726d 616c 5f7a 3d63 7a2c 2063 6d69 6e3d  rmal_z=cz, cmin=
-00030510: 636d 696e 2c20 636d 6178 3d63 6d61 782c  cmin, cmax=cmax,
-00030520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030540: 2020 2020 2020 6669 6c74 6572 696e 675f        filtering_
-00030550: 696e 7465 7276 616c 3d66 696c 7465 7269  interval=filteri
-00030560: 6e67 5f69 6e74 6572 7661 6c2c 2066 696c  ng_interval, fil
-00030570: 7465 7269 6e67 5f76 616c 7565 3d20 6669  tering_value= fi
-00030580: 6c74 6572 696e 675f 7661 6c75 652c 2073  ltering_value, s
-00030590: 6361 6c61 725f 6261 725f 6b77 6172 6773  calar_bar_kwargs
-000305a0: 3d73 6361 6c61 725f 6261 725f 6b77 6172  =scalar_bar_kwar
-000305b0: 6773 290d 0a20 2020 2020 2020 2065 6c73  gs)..        els
-000305c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000305d0: 696d 6770 6c74 332e 6472 6177 496d 6167  imgplt3.drawImag
-000305e0: 6533 445f 7375 7266 6163 6528 696d 2c20  e3D_surface(im, 
-000305f0: 706c 6f74 7465 723d 702c 2063 6d69 6e3d  plotter=p, cmin=
-00030600: 636d 696e 2c20 636d 6178 3d63 6d61 782c  cmin, cmax=cmax,
-00030610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030630: 2020 2020 2020 6669 6c74 6572 696e 675f        filtering_
-00030640: 696e 7465 7276 616c 3d66 696c 7465 7269  interval=filteri
-00030650: 6e67 5f69 6e74 6572 7661 6c2c 2066 696c  ng_interval, fil
-00030660: 7465 7269 6e67 5f76 616c 7565 3d20 6669  tering_value= fi
-00030670: 6c74 6572 696e 675f 7661 6c75 652c 2073  ltering_value, s
-00030680: 6361 6c61 725f 6261 725f 6b77 6172 6773  calar_bar_kwargs
-00030690: 3d73 6361 6c61 725f 6261 725f 6b77 6172  =scalar_bar_kwar
-000306a0: 6773 290d 0a0d 0a20 2020 2020 2020 2069  gs)....        i
-000306b0: 6620 706c 6f74 7465 7220 6973 204e 6f6e  f plotter is Non
-000306c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000306d0: 702e 6164 645f 626f 756e 6469 6e67 5f62  p.add_bounding_b
-000306e0: 6f78 2829 0d0a 2020 2020 2020 2020 2020  ox()..          
-000306f0: 2020 702e 7368 6f77 5f61 7865 7328 290d    p.show_axes().
-00030700: 0a20 2020 2020 2020 2020 2020 2070 2e73  .            p.s
-00030710: 686f 7728 290d 0a0d 0a0d 0a20 2020 2023  how()......    #
-00030720: 6372 6f73 7320 7365 6374 696f 6e73 0d0a  cross sections..
-00030730: 2020 2020 6465 6620 6472 6177 5f63 726f      def draw_cro
-00030740: 7373 5f73 6563 7469 6f6e 2873 656c 662c  ss_section(self,
-00030750: 2062 6163 6b67 726f 756e 643d 2275 6e69   background="uni
-00030760: 7473 222c 2069 753d 302c 2069 6661 3d30  ts", iu=0, ifa=0
-00030770: 2c20 2a2a 6b77 6172 6773 293a 0d0a 0d0a  , **kwargs):....
-00030780: 2020 2020 2020 2020 6578 7465 6e74 2020          extent  
-00030790: 3d20 5b73 656c 662e 6765 745f 6f78 2829  = [self.get_ox()
-000307a0: 2c20 7365 6c66 2e67 6574 5f78 6728 295b  , self.get_xg()[
-000307b0: 2d31 5d2c 2073 656c 662e 6765 745f 6f79  -1], self.get_oy
-000307c0: 2829 2c20 7365 6c66 2e67 6574 5f79 6728  (), self.get_yg(
-000307d0: 295b 2d31 5d5d 0d0a 0d0a 2020 2020 2020  )[-1]]....      
-000307e0: 2020 6966 2062 6163 6b67 726f 756e 6420    if background 
-000307f0: 3d3d 2022 756e 6974 7322 3a20 2023 2061  == "units":  # a
-00030800: 6464 206f 7074 696f 6e20 746f 2070 6173  dd option to pas
-00030810: 7320 7261 7374 6572 730d 0a20 2020 2020  s rasters..     
-00030820: 2020 2020 2020 2062 6163 6b5f 6d61 7020         back_map 
-00030830: 3d20 7365 6c66 2e63 6f6d 7075 7465 5f67  = self.compute_g
-00030840: 656f 6c5f 6d61 7028 302c 2063 6f6c 6f72  eol_map(0, color
-00030850: 203d 2054 7275 6529 0d0a 2020 2020 2020   = True)..      
-00030860: 2020 2020 2020 706c 742e 696d 7368 6f77        plt.imshow
-00030870: 2862 6163 6b5f 6d61 702c 206f 7269 6769  (back_map, origi
-00030880: 6e3d 226c 6f77 6572 222c 2065 7874 656e  n="lower", exten
-00030890: 743d 6578 7465 6e74 290d 0a0d 0a20 2020  t=extent)....   
-000308a0: 2020 2020 2065 6c73 653a 2020 0d0a 2020       else:  ..  
-000308b0: 2020 2020 2020 2020 2020 7061 7373 0d0a            pass..
-000308c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000308d0: 2020 705f 6c69 7374 203d 2070 6c74 2e67    p_list = plt.g
-000308e0: 696e 7075 7428 6e3d 2d31 2c20 7469 6d65  input(n=-1, time
-000308f0: 6f75 743d 3029 0d0a 2020 2020 2020 2020  out=0)..        
-00030900: 706c 742e 636c 6f73 6528 290d 0a0d 0a20  plt.close().... 
-00030910: 2020 2020 2020 2023 2320 6472 6177 2063         ## draw c
-00030920: 726f 7373 2d73 6563 7469 6f6e 2070 6f73  ross-section pos
-00030930: 6974 696f 6e0d 0a20 2020 2020 2020 2070  ition..        p
-00030940: 6c74 2e69 6d73 686f 7728 6261 636b 5f6d  lt.imshow(back_m
-00030950: 6170 2c20 6f72 6967 696e 3d22 6c6f 7765  ap, origin="lowe
-00030960: 7222 2c20 6578 7465 6e74 3d65 7874 656e  r", extent=exten
-00030970: 7429 0d0a 2020 2020 2020 2020 706c 742e  t)..        plt.
-00030980: 706c 6f74 285b 695b 305d 2066 6f72 2069  plot([i[0] for i
-00030990: 2069 6e20 705f 6c69 7374 5d2c 205b 695b   in p_list], [i[
-000309a0: 315d 2066 6f72 2069 2069 6e20 705f 6c69  1] for i in p_li
-000309b0: 7374 5d2c 2063 3d22 7265 6422 290d 0a20  st], c="red").. 
-000309c0: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
-000309d0: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
-000309e0: 7572 6e20 705f 6c69 7374 0d0a 0d0a 0d0a  urn p_list......
-000309f0: 2020 2020 6465 6620 6372 6f73 735f 7365      def cross_se
-00030a00: 6374 696f 6e28 7365 6c66 2c20 6172 725f  ction(self, arr_
-00030a10: 746f 5f70 6c6f 742c 2070 5f6c 6973 742c  to_plot, p_list,
-00030a20: 2065 7370 3d4e 6f6e 6529 3a0d 0a0d 0a20   esp=None):.... 
-00030a30: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00030a40: 2020 2020 5265 7475 726e 2061 2063 726f      Return a cro
-00030a50: 7373 2073 6563 7469 6f6e 2061 6c6f 6e67  ss section along
-00030a60: 2074 6865 2070 6f69 6e74 7320 7061 7373   the points pass
-00030a70: 2069 6e20 705f 6c69 7374 0d0a 0d0a 2020   in p_list....  
-00030a80: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00030a90: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00030aa0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
-00030ab0: 725f 746f 5f70 6c6f 743a 2033 4420 6f72  r_to_plot: 3D or
-00030ac0: 2034 4420 6172 7261 7920 6f66 2064 696d   4D array of dim
-00030ad0: 656e 7369 6f6e 206e 7a2c 206e 792c 206e  ension nz, ny, n
-00030ae0: 7828 2c20 3429 0d0a 2020 2020 2020 2020  x(, 4)..        
-00030af0: 2020 2020 6172 7261 7920 6f66 2077 6869      array of whi
-00030b00: 6368 2077 6520 7761 6e74 2061 2063 726f  ch we want a cro
-00030b10: 7373 2073 6563 7469 6f6e 2e0d 0a20 2020  ss section...   
-00030b20: 2020 2020 2020 2020 2054 6869 7320 6172           This ar
-00030b30: 7261 7920 7769 6c6c 2062 6520 636f 6e73  ray will be cons
-00030b40: 6964 6572 6564 2062 6569 6e67 2070 6172  idered being par
-00030b50: 7420 6f66 2074 6865 2041 7263 6850 7920  t of the ArchPy 
-00030b60: 7369 6d75 6c61 7469 6f6e 2064 6f6d 6169  simulation domai
-00030b70: 6e2e 0d0a 2020 2020 2020 2020 705f 6c69  n...        p_li
-00030b80: 7374 3a20 7365 7175 656e 6365 206f 6620  st: sequence of 
-00030b90: 7475 706c 650d 0a20 2020 2020 2020 2020  tuple..         
-00030ba0: 2020 206c 6973 7420 6f72 2061 7272 6179     list or array
-00030bb0: 206f 6620 7475 706c 6520 636f 6e74 6169   of tuple contai
-00030bc0: 6e69 6e67 2078 2061 6e64 2079 2063 6f6f  ning x and y coo
-00030bd0: 7264 696e 6174 6573 0d0a 2020 2020 2020  rdinates..      
-00030be0: 2020 2020 2020 2865 2e67 2e20 705f 6c69        (e.g. p_li
-00030bf0: 7374 3d5b 2831 3030 2c20 3230 3029 2c20  st=[(100, 200), 
-00030c00: 2833 3030 2c20 3230 3029 5d20 2d2d 3e20  (300, 200)] --> 
-00030c10: 6472 6177 2061 2063 726f 7373 2073 6563  draw a cross sec
-00030c20: 7469 6f6e 2062 6574 7765 656e 2074 6865  tion between the
-00030c30: 7365 2074 776f 2070 6f69 6e74 7329 0d0a  se two points)..
-00030c40: 2020 2020 2020 2020 6573 703a 2066 6c6f          esp: flo
-00030c50: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
-00030c60: 7370 6163 696e 6720 746f 2075 7365 2077  spacing to use w
-00030c70: 6865 6e20 7361 6d70 6c69 6e67 2074 6865  hen sampling the
-00030c80: 2061 7272 6179 2061 6c6f 6e67 2074 6865   array along the
-00030c90: 2063 726f 7373 2073 6563 7469 6f6e 0d0a   cross section..
-00030ca0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00030cb0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00030cc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-00030cd0: 2020 2020 2020 2020 3244 2061 7272 6179          2D array
-00030ce0: 0d0a 2020 2020 2020 2020 2020 2020 6372  ..            cr
-00030cf0: 6f73 7320 7365 6374 696f 6e20 7265 6164  oss section read
-00030d00: 7920 746f 2070 6c6f 740d 0a20 2020 2020  y to plot..     
-00030d10: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-00030d20: 2020 6f78 3d73 656c 662e 6765 745f 6f78    ox=self.get_ox
-00030d30: 2829 0d0a 2020 2020 2020 2020 6f79 3d73  ()..        oy=s
-00030d40: 656c 662e 6765 745f 6f79 2829 0d0a 2020  elf.get_oy()..  
-00030d50: 2020 2020 2020 7378 3d73 656c 662e 6765        sx=self.ge
-00030d60: 745f 7378 2829 0d0a 2020 2020 2020 2020  t_sx()..        
-00030d70: 7379 3d73 656c 662e 6765 745f 7379 2829  sy=self.get_sy()
-00030d80: 0d0a 0d0a 2020 2020 2020 2020 6966 2065  ....        if e
-00030d90: 7370 2069 7320 4e6f 6e65 3a0d 0a20 2020  sp is None:..   
-00030da0: 2020 2020 2020 2020 2065 7370 3d28 7365           esp=(se
-00030db0: 6c66 2e67 6574 5f73 7828 292a 2a32 2b73  lf.get_sx()**2+s
-00030dc0: 656c 662e 6765 745f 7379 2829 2a2a 3229  elf.get_sy()**2)
-00030dd0: 2a2a 302e 350d 0a0d 0a20 2020 2020 2020  **0.5....       
-00030de0: 2064 6973 745f 746f 743d 300d 0a20 2020   dist_tot=0..   
-00030df0: 2020 2020 2066 6f72 2069 7020 696e 2072       for ip in r
-00030e00: 616e 6765 286c 656e 2870 5f6c 6973 7429  ange(len(p_list)
-00030e10: 2d31 293a 2023 206c 6f6f 7020 6f76 6572  -1): # loop over
-00030e20: 2070 6f69 6e74 730d 0a20 2020 2020 2020   points..       
-00030e30: 2020 2020 2070 313d 6e70 2e61 7272 6179       p1=np.array
-00030e40: 2870 5f6c 6973 745b 6970 5d29 0d0a 2020  (p_list[ip])..  
-00030e50: 2020 2020 2020 2020 2020 7032 3d6e 702e            p2=np.
-00030e60: 6172 7261 7928 705f 6c69 7374 5b69 702b  array(p_list[ip+
-00030e70: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-00030e80: 2064 312c 2064 323d 7032 2d70 310d 0a20   d1, d2=p2-p1.. 
-00030e90: 2020 2020 2020 2020 2020 2064 6973 743d             dist=
-00030ea0: 6e70 2e73 7172 7428 6431 2a2a 3220 2b20  np.sqrt(d1**2 + 
-00030eb0: 6432 2a2a 3229 0d0a 2020 2020 2020 2020  d2**2)..        
-00030ec0: 2020 2020 6c61 6d3d 6573 702f 6469 7374      lam=esp/dist
-00030ed0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00030ee0: 785f 642c 2079 5f64 3d70 3120 2023 2073  x_d, y_d=p1  # s
-00030ef0: 7461 7274 696e 6720 706f 696e 740d 0a0d  tarting point...
-00030f00: 0a20 2020 2020 2020 2020 2020 2066 3d61  .            f=a
-00030f10: 7272 5f74 6f5f 706c 6f74 2e63 6f70 7928  rr_to_plot.copy(
-00030f20: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-00030f30: 6f5f 636f 6c6f 723d 4661 6c73 650d 0a20  o_color=False.. 
-00030f40: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00030f50: 6e28 662e 7368 6170 6529 203d 3d20 343a  n(f.shape) == 4:
-00030f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030f70: 2020 6e6f 5f63 6f6c 6f72 3d46 616c 7365    no_color=False
-00030f80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030f90: 2020 785f 7365 635f 693d 6e70 2e7a 6572    x_sec_i=np.zer
-00030fa0: 6f73 285b 662e 7368 6170 655b 305d 2c20  os([f.shape[0], 
-00030fb0: 696e 7428 6469 7374 2f65 7370 292b 312c  int(dist/esp)+1,
-00030fc0: 2034 5d29 0d0a 2020 2020 2020 2020 2020   4])..          
-00030fd0: 2020 2020 2020 6966 2069 7020 3d3d 2030        if ip == 0
-00030fe0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00030ff0: 2020 2020 2020 2078 5f73 6563 3d6e 702e         x_sec=np.
-00031000: 7a65 726f 7328 5b66 2e73 6861 7065 5b30  zeros([f.shape[0
-00031010: 5d2c 2069 6e74 2864 6973 742f 6573 7029  ], int(dist/esp)
-00031020: 2b31 2c20 345d 290d 0a20 2020 2020 2020  +1, 4])..       
-00031030: 2020 2020 2065 6c69 6620 6c65 6e28 662e       elif len(f.
-00031040: 7368 6170 6529 203d 3d20 333a 0d0a 2020  shape) == 3:..  
-00031050: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-00031060: 5f63 6f6c 6f72 3d54 7275 650d 0a20 2020  _color=True..   
-00031070: 2020 2020 2020 2020 2020 2020 2078 5f73               x_s
-00031080: 6563 5f69 3d6e 702e 7a65 726f 7328 5b66  ec_i=np.zeros([f
-00031090: 2e73 6861 7065 5b30 5d2c 696e 7428 6469  .shape[0],int(di
-000310a0: 7374 2f65 7370 292b 315d 290d 0a20 2020  st/esp)+1])..   
-000310b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000310c0: 6970 203d 3d20 303a 0d0a 2020 2020 2020  ip == 0:..      
-000310d0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
-000310e0: 7365 633d 6e70 2e7a 6572 6f73 285b 662e  sec=np.zeros([f.
-000310f0: 7368 6170 655b 305d 2c69 6e74 2864 6973  shape[0],int(dis
-00031100: 742f 6573 7029 2b31 5d29 0d0a 0d0a 2020  t/esp)+1])....  
-00031110: 2020 2020 2020 2020 2020 6966 206e 6f5f            if no_
-00031120: 636f 6c6f 723a 0d0a 2020 2020 2020 2020  color:..        
-00031130: 2020 2020 2020 2020 693d 300d 0a20 2020          i=0..   
-00031140: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00031150: 206f 2069 6e20 6e70 2e61 7261 6e67 6528   o in np.arange(
-00031160: 302c 6469 7374 2c65 7370 293a 0d0a 2020  0,dist,esp):..  
-00031170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031180: 2020 785f 6420 2b3d 2064 312a 6c61 6d0d    x_d += d1*lam.
-00031190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000311a0: 2020 2020 2079 5f64 202b 3d20 6432 2a6c       y_d += d2*l
-000311b0: 616d 0d0a 2020 2020 2020 2020 2020 2020  am..            
-000311c0: 2020 2020 2020 2020 6978 3d69 6e74 2828          ix=int((
-000311d0: 785f 6420 2d20 6f78 292f 7378 290d 0a20  x_d - ox)/sx).. 
-000311e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000311f0: 2020 2069 793d 696e 7428 2879 5f64 202d     iy=int((y_d -
-00031200: 206f 7929 2f73 7929 0d0a 2020 2020 2020   oy)/sy)..      
-00031210: 2020 2020 2020 2020 2020 2020 2020 6670                fp
-00031220: 3d66 5b3a 2c69 792c 6978 5d0d 0a20 2020  =f[:,iy,ix]..   
-00031230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031240: 2069 6620 6970 203d 3d20 303a 0d0a 2020   if ip == 0:..  
-00031250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031260: 2020 2020 2020 785f 7365 635b 3a2c 695d        x_sec[:,i]
-00031270: 3d66 700d 0a20 2020 2020 2020 2020 2020  =fp..           
-00031280: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00031290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000312a0: 2020 2020 2020 2020 785f 7365 635f 695b          x_sec_i[
-000312b0: 3a2c 695d 3d66 700d 0a20 2020 2020 2020  :,i]=fp..       
-000312c0: 2020 2020 2020 2020 2020 2020 2069 202b               i +
-000312d0: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
-000312e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000312f0: 2020 2020 2020 2020 693d 300d 0a20 2020          i=0..   
-00031300: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00031310: 206f 2069 6e20 6e70 2e61 7261 6e67 6528   o in np.arange(
-00031320: 302c 6469 7374 2c65 7370 293a 0d0a 2020  0,dist,esp):..  
-00031330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031340: 2020 785f 6420 2b3d 2064 312a 6c61 6d0d    x_d += d1*lam.
-00031350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031360: 2020 2020 2079 5f64 202b 3d20 6432 2a6c       y_d += d2*l
-00031370: 616d 0d0a 2020 2020 2020 2020 2020 2020  am..            
-00031380: 2020 2020 2020 2020 6978 3d69 6e74 2828          ix=int((
-00031390: 785f 6420 2d20 6f78 292f 7378 290d 0a20  x_d - ox)/sx).. 
-000313a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000313b0: 2020 2069 793d 696e 7428 2879 5f64 202d     iy=int((y_d -
-000313c0: 206f 7929 2f73 7929 0d0a 2020 2020 2020   oy)/sy)..      
-000313d0: 2020 2020 2020 2020 2020 2020 2020 6670                fp
-000313e0: 3d66 5b3a 2c69 792c 6978 5d0d 0a20 2020  =f[:,iy,ix]..   
-000313f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031400: 2069 6620 6970 203d 3d20 303a 0d0a 2020   if ip == 0:..  
-00031410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031420: 2020 2020 2020 785f 7365 635b 3a2c 692c        x_sec[:,i,
-00031430: 3a20 5d3d 6670 0d0a 2020 2020 2020 2020  : ]=fp..        
-00031440: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00031450: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00031460: 2020 2020 2020 2020 2020 2078 5f73 6563             x_sec
-00031470: 5f69 5b3a 2c69 2c3a 205d 3d66 700d 0a20  _i[:,i,: ]=fp.. 
-00031480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031490: 2020 2069 202b 3d20 310d 0a0d 0a20 2020     i += 1....   
-000314a0: 2020 2020 2020 2020 2064 6973 745f 746f           dist_to
-000314b0: 7420 2b3d 2064 6973 740d 0a20 2020 2020  t += dist..     
-000314c0: 2020 2020 2020 2023 6170 7065 6e64 2078         #append x
-000314d0: 7365 6374 696f 6e73 0d0a 2020 2020 2020  sections..      
-000314e0: 2020 2020 2020 6966 2069 7020 3e20 303a        if ip > 0:
-000314f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00031500: 2020 785f 7365 633d 6e70 2e63 6f6e 6361    x_sec=np.conca
-00031510: 7465 6e61 7465 2828 785f 7365 632c 2078  tenate((x_sec, x
-00031520: 5f73 6563 5f69 292c 2061 7869 733d 3129  _sec_i), axis=1)
-00031530: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-00031540: 726e 2078 5f73 6563 2c20 6469 7374 5f74  rn x_sec, dist_t
-00031550: 6f74 0d0a 0d0a 0d0a 0d0a 2020 2020 2323  ot........    ##
-00031560: 2320 4255 4720 544f 2043 4f52 5245 4354  # BUG TO CORRECT
-00031570: 0d0a 2020 2020 2222 220d 0a20 2020 2042  ..    """..    B
-00031580: 6f72 6568 6f6c 6573 2061 7070 6561 7220  oreholes appear 
-00031590: 6d75 6c74 6970 6c65 2074 696d 6573 206f  multiple times o
-000315a0: 6e20 7468 6520 6372 6f73 732d 7365 6374  n the cross-sect
-000315b0: 696f 6e2c 2068 6176 6520 746f 2074 6869  ion, have to thi
-000315c0: 6e6b 2061 626f 7574 2074 6861 740d 0a20  nk about that.. 
-000315d0: 2020 2022 2222 0d0a 2020 2020 6465 6620     """..    def 
-000315e0: 706c 6f74 5f63 726f 7373 5f73 6563 7469  plot_cross_secti
-000315f0: 6f6e 2873 656c 662c 2070 5f6c 6973 742c  on(self, p_list,
-00031600: 2074 7970 3d22 756e 6974 7322 2c20 6172   typ="units", ar
-00031610: 723d 4e6f 6e65 2c20 6975 3d30 2c20 6966  r=None, iu=0, if
-00031620: 613d 302c 2069 703d 302c 0d0a 2020 2020  a=0, ip=0,..    
-00031630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031640: 2020 2020 2020 2070 726f 7065 7274 793d         property=
-00031650: 4e6f 6e65 2c20 6573 703d 4e6f 6e65 2c20  None, esp=None, 
-00031660: 6178 3d4e 6f6e 652c 2063 6f6c 6f72 6261  ax=None, colorba
-00031670: 723d 4661 6c73 652c 0d0a 2020 2020 2020  r=False,..      
-00031680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031690: 2020 2020 2072 6174 696f 5f61 7370 6563       ratio_aspec
-000316a0: 743d 322c 2069 3d30 2c0d 0a20 2020 2020  t=2, i=0,..     
-000316b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000316c0: 2020 2020 2020 6469 7374 5f6d 6178 203d        dist_max =
-000316d0: 2031 3030 2c20 7769 6474 683d 2e35 2c0d   100, width=.5,.
-000316e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000316f0: 2020 2020 2020 2020 2020 2020 766d 6178              vmax
-00031700: 3d4e 6f6e 652c 2076 6d69 6e3d 4e6f 6e65  =None, vmin=None
-00031710: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
-00031720: 220d 0a20 2020 2020 2020 2050 6c6f 7420  "..        Plot 
-00031730: 6120 6372 6f73 7320 7365 6374 696f 6e20  a cross section 
-00031740: 616c 6f6e 6720 7468 6520 706f 696e 7473  along the points
-00031750: 2067 6976 656e 2069 6e0d 0a20 2020 2020   given in..     
-00031760: 2020 2070 5f6c 6973 7420 7769 7468 2061     p_list with a
-00031770: 2073 7061 6369 6e67 2064 6566 696e 6564   spacing defined
-00031780: 2028 6573 7029 0d0a 0d0a 2020 2020 2020   (esp)....      
-00031790: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-000317a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000317b0: 0d0a 2020 2020 2020 2020 705f 6c69 7374  ..        p_list
-000317c0: 203a 206c 6973 7420 6f72 2061 7272 6179   : list or array
-000317d0: 206f 6620 7475 706c 6520 636f 6e74 6169   of tuple contai
-000317e0: 6e69 6e67 0d0a 2020 2020 2020 2020 2020  ning..          
-000317f0: 2020 2020 2020 7820 616e 6420 7920 636f        x and y co
-00031800: 6f72 6469 6e61 7465 730d 0a20 2020 2020  ordinates..     
-00031810: 2020 2020 2020 2020 2020 2028 652e 672e             (e.g.
-00031820: 2070 5f6c 6973 743d 5b28 3130 302c 2032   p_list=[(100, 2
-00031830: 3030 292c 2028 3330 302c 2032 3030 295d  00), (300, 200)]
-00031840: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00031850: 2020 2d2d 3e20 6472 6177 2061 2063 726f    --> draw a cro
-00031860: 7373 2073 6563 7469 6f6e 2062 6574 7765  ss section betwe
-00031870: 656e 2074 6865 7365 2074 776f 2070 6f69  en these two poi
-00031880: 6e74 7329 0d0a 2020 2020 2020 2020 7479  nts)..        ty
-00031890: 703a 2073 7472 696e 670d 0a20 2020 2020  p: string..     
-000318a0: 2020 2020 2020 2075 6e69 7473 2c20 6661         units, fa
-000318b0: 6369 6573 206f 7220 6120 7072 6f70 6572  cies or a proper
-000318c0: 7479 206e 616d 650d 0a20 2020 2020 2020  ty name..       
-000318d0: 2069 753a 2069 6e74 0d0a 2020 2020 2020   iu: int..      
-000318e0: 2020 2020 2020 756e 6974 7320 696e 6465        units inde
-000318f0: 7820 7265 616c 697a 6174 696f 6e0d 0a20  x realization.. 
-00031900: 2020 2020 2020 2069 6661 3a20 696e 740d         ifa: int.
-00031910: 0a20 2020 2020 2020 2020 2020 2066 6163  .            fac
-00031920: 6965 7320 696e 6465 7820 7265 616c 697a  ies index realiz
-00031930: 6174 696f 6e0d 0a20 2020 2020 2020 2069  ation..        i
-00031940: 703a 2069 6e74 0d0a 2020 2020 2020 2020  p: int..        
-00031950: 2020 2020 7072 6f70 6572 7479 2069 6e64      property ind
-00031960: 6578 2072 6561 6c69 7a61 7469 6f6e 0d0a  ex realization..
-00031970: 2020 2020 2020 2020 7072 6f70 6572 7479          property
-00031980: 3a20 7374 720d 0a20 2020 2020 2020 2020  : str..         
-00031990: 2020 2070 726f 7065 7274 7920 6e61 6d65     property name
-000319a0: 2074 6861 7420 6861 7665 2062 6565 6e20   that have been 
-000319b0: 636f 6d70 7574 6564 0d0a 2020 2020 2020  computed..      
-000319c0: 2020 6573 703a 2066 6c6f 6174 0d0a 2020    esp: float..  
-000319d0: 2020 2020 2020 2020 2020 7370 6163 696e            spacin
-000319e0: 6720 746f 2075 7365 2077 6865 6e20 7361  g to use when sa
-000319f0: 6d70 6c69 6e67 2074 6865 2061 7272 6179  mpling the array
-00031a00: 2061 6c6f 6e67 2074 6865 2063 726f 7373   along the cross
-00031a10: 2073 6563 7469 6f6e 0d0a 2020 2020 2020   section..      
-00031a20: 2020 6178 3a20 6d61 7470 6c6f 746c 6962    ax: matplotlib
-00031a30: 2061 7865 7320 6f6e 2077 6869 6368 2074   axes on which t
-00031a40: 6f20 706c 6f74 0d0a 2020 2020 2020 2020  o plot..        
-00031a50: 7261 7469 6f5f 6173 7065 6374 3a20 666c  ratio_aspect: fl
-00031a60: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
-00031a70: 2072 6174 696f 2062 6574 7765 656e 2079   ratio between y
-00031a80: 2061 6e64 2078 2061 7869 7320 746f 2061   and x axis to a
-00031a90: 646a 7573 7420 7665 7274 6963 616c 2065  djust vertical e
-00031aa0: 7861 6767 6572 6174 696f 6e0d 0a20 2020  xaggeration..   
-00031ab0: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-00031ac0: 2020 2020 6465 6620 706c 6f74 5f62 6828      def plot_bh(
-00031ad0: 6268 2c20 783d 4e6f 6e65 2c20 7769 6474  bh, x=None, widt
-00031ae0: 683d 7769 6474 682c 2074 7970 3d22 756e  h=width, typ="un
-00031af0: 6974 7322 293a 0d0a 0d0a 2020 2020 2020  its"):....      
-00031b00: 2020 2020 2020 6966 2074 7970 203d 3d20        if typ == 
-00031b10: 2275 6e69 7473 223a 0d0a 2020 2020 2020  "units":..      
-00031b20: 2020 2020 2020 2020 2020 6966 2062 682e            if bh.
-00031b30: 6c6f 675f 7374 7261 7469 2069 7320 6e6f  log_strati is no
-00031b40: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-00031b50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00031b60: 7820 6973 204e 6f6e 653a 0d0a 2020 2020  x is None:..    
-00031b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b80: 2020 2020 6978 203d 2062 682e 780d 0a20      ix = bh.x.. 
-00031b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ba0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00031bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031bc0: 2020 6978 203d 2078 0d0a 0d0a 2020 2020    ix = x....    
-00031bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031be0: 6920 3d20 2d31 0d0a 2020 2020 2020 2020  i = -1..        
-00031bf0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00031c00: 6920 696e 2072 616e 6765 286c 656e 2862  i in range(len(b
-00031c10: 682e 6c6f 675f 7374 7261 7469 292d 3129  h.log_strati)-1)
-00031c20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00031c30: 2020 2020 2020 2020 2020 2073 203d 2062             s = b
-00031c40: 682e 6c6f 675f 7374 7261 7469 5b69 5d5b  h.log_strati[i][
-00031c50: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-00031c60: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-00031c70: 203d 2062 682e 6c6f 675f 7374 7261 7469   = bh.log_strati
-00031c80: 5b69 5d5b 305d 0d0a 0d0a 2020 2020 2020  [i][0]....      
-00031c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ca0: 2020 6966 2069 203c 206c 656e 2862 682e    if i < len(bh.
-00031cb0: 6c6f 675f 7374 7261 7469 293a 0d0a 2020  log_strati):..  
-00031cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031cd0: 2020 2020 2020 2020 2020 7332 203d 2062            s2 = b
-00031ce0: 682e 6c6f 675f 7374 7261 7469 5b69 2b31  h.log_strati[i+1
-00031cf0: 5d5b 315d 0d0a 0d0a 2020 2020 2020 2020  ][1]....        
-00031d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d10: 6966 2075 6e69 7420 6973 206e 6f74 204e  if unit is not N
-00031d20: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-00031d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d40: 2020 706c 742e 6261 7228 6978 2c20 7320    plt.bar(ix, s 
-00031d50: 2d20 7332 2c20 626f 7474 6f6d 3d73 322c  - s2, bottom=s2,
-00031d60: 2063 6f6c 6f72 3d75 6e69 742e 632c 2061   color=unit.c, a
-00031d70: 6c70 6861 3d31 2c20 6564 6765 636f 6c6f  lpha=1, edgecolo
-00031d80: 7220 3d20 2762 6c61 636b 272c 2077 6964  r = 'black', wid
-00031d90: 7468 3d77 6964 7468 290d 0a0d 0a20 2020  th=width)....   
-00031da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031db0: 2073 203d 2062 682e 6c6f 675f 7374 7261   s = bh.log_stra
-00031dc0: 7469 5b69 2b31 5d5b 315d 0d0a 2020 2020  ti[i+1][1]..    
-00031dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031de0: 756e 6974 203d 2062 682e 6c6f 675f 7374  unit = bh.log_st
-00031df0: 7261 7469 5b69 2b31 5d5b 305d 0d0a 2020  rati[i+1][0]..  
-00031e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e10: 2020 7332 203d 2062 682e 7a20 2d20 6268    s2 = bh.z - bh
-00031e20: 2e64 6570 7468 0d0a 2020 2020 2020 2020  .depth..        
-00031e30: 2020 2020 2020 2020 2020 2020 6966 2075              if u
-00031e40: 6e69 7420 6973 206e 6f74 204e 6f6e 653a  nit is not None:
-00031e50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00031e60: 2020 2020 2020 2020 2020 706c 742e 6261            plt.ba
-00031e70: 7228 6978 2c20 7320 2d20 7332 2c20 626f  r(ix, s - s2, bo
-00031e80: 7474 6f6d 3d73 322c 2063 6f6c 6f72 3d75  ttom=s2, color=u
-00031e90: 6e69 742e 632c 2061 6c70 6861 3d31 2c20  nit.c, alpha=1, 
-00031ea0: 6564 6765 636f 6c6f 7220 3d20 2762 6c61  edgecolor = 'bla
-00031eb0: 636b 272c 2077 6964 7468 3d77 6964 7468  ck', width=width
-00031ec0: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00031ed0: 7479 7020 3d3d 2022 756e 6974 7322 3a0d  typ == "units":.
-00031ee0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-00031ef0: 3d73 656c 662e 6765 745f 756e 6974 735f  =self.get_units_
-00031f00: 646f 6d61 696e 735f 7265 616c 697a 6174  domains_realizat
-00031f10: 696f 6e73 2869 753d 6975 2c20 6669 6c6c  ions(iu=iu, fill
-00031f20: 3d22 636f 6c6f 7222 2c20 616c 6c5f 6461  ="color", all_da
-00031f30: 7461 3d46 616c 7365 290d 0a0d 0a20 2020  ta=False)....   
-00031f40: 2020 2020 2065 6c69 6620 7479 7020 3d3d       elif typ ==
-00031f50: 2027 7072 6f62 615f 756e 6974 7327 3a0d   'proba_units':.
-00031f60: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
-00031f70: 7473 3d73 656c 662e 6765 745f 756e 6974  ts=self.get_unit
-00031f80: 735f 646f 6d61 696e 735f 7265 616c 697a  s_domains_realiz
-00031f90: 6174 696f 6e73 2829 0d0a 2020 2020 2020  ations()..      
-00031fa0: 2020 2020 2020 6e72 6561 6c3d 756e 6974        nreal=unit
-00031fb0: 732e 7368 6170 655b 305d 0d0a 2020 2020  s.shape[0]..    
-00031fc0: 2020 2020 2020 2020 6172 723d 2875 6e69          arr=(uni
-00031fd0: 7473 203d 3d20 6929 2e73 756d 2830 292f  ts == i).sum(0)/
-00031fe0: 6e72 6561 6c0d 0a20 2020 2020 2020 2020  nreal..         
-00031ff0: 2020 2064 656c 2875 6e69 7473 290d 0a0d     del(units)...
-00032000: 0a20 2020 2020 2020 2065 6c69 6620 7479  .        elif ty
-00032010: 7020 3d3d 2027 7072 6f62 615f 6661 6369  p == 'proba_faci
-00032020: 6573 273a 0d0a 2020 2020 2020 2020 2020  es':..          
-00032030: 2020 6661 6369 6573 3d73 656c 662e 6765    facies=self.ge
-00032040: 745f 6661 6369 6573 2829 0d0a 2020 2020  t_facies()..    
-00032050: 2020 2020 2020 2020 6e72 6561 6c3d 6661          nreal=fa
-00032060: 6369 6573 2e73 6861 7065 5b30 5d20 2a20  cies.shape[0] * 
-00032070: 6661 6369 6573 2e73 6861 7065 5b31 5d0d  facies.shape[1].
-00032080: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-00032090: 3d28 6661 6369 6573 203d 3d20 6929 2e73  =(facies == i).s
-000320a0: 756d 2830 292e 7375 6d28 3029 202f 6e72  um(0).sum(0) /nr
-000320b0: 6561 6c0d 0a20 2020 2020 2020 2020 2020  eal..           
-000320c0: 2064 656c 2866 6163 6965 7329 0d0a 2020   del(facies)..  
-000320d0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000320e0: 2020 2020 656c 6966 2074 7970 203d 3d22      elif typ =="
-000320f0: 6661 6369 6573 223a 0d0a 2020 2020 2020  facies":..      
-00032100: 2020 2020 2020 6172 723d 7365 6c66 2e67        arr=self.g
-00032110: 6574 5f66 6163 6965 7328 6975 2c20 6966  et_facies(iu, if
-00032120: 612c 2061 6c6c 5f64 6174 613d 4661 6c73  a, all_data=Fals
-00032130: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00032140: 2363 6861 6e67 6520 7661 6c75 6573 2074  #change values t
-00032150: 6f20 6861 7665 2063 6f6c 6f72 7320 6469  o have colors di
-00032160: 7265 6374 6c79 0d0a 2020 2020 2020 2020  rectly..        
-00032170: 2020 2020 6e65 775f 6172 723d 6e70 2e7a      new_arr=np.z
-00032180: 6572 6f73 285b 6172 722e 7368 6170 655b  eros([arr.shape[
-00032190: 305d 2c20 6172 722e 7368 6170 655b 315d  0], arr.shape[1]
-000321a0: 2c20 6172 722e 7368 6170 655b 325d 2c20  , arr.shape[2], 
-000321b0: 345d 290d 0a20 2020 2020 2020 2020 2020  4])..           
-000321c0: 206c 6973 745f 6661 3d6e 702e 756e 6971   list_fa=np.uniq
-000321d0: 7565 2861 7272 290d 0a20 2020 2020 2020  ue(arr)..       
-000321e0: 2020 2020 2066 6f72 2049 4466 6120 696e       for IDfa in
-000321f0: 206c 6973 745f 6661 3a0d 0a20 2020 2020   list_fa:..     
-00032200: 2020 2020 2020 2020 2020 2069 6620 4944             if ID
-00032210: 6661 2021 3d20 303a 0d0a 2020 2020 2020  fa != 0:..      
-00032220: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-00032230: 3d73 656c 662e 6765 745f 6661 6369 6573  =self.get_facies
-00032240: 5f6f 626a 2849 443d 4944 6661 2c20 7479  _obj(ID=IDfa, ty
-00032250: 7065 3d22 4944 2229 2020 2320 6765 7420  pe="ID")  # get 
-00032260: 6661 6369 6573 206f 626a 6563 740d 0a20  facies object.. 
-00032270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032280: 2020 206d 6173 6b3d 2861 7272 203d 3d20     mask=(arr == 
-00032290: 4944 6661 290d 0a20 2020 2020 2020 2020  IDfa)..         
-000322a0: 2020 2020 2020 2020 2020 206e 6577 5f61             new_a
-000322b0: 7272 5b6d 6173 6b2c 3a20 5d3d 636f 6c6f  rr[mask,: ]=colo
-000322c0: 7273 2e74 6f5f 7267 6261 2866 612e 6329  rs.to_rgba(fa.c)
-000322d0: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-000322e0: 723d 6e65 775f 6172 720d 0a0d 0a20 2020  r=new_arr....   
-000322f0: 2020 2020 2065 6c69 6620 7479 7020 3d3d       elif typ ==
-00032300: 2270 726f 7022 3a0d 0a20 2020 2020 2020  "prop":..       
-00032310: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-00032320: 7374 616e 6365 2870 726f 7065 7274 792c  stance(property,
-00032330: 2073 7472 292c 2022 7072 6f70 6572 7479   str), "property
-00032340: 2073 686f 756c 6420 6265 2067 6976 656e   should be given
-00032350: 2069 6e20 6120 7072 6f70 6572 7479 206e   in a property n
-00032360: 616d 6520 2d2d 3e20 7374 7269 6e67 220d  ame --> string".
-00032370: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-00032380: 3d73 656c 662e 6765 7470 726f 7028 7072  =self.getprop(pr
-00032390: 6f70 6572 7479 2c20 6975 2c20 6966 612c  operty, iu, ifa,
-000323a0: 2069 702c 2061 6c6c 5f64 6174 613d 4661   ip, all_data=Fa
-000323b0: 6c73 6529 0d0a 0d0a 2020 2020 2020 2020  lse)....        
-000323c0: 656c 6966 2074 7970 203d 3d22 656e 7472  elif typ =="entr
-000323d0: 6f70 795f 756e 6974 7322 3a0d 0a20 2020  opy_units":..   
-000323e0: 2020 2020 2020 2020 2075 6e69 7473 3d73           units=s
-000323f0: 656c 662e 6765 745f 756e 6974 735f 646f  elf.get_units_do
-00032400: 6d61 696e 735f 7265 616c 697a 6174 696f  mains_realizatio
-00032410: 6e73 2829 0d0a 2020 2020 2020 2020 2020  ns()..          
-00032420: 2020 5345 3d6e 702e 7a65 726f 7328 7365    SE=np.zeros(se
-00032430: 6c66 2e6d 6173 6b2e 7368 6170 6529 2020  lf.mask.shape)  
-00032440: 2320 7368 616e 6e6f 6e20 656e 7472 6f70  # shannon entrop
-00032450: 790d 0a20 2020 2020 2020 2020 2020 2062  y..            b
-00032460: 3d6c 656e 2873 656c 662e 6765 745f 616c  =len(self.get_al
-00032470: 6c5f 756e 6974 7328 2929 0d0a 2020 2020  l_units())..    
-00032480: 2020 2020 2020 2020 6e72 6561 6c3d 756e          nreal=un
-00032490: 6974 732e 7368 6170 655b 305d 0d0a 2020  its.shape[0]..  
-000324a0: 2020 2020 2020 2020 2020 666f 7220 756e            for un
-000324b0: 6974 2069 6e20 7365 6c66 2e67 6574 5f61  it in self.get_a
-000324c0: 6c6c 5f75 6e69 7473 2829 3a0d 0a20 2020  ll_units():..   
-000324d0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000324e0: 6e74 2875 6e69 7429 0d0a 2020 2020 2020  nt(unit)..      
-000324f0: 2020 2020 2020 2020 2020 5069 3d28 756e            Pi=(un
-00032500: 6974 733d 3d75 6e69 742e 4944 292e 7375  its==unit.ID).su
-00032510: 6d28 3029 2f6e 7265 616c 0d0a 2020 2020  m(0)/nreal..    
-00032520: 2020 2020 2020 2020 2020 2020 7069 5f6d              pi_m
-00032530: 6173 6b3d 2873 656c 662e 6d61 736b 2920  ask=(self.mask) 
-00032540: 2620 2850 6921 3d30 290d 0a20 2020 2020  & (Pi!=0)..     
-00032550: 2020 2020 2020 2020 2020 2053 455b 7069             SE[pi
-00032560: 5f6d 6173 6b5d 202b 3d20 5069 5b70 695f  _mask] += Pi[pi_
-00032570: 6d61 736b 5d2a 286e 702e 6c6f 6728 5069  mask]*(np.log(Pi
-00032580: 5b70 695f 6d61 736b 5d29 2f6e 702e 6c6f  [pi_mask])/np.lo
-00032590: 6728 6229 290d 0a20 2020 2020 2020 2020  g(b))..         
-000325a0: 2020 2020 2020 2061 7272 3d2d 5345 0d0a         arr=-SE..
-000325b0: 2020 2020 2020 2020 2020 2020 6172 725b              arr[
-000325c0: 7e73 656c 662e 6d61 736b 5d3d 6e70 2e6e  ~self.mask]=np.n
-000325d0: 616e 0d0a 2020 2020 2020 2020 2020 2020  an..            
-000325e0: 6465 6c28 756e 6974 7329 0d0a 0d0a 2020  del(units)....  
-000325f0: 2020 2020 2020 656c 6966 2074 7970 203d        elif typ =
-00032600: 3d20 2265 6e74 726f 7079 5f66 6163 6965  = "entropy_facie
-00032610: 7322 3a0d 0a20 2020 2020 2020 2020 2020  s":..           
-00032620: 2066 6163 6965 735f 646f 6d61 696e 733d   facies_domains=
-00032630: 7365 6c66 2e67 6574 5f66 6163 6965 7328  self.get_facies(
-00032640: 292e 7265 7368 6170 6528 2d31 2c20 7365  ).reshape(-1, se
-00032650: 6c66 2e6e 7a2c 2073 656c 662e 6e79 2c20  lf.nz, self.ny, 
-00032660: 7365 6c66 2e6e 7829 0d0a 2020 2020 2020  self.nx)..      
-00032670: 2020 2020 2020 5345 3d6e 702e 7a65 726f        SE=np.zero
-00032680: 7328 7365 6c66 2e6d 6173 6b2e 7368 6170  s(self.mask.shap
-00032690: 6529 2020 2320 7368 616e 6e6f 6e20 656e  e)  # shannon en
-000326a0: 7472 6f70 790d 0a20 2020 2020 2020 2020  tropy..         
-000326b0: 2020 2062 3d6c 656e 2873 656c 662e 6765     b=len(self.ge
-000326c0: 745f 616c 6c5f 6661 6369 6573 2829 290d  t_all_facies()).
-000326d0: 0a20 2020 2020 2020 2020 2020 206e 7265  .            nre
-000326e0: 616c 3d66 6163 6965 735f 646f 6d61 696e  al=facies_domain
-000326f0: 732e 7368 6170 655b 305d 0d0a 2020 2020  s.shape[0]..    
-00032700: 2020 2020 2020 2020 666f 7220 6661 6369          for faci
-00032710: 6573 2069 6e20 7365 6c66 2e67 6574 5f61  es in self.get_a
-00032720: 6c6c 5f66 6163 6965 7328 293a 0d0a 2020  ll_facies():..  
-00032730: 2020 2020 2020 2020 2020 2020 2020 5069                Pi
-00032740: 3d28 6661 6369 6573 5f64 6f6d 6169 6e73  =(facies_domains
-00032750: 3d3d 6661 6369 6573 2e49 4429 2e73 756d  ==facies.ID).sum
-00032760: 2830 292f 6e72 6561 6c0d 0a20 2020 2020  (0)/nreal..     
-00032770: 2020 2020 2020 2020 2020 2070 695f 6d61             pi_ma
-00032780: 736b 3d28 7365 6c66 2e6d 6173 6b29 2026  sk=(self.mask) &
-00032790: 2028 5069 213d 3029 0d0a 2020 2020 2020   (Pi!=0)..      
-000327a0: 2020 2020 2020 2020 2020 5345 5b70 695f            SE[pi_
-000327b0: 6d61 736b 5d20 2b3d 2050 695b 7069 5f6d  mask] += Pi[pi_m
-000327c0: 6173 6b5d 2a28 6e70 2e6c 6f67 2850 695b  ask]*(np.log(Pi[
-000327d0: 7069 5f6d 6173 6b5d 292f 6e70 2e6c 6f67  pi_mask])/np.log
-000327e0: 2862 2929 0d0a 2020 2020 2020 2020 2020  (b))..          
-000327f0: 2020 2020 2020 6172 723d 2d53 450d 0a20        arr=-SE.. 
-00032800: 2020 2020 2020 2020 2020 2061 7272 5b7e             arr[~
-00032810: 7365 6c66 2e6d 6173 6b5d 3d6e 702e 6e61  self.mask]=np.na
-00032820: 6e0d 0a20 2020 2020 2020 2020 2020 2064  n..            d
-00032830: 656c 2866 6163 6965 735f 646f 6d61 696e  el(facies_domain
-00032840: 7329 0d0a 0d0a 2020 2020 2020 2020 656c  s)....        el
-00032850: 6966 2074 7970 203d 3d22 6172 7222 3a0d  if typ =="arr":.
-00032860: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00032870: 730d 0a20 2020 2020 2020 2065 6c73 653a  s..        else:
-00032880: 0d0a 2020 2020 2020 2020 2020 2020 6173  ..            as
-00032890: 7365 7274 2027 5479 7020 756e 6b6e 6f77  sert 'Typ unknow
-000328a0: 6e27 0d0a 2020 2020 2020 2020 2020 2020  n'..            
-000328b0: 7265 7475 726e 0d0a 0d0a 2020 2020 2020  return....      
-000328c0: 2020 2365 7874 7261 6374 2063 726f 7373    #extract cross
-000328d0: 2073 6563 7469 6f6e 0d0a 2020 2020 2020   section..      
-000328e0: 2020 7873 6563 2c20 6469 7374 3d73 656c    xsec, dist=sel
-000328f0: 662e 6372 6f73 735f 7365 6374 696f 6e28  f.cross_section(
-00032900: 6172 722c 2070 5f6c 6973 742c 2065 7370  arr, p_list, esp
-00032910: 3d65 7370 290d 0a0d 0a20 2020 2020 2020  =esp)....       
-00032920: 2069 6620 6178 2069 7320 4e6f 6e65 3a0d   if ax is None:.
-00032930: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
-00032940: 2c20 6178 3d70 6c74 2e73 7562 706c 6f74  , ax=plt.subplot
-00032950: 7328 6669 6773 697a 653d 2831 302c 2031  s(figsize=(10, 1
-00032960: 3029 290d 0a0d 0a20 2020 2020 2020 2065  0))....        e
-00032970: 7874 656e 743d 5b30 2c20 6469 7374 2c20  xtent=[0, dist, 
-00032980: 7365 6c66 2e67 6574 5f6f 7a28 292c 2073  self.get_oz(), s
-00032990: 656c 662e 6765 745f 7a67 2829 5b2d 315d  elf.get_zg()[-1]
-000329a0: 5d0d 0a20 2020 2020 2020 2061 3d61 782e  ]..        a=ax.
-000329b0: 696d 7368 6f77 2878 7365 632c 206f 7269  imshow(xsec, ori
-000329c0: 6769 6e3d 226c 6f77 6572 222c 2065 7874  gin="lower", ext
-000329d0: 656e 743d 6578 7465 6e74 2c20 696e 7465  ent=extent, inte
-000329e0: 7270 6f6c 6174 696f 6e3d 226e 6f6e 6522  rpolation="none"
-000329f0: 2c20 766d 6178 3d76 6d61 782c 2076 6d69  , vmax=vmax, vmi
-00032a00: 6e3d 766d 696e 290d 0a20 2020 2020 2020  n=vmin)..       
-00032a10: 2069 6620 636f 6c6f 7262 6172 3a0d 0a20   if colorbar:.. 
-00032a20: 2020 2020 2020 2020 2020 2070 6c74 2e63             plt.c
-00032a30: 6f6c 6f72 6261 7228 612c 2061 783d 6178  olorbar(a, ax=ax
-00032a40: 2c20 6f72 6965 6e74 6174 696f 6e3d 2768  , orientation='h
-00032a50: 6f72 697a 6f6e 7461 6c27 290d 0a20 2020  orizontal')..   
-00032a60: 2020 2020 2061 782e 7365 745f 6173 7065       ax.set_aspe
-00032a70: 6374 2861 6273 2828 6578 7465 6e74 5b31  ct(abs((extent[1
-00032a80: 5d2d 6578 7465 6e74 5b30 5d29 2f28 6578  ]-extent[0])/(ex
-00032a90: 7465 6e74 5b33 5d2d 6578 7465 6e74 5b32  tent[3]-extent[2
-00032aa0: 5d29 292f 7261 7469 6f5f 6173 7065 6374  ]))/ratio_aspect
-00032ab0: 290d 0a0d 0a20 2020 2020 2020 2064 656c  )....        del
-00032ac0: 2861 7272 290d 0a0d 0a20 2020 2020 2020  (arr)....       
-00032ad0: 2023 6765 7420 626f 7265 686f 6c65 730d   #get boreholes.
-00032ae0: 0a20 2020 2020 2020 2064 6973 745f 746f  .        dist_to
-00032af0: 7420 3d20 300d 0a20 2020 2020 2020 2066  t = 0..        f
-00032b00: 6f72 2069 7020 696e 2072 616e 6765 286c  or ip in range(l
-00032b10: 656e 2870 5f6c 6973 7429 2d31 293a 0d0a  en(p_list)-1):..
-00032b20: 0d0a 2020 2020 2020 2020 2020 2020 7031  ..            p1
-00032b30: 203d 2070 5f6c 6973 745b 6970 5d0d 0a20   = p_list[ip].. 
-00032b40: 2020 2020 2020 2020 2020 2070 3220 3d20             p2 = 
-00032b50: 705f 6c69 7374 5b69 702b 315d 0d0a 2020  p_list[ip+1]..  
-00032b60: 2020 2020 2020 2020 2020 786d 696e 203d            xmin =
-00032b70: 206d 696e 2870 315b 305d 2c20 7032 5b30   min(p1[0], p2[0
-00032b80: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00032b90: 786d 6178 203d 206d 6178 2870 315b 305d  xmax = max(p1[0]
-00032ba0: 2c20 7032 5b30 5d29 0d0a 2020 2020 2020  , p2[0])..      
-00032bb0: 2020 2020 2020 4c78 203d 2078 6d61 7820        Lx = xmax 
-00032bc0: 2d20 786d 696e 0d0a 2020 2020 2020 2020  - xmin..        
-00032bd0: 2020 2020 786d 696e 202d 3d20 6d61 7828      xmin -= max(
-00032be0: 302e 322a 4c78 2c20 6469 7374 5f6d 6178  0.2*Lx, dist_max
-00032bf0: 2f32 290d 0a20 2020 2020 2020 2020 2020  /2)..           
-00032c00: 2078 6d61 7820 2b3d 206d 6178 2830 2e32   xmax += max(0.2
-00032c10: 2a4c 782c 2064 6973 745f 6d61 782f 3229  *Lx, dist_max/2)
-00032c20: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00032c30: 796d 696e 203d 206d 696e 2870 315b 315d  ymin = min(p1[1]
-00032c40: 2c20 7032 5b31 5d29 0d0a 2020 2020 2020  , p2[1])..      
-00032c50: 2020 2020 2020 796d 6178 203d 206d 6178        ymax = max
-00032c60: 2870 315b 315d 2c20 7032 5b31 5d29 0d0a  (p1[1], p2[1])..
-00032c70: 2020 2020 2020 2020 2020 2020 4c79 203d              Ly =
-00032c80: 2079 6d61 7820 2d20 796d 696e 0d0a 2020   ymax - ymin..  
-00032c90: 2020 2020 2020 2020 2020 796d 696e 202d            ymin -
-00032ca0: 3d20 6d61 7828 302e 322a 4c79 2c20 6469  = max(0.2*Ly, di
-00032cb0: 7374 5f6d 6178 2f32 290d 0a20 2020 2020  st_max/2)..     
-00032cc0: 2020 2020 2020 2079 6d61 7820 2b3d 206d         ymax += m
-00032cd0: 6178 2830 2e32 2a4c 792c 2064 6973 745f  ax(0.2*Ly, dist_
-00032ce0: 6d61 782f 3229 0d0a 0d0a 2020 2020 2020  max/2)....      
-00032cf0: 2020 2020 2020 2320 7365 6c65 6374 2062        # select b
-00032d00: 6820 696e 7369 6465 2070 3120 616e 6420  h inside p1 and 
-00032d10: 7032 0d0a 2020 2020 2020 2020 2020 2020  p2..            
-00032d20: 7365 6c5f 6268 7320 3d20 5b62 6820 666f  sel_bhs = [bh fo
-00032d30: 7220 6268 2069 6e20 7365 6c66 2e6c 6973  r bh in self.lis
-00032d40: 745f 6268 7320 6966 2062 682e 7820 3e20  t_bhs if bh.x > 
-00032d50: 786d 696e 2061 6e64 2062 682e 7820 3c20  xmin and bh.x < 
-00032d60: 786d 6178 2061 6e64 2062 682e 7920 3e20  xmax and bh.y > 
-00032d70: 796d 696e 2061 6e64 2062 682e 7920 3c20  ymin and bh.y < 
-00032d80: 796d 6178 5d0d 0a0d 0a20 2020 2020 2020  ymax]....       
-00032d90: 2020 2020 2023 2063 6f6d 7075 7465 2064       # compute d
-00032da0: 6973 7420 6f66 2073 656c 5f62 6873 2074  ist of sel_bhs t
-00032db0: 6f20 6c69 6e65 0d0a 0d0a 2020 2020 2020  o line....      
-00032dc0: 2020 2020 2020 2320 7072 6f6a 2062 6873        # proj bhs
-00032dd0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00032de0: 7220 6268 2069 6e20 7365 6c5f 6268 733a  r bh in sel_bhs:
-00032df0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00032e00: 2020 6120 3d20 7032 5b30 5d20 2d20 7031    a = p2[0] - p1
-00032e10: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-00032e20: 2020 2020 2062 203d 2070 325b 315d 202d       b = p2[1] -
-00032e30: 2070 315b 315d 0d0a 2020 2020 2020 2020   p1[1]..        
-00032e40: 2020 2020 2020 2020 785f 7072 6f6a 203d          x_proj =
-00032e50: 2028 612a 2a32 202a 2062 682e 7820 2b20   (a**2 * bh.x + 
-00032e60: 622a 2a32 202a 2070 325b 305d 202b 2061  b**2 * p2[0] + a
-00032e70: 202a 2062 202a 2028 6268 2e79 202d 2070   * b * (bh.y - p
-00032e80: 325b 315d 2929 202f 2028 612a 2a32 202b  2[1])) / (a**2 +
-00032e90: 2062 2a2a 3229 0d0a 2020 2020 2020 2020   b**2)..        
-00032ea0: 2020 2020 2020 2020 795f 7072 6f6a 203d          y_proj =
-00032eb0: 2028 6220 2a20 785f 7072 6f6a 202d 2062   (b * x_proj - b
-00032ec0: 202a 2070 325b 305d 202b 2061 202a 2070   * p2[0] + a * p
-00032ed0: 325b 315d 2920 2f20 610d 0a0d 0a20 2020  2[1]) / a....   
-00032ee0: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-00032ef0: 745f 6c69 6e65 203d 2028 2862 682e 7820  t_line = ((bh.x 
-00032f00: 2d20 785f 7072 6f6a 2920 2a2a 2032 202b  - x_proj) ** 2 +
-00032f10: 2028 6268 2e79 202d 2079 5f70 726f 6a29   (bh.y - y_proj)
-00032f20: 202a 2a20 3229 2a2a 302e 350d 0a0d 0a20   ** 2)**0.5.... 
-00032f30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00032f40: 6620 6469 7374 5f6c 696e 6520 3c20 6469  f dist_line < di
-00032f50: 7374 5f6d 6178 3a0d 0a20 2020 2020 2020  st_max:..       
-00032f60: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-00032f70: 7420 3d20 2828 785f 7072 6f6a 202d 2070  t = ((x_proj - p
-00032f80: 315b 305d 2920 2a2a 2032 202b 2028 795f  1[0]) ** 2 + (y_
-00032f90: 7072 6f6a 202d 2070 315b 315d 2920 2a2a  proj - p1[1]) **
-00032fa0: 2032 292a 2a30 2e35 0d0a 2020 2020 2020   2)**0.5..      
-00032fb0: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00032fc0: 7374 5f74 6f5f 706c 6f74 203d 2064 6973  st_to_plot = dis
-00032fd0: 745f 746f 7420 2b20 6469 7374 2020 2320  t_tot + dist  # 
-00032fe0: 6469 7374 616e 6365 2077 6865 7265 2074  distance where t
-00032ff0: 6f20 706c 6f74 2074 6865 2062 680d 0a0d  o plot the bh...
-00033000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033010: 2020 2020 2023 2070 6c6f 7420 6268 0d0a       # plot bh..
-00033020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033030: 2020 2020 6966 2074 7970 203d 3d20 2275      if typ == "u
-00033040: 6e69 7473 223a 0d0a 2020 2020 2020 2020  nits":..        
-00033050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033060: 706c 6f74 5f62 6828 6268 2c20 6469 7374  plot_bh(bh, dist
-00033070: 5f74 6f5f 706c 6f74 290d 0a0d 0a20 2020  _to_plot)....   
-00033080: 2020 2020 2020 2020 2023 2069 6e63 7265           # incre
-00033090: 6d65 6e74 2074 6f74 616c 2064 6973 7461  ment total dista
-000330a0: 6e63 650d 0a20 2020 2020 2020 2020 2020  nce..           
-000330b0: 2064 6973 745f 706f 696e 7473 203d 2028   dist_points = (
-000330c0: 2870 325b 305d 202d 2070 315b 305d 2920  (p2[0] - p1[0]) 
-000330d0: 2a2a 2032 202b 2028 7032 5b31 5d20 2d20  ** 2 + (p2[1] - 
-000330e0: 7031 5b31 5d29 202a 2a20 3229 2a2a 302e  p1[1]) ** 2)**0.
-000330f0: 350d 0a20 2020 2020 2020 2020 2020 2064  5..            d
-00033100: 6973 745f 746f 7420 2b3d 2064 6973 745f  ist_tot += dist_
-00033110: 706f 696e 7473 0d0a 0d0a 2020 2020 2020  points....      
-00033120: 2020 0d0a 0d0a 0d0a 2020 2020 6465 6620    ......    def 
-00033130: 706c 6f74 5f6c 696e 6573 2873 656c 662c  plot_lines(self,
-00033140: 206c 6973 745f 6c69 6e65 732c 206e 616d   list_lines, nam
-00033150: 6573 3d4e 6f6e 652c 2061 783d 4e6f 6e65  es=None, ax=None
-00033160: 2c20 6c65 6765 6e64 3d54 7275 6529 3a0d  , legend=True):.
-00033170: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00033180: 2020 2020 2020 2020 506c 6f74 2063 726f          Plot cro
-00033190: 7373 2d73 6563 7469 6f6e 7320 6c69 6e65  ss-sections line
-000331a0: 7320 6769 7665 6e20 696e 2020 7468 650d  s given in  the.
-000331b0: 0a20 2020 2020 2020 2022 6c69 7374 5f6c  .        "list_l
-000331c0: 696e 6573 2220 6172 6775 6d65 6e74 206f  ines" argument o
-000331d0: 6e20 6120 3244 2074 6f70 2076 6965 7720  n a 2D top view 
-000331e0: 6f66 2074 6865 2064 6f6d 6169 6e0d 0a0d  of the domain...
-000331f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00033200: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00033210: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00033220: 206c 6973 745f 6c69 6e65 733a 2073 6571   list_lines: seq
-00033230: 656e 6365 206f 6620 706f 696e 7473 0d0a  ence of points..
-00033240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033250: 6c69 7374 206f 6620 706f 696e 7473 2064  list of points d
-00033260: 6566 696e 696e 6720 7468 6520 6372 6f73  efining the cros
-00033270: 732d 7365 6374 696f 6e0d 0a20 2020 2020  s-section..     
-00033280: 2020 2020 2020 2020 2020 206c 696e 6573             lines
-00033290: 2e20 4561 6368 2070 6f69 6e74 2069 7320  . Each point is 
-000332a0: 6120 6c69 7374 206f 6620 3220 666c 6f61  a list of 2 floa
-000332b0: 7473 205b 782c 2079 5d0d 0a20 2020 2020  ts [x, y]..     
-000332c0: 2020 206e 616d 6573 3a20 7365 7175 656e     names: sequen
-000332d0: 6365 206f 6620 7374 7269 6e67 0d0a 2020  ce of string..  
-000332e0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-000332f0: 7374 206f 6620 6e61 6d65 7320 746f 2067  st of names to g
-00033300: 6976 6520 746f 2074 6865 2063 726f 7373  ive to the cross
-00033310: 2d73 6563 7469 6f6e 206c 696e 6573 0d0a  -section lines..
-00033320: 2020 2020 2020 2020 6178 3a20 6d61 7470          ax: matp
-00033330: 6c6f 746c 6962 2061 7869 730d 0a20 2020  lotlib axis..   
-00033340: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-00033350: 7320 6f6e 2077 6869 6368 2074 6f20 706c  s on which to pl
-00033360: 6f74 2074 6865 2063 726f 7373 2d73 6563  ot the cross-sec
-00033370: 7469 6f6e 0d0a 2020 2020 2020 2020 6c65  tion..        le
-00033380: 6765 6e64 3a20 626f 6f6c 0d0a 2020 2020  gend: bool..    
-00033390: 2020 2020 2020 2020 2020 2020 6966 2054              if T
-000333a0: 7275 652c 2070 6c6f 7420 6120 6c65 6765  rue, plot a lege
-000333b0: 6e64 0d0a 2020 2020 2020 2020 2222 220d  nd..        """.
-000333c0: 0a0d 0a20 2020 2020 2020 2069 6620 6178  ...        if ax
-000333d0: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-000333e0: 2020 2020 2020 2066 6967 2c20 6178 3d70         fig, ax=p
-000333f0: 6c74 2e73 7562 706c 6f74 7328 290d 0a0d  lt.subplots()...
-00033400: 0a20 2020 2020 2020 206f 783d 7365 6c66  .        ox=self
-00033410: 2e6f 780d 0a20 2020 2020 2020 206f 793d  .ox..        oy=
-00033420: 7365 6c66 2e6f 790d 0a20 2020 2020 2020  self.oy..       
-00033430: 2078 313d 7365 6c66 2e78 675b 2d31 5d0d   x1=self.xg[-1].
-00033440: 0a20 2020 2020 2020 2079 313d 7365 6c66  .        y1=self
-00033450: 2e79 675b 2d31 5d0d 0a20 2020 2020 2020  .yg[-1]..       
-00033460: 2061 782e 706c 6f74 2828 6f78 2c20 6f78   ax.plot((ox, ox
-00033470: 2c20 7831 2c20 7831 2c20 6f78 292c 286f  , x1, x1, ox),(o
-00033480: 792c 2079 312c 2079 312c 206f 792c 206f  y, y1, y1, oy, o
-00033490: 7929 2c20 633d 226b 2229 2023 706c 6f74  y), c="k") #plot
-000334a0: 2064 6f6d 6169 6e0d 0a20 2020 2020 2020   domain..       
-000334b0: 2061 782e 7365 745f 6173 7065 6374 2822   ax.set_aspect("
-000334c0: 6571 7561 6c22 290d 0a0d 0a20 2020 2020  equal")....     
-000334d0: 2020 2069 3d31 0d0a 2020 2020 2020 2020     i=1..        
-000334e0: 666f 7220 6c69 6e65 2069 6e20 6c69 7374  for line in list
-000334f0: 5f6c 696e 6573 3a0d 0a20 2020 2020 2020  _lines:..       
-00033500: 2020 2020 2069 6620 6e61 6d65 7320 6973       if names is
-00033510: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00033520: 2020 2020 2020 2020 6c61 6265 6c3d 2263          label="c
-00033530: 726f 7373 2022 202b 2073 7472 2869 290d  ross " + str(i).
-00033540: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00033550: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00033560: 2020 2020 6c61 6265 6c3d 6e61 6d65 735b      label=names[
-00033570: 692d 315d 0d0a 2020 2020 2020 2020 2020  i-1]..          
-00033580: 2020 6c69 6e65 3d6e 702e 6172 7261 7928    line=np.array(
-00033590: 6c69 6e65 290d 0a20 2020 2020 2020 2020  line)..         
-000335a0: 2020 2061 782e 706c 6f74 286c 696e 655b     ax.plot(line[
-000335b0: 3a2c 305d 2c20 6c69 6e65 5b3a 2c31 5d2c  :,0], line[:,1],
-000335c0: 206c 6162 656c 3d6c 6162 656c 290d 0a20   label=label).. 
-000335d0: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
-000335e0: 310d 0a0d 0a20 2020 2020 2020 2069 6620  1....        if 
-000335f0: 6c65 6765 6e64 3a0d 0a20 2020 2020 2020  legend:..       
-00033600: 2020 2020 2061 782e 6c65 6765 6e64 2829       ax.legend()
-00033610: 0d0a 0d0a 0d0a 2320 434c 4153 5345 5320  ......# CLASSES 
-00033620: 5049 4c45 202b 2055 4e49 5420 2b20 5355  PILE + UNIT + SU
-00033630: 5246 4143 450d 0a63 6c61 7373 2050 696c  RFACE..class Pil
-00033640: 6528 293a 0d0a 0d0a 2020 2020 2222 220d  e():....    """.
-00033650: 0a20 2020 2054 6869 7320 636c 6173 7320  .    This class 
-00033660: 6973 2061 206d 616a 6f72 206f 626a 6563  is a major objec
-00033670: 7420 7468 6520 5374 7261 7469 6772 6170  t the Stratigrap
-00033680: 6869 6320 5069 6c65 2028 5350 292e 0d0a  hic Pile (SP)...
-00033690: 2020 2020 4974 2063 6f6e 7461 696e 7320      It contains 
-000336a0: 616c 6c20 7468 6520 756e 6974 7320 6f62  all the units ob
-000336b0: 6a65 6374 730d 0a20 2020 2061 6e64 2061  jects..    and a
-000336c0: 6c6c 6f77 2074 6f20 6b6e 6f77 2074 6865  llow to know the
-000336d0: 2073 7472 6174 6967 7261 7068 6963 616c   stratigraphical
-000336e0: 2072 656c 6174 696f 6e73 2062 6574 7765   relations betwe
-000336f0: 656e 2074 6865 2075 6e69 7473 2e0d 0a20  en the units... 
-00033700: 2020 204f 6e65 2050 696c 6520 6f62 6a65     One Pile obje
-00033710: 6374 206d 7573 7420 6265 2064 6566 696e  ct must be defin
-00033720: 6564 2066 6f72 2065 6163 6820 7375 6270  ed for each subp
-00033730: 696c 6520 2b20 3120 226d 6173 7465 7222  ile + 1 "master"
-00033740: 2070 696c 652e 0d0a 0d0a 2020 2020 5061   pile.....    Pa
-00033750: 7261 6d65 7465 7273 0d0a 2020 2020 2d2d  rameters..    --
-00033760: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6e61  --------..    na
-00033770: 6d65 3a20 7374 720d 0a20 2020 2020 2020  me: str..       
-00033780: 206e 616d 6520 6f66 2074 6865 2070 696c   name of the pil
-00033790: 650d 0a20 2020 206e 6174 7572 653a 2073  e..    nature: s
-000337a0: 7472 0d0a 2020 2020 2020 2020 756e 6974  tr..        unit
-000337b0: 7320 7479 7065 206f 6620 696e 7465 7270  s type of interp
-000337c0: 6f6c 6174 696f 6e2c 2063 616e 2062 6520  olation, can be 
-000337d0: 2273 7572 6661 6365 7322 206f 7220 2233  "surfaces" or "3
-000337e0: 645f 6361 7465 676f 7269 6361 6c22 0d0a  d_categorical"..
-000337f0: 2020 2020 2020 2020 6966 2022 7375 7266          if "surf
-00033800: 6163 6573 2220 6973 2063 686f 7365 6e20  aces" is chosen 
-00033810: 2864 6566 6175 6c74 292c 2032 4420 7375  (default), 2D su
-00033820: 7266 6163 6573 2069 6e74 6572 706f 6c61  rfaces interpola
-00033830: 7469 6f6e 7320 6f66 0d0a 2020 2020 2020  tions of..      
-00033840: 2020 7468 6520 7375 7266 6163 6573 2061    the surfaces a
-00033850: 7265 2070 6572 666f 726d 6564 2e20 5468  re performed. Th
-00033860: 6520 7375 7266 6163 6573 2061 7265 2074  e surfaces are t
-00033870: 6865 6e20 7573 6564 2074 6f20 6465 6c69  hen used to deli
-00033880: 6d69 7420 756e 6974 2064 6f6d 6169 6e73  mit unit domains
-00033890: 2e0d 0a20 2020 2020 2020 2069 6620 2233  ...        if "3
-000338a0: 645f 6361 7465 676f 7269 6361 6c22 2c20  d_categorical", 
-000338b0: 6120 6661 6369 6573 206d 6574 686f 6420  a facies method 
-000338c0: 6973 2075 7365 6420 746f 2073 696d 756c  is used to simul
-000338d0: 6174 6520 706f 7369 7469 6f6e 206f 6620  ate position of 
-000338e0: 7468 6520 756e 6974 732e 0d0a 2020 2020  the units...    
-000338f0: 2020 2020 5468 6520 6176 6169 6c61 626c      The availabl
-00033900: 6520 6d65 7468 6f64 7320 6172 6520 7468  e methods are th
-00033910: 6520 7361 6d65 2074 6f20 7369 6d75 6c61  e same to simula
-00033920: 7465 2074 6865 2066 6163 6965 732e 0d0a  te the facies...
-00033930: 2020 2020 7665 7262 6f73 653a 2069 6e74      verbose: int
-00033940: 0d0a 2020 2020 2020 2020 6c65 7665 6c20  ..        level 
-00033950: 6f66 2076 6572 626f 7369 7479 0d0a 2020  of verbosity..  
-00033960: 2020 7365 6564 3a20 696e 740d 0a20 2020    seed: int..   
-00033970: 2020 2020 2073 6565 6420 666f 7220 7261       seed for ra
-00033980: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-00033990: 7261 7469 6f6e 0d0a 2020 2020 2222 220d  ration..    """.
-000339a0: 0a0d 0a20 2020 2064 6566 205f 5f69 6e69  ...    def __ini
-000339b0: 745f 5f28 7365 6c66 2c20 6e61 6d65 2c20  t__(self, name, 
-000339c0: 6e61 7475 7265 3d22 7375 7266 6163 6573  nature="surfaces
-000339d0: 222c 2076 6572 626f 7365 3d31 2c20 7365  ", verbose=1, se
-000339e0: 6564 3d31 293a 0d0a 0d0a 2020 2020 2020  ed=1):....      
-000339f0: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
-00033a00: 6e63 6528 6e61 6d65 2c20 7374 7229 2c20  nce(name, str), 
-00033a10: 2241 206e 616d 6520 7368 6f75 6c64 2062  "A name should b
-00033a20: 6520 7072 6f76 6964 6564 2061 6e64 206d  e provided and m
-00033a30: 7573 7420 6265 2061 2073 7472 696e 6722  ust be a string"
-00033a40: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-00033a50: 6973 745f 756e 6974 733d 5b5d 0d0a 2020  ist_units=[]..  
-00033a60: 2020 2020 2020 7365 6c66 2e6e 616d 653d        self.name=
-00033a70: 6e61 6d65 0d0a 2020 2020 2020 2020 7365  name..        se
-00033a80: 6c66 2e76 6572 626f 7365 3d76 6572 626f  lf.verbose=verbo
-00033a90: 7365 0d0a 2020 2020 2020 2020 7365 6c66  se..        self
-00033aa0: 2e73 6565 643d 7365 6564 0d0a 2020 2020  .seed=seed..    
-00033ab0: 2020 2020 7365 6c66 2e6e 6174 7572 6520      self.nature 
-00033ac0: 3d20 6e61 7475 7265 0d0a 0d0a 0d0a 2020  = nature......  
-00033ad0: 2020 6465 6620 5f5f 7265 7072 5f5f 2873    def __repr__(s
-00033ae0: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
-00033af0: 6574 7572 6e20 7365 6c66 2e6e 616d 650d  eturn self.name.
-00033b00: 0a0d 0a20 2020 2064 6566 2061 6464 5f75  ...    def add_u
-00033b10: 6e69 7428 7365 6c66 2c20 756e 6974 293a  nit(self, unit):
-00033b20: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00033b30: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00033b40: 2041 6464 2061 2075 6e69 7420 746f 2074   Add a unit to t
-00033b50: 6865 2070 696c 650d 0a0d 0a20 2020 2020  he pile....     
-00033b60: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00033b70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00033b80: 2d0d 0a20 2020 2020 2020 2075 6e69 743a  -..        unit:
-00033b90: 2055 6e69 7420 6f62 6a65 6374 206f 7220   Unit object or 
-00033ba0: 6c69 7374 206f 6620 556e 6974 206f 626a  list of Unit obj
-00033bb0: 6563 7473 0d0a 2020 2020 2020 2020 2020  ects..          
-00033bc0: 2020 756e 6974 2873 2920 746f 2061 6464    unit(s) to add
-00033bd0: 2074 6f20 7468 6520 7069 6c65 0d0a 2020   to the pile..  
-00033be0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-00033bf0: 2020 2020 2074 7279 3a20 2369 7465 7261       try: #itera
-00033c00: 626c 650d 0a20 2020 2020 2020 2020 2020  ble..           
-00033c10: 2066 6f72 2069 2069 6e20 756e 6974 3a0d   for i in unit:.
-00033c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033c30: 2069 6620 2869 7369 6e73 7461 6e63 6528   if (isinstance(
-00033c40: 692c 2055 6e69 7429 2920 616e 6420 2869  i, Unit)) and (i
-00033c50: 206e 6f74 2069 6e20 7365 6c66 2e6c 6973   not in self.lis
-00033c60: 745f 756e 6974 7329 3a0d 0a20 2020 2020  t_units):..     
-00033c70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00033c80: 2e76 6572 626f 7365 203d 2073 656c 662e  .verbose = self.
-00033c90: 7665 7262 6f73 650d 0a20 2020 2020 2020  verbose..       
-00033ca0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00033cb0: 662e 6c69 7374 5f75 6e69 7473 2e61 7070  f.list_units.app
-00033cc0: 656e 6428 6929 0d0a 2020 2020 2020 2020  end(i)..        
-00033cd0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00033ce0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-00033cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d00: 2020 2020 2020 7072 696e 7428 2253 7472        print("Str
-00033d10: 6174 6967 7261 7068 6963 2075 6e69 7420  atigraphic unit 
-00033d20: 7b7d 2061 6464 6564 222e 666f 726d 6174  {} added".format
-00033d30: 2869 2e6e 616d 6529 290d 0a20 2020 2020  (i.name))..     
-00033d40: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00033d50: 2869 7369 6e73 7461 6e63 6528 692c 2055  (isinstance(i, U
-00033d60: 6e69 7429 293a 0d0a 2020 2020 2020 2020  nit)):..        
-00033d70: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00033d80: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-00033d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033da0: 2020 2020 2020 7072 696e 7428 226f 626a        print("obj
-00033db0: 6563 7420 6973 2061 6c72 6561 6479 2069  ect is already i
-00033dc0: 6e20 7468 6520 6c69 7374 2229 0d0a 2020  n the list")..  
-00033dd0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00033de0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00033df0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00033e00: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
-00033e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033e20: 2020 2070 7269 6e74 2822 6f62 6a65 6374     print("object
-00033e30: 2069 736e 2774 2061 2075 6e69 7420 6f62   isn't a unit ob
-00033e40: 6a65 6374 2229 0d0a 2020 2020 2020 2020  ject")..        
-00033e50: 6578 6365 7074 3a20 2320 756e 6974 206e  except: # unit n
-00033e60: 6f74 2069 6e20 6120 6c69 7374 0d0a 2020  ot in a list..  
-00033e70: 2020 2020 2020 2020 2020 6966 2028 6973            if (is
-00033e80: 696e 7374 616e 6365 2875 6e69 742c 2055  instance(unit, U
-00033e90: 6e69 7429 2920 616e 6420 2875 6e69 7420  nit)) and (unit 
-00033ea0: 6e6f 7420 696e 2073 656c 662e 6c69 7374  not in self.list
-00033eb0: 5f75 6e69 7473 293a 0d0a 2020 2020 2020  _units):..      
-00033ec0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00033ed0: 6973 745f 756e 6974 732e 6170 7065 6e64  ist_units.append
-00033ee0: 2875 6e69 7429 0d0a 2020 2020 2020 2020  (unit)..        
-00033ef0: 2020 2020 2020 2020 756e 6974 2e76 6572          unit.ver
-00033f00: 626f 7365 203d 2073 656c 662e 7665 7262  bose = self.verb
-00033f10: 6f73 650d 0a20 2020 2020 2020 2020 2020  ose..           
-00033f20: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00033f30: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-00033f40: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00033f50: 2822 5374 7261 7469 6772 6170 6869 6320  ("Stratigraphic 
-00033f60: 756e 6974 207b 7d20 6164 6465 6422 2e66  unit {} added".f
-00033f70: 6f72 6d61 7428 756e 6974 2e6e 616d 6529  ormat(unit.name)
-00033f80: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00033f90: 6c69 6620 2869 7369 6e73 7461 6e63 6528  lif (isinstance(
-00033fa0: 756e 6974 2c20 556e 6974 2929 3a0d 0a20  unit, Unit)):.. 
-00033fb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00033fc0: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00033fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033fe0: 2020 2020 2070 7269 6e74 2822 6f62 6a65       print("obje
-00033ff0: 6374 2069 7320 616c 7265 6164 7920 696e  ct is already in
-00034000: 2074 6865 206c 6973 7422 290d 0a20 2020   the list")..   
-00034010: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00034020: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00034030: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00034040: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-00034050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034060: 2020 7072 696e 7428 226f 626a 6563 7420    print("object 
-00034070: 6973 6e27 7420 6120 756e 6974 206f 626a  isn't a unit obj
-00034080: 6563 7422 290d 0a0d 0a20 2020 2064 6566  ect")....    def
-00034090: 2072 656d 6f76 655f 756e 6974 2873 656c   remove_unit(sel
-000340a0: 662c 2075 6e69 745f 746f 5f72 656d 293a  f, unit_to_rem):
-000340b0: 0d0a 0d0a 2020 2020 2020 2020 2222 2252  ....        """R
-000340c0: 656d 6f76 6520 7468 6520 6769 7665 6e20  emove the given 
-000340d0: 756e 6974 206f 626a 6563 7420 6672 6f6d  unit object from
-000340e0: 2050 696c 6520 6f62 6a65 6374 0d0a 2020   Pile object..  
-000340f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00034100: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00034110: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00034120: 2020 2020 2020 2020 756e 6974 5f74 6f5f          unit_to_
-00034130: 7265 6d3a 203a 636c 6173 733a 6055 6e69  rem: :class:`Uni
-00034140: 7460 206f 626a 6563 740d 0a20 2020 2020  t` object..     
-00034150: 2020 2020 2020 2075 6e69 7420 746f 2072         unit to r
-00034160: 656d 6f76 6520 6672 6f6d 2074 6865 2070  emove from the p
-00034170: 696c 650d 0a20 2020 2020 2020 2022 2222  ile..        """
-00034180: 0d0a 0d0a 2020 2020 2020 2020 6966 206c  ....        if l
-00034190: 656e 2873 656c 662e 6c69 7374 5f75 6e69  en(self.list_uni
-000341a0: 7473 2920 3e20 303a 0d0a 2020 2020 2020  ts) > 0:..      
-000341b0: 2020 2020 2020 6966 2075 6e69 745f 746f        if unit_to
-000341c0: 5f72 656d 2069 6e20 7365 6c66 2e6c 6973  _rem in self.lis
-000341d0: 745f 756e 6974 733a 0d0a 2020 2020 2020  t_units:..      
-000341e0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-000341f0: 6973 745f 756e 6974 732e 7265 6d6f 7665  ist_units.remove
-00034200: 2875 6e69 745f 746f 5f72 656d 290d 0a20  (unit_to_rem).. 
-00034210: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00034220: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00034230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034240: 2020 2020 2070 7269 6e74 2822 556e 6974       print("Unit
-00034250: 207b 7d20 7265 6d6f 7665 6420 6672 6f6d   {} removed from
-00034260: 2050 696c 6520 7b7d 222e 666f 726d 6174   Pile {}".format
-00034270: 2875 6e69 745f 746f 5f72 656d 2e6e 616d  (unit_to_rem.nam
-00034280: 652c 2073 656c 662e 6e61 6d65 2929 0d0a  e, self.name))..
-00034290: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000342a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000342b0: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
-000342c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000342d0: 7269 6e74 2822 6e6f 2075 6e69 7473 2066  rint("no units f
-000342e0: 6f75 6e64 2069 6e20 7069 6c65 207b 7d22  ound in pile {}"
-000342f0: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
-00034300: 6529 290d 0a0d 0a20 2020 2064 6566 206f  e))....    def o
-00034310: 7264 6572 5f75 6e69 7473 2873 656c 662c  rder_units(self,
-00034320: 2076 623d 3129 3a0d 0a0d 0a20 2020 2020   vb=1):....     
-00034330: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00034340: 4f72 6465 7220 6c69 7374 5f6c 6974 6873  Order list_liths
-00034350: 2061 6363 6f72 6469 6e67 2074 6865 206f   according the o
-00034360: 7264 6572 2061 7474 7269 6275 7465 7320  rder attributes 
-00034370: 6f66 2065 6163 6820 6c69 7468 6f6c 6f67  of each litholog
-00034380: 6965 730d 0a0d 0a20 2020 2020 2020 2050  ies....        P
-00034390: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-000343a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-000343b0: 2020 2020 2020 2076 623a 2069 6e74 0d0a         vb: int..
-000343c0: 2020 2020 2020 2020 2020 2020 6c65 7665              leve
-000343d0: 6c20 6f66 2076 6572 626f 7369 7479 2c20  l of verbosity, 
-000343e0: 3020 666f 7220 6e6f 2070 7269 6e74 2c20  0 for no print, 
-000343f0: 3120 666f 7220 7072 696e 740d 0a20 2020  1 for print..   
-00034400: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-00034410: 2020 2020 6966 2076 623a 0d0a 2020 2020      if vb:..    
-00034420: 2020 2020 2020 2020 7072 696e 7428 2250          print("P
-00034430: 696c 6520 7b7d 3a20 6f72 6465 7269 6e67  ile {}: ordering
-00034440: 2075 6e69 7473 222e 666f 726d 6174 2873   units".format(s
-00034450: 656c 662e 6e61 6d65 2929 0d0a 0d0a 2020  elf.name))....  
-00034460: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
-00034470: 756e 6974 732e 736f 7274 286b 6579 3d6c  units.sort(key=l
-00034480: 616d 6264 6120 783a 2078 2e6f 7264 6572  ambda x: x.order
-00034490: 290d 0a20 2020 2020 2020 2069 6620 7662  )..        if vb
-000344a0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-000344b0: 7269 6e74 2822 5374 7261 7469 6772 6170  rint("Stratigrap
-000344c0: 6869 6320 756e 6974 7320 6861 7665 2062  hic units have b
-000344d0: 6565 6e20 736f 7274 6564 2061 6363 6f72  een sorted accor
-000344e0: 6469 6e67 2074 6f20 6f72 6465 7222 290d  ding to order").
-000344f0: 0a0d 0a20 2020 2020 2020 2069 3d30 0d0a  ...        i=0..
-00034500: 2020 2020 2020 2020 666c 6167 3d30 0d0a          flag=0..
-00034510: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-00034520: 6f72 6465 7273 206f 6620 756e 6974 0d0a  orders of unit..
-00034530: 2020 2020 2020 2020 666f 7220 7320 696e          for s in
-00034540: 2073 656c 662e 6c69 7374 5f75 6e69 7473   self.list_units
-00034550: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00034560: 6620 6920 3d3d 2030 3a0d 0a20 2020 2020  f i == 0:..     
-00034570: 2020 2020 2020 2020 2020 2073 5f62 6566             s_bef
-00034580: 3d73 0d0a 2020 2020 2020 2020 2020 2020  =s..            
-00034590: 2020 2020 6966 2073 5f62 6566 2e6f 7264      if s_bef.ord
-000345a0: 6572 2021 3d20 313a 0d0a 2020 2020 2020  er != 1:..      
-000345b0: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-000345c0: 6167 3d31 0d0a 2020 2020 2020 2020 2020  ag=1..          
-000345d0: 2020 2020 2020 2020 2020 6966 2076 623a            if vb:
-000345e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000345f0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00034600: 2266 6972 7374 2075 6e69 7420 6f72 6465  "first unit orde
-00034610: 7220 6973 206e 6f74 2065 7175 616c 2074  r is not equal t
-00034620: 6f20 3122 290d 0a0d 0a20 2020 2020 2020  o 1")....       
-00034630: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00034640: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00034650: 2e6f 7264 6572 203d 3d20 735f 6265 662e  .order == s_bef.
-00034660: 6f72 6465 723a 0d0a 2020 2020 2020 2020  order:..        
-00034670: 2020 2020 2020 2020 2020 2020 666c 6167              flag
-00034680: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
-00034690: 2020 2020 2020 2020 6966 2076 623a 0d0a          if vb:..
-000346a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000346b0: 2020 2020 2020 2020 7072 696e 7428 2275          print("u
-000346c0: 6e69 7473 207b 7d20 616e 6420 7b7d 2068  nits {} and {} h
-000346d0: 6176 6520 7468 6520 7361 6d65 206f 7264  ave the same ord
-000346e0: 6572 222e 666f 726d 6174 2873 2e6e 616d  er".format(s.nam
-000346f0: 652c 2073 5f62 6566 2e6e 616d 6529 290d  e, s_bef.name)).
-00034700: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00034710: 2020 2065 6c69 6620 732e 6f72 6465 7220     elif s.order 
-00034720: 213d 2073 5f62 6566 2e6f 7264 6572 202b  != s_bef.order +
-00034730: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-00034740: 2020 2020 2020 2020 2066 6c61 673d 310d           flag=1.
-00034750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034760: 2020 2020 2069 6620 7662 3a0d 0a20 2020       if vb:..   
-00034770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034780: 2020 2020 2070 7269 6e74 2822 4469 7363       print("Disc
-00034790: 7265 7065 6e63 7920 696e 2074 6865 206f  repency in the o
-000347a0: 7264 6572 7320 666f 7220 756e 6974 7320  rders for units 
-000347b0: 7b7d 2061 6e64 207b 7d22 2e66 6f72 6d61  {} and {}".forma
-000347c0: 7428 732e 6e61 6d65 2c20 735f 6265 662e  t(s.name, s_bef.
-000347d0: 6e61 6d65 2929 0d0a 0d0a 2020 2020 2020  name))....      
-000347e0: 2020 2020 2020 2020 2020 735f 6265 663d            s_bef=
-000347f0: 730d 0a20 2020 2020 2020 2020 2020 2069  s..            i
-00034800: 202b 3d20 310d 0a0d 0a20 2020 2020 2020   += 1....       
-00034810: 2069 6620 666c 6167 3a0d 0a20 2020 2020   if flag:..     
-00034820: 2020 2020 2020 2069 6620 7662 3a0d 0a20         if vb:.. 
-00034830: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00034840: 7269 6e74 2822 4368 616e 6769 6e67 206f  rint("Changing o
-00034850: 7264 6572 7320 666f 7220 7468 6174 2074  rders for that t
-00034860: 6865 7920 7261 6e67 6520 6672 6f6d 2031  hey range from 1
-00034870: 2074 6f20 6e22 290d 0a20 2020 2020 2020   to n")..       
-00034880: 2020 2020 2023 2063 6865 636b 206f 7264       # check ord
-00034890: 6572 2072 616e 6769 6e67 2066 726f 6d20  er ranging from 
-000348a0: 3120 746f 206e 0d0a 2020 2020 2020 2020  1 to n..        
-000348b0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-000348c0: 6765 286c 656e 2873 656c 662e 6c69 7374  ge(len(self.list
-000348d0: 5f75 6e69 7473 2929 3a0d 0a20 2020 2020  _units)):..     
-000348e0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000348f0: 6c66 2e6c 6973 745f 756e 6974 735b 695d  lf.list_units[i]
-00034900: 2e6f 7264 6572 2021 3d20 692b 313a 0d0a  .order != i+1:..
+0002f990: 2020 206d 6173 6b3d 7365 6c66 2e75 6e69     mask=self.uni
+0002f9a0: 745f 6d61 736b 2875 2c20 6975 3d69 7529  t_mask(u, iu=iu)
+0002f9b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002f9c0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+0002f9d0: 7461 6e63 6528 752c 2055 6e69 7429 2061  tance(u, Unit) a
+0002f9e0: 6e64 2075 2069 6e20 7365 6c66 2e67 6574  nd u in self.get
+0002f9f0: 5f61 6c6c 5f75 6e69 7473 2829 3a0d 0a20  _all_units():.. 
+0002fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa10: 2020 2020 2020 206d 6173 6b3d 7365 6c66         mask=self
+0002fa20: 2e75 6e69 745f 6d61 736b 2875 2e6e 616d  .unit_mask(u.nam
+0002fa30: 652c 2069 753d 6975 290d 0a20 2020 2020  e, iu=iu)..     
+0002fa40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002fa50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0002fa60: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0002fa70: 6973 6520 5661 6c75 6545 7272 6f72 2028  ise ValueError (
+0002fa80: 2255 6e69 7420 7061 7373 6564 2069 6e20  "Unit passed in 
+0002fa90: 696e 7369 6465 5f75 6e69 7473 206d 7573  inside_units mus
+0002faa0: 7420 6265 2061 2075 6e69 7420 6e61 6d65  t be a unit name
+0002fab0: 206f 7220 6120 756e 6974 206f 626a 6563   or a unit objec
+0002fac0: 7420 636f 6e74 6169 6e65 6420 696e 2074  t contained in t
+0002fad0: 6865 2041 7263 6854 6162 6c65 2229 0d0a  he ArchTable")..
+0002fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002faf0: 2020 2020 6d61 736b 5f61 6c6c 5b69 752c      mask_all[iu,
+0002fb00: 3a2c 3a2c 6d61 736b 203d 3d20 315d 3d31  :,:,mask == 1]=1
+0002fb10: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0002fb20: 7072 6f70 5b6d 6173 6b5f 616c 6c20 213d  prop[mask_all !=
+0002fb30: 2031 5d3d 6e70 2e6e 616e 0d0a 0d0a 2020   1]=np.nan....  
+0002fb40: 2020 2020 2020 236b 6565 7020 7661 6c75        #keep valu
+0002fb50: 6573 2069 6e20 6f6e 6c79 2077 616e 7465  es in only wante
+0002fb60: 6420 6661 6369 6573 0d0a 2020 2020 2020  d facies..      
+0002fb70: 2020 6966 2069 6e73 6964 655f 6661 6369    if inside_faci
+0002fb80: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a0d  es is not None:.
+0002fb90: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+0002fba0: 6b5f 616c 6c3d 6e70 2e7a 6572 6f73 2870  k_all=np.zeros(p
+0002fbb0: 726f 705f 7368 6170 6529 0d0a 2020 2020  rop_shape)..    
+0002fbc0: 2020 2020 2020 2020 666f 7220 6975 2069          for iu i
+0002fbd0: 6e20 7261 6e67 6528 6e72 6561 6c5f 756e  n range(nreal_un
+0002fbe0: 6974 7329 3a0d 0a20 2020 2020 2020 2020  its):..         
+0002fbf0: 2020 2020 2020 2066 6f72 2069 6661 2069         for ifa i
+0002fc00: 6e20 7261 6e67 6528 7365 6c66 2e6e 7265  n range(self.nre
+0002fc10: 616c 5f66 6129 3a0d 0a20 2020 2020 2020  al_fa):..       
+0002fc20: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0002fc30: 2066 6120 696e 2069 6e73 6964 655f 6661   fa in inside_fa
+0002fc40: 6369 6573 3a0d 0a20 2020 2020 2020 2020  cies:..         
+0002fc50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002fc60: 6620 6973 696e 7374 616e 6365 2866 612c  f isinstance(fa,
+0002fc70: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
+0002fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc90: 2020 2020 6d61 736b 3d28 6661 6369 6573      mask=(facies
+0002fca0: 5b69 752c 6966 615d 203d 3d20 7365 6c66  [iu,ifa] == self
+0002fcb0: 2e67 6574 5f66 6163 6965 735f 6f62 6a28  .get_facies_obj(
+0002fcc0: 6661 292e 4944 290d 0a20 2020 2020 2020  fa).ID)..       
+0002fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fce0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0002fcf0: 2866 612c 2046 6163 6965 7329 2061 6e64  (fa, Facies) and
+0002fd00: 2066 6120 696e 2073 656c 662e 6765 745f   fa in self.get_
+0002fd10: 616c 6c5f 6661 6369 6573 2829 3a0d 0a20  all_facies():.. 
+0002fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd30: 2020 2020 2020 2020 2020 206d 6173 6b3d             mask=
+0002fd40: 2866 6163 6965 735b 6975 2c69 6661 5d20  (facies[iu,ifa] 
+0002fd50: 3d3d 2066 612e 4944 290d 0a20 2020 2020  == fa.ID)..     
+0002fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd70: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0002fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd90: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002fda0: 6545 7272 6f72 2028 2255 6e69 7420 7061  eError ("Unit pa
+0002fdb0: 7373 6564 2069 6e20 696e 7369 6465 5f75  ssed in inside_u
+0002fdc0: 6e69 7473 206d 7573 7420 6265 2061 2075  nits must be a u
+0002fdd0: 6e69 7420 6e61 6d65 206f 7220 6120 756e  nit name or a un
+0002fde0: 6974 206f 626a 6563 7420 636f 6e74 6169  it object contai
+0002fdf0: 6e65 6420 696e 2074 6865 2041 7263 6854  ned in the ArchT
+0002fe00: 6162 6c65 2229 0d0a 2020 2020 2020 2020  able")..        
+0002fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe20: 6d61 736b 5f61 6c6c 5b69 752c 6966 612c  mask_all[iu,ifa,
+0002fe30: 3a2c 6d61 736b 203d 3d20 315d 3d31 0d0a  :,mask == 1]=1..
+0002fe40: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+0002fe50: 6f70 5b6d 6173 6b5f 616c 6c20 213d 2031  op[mask_all != 1
+0002fe60: 5d3d 6e70 2e6e 616e 0d0a 0d0a 2020 2020  ]=np.nan....    
+0002fe70: 2020 2020 6966 207e 7072 6f70 2e61 6e79      if ~prop.any
+0002fe80: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+0002fe90: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0002fea0: 7220 2822 4572 726f 723a 204e 6f20 7661  r ("Error: No va
+0002feb0: 6c75 6573 2066 6f75 6e64 2229 0d0a 0d0a  lues found")....
+0002fec0: 2020 2020 2020 2020 6966 2074 7970 6520          if type 
+0002fed0: 3d3d 2022 6172 6974 686d 6574 6963 223a  == "arithmetic":
+0002fee0: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+0002fef0: 723d 6e70 2e6e 616e 6d65 616e 2870 726f  r=np.nanmean(pro
+0002ff00: 702e 7265 7368 6170 6528 2d31 2c73 656c  p.reshape(-1,sel
+0002ff10: 662e 6765 745f 6e7a 2829 2c73 656c 662e  f.get_nz(),self.
+0002ff20: 6765 745f 6e79 2829 2c73 656c 662e 6765  get_ny(),self.ge
+0002ff30: 745f 6e78 2829 292c 6178 6973 3d30 290d  t_nx()),axis=0).
+0002ff40: 0a0d 0a20 2020 2020 2020 2065 6c69 6620  ...        elif 
+0002ff50: 7479 7065 203d 3d20 2273 7464 223a 0d0a  type == "std":..
+0002ff60: 2020 2020 2020 2020 2020 2020 6172 723d              arr=
+0002ff70: 6e70 2e6e 616e 7374 6428 7072 6f70 2e72  np.nanstd(prop.r
+0002ff80: 6573 6861 7065 282d 312c 7365 6c66 2e67  eshape(-1,self.g
+0002ff90: 6574 5f6e 7a28 292c 7365 6c66 2e67 6574  et_nz(),self.get
+0002ffa0: 5f6e 7928 292c 7365 6c66 2e67 6574 5f6e  _ny(),self.get_n
+0002ffb0: 7828 2929 2c61 7869 733d 3029 0d0a 0d0a  x()),axis=0)....
+0002ffc0: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
+0002ffd0: 6520 3d3d 2022 6d65 6469 616e 223a 0d0a  e == "median":..
+0002ffe0: 2020 2020 2020 2020 2020 2020 6172 723d              arr=
+0002fff0: 6e70 2e6e 616e 6d65 6469 616e 2870 726f  np.nanmedian(pro
+00030000: 702e 7265 7368 6170 6528 2d31 2c73 656c  p.reshape(-1,sel
+00030010: 662e 6765 745f 6e7a 2829 2c73 656c 662e  f.get_nz(),self.
+00030020: 6765 745f 6e79 2829 2c73 656c 662e 6765  get_ny(),self.ge
+00030030: 745f 6e78 2829 292c 6178 6973 3d30 290d  t_nx()),axis=0).
+00030040: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00030050: 706c 6f74 5f61 7272 2861 7272 2c70 726f  plot_arr(arr,pro
+00030060: 7065 7274 792c 765f 6578 3d76 5f65 782c  perty,v_ex=v_ex,
+00030070: 2070 6c6f 7474 6572 3d70 6c6f 7474 6572   plotter=plotter
+00030080: 2c20 736c 6963 6578 3d73 6c69 6365 782c  , slicex=slicex,
+00030090: 2073 6c69 6365 793d 736c 6963 6579 2c20   slicey=slicey, 
+000300a0: 736c 6963 657a 3d73 6c69 6365 7a2c 0d0a  slicez=slicez,..
+000300b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300c0: 2020 2020 2020 636d 696e 3d63 6d69 6e2c        cmin=cmin,
+000300d0: 2063 6d61 783d 636d 6178 2c20 7363 616c   cmax=cmax, scal
+000300e0: 6172 5f62 6172 5f6b 7761 7267 733d 7363  ar_bar_kwargs=sc
+000300f0: 616c 6172 5f62 6172 5f6b 7761 7267 732c  alar_bar_kwargs,
+00030100: 202a 2a6b 7761 7267 7329 0d0a 0d0a 0d0a   **kwargs)......
+00030110: 2020 2020 6465 6620 706c 6f74 5f61 7272      def plot_arr
+00030120: 2873 656c 662c 6172 722c 7661 725f 6e61  (self,arr,var_na
+00030130: 6d65 203d 2256 3022 2c76 5f65 783d 312c  me ="V0",v_ex=1,
+00030140: 2070 6c6f 7474 6572 3d4e 6f6e 652c 2073   plotter=None, s
+00030150: 6c69 6365 783d 4e6f 6e65 2c20 736c 6963  licex=None, slic
+00030160: 6579 3d4e 6f6e 652c 2073 6c69 6365 7a3d  ey=None, slicez=
+00030170: 4e6f 6e65 2c20 6669 6c74 6572 696e 675f  None, filtering_
+00030180: 696e 7465 7276 616c 3d4e 6f6e 652c 0d0a  interval=None,..
+00030190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301a0: 2063 6d69 6e3d 4e6f 6e65 2c20 636d 6178   cmin=None, cmax
+000301b0: 3d4e 6f6e 652c 2073 6361 6c61 725f 6261  =None, scalar_ba
+000301c0: 725f 6b77 6172 6773 3d4e 6f6e 652c 202a  r_kwargs=None, *
+000301d0: 2a6b 7761 7267 7329 3a0d 0a0d 0a20 2020  *kwargs):....   
+000301e0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000301f0: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+00030200: 706c 6f74 2061 2033 4420 6172 7261 7920  plot a 3D array 
+00030210: 7769 7468 2074 6865 2073 616d 6520 7369  with the same si
+00030220: 7a65 206f 6620 7468 6520 7369 6d75 6c61  ze of the simula
+00030230: 7469 6f6e 2064 6f6d 6169 6e0d 0a0d 0a20  tion domain.... 
+00030240: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00030250: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00030260: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
+00030270: 7272 3a20 3344 2061 7272 6179 0d0a 2020  rr: 3D array..  
+00030280: 2020 2020 2020 2020 2020 6172 7261 7920            array 
+00030290: 746f 2070 6c6f 742e 2053 697a 6520 6f66  to plot. Size of
+000302a0: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
+000302b0: 646f 6d61 696e 2028 6e78 2c20 6e79 2c20  domain (nx, ny, 
+000302c0: 6e7a 2920 2020 0d0a 2020 2020 2020 2020  nz)   ..        
+000302d0: 7661 725f 6e61 6d65 3a20 7374 720d 0a20  var_name: str.. 
+000302e0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+000302f0: 626c 6520 6e61 6d65 7320 746f 2070 6c6f  ble names to plo
+00030300: 7420 616e 6420 746f 2073 686f 7720 696e  t and to show in
+00030310: 2074 6865 2070 7976 6973 7461 2070 6c6f   the pyvista plo
+00030320: 740d 0a20 2020 2020 2020 2076 5f65 783a  t..        v_ex:
+00030330: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
+00030340: 2020 2020 7665 7274 6963 616c 2065 7861      vertical exa
+00030350: 6767 6572 6174 696f 6e0d 0a20 2020 2020  ggeration..     
+00030360: 2020 2070 6c6f 7474 6572 3a20 7079 7669     plotter: pyvi
+00030370: 7374 612e 506c 6f74 7465 720d 0a20 2020  sta.Plotter..   
+00030380: 2020 2020 2020 2020 2070 7976 6973 7461           pyvista
+00030390: 2070 6c6f 7474 6572 2074 6f20 706c 6f74   plotter to plot
+000303a0: 206f 6e0d 0a20 2020 2020 2020 2073 6c69   on..        sli
+000303b0: 6365 783a 2066 6c6f 6174 206f 7220 7365  cex: float or se
+000303c0: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
+000303d0: 0d0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
+000303e0: 6163 7469 6f6e 206f 6620 7468 6520 7820  action of the x 
+000303f0: 6178 6973 2074 6f20 706c 6f74 0d0a 2020  axis to plot..  
+00030400: 2020 2020 2020 736c 6963 6579 3a20 666c        slicey: fl
+00030410: 6f61 7420 6f72 2073 6571 7565 6e63 6520  oat or sequence 
+00030420: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
+00030430: 2020 2020 2020 2066 7261 6374 696f 6e20         fraction 
+00030440: 6f66 2074 6865 2079 2061 7869 7320 746f  of the y axis to
+00030450: 2070 6c6f 740d 0a20 2020 2020 2020 2073   plot..        s
+00030460: 6c69 6365 7a3a 2066 6c6f 6174 206f 7220  licez: float or 
+00030470: 7365 7175 656e 6365 206f 6620 666c 6f61  sequence of floa
+00030480: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+00030490: 6672 6163 7469 6f6e 206f 6620 7468 6520  fraction of the 
+000304a0: 7a20 6178 6973 2074 6f20 706c 6f74 0d0a  z axis to plot..
+000304b0: 2020 2020 2020 2020 6669 6c74 6572 696e          filterin
+000304c0: 675f 696e 7465 7276 616c 3a20 6c69 7374  g_interval: list
+000304d0: 206f 6620 7477 6f20 666c 6f61 7473 0d0a   of two floats..
+000304e0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+000304f0: 7276 616c 206f 6620 7661 6c75 6573 2074  rval of values t
+00030500: 6f20 6b65 6570 0d0a 2020 2020 2020 2020  o keep..        
+00030510: 636d 696e 3a20 666c 6f61 740d 0a20 2020  cmin: float..   
+00030520: 2020 2020 2020 2020 206d 696e 696d 756d           minimum
+00030530: 2076 616c 7565 2066 6f72 2074 6865 2063   value for the c
+00030540: 6f6c 6f72 6261 720d 0a20 2020 2020 2020  olorbar..       
+00030550: 2063 6d61 783a 2066 6c6f 6174 0d0a 2020   cmax: float..  
+00030560: 2020 2020 2020 2020 2020 6d61 7869 6d75            maximu
+00030570: 6d20 7661 6c75 6520 666f 7220 7468 6520  m value for the 
+00030580: 636f 6c6f 7262 6172 0d0a 2020 2020 2020  colorbar..      
+00030590: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
+000305a0: 7267 733a 2064 6963 740d 0a20 2020 2020  rgs: dict..     
+000305b0: 2020 2020 2020 2064 6963 7469 6f6e 6172         dictionar
+000305c0: 7920 6f66 2061 7267 756d 656e 7473 2074  y of arguments t
+000305d0: 6f20 7061 7373 2074 6f20 7468 6520 7079  o pass to the py
+000305e0: 7669 7374 6120 7363 616c 6172 2062 6172  vista scalar bar
+000305f0: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+00030600: 0a20 2020 2020 2020 206e 783d 7365 6c66  .        nx=self
+00030610: 2e67 6574 5f6e 7828 290d 0a20 2020 2020  .get_nx()..     
+00030620: 2020 206e 793d 7365 6c66 2e67 6574 5f6e     ny=self.get_n
+00030630: 7928 290d 0a20 2020 2020 2020 206e 7a3d  y()..        nz=
+00030640: 7365 6c66 2e67 6574 5f6e 7a28 290d 0a20  self.get_nz().. 
+00030650: 2020 2020 2020 2073 783d 7365 6c66 2e67         sx=self.g
+00030660: 6574 5f73 7828 290d 0a20 2020 2020 2020  et_sx()..       
+00030670: 2073 793d 7365 6c66 2e67 6574 5f73 7928   sy=self.get_sy(
+00030680: 290d 0a20 2020 2020 2020 2073 7a3d 7365  )..        sz=se
+00030690: 6c66 2e67 6574 5f73 7a28 290d 0a20 2020  lf.get_sz()..   
+000306a0: 2020 2020 2078 303d 7365 6c66 2e67 6574       x0=self.get
+000306b0: 5f6f 7828 290d 0a20 2020 2020 2020 2079  _ox()..        y
+000306c0: 303d 7365 6c66 2e67 6574 5f6f 7928 290d  0=self.get_oy().
+000306d0: 0a20 2020 2020 2020 207a 303d 7365 6c66  .        z0=self
+000306e0: 2e67 6574 5f6f 7a28 290d 0a0d 0a20 2020  .get_oz()....   
+000306f0: 2020 2020 2061 7373 6572 7420 6172 722e       assert arr.
+00030700: 7368 6170 6520 3d3d 2028 6e7a 2c20 6e79  shape == (nz, ny
+00030710: 2c20 6e78 292c 2022 496e 7661 6c69 6420  , nx), "Invalid 
+00030720: 7368 6170 6520 666f 7220 6172 7261 792c  shape for array,
+00030730: 206d 7573 7420 6265 2065 7175 616c 2074   must be equal t
+00030740: 6f20 7b7d 222e 666f 726d 6174 286e 7a2c  o {}".format(nz,
+00030750: 206e 792c 206e 7829 0d0a 0d0a 2020 2020   ny, nx)....    
+00030760: 2020 2020 6966 2070 6c6f 7474 6572 2069      if plotter i
+00030770: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00030780: 2020 2020 2070 3d70 762e 506c 6f74 7465       p=pv.Plotte
+00030790: 7228 290d 0a20 2020 2020 2020 2065 6c73  r()..        els
+000307a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000307b0: 703d 706c 6f74 7465 720d 0a20 2020 2020  p=plotter..     
+000307c0: 2020 2069 6d3d 6765 6f6e 652e 696d 672e     im=geone.img.
+000307d0: 496d 6728 6e78 2c20 6e79 2c20 6e7a 2c20  Img(nx, ny, nz, 
+000307e0: 7378 2c20 7379 2c20 737a 2a76 5f65 782c  sx, sy, sz*v_ex,
+000307f0: 2078 302c 2079 302c 207a 302c 206e 763d   x0, y0, z0, nv=
+00030800: 312c 2076 616c 3d61 7272 2c20 7661 726e  1, val=arr, varn
+00030810: 616d 653d 7661 725f 6e61 6d65 290d 0a0d  ame=var_name)...
+00030820: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
+00030830: 6578 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ex is not None:.
+00030840: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
+00030850: 6365 783d 6e70 2e61 7272 6179 2873 6c69  cex=np.array(sli
+00030860: 6365 7829 0d0a 2020 2020 2020 2020 2020  cex)..          
+00030870: 2020 736c 6963 6578 5b73 6c69 6365 783c    slicex[slicex<
+00030880: 305d 3d30 0d0a 2020 2020 2020 2020 2020  0]=0..          
+00030890: 2020 736c 6963 6578 5b73 6c69 6365 783e    slicex[slicex>
+000308a0: 315d 3d31 0d0a 2020 2020 2020 2020 2020  1]=1..          
+000308b0: 2020 6378 3d69 6d2e 6f78 202b 2073 6c69    cx=im.ox + sli
+000308c0: 6365 7820 2a20 696d 2e6e 7820 2a20 696d  cex * im.nx * im
+000308d0: 2e73 7820 2023 2063 656e 7465 7220 616c  .sx  # center al
+000308e0: 6f6e 6720 780d 0a20 2020 2020 2020 2065  ong x..        e
+000308f0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00030900: 2020 6378 3d4e 6f6e 650d 0a20 2020 2020    cx=None..     
+00030910: 2020 2069 6620 736c 6963 6579 2069 7320     if slicey is 
+00030920: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+00030930: 2020 2020 2020 2073 6c69 6365 793d 6e70         slicey=np
+00030940: 2e61 7272 6179 2873 6c69 6365 7929 0d0a  .array(slicey)..
+00030950: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+00030960: 6579 5b73 6c69 6365 793c 305d 3d30 0d0a  ey[slicey<0]=0..
+00030970: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+00030980: 6579 5b73 6c69 6365 793e 315d 3d31 0d0a  ey[slicey>1]=1..
+00030990: 2020 2020 2020 2020 2020 2020 6379 3d69              cy=i
+000309a0: 6d2e 6f79 202b 2073 6c69 6365 7920 2a20  m.oy + slicey * 
+000309b0: 696d 2e6e 7920 2a20 696d 2e73 7920 2023  im.ny * im.sy  #
+000309c0: 2063 656e 7465 7220 616c 6f6e 6720 790d   center along y.
+000309d0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+000309e0: 2020 2020 2020 2020 2020 2020 6379 3d4e              cy=N
+000309f0: 6f6e 650d 0a20 2020 2020 2020 2069 6620  one..        if 
+00030a00: 736c 6963 657a 2069 7320 6e6f 7420 4e6f  slicez is not No
+00030a10: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00030a20: 2073 6c69 6365 7a3d 6e70 2e61 7272 6179   slicez=np.array
+00030a30: 2873 6c69 6365 7a29 0d0a 2020 2020 2020  (slicez)..      
+00030a40: 2020 2020 2020 736c 6963 657a 5b73 6c69        slicez[sli
+00030a50: 6365 7a3c 305d 3d30 0d0a 2020 2020 2020  cez<0]=0..      
+00030a60: 2020 2020 2020 736c 6963 657a 5b73 6c69        slicez[sli
+00030a70: 6365 7a3e 315d 3d31 0d0a 2020 2020 2020  cez>1]=1..      
+00030a80: 2020 2020 2020 637a 3d69 6d2e 6f7a 202b        cz=im.oz +
+00030a90: 2073 6c69 6365 7a20 2a20 696d 2e6e 7a20   slicez * im.nz 
+00030aa0: 2a20 696d 2e73 7a20 2023 2063 656e 7465  * im.sz  # cente
+00030ab0: 7220 616c 6f6e 6720 7a0d 0a20 2020 2020  r along z..     
+00030ac0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00030ad0: 2020 2020 2020 637a 3d4e 6f6e 650d 0a0d        cz=None...
+00030ae0: 0a20 2020 2020 2020 2023 2066 696c 7465  .        # filte
+00030af0: 7220 7661 6c75 6573 0d0a 2020 2020 2020  r values..      
+00030b00: 2020 6966 2066 696c 7465 7269 6e67 5f69    if filtering_i
+00030b10: 6e74 6572 7661 6c20 6973 206e 6f74 204e  nterval is not N
+00030b20: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00030b30: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00030b40: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+00030b50: 616c 2c20 6c69 7374 293a 0d0a 2020 2020  al, list):..    
+00030b60: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00030b70: 656e 2866 696c 7465 7269 6e67 5f69 6e74  en(filtering_int
+00030b80: 6572 7661 6c29 203d 3d20 323a 0d0a 2020  erval) == 2:..  
+00030b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ba0: 2020 6966 2066 696c 7465 7269 6e67 5f69    if filtering_i
+00030bb0: 6e74 6572 7661 6c5b 305d 203c 2066 696c  nterval[0] < fil
+00030bc0: 7465 7269 6e67 5f69 6e74 6572 7661 6c5b  tering_interval[
+00030bd0: 315d 3a0d 0a20 2020 2020 2020 2020 2020  1]:..           
+00030be0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+00030bf0: 5b61 7272 203c 2066 696c 7465 7269 6e67  [arr < filtering
+00030c00: 5f69 6e74 6572 7661 6c5b 305d 5d20 3d20  _interval[0]] = 
+00030c10: 6e70 2e6e 616e 0d0a 2020 2020 2020 2020  np.nan..        
+00030c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030c30: 6172 725b 6172 7220 3e20 6669 6c74 6572  arr[arr > filter
+00030c40: 696e 675f 696e 7465 7276 616c 5b31 5d5d  ing_interval[1]]
+00030c50: 203d 206e 702e 6e61 6e0d 0a20 2020 2020   = np.nan..     
+00030c60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00030c70: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00030c80: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00030c90: 696e 7428 2266 696c 7465 7269 6e67 5f69  int("filtering_i
+00030ca0: 6e74 6572 7661 6c5b 305d 206d 7573 7420  nterval[0] must 
+00030cb0: 6265 2073 6d61 6c6c 6572 2074 6861 6e20  be smaller than 
+00030cc0: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+00030cd0: 616c 5b31 5d22 290d 0a20 2020 2020 2020  al[1]")..       
+00030ce0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00030cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030d00: 2020 2020 7072 696e 7428 2266 696c 7465      print("filte
+00030d10: 7269 6e67 5f69 6e74 6572 7661 6c20 6d75  ring_interval mu
+00030d20: 7374 2062 6520 6120 6c69 7374 206f 6620  st be a list of 
+00030d30: 7477 6f20 7661 6c75 6573 2229 0d0a 2020  two values")..  
+00030d40: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00030d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030d60: 2070 7269 6e74 2822 6669 6c74 6572 696e   print("filterin
+00030d70: 675f 696e 7465 7276 616c 206d 7573 7420  g_interval must 
+00030d80: 6265 2061 206c 6973 7420 6f66 2074 776f  be a list of two
+00030d90: 2076 616c 7565 7322 290d 0a0d 0a20 2020   values")....   
+00030da0: 2020 2020 2069 6620 736c 6963 6578 2069       if slicex i
+00030db0: 7320 6e6f 7420 4e6f 6e65 206f 7220 736c  s not None or sl
+00030dc0: 6963 6579 2069 7320 6e6f 7420 4e6f 6e65  icey is not None
+00030dd0: 206f 7220 736c 6963 657a 2069 7320 6e6f   or slicez is no
+00030de0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+00030df0: 2020 2020 2069 6d67 706c 7433 2e64 7261       imgplt3.dra
+00030e00: 7749 6d61 6765 3344 5f73 6c69 6365 2869  wImage3D_slice(i
+00030e10: 6d2c 2070 6c6f 7474 6572 3d70 2c20 736c  m, plotter=p, sl
+00030e20: 6963 655f 6e6f 726d 616c 5f78 3d63 782c  ice_normal_x=cx,
+00030e30: 2073 6c69 6365 5f6e 6f72 6d61 6c5f 793d   slice_normal_y=
+00030e40: 6379 2c20 736c 6963 655f 6e6f 726d 616c  cy, slice_normal
+00030e50: 5f7a 3d63 7a2c 2063 6d69 6e3d 636d 696e  _z=cz, cmin=cmin
+00030e60: 2c20 636d 6178 3d63 6d61 780d 0a20 2020  , cmax=cmax..   
+00030e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e90: 2020 202c 2073 6361 6c61 725f 6261 725f     , scalar_bar_
+00030ea0: 6b77 6172 6773 3d73 6361 6c61 725f 6261  kwargs=scalar_ba
+00030eb0: 725f 6b77 6172 6773 2c20 2a2a 6b77 6172  r_kwargs, **kwar
+00030ec0: 6773 290d 0a20 2020 2020 2020 2065 6c73  gs)..        els
+00030ed0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00030ee0: 696d 6770 6c74 332e 6472 6177 496d 6167  imgplt3.drawImag
+00030ef0: 6533 445f 7375 7266 6163 6528 696d 2c20  e3D_surface(im, 
+00030f00: 706c 6f74 7465 723d 702c 2063 6d69 6e3d  plotter=p, cmin=
+00030f10: 636d 696e 2c20 636d 6178 3d63 6d61 782c  cmin, cmax=cmax,
+00030f20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00030f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f40: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
+00030f50: 725f 6261 725f 6b77 6172 6773 3d73 6361  r_bar_kwargs=sca
+00030f60: 6c61 725f 6261 725f 6b77 6172 6773 2c20  lar_bar_kwargs, 
+00030f70: 2a2a 6b77 6172 6773 290d 0a0d 0a20 2020  **kwargs)....   
+00030f80: 2020 2020 2069 6620 706c 6f74 7465 7220       if plotter 
+00030f90: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+00030fa0: 2020 2020 2020 702e 6164 645f 626f 756e        p.add_boun
+00030fb0: 6469 6e67 5f62 6f78 2829 0d0a 2020 2020  ding_box()..    
+00030fc0: 2020 2020 2020 2020 702e 7368 6f77 5f61          p.show_a
+00030fd0: 7865 7328 290d 0a20 2020 2020 2020 2020  xes()..         
+00030fe0: 2020 2070 2e73 686f 7728 290d 0a0d 0a0d     p.show().....
+00030ff0: 0a20 2020 2023 6372 6f73 7320 7365 6374  .    #cross sect
+00031000: 696f 6e73 0d0a 2020 2020 6465 6620 6472  ions..    def dr
+00031010: 6177 5f63 726f 7373 5f73 6563 7469 6f6e  aw_cross_section
+00031020: 2873 656c 662c 2062 6163 6b67 726f 756e  (self, backgroun
+00031030: 643d 2275 6e69 7473 222c 2069 753d 302c  d="units", iu=0,
+00031040: 2069 6661 3d30 293a 0d0a 0d0a 2020 2020   ifa=0):....    
+00031050: 2020 2020 6578 7465 6e74 2020 3d20 5b73      extent  = [s
+00031060: 656c 662e 6765 745f 6f78 2829 2c20 7365  elf.get_ox(), se
+00031070: 6c66 2e67 6574 5f78 6728 295b 2d31 5d2c  lf.get_xg()[-1],
+00031080: 2073 656c 662e 6765 745f 6f79 2829 2c20   self.get_oy(), 
+00031090: 7365 6c66 2e67 6574 5f79 6728 295b 2d31  self.get_yg()[-1
+000310a0: 5d5d 0d0a 0d0a 2020 2020 2020 2020 6966  ]]....        if
+000310b0: 2062 6163 6b67 726f 756e 6420 3d3d 2022   background == "
+000310c0: 756e 6974 7322 3a20 2023 2061 6464 206f  units":  # add o
+000310d0: 7074 696f 6e20 746f 2070 6173 7320 7261  ption to pass ra
+000310e0: 7374 6572 730d 0a20 2020 2020 2020 2020  sters..         
+000310f0: 2020 2062 6163 6b5f 6d61 7020 3d20 7365     back_map = se
+00031100: 6c66 2e63 6f6d 7075 7465 5f67 656f 6c5f  lf.compute_geol_
+00031110: 6d61 7028 302c 2063 6f6c 6f72 203d 2054  map(0, color = T
+00031120: 7275 6529 0d0a 2020 2020 2020 2020 2020  rue)..          
+00031130: 2020 706c 742e 696d 7368 6f77 2862 6163    plt.imshow(bac
+00031140: 6b5f 6d61 702c 206f 7269 6769 6e3d 226c  k_map, origin="l
+00031150: 6f77 6572 222c 2065 7874 656e 743d 6578  ower", extent=ex
+00031160: 7465 6e74 290d 0a0d 0a20 2020 2020 2020  tent)....       
+00031170: 2065 6c73 653a 2020 0d0a 2020 2020 2020   else:  ..      
+00031180: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+00031190: 2020 2020 0d0a 2020 2020 2020 2020 705f      ..        p_
+000311a0: 6c69 7374 203d 2070 6c74 2e67 696e 7075  list = plt.ginpu
+000311b0: 7428 6e3d 2d31 2c20 7469 6d65 6f75 743d  t(n=-1, timeout=
+000311c0: 3029 0d0a 2020 2020 2020 2020 706c 742e  0)..        plt.
+000311d0: 636c 6f73 6528 290d 0a0d 0a20 2020 2020  close()....     
+000311e0: 2020 2023 2320 6472 6177 2063 726f 7373     ## draw cross
+000311f0: 2d73 6563 7469 6f6e 2070 6f73 6974 696f  -section positio
+00031200: 6e0d 0a20 2020 2020 2020 2070 6c74 2e69  n..        plt.i
+00031210: 6d73 686f 7728 6261 636b 5f6d 6170 2c20  mshow(back_map, 
+00031220: 6f72 6967 696e 3d22 6c6f 7765 7222 2c20  origin="lower", 
+00031230: 6578 7465 6e74 3d65 7874 656e 7429 0d0a  extent=extent)..
+00031240: 2020 2020 2020 2020 706c 742e 706c 6f74          plt.plot
+00031250: 285b 695b 305d 2066 6f72 2069 2069 6e20  ([i[0] for i in 
+00031260: 705f 6c69 7374 5d2c 205b 695b 315d 2066  p_list], [i[1] f
+00031270: 6f72 2069 2069 6e20 705f 6c69 7374 5d2c  or i in p_list],
+00031280: 2063 3d22 7265 6422 290d 0a20 2020 2020   c="red")..     
+00031290: 2020 2070 6c74 2e73 686f 7728 290d 0a0d     plt.show()...
+000312a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000312b0: 705f 6c69 7374 0d0a 0d0a 0d0a 2020 2020  p_list......    
+000312c0: 6465 6620 6372 6f73 735f 7365 6374 696f  def cross_sectio
+000312d0: 6e28 7365 6c66 2c20 6172 725f 746f 5f70  n(self, arr_to_p
+000312e0: 6c6f 742c 2070 5f6c 6973 742c 2065 7370  lot, p_list, esp
+000312f0: 3d4e 6f6e 6529 3a0d 0a0d 0a20 2020 2020  =None):....     
+00031300: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00031310: 5265 7475 726e 2061 2063 726f 7373 2073  Return a cross s
+00031320: 6563 7469 6f6e 2061 6c6f 6e67 2074 6865  ection along the
+00031330: 2070 6f69 6e74 7320 7061 7373 2069 6e20   points pass in 
+00031340: 705f 6c69 7374 0d0a 0d0a 2020 2020 2020  p_list....      
+00031350: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00031360: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00031370: 0d0a 2020 2020 2020 2020 6172 725f 746f  ..        arr_to
+00031380: 5f70 6c6f 743a 2033 4420 6f72 2034 4420  _plot: 3D or 4D 
+00031390: 6172 7261 7920 6f66 2064 696d 656e 7369  array of dimensi
+000313a0: 6f6e 206e 7a2c 206e 792c 206e 7828 2c20  on nz, ny, nx(, 
+000313b0: 3429 0d0a 2020 2020 2020 2020 2020 2020  4)..            
+000313c0: 6172 7261 7920 6f66 2077 6869 6368 2077  array of which w
+000313d0: 6520 7761 6e74 2061 2063 726f 7373 2073  e want a cross s
+000313e0: 6563 7469 6f6e 2e0d 0a20 2020 2020 2020  ection...       
+000313f0: 2020 2020 2054 6869 7320 6172 7261 7920       This array 
+00031400: 7769 6c6c 2062 6520 636f 6e73 6964 6572  will be consider
+00031410: 6564 2062 6569 6e67 2070 6172 7420 6f66  ed being part of
+00031420: 2074 6865 2041 7263 6850 7920 7369 6d75   the ArchPy simu
+00031430: 6c61 7469 6f6e 2064 6f6d 6169 6e2e 0d0a  lation domain...
+00031440: 2020 2020 2020 2020 705f 6c69 7374 3a20          p_list: 
+00031450: 7365 7175 656e 6365 206f 6620 7475 706c  sequence of tupl
+00031460: 650d 0a20 2020 2020 2020 2020 2020 206c  e..            l
+00031470: 6973 7420 6f72 2061 7272 6179 206f 6620  ist or array of 
+00031480: 7475 706c 6520 636f 6e74 6169 6e69 6e67  tuple containing
+00031490: 2078 2061 6e64 2079 2063 6f6f 7264 696e   x and y coordin
+000314a0: 6174 6573 0d0a 2020 2020 2020 2020 2020  ates..          
+000314b0: 2020 2865 2e67 2e20 705f 6c69 7374 3d5b    (e.g. p_list=[
+000314c0: 2831 3030 2c20 3230 3029 2c20 2833 3030  (100, 200), (300
+000314d0: 2c20 3230 3029 5d20 2d2d 3e20 6472 6177  , 200)] --> draw
+000314e0: 2061 2063 726f 7373 2073 6563 7469 6f6e   a cross section
+000314f0: 2062 6574 7765 656e 2074 6865 7365 2074   between these t
+00031500: 776f 2070 6f69 6e74 7329 0d0a 2020 2020  wo points)..    
+00031510: 2020 2020 6573 703a 2066 6c6f 6174 0d0a      esp: float..
+00031520: 2020 2020 2020 2020 2020 2020 7370 6163              spac
+00031530: 696e 6720 746f 2075 7365 2077 6865 6e20  ing to use when 
+00031540: 7361 6d70 6c69 6e67 2074 6865 2061 7272  sampling the arr
+00031550: 6179 2061 6c6f 6e67 2074 6865 2063 726f  ay along the cro
+00031560: 7373 2073 6563 7469 6f6e 0d0a 2020 2020  ss section..    
+00031570: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00031580: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00031590: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+000315a0: 2020 2020 3244 2061 7272 6179 0d0a 2020      2D array..  
+000315b0: 2020 2020 2020 2020 2020 6372 6f73 7320            cross 
+000315c0: 7365 6374 696f 6e20 7265 6164 7920 746f  section ready to
+000315d0: 2070 6c6f 740d 0a20 2020 2020 2020 2022   plot..        "
+000315e0: 2222 0d0a 0d0a 2020 2020 2020 2020 6f78  ""....        ox
+000315f0: 3d73 656c 662e 6765 745f 6f78 2829 0d0a  =self.get_ox()..
+00031600: 2020 2020 2020 2020 6f79 3d73 656c 662e          oy=self.
+00031610: 6765 745f 6f79 2829 0d0a 2020 2020 2020  get_oy()..      
+00031620: 2020 7378 3d73 656c 662e 6765 745f 7378    sx=self.get_sx
+00031630: 2829 0d0a 2020 2020 2020 2020 7379 3d73  ()..        sy=s
+00031640: 656c 662e 6765 745f 7379 2829 0d0a 0d0a  elf.get_sy()....
+00031650: 2020 2020 2020 2020 6966 2065 7370 2069          if esp i
+00031660: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00031670: 2020 2020 2065 7370 3d28 7365 6c66 2e67       esp=(self.g
+00031680: 6574 5f73 7828 292a 2a32 2b73 656c 662e  et_sx()**2+self.
+00031690: 6765 745f 7379 2829 2a2a 3229 2a2a 302e  get_sy()**2)**0.
+000316a0: 350d 0a0d 0a20 2020 2020 2020 2064 6973  5....        dis
+000316b0: 745f 746f 743d 300d 0a20 2020 2020 2020  t_tot=0..       
+000316c0: 2066 6f72 2069 7020 696e 2072 616e 6765   for ip in range
+000316d0: 286c 656e 2870 5f6c 6973 7429 2d31 293a  (len(p_list)-1):
+000316e0: 2023 206c 6f6f 7020 6f76 6572 2070 6f69   # loop over poi
+000316f0: 6e74 730d 0a20 2020 2020 2020 2020 2020  nts..           
+00031700: 2070 313d 6e70 2e61 7272 6179 2870 5f6c   p1=np.array(p_l
+00031710: 6973 745b 6970 5d29 0d0a 2020 2020 2020  ist[ip])..      
+00031720: 2020 2020 2020 7032 3d6e 702e 6172 7261        p2=np.arra
+00031730: 7928 705f 6c69 7374 5b69 702b 315d 290d  y(p_list[ip+1]).
+00031740: 0a20 2020 2020 2020 2020 2020 2064 312c  .            d1,
+00031750: 2064 323d 7032 2d70 310d 0a20 2020 2020   d2=p2-p1..     
+00031760: 2020 2020 2020 2064 6973 743d 6e70 2e73         dist=np.s
+00031770: 7172 7428 6431 2a2a 3220 2b20 6432 2a2a  qrt(d1**2 + d2**
+00031780: 3229 0d0a 2020 2020 2020 2020 2020 2020  2)..            
+00031790: 6c61 6d3d 6573 702f 6469 7374 0d0a 0d0a  lam=esp/dist....
+000317a0: 2020 2020 2020 2020 2020 2020 785f 642c              x_d,
+000317b0: 2079 5f64 3d70 3120 2023 2073 7461 7274   y_d=p1  # start
+000317c0: 696e 6720 706f 696e 740d 0a0d 0a20 2020  ing point....   
+000317d0: 2020 2020 2020 2020 2066 3d61 7272 5f74           f=arr_t
+000317e0: 6f5f 706c 6f74 2e63 6f70 7928 290d 0a20  o_plot.copy().. 
+000317f0: 2020 2020 2020 2020 2020 206e 6f5f 636f             no_co
+00031800: 6c6f 723d 4661 6c73 650d 0a20 2020 2020  lor=False..     
+00031810: 2020 2020 2020 2069 6620 6c65 6e28 662e         if len(f.
+00031820: 7368 6170 6529 203d 3d20 343a 0d0a 2020  shape) == 4:..  
+00031830: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+00031840: 5f63 6f6c 6f72 3d46 616c 7365 0d0a 2020  _color=False..  
+00031850: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+00031860: 7365 635f 693d 6e70 2e7a 6572 6f73 285b  sec_i=np.zeros([
+00031870: 662e 7368 6170 655b 305d 2c20 696e 7428  f.shape[0], int(
+00031880: 6469 7374 2f65 7370 292b 312c 2034 5d29  dist/esp)+1, 4])
+00031890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000318a0: 2020 6966 2069 7020 3d3d 2030 3a0d 0a20    if ip == 0:.. 
+000318b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000318c0: 2020 2078 5f73 6563 3d6e 702e 7a65 726f     x_sec=np.zero
+000318d0: 7328 5b66 2e73 6861 7065 5b30 5d2c 2069  s([f.shape[0], i
+000318e0: 6e74 2864 6973 742f 6573 7029 2b31 2c20  nt(dist/esp)+1, 
+000318f0: 345d 290d 0a20 2020 2020 2020 2020 2020  4])..           
+00031900: 2065 6c69 6620 6c65 6e28 662e 7368 6170   elif len(f.shap
+00031910: 6529 203d 3d20 333a 0d0a 2020 2020 2020  e) == 3:..      
+00031920: 2020 2020 2020 2020 2020 6e6f 5f63 6f6c            no_col
+00031930: 6f72 3d54 7275 650d 0a20 2020 2020 2020  or=True..       
+00031940: 2020 2020 2020 2020 2078 5f73 6563 5f69           x_sec_i
+00031950: 3d6e 702e 7a65 726f 7328 5b66 2e73 6861  =np.zeros([f.sha
+00031960: 7065 5b30 5d2c 696e 7428 6469 7374 2f65  pe[0],int(dist/e
+00031970: 7370 292b 315d 290d 0a20 2020 2020 2020  sp)+1])..       
+00031980: 2020 2020 2020 2020 2069 6620 6970 203d           if ip =
+00031990: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+000319a0: 2020 2020 2020 2020 2020 785f 7365 633d            x_sec=
+000319b0: 6e70 2e7a 6572 6f73 285b 662e 7368 6170  np.zeros([f.shap
+000319c0: 655b 305d 2c69 6e74 2864 6973 742f 6573  e[0],int(dist/es
+000319d0: 7029 2b31 5d29 0d0a 0d0a 2020 2020 2020  p)+1])....      
+000319e0: 2020 2020 2020 6966 206e 6f5f 636f 6c6f        if no_colo
+000319f0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+00031a00: 2020 2020 693d 300d 0a20 2020 2020 2020      i=0..       
+00031a10: 2020 2020 2020 2020 2066 6f72 206f 2069           for o i
+00031a20: 6e20 6e70 2e61 7261 6e67 6528 302c 6469  n np.arange(0,di
+00031a30: 7374 2c65 7370 293a 0d0a 2020 2020 2020  st,esp):..      
+00031a40: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+00031a50: 6420 2b3d 2064 312a 6c61 6d0d 0a20 2020  d += d1*lam..   
+00031a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a70: 2079 5f64 202b 3d20 6432 2a6c 616d 0d0a   y_d += d2*lam..
+00031a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a90: 2020 2020 6978 3d69 6e74 2828 785f 6420      ix=int((x_d 
+00031aa0: 2d20 6f78 292f 7378 290d 0a20 2020 2020  - ox)/sx)..     
+00031ab0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00031ac0: 793d 696e 7428 2879 5f64 202d 206f 7929  y=int((y_d - oy)
+00031ad0: 2f73 7929 0d0a 2020 2020 2020 2020 2020  /sy)..          
+00031ae0: 2020 2020 2020 2020 2020 6670 3d66 5b3a            fp=f[:
+00031af0: 2c69 792c 6978 5d0d 0a20 2020 2020 2020  ,iy,ix]..       
+00031b00: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00031b10: 6970 203d 3d20 303a 0d0a 2020 2020 2020  ip == 0:..      
+00031b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b30: 2020 785f 7365 635b 3a2c 695d 3d66 700d    x_sec[:,i]=fp.
+00031b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031b50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00031b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b70: 2020 2020 785f 7365 635f 695b 3a2c 695d      x_sec_i[:,i]
+00031b80: 3d66 700d 0a20 2020 2020 2020 2020 2020  =fp..           
+00031b90: 2020 2020 2020 2020 2069 202b 3d20 310d           i += 1.
+00031ba0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00031bb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00031bc0: 2020 2020 693d 300d 0a20 2020 2020 2020      i=0..       
+00031bd0: 2020 2020 2020 2020 2066 6f72 206f 2069           for o i
+00031be0: 6e20 6e70 2e61 7261 6e67 6528 302c 6469  n np.arange(0,di
+00031bf0: 7374 2c65 7370 293a 0d0a 2020 2020 2020  st,esp):..      
+00031c00: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+00031c10: 6420 2b3d 2064 312a 6c61 6d0d 0a20 2020  d += d1*lam..   
+00031c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c30: 2079 5f64 202b 3d20 6432 2a6c 616d 0d0a   y_d += d2*lam..
+00031c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c50: 2020 2020 6978 3d69 6e74 2828 785f 6420      ix=int((x_d 
+00031c60: 2d20 6f78 292f 7378 290d 0a20 2020 2020  - ox)/sx)..     
+00031c70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00031c80: 793d 696e 7428 2879 5f64 202d 206f 7929  y=int((y_d - oy)
+00031c90: 2f73 7929 0d0a 2020 2020 2020 2020 2020  /sy)..          
+00031ca0: 2020 2020 2020 2020 2020 6670 3d66 5b3a            fp=f[:
+00031cb0: 2c69 792c 6978 5d0d 0a20 2020 2020 2020  ,iy,ix]..       
+00031cc0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00031cd0: 6970 203d 3d20 303a 0d0a 2020 2020 2020  ip == 0:..      
+00031ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031cf0: 2020 785f 7365 635b 3a2c 692c 3a20 5d3d    x_sec[:,i,: ]=
+00031d00: 6670 0d0a 2020 2020 2020 2020 2020 2020  fp..            
+00031d10: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00031d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d30: 2020 2020 2020 2078 5f73 6563 5f69 5b3a         x_sec_i[:
+00031d40: 2c69 2c3a 205d 3d66 700d 0a20 2020 2020  ,i,: ]=fp..     
+00031d50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00031d60: 202b 3d20 310d 0a0d 0a20 2020 2020 2020   += 1....       
+00031d70: 2020 2020 2064 6973 745f 746f 7420 2b3d       dist_tot +=
+00031d80: 2064 6973 740d 0a20 2020 2020 2020 2020   dist..         
+00031d90: 2020 2023 6170 7065 6e64 2078 7365 6374     #append xsect
+00031da0: 696f 6e73 0d0a 2020 2020 2020 2020 2020  ions..          
+00031db0: 2020 6966 2069 7020 3e20 303a 0d0a 2020    if ip > 0:..  
+00031dc0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+00031dd0: 7365 633d 6e70 2e63 6f6e 6361 7465 6e61  sec=np.concatena
+00031de0: 7465 2828 785f 7365 632c 2078 5f73 6563  te((x_sec, x_sec
+00031df0: 5f69 292c 2061 7869 733d 3129 0d0a 0d0a  _i), axis=1)....
+00031e00: 2020 2020 2020 2020 7265 7475 726e 2078          return x
+00031e10: 5f73 6563 2c20 6469 7374 5f74 6f74 0d0a  _sec, dist_tot..
+00031e20: 0d0a 0d0a 0d0a 2020 2020 2323 2320 4255  ......    ### BU
+00031e30: 4720 544f 2043 4f52 5245 4354 0d0a 2020  G TO CORRECT..  
+00031e40: 2020 2222 220d 0a20 2020 2042 6f72 6568    """..    Boreh
+00031e50: 6f6c 6573 2061 7070 6561 7220 6d75 6c74  oles appear mult
+00031e60: 6970 6c65 2074 696d 6573 206f 6e20 7468  iple times on th
+00031e70: 6520 6372 6f73 732d 7365 6374 696f 6e2c  e cross-section,
+00031e80: 2068 6176 6520 746f 2074 6869 6e6b 2061   have to think a
+00031e90: 626f 7574 2074 6861 740d 0a20 2020 2022  bout that..    "
+00031ea0: 2222 0d0a 2020 2020 6465 6620 706c 6f74  ""..    def plot
+00031eb0: 5f63 726f 7373 5f73 6563 7469 6f6e 2873  _cross_section(s
+00031ec0: 656c 662c 2070 5f6c 6973 742c 2074 7970  elf, p_list, typ
+00031ed0: 3d22 756e 6974 7322 2c20 6172 723d 4e6f  ="units", arr=No
+00031ee0: 6e65 2c20 6975 3d30 2c20 6966 613d 302c  ne, iu=0, ifa=0,
+00031ef0: 2069 703d 302c 0d0a 2020 2020 2020 2020   ip=0,..        
+00031f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f10: 2020 2070 726f 7065 7274 793d 4e6f 6e65     property=None
+00031f20: 2c20 6573 703d 4e6f 6e65 2c20 6178 3d4e  , esp=None, ax=N
+00031f30: 6f6e 652c 2063 6f6c 6f72 6261 723d 4661  one, colorbar=Fa
+00031f40: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
+00031f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f60: 2072 6174 696f 5f61 7370 6563 743d 322c   ratio_aspect=2,
+00031f70: 2069 3d30 2c0d 0a20 2020 2020 2020 2020   i=0,..         
+00031f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f90: 2020 6469 7374 5f6d 6178 203d 2031 3030    dist_max = 100
+00031fa0: 2c20 7769 6474 683d 2e35 2c0d 0a20 2020  , width=.5,..   
+00031fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fc0: 2020 2020 2020 2020 766d 6178 3d4e 6f6e          vmax=Non
+00031fd0: 652c 2076 6d69 6e3d 4e6f 6e65 293a 0d0a  e, vmin=None):..
+00031fe0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00031ff0: 2020 2020 2020 2050 6c6f 7420 6120 6372         Plot a cr
+00032000: 6f73 7320 7365 6374 696f 6e20 616c 6f6e  oss section alon
+00032010: 6720 7468 6520 706f 696e 7473 2067 6976  g the points giv
+00032020: 656e 2069 6e0d 0a20 2020 2020 2020 2070  en in..        p
+00032030: 5f6c 6973 7420 7769 7468 2061 2073 7061  _list with a spa
+00032040: 6369 6e67 2064 6566 696e 6564 2028 6573  cing defined (es
+00032050: 7029 0d0a 0d0a 2020 2020 2020 2020 5061  p)....        Pa
+00032060: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00032070: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00032080: 2020 2020 2020 705f 6c69 7374 203a 206c        p_list : l
+00032090: 6973 7420 6f72 2061 7272 6179 206f 6620  ist or array of 
+000320a0: 7475 706c 6520 636f 6e74 6169 6e69 6e67  tuple containing
+000320b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000320c0: 2020 7820 616e 6420 7920 636f 6f72 6469    x and y coordi
+000320d0: 6e61 7465 730d 0a20 2020 2020 2020 2020  nates..         
+000320e0: 2020 2020 2020 2028 652e 672e 2070 5f6c         (e.g. p_l
+000320f0: 6973 743d 5b28 3130 302c 2032 3030 292c  ist=[(100, 200),
+00032100: 2028 3330 302c 2032 3030 295d 0d0a 2020   (300, 200)]..  
+00032110: 2020 2020 2020 2020 2020 2020 2020 2d2d                --
+00032120: 3e20 6472 6177 2061 2063 726f 7373 2073  > draw a cross s
+00032130: 6563 7469 6f6e 2062 6574 7765 656e 2074  ection between t
+00032140: 6865 7365 2074 776f 2070 6f69 6e74 7329  hese two points)
+00032150: 0d0a 2020 2020 2020 2020 7479 703a 2073  ..        typ: s
+00032160: 7472 696e 670d 0a20 2020 2020 2020 2020  tring..         
+00032170: 2020 2075 6e69 7473 2c20 6661 6369 6573     units, facies
+00032180: 206f 7220 6120 7072 6f70 6572 7479 206e   or a property n
+00032190: 616d 650d 0a20 2020 2020 2020 2069 753a  ame..        iu:
+000321a0: 2069 6e74 0d0a 2020 2020 2020 2020 2020   int..          
+000321b0: 2020 756e 6974 7320 696e 6465 7820 7265    units index re
+000321c0: 616c 697a 6174 696f 6e0d 0a20 2020 2020  alization..     
+000321d0: 2020 2069 6661 3a20 696e 740d 0a20 2020     ifa: int..   
+000321e0: 2020 2020 2020 2020 2066 6163 6965 7320           facies 
+000321f0: 696e 6465 7820 7265 616c 697a 6174 696f  index realizatio
+00032200: 6e0d 0a20 2020 2020 2020 2069 703a 2069  n..        ip: i
+00032210: 6e74 0d0a 2020 2020 2020 2020 2020 2020  nt..            
+00032220: 7072 6f70 6572 7479 2069 6e64 6578 2072  property index r
+00032230: 6561 6c69 7a61 7469 6f6e 0d0a 2020 2020  ealization..    
+00032240: 2020 2020 7072 6f70 6572 7479 3a20 7374      property: st
+00032250: 720d 0a20 2020 2020 2020 2020 2020 2070  r..            p
+00032260: 726f 7065 7274 7920 6e61 6d65 2074 6861  roperty name tha
+00032270: 7420 6861 7665 2062 6565 6e20 636f 6d70  t have been comp
+00032280: 7574 6564 0d0a 2020 2020 2020 2020 6573  uted..        es
+00032290: 703a 2066 6c6f 6174 0d0a 2020 2020 2020  p: float..      
+000322a0: 2020 2020 2020 7370 6163 696e 6720 746f        spacing to
+000322b0: 2075 7365 2077 6865 6e20 7361 6d70 6c69   use when sampli
+000322c0: 6e67 2074 6865 2061 7272 6179 2061 6c6f  ng the array alo
+000322d0: 6e67 2074 6865 2063 726f 7373 2073 6563  ng the cross sec
+000322e0: 7469 6f6e 0d0a 2020 2020 2020 2020 6178  tion..        ax
+000322f0: 3a20 6d61 7470 6c6f 746c 6962 2061 7865  : matplotlib axe
+00032300: 7320 6f6e 2077 6869 6368 2074 6f20 706c  s on which to pl
+00032310: 6f74 0d0a 2020 2020 2020 2020 7261 7469  ot..        rati
+00032320: 6f5f 6173 7065 6374 3a20 666c 6f61 740d  o_aspect: float.
+00032330: 0a20 2020 2020 2020 2020 2020 2072 6174  .            rat
+00032340: 696f 2062 6574 7765 656e 2079 2061 6e64  io between y and
+00032350: 2078 2061 7869 7320 746f 2061 646a 7573   x axis to adjus
+00032360: 7420 7665 7274 6963 616c 2065 7861 6767  t vertical exagg
+00032370: 6572 6174 696f 6e0d 0a20 2020 2020 2020  eration..       
+00032380: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+00032390: 6465 6620 706c 6f74 5f62 6828 6268 2c20  def plot_bh(bh, 
+000323a0: 783d 4e6f 6e65 2c20 7769 6474 683d 7769  x=None, width=wi
+000323b0: 6474 682c 2074 7970 3d22 756e 6974 7322  dth, typ="units"
+000323c0: 293a 0d0a 0d0a 2020 2020 2020 2020 2020  ):....          
+000323d0: 2020 6966 2074 7970 203d 3d20 2275 6e69    if typ == "uni
+000323e0: 7473 223a 0d0a 2020 2020 2020 2020 2020  ts":..          
+000323f0: 2020 2020 2020 6966 2062 682e 6c6f 675f        if bh.log_
+00032400: 7374 7261 7469 2069 7320 6e6f 7420 4e6f  strati is not No
+00032410: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00032420: 2020 2020 2020 2020 2069 6620 7820 6973           if x is
+00032430: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00032440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032450: 6978 203d 2062 682e 780d 0a20 2020 2020  ix = bh.x..     
+00032460: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00032470: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00032480: 2020 2020 2020 2020 2020 2020 2020 6978                ix
+00032490: 203d 2078 0d0a 0d0a 2020 2020 2020 2020   = x....        
+000324a0: 2020 2020 2020 2020 2020 2020 6920 3d20              i = 
+000324b0: 2d31 0d0a 2020 2020 2020 2020 2020 2020  -1..            
+000324c0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+000324d0: 2072 616e 6765 286c 656e 2862 682e 6c6f   range(len(bh.lo
+000324e0: 675f 7374 7261 7469 292d 3129 3a0d 0a20  g_strati)-1):.. 
+000324f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032500: 2020 2020 2020 2073 203d 2062 682e 6c6f         s = bh.lo
+00032510: 675f 7374 7261 7469 5b69 5d5b 315d 0d0a  g_strati[i][1]..
+00032520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032530: 2020 2020 2020 2020 756e 6974 203d 2062          unit = b
+00032540: 682e 6c6f 675f 7374 7261 7469 5b69 5d5b  h.log_strati[i][
+00032550: 305d 0d0a 0d0a 2020 2020 2020 2020 2020  0]....          
+00032560: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00032570: 2069 203c 206c 656e 2862 682e 6c6f 675f   i < len(bh.log_
+00032580: 7374 7261 7469 293a 0d0a 2020 2020 2020  strati):..      
+00032590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000325a0: 2020 2020 2020 7332 203d 2062 682e 6c6f        s2 = bh.lo
+000325b0: 675f 7374 7261 7469 5b69 2b31 5d5b 315d  g_strati[i+1][1]
+000325c0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000325d0: 2020 2020 2020 2020 2020 2020 6966 2075              if u
+000325e0: 6e69 7420 6973 206e 6f74 204e 6f6e 653a  nit is not None:
+000325f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00032600: 2020 2020 2020 2020 2020 2020 2020 706c                pl
+00032610: 742e 6261 7228 6978 2c20 7320 2d20 7332  t.bar(ix, s - s2
+00032620: 2c20 626f 7474 6f6d 3d73 322c 2063 6f6c  , bottom=s2, col
+00032630: 6f72 3d75 6e69 742e 632c 2061 6c70 6861  or=unit.c, alpha
+00032640: 3d31 2c20 6564 6765 636f 6c6f 7220 3d20  =1, edgecolor = 
+00032650: 2762 6c61 636b 272c 2077 6964 7468 3d77  'black', width=w
+00032660: 6964 7468 290d 0a0d 0a20 2020 2020 2020  idth)....       
+00032670: 2020 2020 2020 2020 2020 2020 2073 203d               s =
+00032680: 2062 682e 6c6f 675f 7374 7261 7469 5b69   bh.log_strati[i
+00032690: 2b31 5d5b 315d 0d0a 2020 2020 2020 2020  +1][1]..        
+000326a0: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+000326b0: 203d 2062 682e 6c6f 675f 7374 7261 7469   = bh.log_strati
+000326c0: 5b69 2b31 5d5b 305d 0d0a 2020 2020 2020  [i+1][0]..      
+000326d0: 2020 2020 2020 2020 2020 2020 2020 7332                s2
+000326e0: 203d 2062 682e 7a20 2d20 6268 2e64 6570   = bh.z - bh.dep
+000326f0: 7468 0d0a 2020 2020 2020 2020 2020 2020  th..            
+00032700: 2020 2020 2020 2020 6966 2075 6e69 7420          if unit 
+00032710: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00032720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032730: 2020 2020 2020 706c 742e 6261 7228 6978        plt.bar(ix
+00032740: 2c20 7320 2d20 7332 2c20 626f 7474 6f6d  , s - s2, bottom
+00032750: 3d73 322c 2063 6f6c 6f72 3d75 6e69 742e  =s2, color=unit.
+00032760: 632c 2061 6c70 6861 3d31 2c20 6564 6765  c, alpha=1, edge
+00032770: 636f 6c6f 7220 3d20 2762 6c61 636b 272c  color = 'black',
+00032780: 2077 6964 7468 3d77 6964 7468 290d 0a0d   width=width)...
+00032790: 0a20 2020 2020 2020 2069 6620 7479 7020  .        if typ 
+000327a0: 3d3d 2022 756e 6974 7322 3a0d 0a20 2020  == "units":..   
+000327b0: 2020 2020 2020 2020 2061 7272 3d73 656c           arr=sel
+000327c0: 662e 6765 745f 756e 6974 735f 646f 6d61  f.get_units_doma
+000327d0: 696e 735f 7265 616c 697a 6174 696f 6e73  ins_realizations
+000327e0: 2869 753d 6975 2c20 6669 6c6c 3d22 636f  (iu=iu, fill="co
+000327f0: 6c6f 7222 2c20 616c 6c5f 6461 7461 3d46  lor", all_data=F
+00032800: 616c 7365 290d 0a0d 0a20 2020 2020 2020  alse)....       
+00032810: 2065 6c69 6620 7479 7020 3d3d 2027 7072   elif typ == 'pr
+00032820: 6f62 615f 756e 6974 7327 3a0d 0a20 2020  oba_units':..   
+00032830: 2020 2020 2020 2020 2075 6e69 7473 3d73           units=s
+00032840: 656c 662e 6765 745f 756e 6974 735f 646f  elf.get_units_do
+00032850: 6d61 696e 735f 7265 616c 697a 6174 696f  mains_realizatio
+00032860: 6e73 2829 0d0a 2020 2020 2020 2020 2020  ns()..          
+00032870: 2020 6e72 6561 6c3d 756e 6974 732e 7368    nreal=units.sh
+00032880: 6170 655b 305d 0d0a 2020 2020 2020 2020  ape[0]..        
+00032890: 2020 2020 6172 723d 2875 6e69 7473 203d      arr=(units =
+000328a0: 3d20 6929 2e73 756d 2830 292f 6e72 6561  = i).sum(0)/nrea
+000328b0: 6c0d 0a20 2020 2020 2020 2020 2020 2064  l..            d
+000328c0: 656c 2875 6e69 7473 290d 0a0d 0a20 2020  el(units)....   
+000328d0: 2020 2020 2065 6c69 6620 7479 7020 3d3d       elif typ ==
+000328e0: 2027 7072 6f62 615f 6661 6369 6573 273a   'proba_facies':
+000328f0: 0d0a 2020 2020 2020 2020 2020 2020 6661  ..            fa
+00032900: 6369 6573 3d73 656c 662e 6765 745f 6661  cies=self.get_fa
+00032910: 6369 6573 2829 0d0a 2020 2020 2020 2020  cies()..        
+00032920: 2020 2020 6e72 6561 6c3d 6661 6369 6573      nreal=facies
+00032930: 2e73 6861 7065 5b30 5d20 2a20 6661 6369  .shape[0] * faci
+00032940: 6573 2e73 6861 7065 5b31 5d0d 0a20 2020  es.shape[1]..   
+00032950: 2020 2020 2020 2020 2061 7272 3d28 6661           arr=(fa
+00032960: 6369 6573 203d 3d20 6929 2e73 756d 2830  cies == i).sum(0
+00032970: 292e 7375 6d28 3029 202f 6e72 6561 6c0d  ).sum(0) /nreal.
+00032980: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
+00032990: 2866 6163 6965 7329 0d0a 2020 2020 2020  (facies)..      
+000329a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000329b0: 656c 6966 2074 7970 203d 3d22 6661 6369  elif typ =="faci
+000329c0: 6573 223a 0d0a 2020 2020 2020 2020 2020  es":..          
+000329d0: 2020 6172 723d 7365 6c66 2e67 6574 5f66    arr=self.get_f
+000329e0: 6163 6965 7328 6975 2c20 6966 612c 2061  acies(iu, ifa, a
+000329f0: 6c6c 5f64 6174 613d 4661 6c73 6529 0d0a  ll_data=False)..
+00032a00: 2020 2020 2020 2020 2020 2020 2363 6861              #cha
+00032a10: 6e67 6520 7661 6c75 6573 2074 6f20 6861  nge values to ha
+00032a20: 7665 2063 6f6c 6f72 7320 6469 7265 6374  ve colors direct
+00032a30: 6c79 0d0a 2020 2020 2020 2020 2020 2020  ly..            
+00032a40: 6e65 775f 6172 723d 6e70 2e7a 6572 6f73  new_arr=np.zeros
+00032a50: 285b 6172 722e 7368 6170 655b 305d 2c20  ([arr.shape[0], 
+00032a60: 6172 722e 7368 6170 655b 315d 2c20 6172  arr.shape[1], ar
+00032a70: 722e 7368 6170 655b 325d 2c20 345d 290d  r.shape[2], 4]).
+00032a80: 0a20 2020 2020 2020 2020 2020 206c 6973  .            lis
+00032a90: 745f 6661 3d6e 702e 756e 6971 7565 2861  t_fa=np.unique(a
+00032aa0: 7272 290d 0a20 2020 2020 2020 2020 2020  rr)..           
+00032ab0: 2066 6f72 2049 4466 6120 696e 206c 6973   for IDfa in lis
+00032ac0: 745f 6661 3a0d 0a20 2020 2020 2020 2020  t_fa:..         
+00032ad0: 2020 2020 2020 2069 6620 4944 6661 2021         if IDfa !
+00032ae0: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+00032af0: 2020 2020 2020 2020 2020 6661 3d73 656c            fa=sel
+00032b00: 662e 6765 745f 6661 6369 6573 5f6f 626a  f.get_facies_obj
+00032b10: 2849 443d 4944 6661 2c20 7479 7065 3d22  (ID=IDfa, type="
+00032b20: 4944 2229 2020 2320 6765 7420 6661 6369  ID")  # get faci
+00032b30: 6573 206f 626a 6563 740d 0a20 2020 2020  es object..     
+00032b40: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00032b50: 6173 6b3d 2861 7272 203d 3d20 4944 6661  ask=(arr == IDfa
+00032b60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00032b70: 2020 2020 2020 206e 6577 5f61 7272 5b6d         new_arr[m
+00032b80: 6173 6b2c 3a20 5d3d 636f 6c6f 7273 2e74  ask,: ]=colors.t
+00032b90: 6f5f 7267 6261 2866 612e 6329 0d0a 2020  o_rgba(fa.c)..  
+00032ba0: 2020 2020 2020 2020 2020 6172 723d 6e65            arr=ne
+00032bb0: 775f 6172 720d 0a0d 0a20 2020 2020 2020  w_arr....       
+00032bc0: 2065 6c69 6620 7479 7020 3d3d 2270 726f   elif typ =="pro
+00032bd0: 7022 3a0d 0a20 2020 2020 2020 2020 2020  p":..           
+00032be0: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
+00032bf0: 6365 2870 726f 7065 7274 792c 2073 7472  ce(property, str
+00032c00: 292c 2022 7072 6f70 6572 7479 2073 686f  ), "property sho
+00032c10: 756c 6420 6265 2067 6976 656e 2069 6e20  uld be given in 
+00032c20: 6120 7072 6f70 6572 7479 206e 616d 6520  a property name 
+00032c30: 2d2d 3e20 7374 7269 6e67 220d 0a20 2020  --> string"..   
+00032c40: 2020 2020 2020 2020 2061 7272 3d73 656c           arr=sel
+00032c50: 662e 6765 7470 726f 7028 7072 6f70 6572  f.getprop(proper
+00032c60: 7479 2c20 6975 2c20 6966 612c 2069 702c  ty, iu, ifa, ip,
+00032c70: 2061 6c6c 5f64 6174 613d 4661 6c73 6529   all_data=False)
+00032c80: 0d0a 0d0a 2020 2020 2020 2020 656c 6966  ....        elif
+00032c90: 2074 7970 203d 3d22 656e 7472 6f70 795f   typ =="entropy_
+00032ca0: 756e 6974 7322 3a0d 0a20 2020 2020 2020  units":..       
+00032cb0: 2020 2020 2075 6e69 7473 3d73 656c 662e       units=self.
+00032cc0: 6765 745f 756e 6974 735f 646f 6d61 696e  get_units_domain
+00032cd0: 735f 7265 616c 697a 6174 696f 6e73 2829  s_realizations()
+00032ce0: 0d0a 2020 2020 2020 2020 2020 2020 5345  ..            SE
+00032cf0: 3d6e 702e 7a65 726f 7328 7365 6c66 2e6d  =np.zeros(self.m
+00032d00: 6173 6b2e 7368 6170 6529 2020 2320 7368  ask.shape)  # sh
+00032d10: 616e 6e6f 6e20 656e 7472 6f70 790d 0a20  annon entropy.. 
+00032d20: 2020 2020 2020 2020 2020 2062 3d6c 656e             b=len
+00032d30: 2873 656c 662e 6765 745f 616c 6c5f 756e  (self.get_all_un
+00032d40: 6974 7328 2929 0d0a 2020 2020 2020 2020  its())..        
+00032d50: 2020 2020 6e72 6561 6c3d 756e 6974 732e      nreal=units.
+00032d60: 7368 6170 655b 305d 0d0a 2020 2020 2020  shape[0]..      
+00032d70: 2020 2020 2020 666f 7220 756e 6974 2069        for unit i
+00032d80: 6e20 7365 6c66 2e67 6574 5f61 6c6c 5f75  n self.get_all_u
+00032d90: 6e69 7473 2829 3a0d 0a20 2020 2020 2020  nits():..       
+00032da0: 2020 2020 2020 2020 2070 7269 6e74 2875           print(u
+00032db0: 6e69 7429 0d0a 2020 2020 2020 2020 2020  nit)..          
+00032dc0: 2020 2020 2020 5069 3d28 756e 6974 733d        Pi=(units=
+00032dd0: 3d75 6e69 742e 4944 292e 7375 6d28 3029  =unit.ID).sum(0)
+00032de0: 2f6e 7265 616c 0d0a 2020 2020 2020 2020  /nreal..        
+00032df0: 2020 2020 2020 2020 7069 5f6d 6173 6b3d          pi_mask=
+00032e00: 2873 656c 662e 6d61 736b 2920 2620 2850  (self.mask) & (P
+00032e10: 6921 3d30 290d 0a20 2020 2020 2020 2020  i!=0)..         
+00032e20: 2020 2020 2020 2053 455b 7069 5f6d 6173         SE[pi_mas
+00032e30: 6b5d 202b 3d20 5069 5b70 695f 6d61 736b  k] += Pi[pi_mask
+00032e40: 5d2a 286e 702e 6c6f 6728 5069 5b70 695f  ]*(np.log(Pi[pi_
+00032e50: 6d61 736b 5d29 2f6e 702e 6c6f 6728 6229  mask])/np.log(b)
+00032e60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00032e70: 2020 2061 7272 3d2d 5345 0d0a 2020 2020     arr=-SE..    
+00032e80: 2020 2020 2020 2020 6172 725b 7e73 656c          arr[~sel
+00032e90: 662e 6d61 736b 5d3d 6e70 2e6e 616e 0d0a  f.mask]=np.nan..
+00032ea0: 2020 2020 2020 2020 2020 2020 6465 6c28              del(
+00032eb0: 756e 6974 7329 0d0a 0d0a 2020 2020 2020  units)....      
+00032ec0: 2020 656c 6966 2074 7970 203d 3d20 2265    elif typ == "e
+00032ed0: 6e74 726f 7079 5f66 6163 6965 7322 3a0d  ntropy_facies":.
+00032ee0: 0a20 2020 2020 2020 2020 2020 2066 6163  .            fac
+00032ef0: 6965 735f 646f 6d61 696e 733d 7365 6c66  ies_domains=self
+00032f00: 2e67 6574 5f66 6163 6965 7328 292e 7265  .get_facies().re
+00032f10: 7368 6170 6528 2d31 2c20 7365 6c66 2e6e  shape(-1, self.n
+00032f20: 7a2c 2073 656c 662e 6e79 2c20 7365 6c66  z, self.ny, self
+00032f30: 2e6e 7829 0d0a 2020 2020 2020 2020 2020  .nx)..          
+00032f40: 2020 5345 3d6e 702e 7a65 726f 7328 7365    SE=np.zeros(se
+00032f50: 6c66 2e6d 6173 6b2e 7368 6170 6529 2020  lf.mask.shape)  
+00032f60: 2320 7368 616e 6e6f 6e20 656e 7472 6f70  # shannon entrop
+00032f70: 790d 0a20 2020 2020 2020 2020 2020 2062  y..            b
+00032f80: 3d6c 656e 2873 656c 662e 6765 745f 616c  =len(self.get_al
+00032f90: 6c5f 6661 6369 6573 2829 290d 0a20 2020  l_facies())..   
+00032fa0: 2020 2020 2020 2020 206e 7265 616c 3d66           nreal=f
+00032fb0: 6163 6965 735f 646f 6d61 696e 732e 7368  acies_domains.sh
+00032fc0: 6170 655b 305d 0d0a 2020 2020 2020 2020  ape[0]..        
+00032fd0: 2020 2020 666f 7220 6661 6369 6573 2069      for facies i
+00032fe0: 6e20 7365 6c66 2e67 6574 5f61 6c6c 5f66  n self.get_all_f
+00032ff0: 6163 6965 7328 293a 0d0a 2020 2020 2020  acies():..      
+00033000: 2020 2020 2020 2020 2020 5069 3d28 6661            Pi=(fa
+00033010: 6369 6573 5f64 6f6d 6169 6e73 3d3d 6661  cies_domains==fa
+00033020: 6369 6573 2e49 4429 2e73 756d 2830 292f  cies.ID).sum(0)/
+00033030: 6e72 6561 6c0d 0a20 2020 2020 2020 2020  nreal..         
+00033040: 2020 2020 2020 2070 695f 6d61 736b 3d28         pi_mask=(
+00033050: 7365 6c66 2e6d 6173 6b29 2026 2028 5069  self.mask) & (Pi
+00033060: 213d 3029 0d0a 2020 2020 2020 2020 2020  !=0)..          
+00033070: 2020 2020 2020 5345 5b70 695f 6d61 736b        SE[pi_mask
+00033080: 5d20 2b3d 2050 695b 7069 5f6d 6173 6b5d  ] += Pi[pi_mask]
+00033090: 2a28 6e70 2e6c 6f67 2850 695b 7069 5f6d  *(np.log(Pi[pi_m
+000330a0: 6173 6b5d 292f 6e70 2e6c 6f67 2862 2929  ask])/np.log(b))
+000330b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000330c0: 2020 6172 723d 2d53 450d 0a20 2020 2020    arr=-SE..     
+000330d0: 2020 2020 2020 2061 7272 5b7e 7365 6c66         arr[~self
+000330e0: 2e6d 6173 6b5d 3d6e 702e 6e61 6e0d 0a20  .mask]=np.nan.. 
+000330f0: 2020 2020 2020 2020 2020 2064 656c 2866             del(f
+00033100: 6163 6965 735f 646f 6d61 696e 7329 0d0a  acies_domains)..
+00033110: 0d0a 2020 2020 2020 2020 656c 6966 2074  ..        elif t
+00033120: 7970 203d 3d22 6172 7222 3a0d 0a20 2020  yp =="arr":..   
+00033130: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+00033140: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00033150: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00033160: 2027 5479 7020 756e 6b6e 6f77 6e27 0d0a   'Typ unknown'..
+00033170: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00033180: 726e 0d0a 0d0a 2020 2020 2020 2020 2365  rn....        #e
+00033190: 7874 7261 6374 2063 726f 7373 2073 6563  xtract cross sec
+000331a0: 7469 6f6e 0d0a 2020 2020 2020 2020 7873  tion..        xs
+000331b0: 6563 2c20 6469 7374 3d73 656c 662e 6372  ec, dist=self.cr
+000331c0: 6f73 735f 7365 6374 696f 6e28 6172 722c  oss_section(arr,
+000331d0: 2070 5f6c 6973 742c 2065 7370 3d65 7370   p_list, esp=esp
+000331e0: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
+000331f0: 6178 2069 7320 4e6f 6e65 3a0d 0a20 2020  ax is None:..   
+00033200: 2020 2020 2020 2020 2066 6967 2c20 6178           fig, ax
+00033210: 3d70 6c74 2e73 7562 706c 6f74 7328 6669  =plt.subplots(fi
+00033220: 6773 697a 653d 2831 302c 2031 3029 290d  gsize=(10, 10)).
+00033230: 0a0d 0a20 2020 2020 2020 2065 7874 656e  ...        exten
+00033240: 743d 5b30 2c20 6469 7374 2c20 7365 6c66  t=[0, dist, self
+00033250: 2e67 6574 5f6f 7a28 292c 2073 656c 662e  .get_oz(), self.
+00033260: 6765 745f 7a67 2829 5b2d 315d 5d0d 0a20  get_zg()[-1]].. 
+00033270: 2020 2020 2020 2061 3d61 782e 696d 7368         a=ax.imsh
+00033280: 6f77 2878 7365 632c 206f 7269 6769 6e3d  ow(xsec, origin=
+00033290: 226c 6f77 6572 222c 2065 7874 656e 743d  "lower", extent=
+000332a0: 6578 7465 6e74 2c20 696e 7465 7270 6f6c  extent, interpol
+000332b0: 6174 696f 6e3d 226e 6f6e 6522 2c20 766d  ation="none", vm
+000332c0: 6178 3d76 6d61 782c 2076 6d69 6e3d 766d  ax=vmax, vmin=vm
+000332d0: 696e 290d 0a20 2020 2020 2020 2069 6620  in)..        if 
+000332e0: 636f 6c6f 7262 6172 3a0d 0a20 2020 2020  colorbar:..     
+000332f0: 2020 2020 2020 2070 6c74 2e63 6f6c 6f72         plt.color
+00033300: 6261 7228 612c 2061 783d 6178 2c20 6f72  bar(a, ax=ax, or
+00033310: 6965 6e74 6174 696f 6e3d 2768 6f72 697a  ientation='horiz
+00033320: 6f6e 7461 6c27 290d 0a20 2020 2020 2020  ontal')..       
+00033330: 2061 782e 7365 745f 6173 7065 6374 2861   ax.set_aspect(a
+00033340: 6273 2828 6578 7465 6e74 5b31 5d2d 6578  bs((extent[1]-ex
+00033350: 7465 6e74 5b30 5d29 2f28 6578 7465 6e74  tent[0])/(extent
+00033360: 5b33 5d2d 6578 7465 6e74 5b32 5d29 292f  [3]-extent[2]))/
+00033370: 7261 7469 6f5f 6173 7065 6374 290d 0a0d  ratio_aspect)...
+00033380: 0a20 2020 2020 2020 2064 656c 2861 7272  .        del(arr
+00033390: 290d 0a0d 0a20 2020 2020 2020 2023 6765  )....        #ge
+000333a0: 7420 626f 7265 686f 6c65 730d 0a20 2020  t boreholes..   
+000333b0: 2020 2020 2064 6973 745f 746f 7420 3d20       dist_tot = 
+000333c0: 300d 0a20 2020 2020 2020 2066 6f72 2069  0..        for i
+000333d0: 7020 696e 2072 616e 6765 286c 656e 2870  p in range(len(p
+000333e0: 5f6c 6973 7429 2d31 293a 0d0a 0d0a 2020  _list)-1):....  
+000333f0: 2020 2020 2020 2020 2020 7031 203d 2070            p1 = p
+00033400: 5f6c 6973 745b 6970 5d0d 0a20 2020 2020  _list[ip]..     
+00033410: 2020 2020 2020 2070 3220 3d20 705f 6c69         p2 = p_li
+00033420: 7374 5b69 702b 315d 0d0a 2020 2020 2020  st[ip+1]..      
+00033430: 2020 2020 2020 786d 696e 203d 206d 696e        xmin = min
+00033440: 2870 315b 305d 2c20 7032 5b30 5d29 0d0a  (p1[0], p2[0])..
+00033450: 2020 2020 2020 2020 2020 2020 786d 6178              xmax
+00033460: 203d 206d 6178 2870 315b 305d 2c20 7032   = max(p1[0], p2
+00033470: 5b30 5d29 0d0a 2020 2020 2020 2020 2020  [0])..          
+00033480: 2020 4c78 203d 2078 6d61 7820 2d20 786d    Lx = xmax - xm
+00033490: 696e 0d0a 2020 2020 2020 2020 2020 2020  in..            
+000334a0: 786d 696e 202d 3d20 6d61 7828 302e 322a  xmin -= max(0.2*
+000334b0: 4c78 2c20 6469 7374 5f6d 6178 2f32 290d  Lx, dist_max/2).
+000334c0: 0a20 2020 2020 2020 2020 2020 2078 6d61  .            xma
+000334d0: 7820 2b3d 206d 6178 2830 2e32 2a4c 782c  x += max(0.2*Lx,
+000334e0: 2064 6973 745f 6d61 782f 3229 0d0a 0d0a   dist_max/2)....
+000334f0: 2020 2020 2020 2020 2020 2020 796d 696e              ymin
+00033500: 203d 206d 696e 2870 315b 315d 2c20 7032   = min(p1[1], p2
+00033510: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
+00033520: 2020 796d 6178 203d 206d 6178 2870 315b    ymax = max(p1[
+00033530: 315d 2c20 7032 5b31 5d29 0d0a 2020 2020  1], p2[1])..    
+00033540: 2020 2020 2020 2020 4c79 203d 2079 6d61          Ly = yma
+00033550: 7820 2d20 796d 696e 0d0a 2020 2020 2020  x - ymin..      
+00033560: 2020 2020 2020 796d 696e 202d 3d20 6d61        ymin -= ma
+00033570: 7828 302e 322a 4c79 2c20 6469 7374 5f6d  x(0.2*Ly, dist_m
+00033580: 6178 2f32 290d 0a20 2020 2020 2020 2020  ax/2)..         
+00033590: 2020 2079 6d61 7820 2b3d 206d 6178 2830     ymax += max(0
+000335a0: 2e32 2a4c 792c 2064 6973 745f 6d61 782f  .2*Ly, dist_max/
+000335b0: 3229 0d0a 0d0a 2020 2020 2020 2020 2020  2)....          
+000335c0: 2020 2320 7365 6c65 6374 2062 6820 696e    # select bh in
+000335d0: 7369 6465 2070 3120 616e 6420 7032 0d0a  side p1 and p2..
+000335e0: 2020 2020 2020 2020 2020 2020 7365 6c5f              sel_
+000335f0: 6268 7320 3d20 5b62 6820 666f 7220 6268  bhs = [bh for bh
+00033600: 2069 6e20 7365 6c66 2e6c 6973 745f 6268   in self.list_bh
+00033610: 7320 6966 2062 682e 7820 3e20 786d 696e  s if bh.x > xmin
+00033620: 2061 6e64 2062 682e 7820 3c20 786d 6178   and bh.x < xmax
+00033630: 2061 6e64 2062 682e 7920 3e20 796d 696e   and bh.y > ymin
+00033640: 2061 6e64 2062 682e 7920 3c20 796d 6178   and bh.y < ymax
+00033650: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+00033660: 2023 2063 6f6d 7075 7465 2064 6973 7420   # compute dist 
+00033670: 6f66 2073 656c 5f62 6873 2074 6f20 6c69  of sel_bhs to li
+00033680: 6e65 0d0a 0d0a 2020 2020 2020 2020 2020  ne....          
+00033690: 2020 2320 7072 6f6a 2062 6873 0d0a 2020    # proj bhs..  
+000336a0: 2020 2020 2020 2020 2020 666f 7220 6268            for bh
+000336b0: 2069 6e20 7365 6c5f 6268 733a 0d0a 2020   in sel_bhs:..  
+000336c0: 2020 2020 2020 2020 2020 2020 2020 6120                a 
+000336d0: 3d20 7032 5b30 5d20 2d20 7031 5b30 5d0d  = p2[0] - p1[0].
+000336e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000336f0: 2062 203d 2070 325b 315d 202d 2070 315b   b = p2[1] - p1[
+00033700: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
+00033710: 2020 2020 785f 7072 6f6a 203d 2028 612a      x_proj = (a*
+00033720: 2a32 202a 2062 682e 7820 2b20 622a 2a32  *2 * bh.x + b**2
+00033730: 202a 2070 325b 305d 202b 2061 202a 2062   * p2[0] + a * b
+00033740: 202a 2028 6268 2e79 202d 2070 325b 315d   * (bh.y - p2[1]
+00033750: 2929 202f 2028 612a 2a32 202b 2062 2a2a  )) / (a**2 + b**
+00033760: 3229 0d0a 2020 2020 2020 2020 2020 2020  2)..            
+00033770: 2020 2020 795f 7072 6f6a 203d 2028 6220      y_proj = (b 
+00033780: 2a20 785f 7072 6f6a 202d 2062 202a 2070  * x_proj - b * p
+00033790: 325b 305d 202b 2061 202a 2070 325b 315d  2[0] + a * p2[1]
+000337a0: 2920 2f20 610d 0a0d 0a20 2020 2020 2020  ) / a....       
+000337b0: 2020 2020 2020 2020 2064 6973 745f 6c69           dist_li
+000337c0: 6e65 203d 2028 2862 682e 7820 2d20 785f  ne = ((bh.x - x_
+000337d0: 7072 6f6a 2920 2a2a 2032 202b 2028 6268  proj) ** 2 + (bh
+000337e0: 2e79 202d 2079 5f70 726f 6a29 202a 2a20  .y - y_proj) ** 
+000337f0: 3229 2a2a 302e 350d 0a0d 0a20 2020 2020  2)**0.5....     
+00033800: 2020 2020 2020 2020 2020 2069 6620 6469             if di
+00033810: 7374 5f6c 696e 6520 3c20 6469 7374 5f6d  st_line < dist_m
+00033820: 6178 3a0d 0a20 2020 2020 2020 2020 2020  ax:..           
+00033830: 2020 2020 2020 2020 2064 6973 7420 3d20           dist = 
+00033840: 2828 785f 7072 6f6a 202d 2070 315b 305d  ((x_proj - p1[0]
+00033850: 2920 2a2a 2032 202b 2028 795f 7072 6f6a  ) ** 2 + (y_proj
+00033860: 202d 2070 315b 315d 2920 2a2a 2032 292a   - p1[1]) ** 2)*
+00033870: 2a30 2e35 0d0a 2020 2020 2020 2020 2020  *0.5..          
+00033880: 2020 2020 2020 2020 2020 6469 7374 5f74            dist_t
+00033890: 6f5f 706c 6f74 203d 2064 6973 745f 746f  o_plot = dist_to
+000338a0: 7420 2b20 6469 7374 2020 2320 6469 7374  t + dist  # dist
+000338b0: 616e 6365 2077 6865 7265 2074 6f20 706c  ance where to pl
+000338c0: 6f74 2074 6865 2062 680d 0a0d 0a20 2020  ot the bh....   
+000338d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000338e0: 2023 2070 6c6f 7420 6268 0d0a 2020 2020   # plot bh..    
+000338f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033900: 6966 2074 7970 203d 3d20 2275 6e69 7473  if typ == "units
+00033910: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00033920: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
+00033930: 5f62 6828 6268 2c20 6469 7374 5f74 6f5f  _bh(bh, dist_to_
+00033940: 706c 6f74 290d 0a0d 0a20 2020 2020 2020  plot)....       
+00033950: 2020 2020 2023 2069 6e63 7265 6d65 6e74       # increment
+00033960: 2074 6f74 616c 2064 6973 7461 6e63 650d   total distance.
+00033970: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+00033980: 745f 706f 696e 7473 203d 2028 2870 325b  t_points = ((p2[
+00033990: 305d 202d 2070 315b 305d 2920 2a2a 2032  0] - p1[0]) ** 2
+000339a0: 202b 2028 7032 5b31 5d20 2d20 7031 5b31   + (p2[1] - p1[1
+000339b0: 5d29 202a 2a20 3229 2a2a 302e 350d 0a20  ]) ** 2)**0.5.. 
+000339c0: 2020 2020 2020 2020 2020 2064 6973 745f             dist_
+000339d0: 746f 7420 2b3d 2064 6973 745f 706f 696e  tot += dist_poin
+000339e0: 7473 0d0a 0d0a 0d0a 2020 2020 6465 6620  ts......    def 
+000339f0: 706c 6f74 5f6c 696e 6573 2873 656c 662c  plot_lines(self,
+00033a00: 206c 6973 745f 6c69 6e65 732c 206e 616d   list_lines, nam
+00033a10: 6573 3d4e 6f6e 652c 2061 783d 4e6f 6e65  es=None, ax=None
+00033a20: 2c20 6c65 6765 6e64 3d54 7275 6529 3a0d  , legend=True):.
+00033a30: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00033a40: 2020 2020 2020 2020 506c 6f74 2063 726f          Plot cro
+00033a50: 7373 2d73 6563 7469 6f6e 7320 6c69 6e65  ss-sections line
+00033a60: 7320 6769 7665 6e20 696e 2020 7468 650d  s given in  the.
+00033a70: 0a20 2020 2020 2020 2022 6c69 7374 5f6c  .        "list_l
+00033a80: 696e 6573 2220 6172 6775 6d65 6e74 206f  ines" argument o
+00033a90: 6e20 6120 3244 2074 6f70 2076 6965 7720  n a 2D top view 
+00033aa0: 6f66 2074 6865 2064 6f6d 6169 6e0d 0a0d  of the domain...
+00033ab0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00033ac0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00033ad0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00033ae0: 206c 6973 745f 6c69 6e65 733a 2073 6571   list_lines: seq
+00033af0: 656e 6365 206f 6620 706f 696e 7473 0d0a  ence of points..
+00033b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033b10: 6c69 7374 206f 6620 706f 696e 7473 2064  list of points d
+00033b20: 6566 696e 696e 6720 7468 6520 6372 6f73  efining the cros
+00033b30: 732d 7365 6374 696f 6e0d 0a20 2020 2020  s-section..     
+00033b40: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+00033b50: 2e20 4561 6368 2070 6f69 6e74 2069 7320  . Each point is 
+00033b60: 6120 6c69 7374 206f 6620 3220 666c 6f61  a list of 2 floa
+00033b70: 7473 205b 782c 2079 5d0d 0a20 2020 2020  ts [x, y]..     
+00033b80: 2020 206e 616d 6573 3a20 7365 7175 656e     names: sequen
+00033b90: 6365 206f 6620 7374 7269 6e67 0d0a 2020  ce of string..  
+00033ba0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00033bb0: 7374 206f 6620 6e61 6d65 7320 746f 2067  st of names to g
+00033bc0: 6976 6520 746f 2074 6865 2063 726f 7373  ive to the cross
+00033bd0: 2d73 6563 7469 6f6e 206c 696e 6573 0d0a  -section lines..
+00033be0: 2020 2020 2020 2020 6178 3a20 6d61 7470          ax: matp
+00033bf0: 6c6f 746c 6962 2061 7869 730d 0a20 2020  lotlib axis..   
+00033c00: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00033c10: 7320 6f6e 2077 6869 6368 2074 6f20 706c  s on which to pl
+00033c20: 6f74 2074 6865 2063 726f 7373 2d73 6563  ot the cross-sec
+00033c30: 7469 6f6e 0d0a 2020 2020 2020 2020 6c65  tion..        le
+00033c40: 6765 6e64 3a20 626f 6f6c 0d0a 2020 2020  gend: bool..    
+00033c50: 2020 2020 2020 2020 2020 2020 6966 2054              if T
+00033c60: 7275 652c 2070 6c6f 7420 6120 6c65 6765  rue, plot a lege
+00033c70: 6e64 0d0a 2020 2020 2020 2020 2222 220d  nd..        """.
+00033c80: 0a0d 0a20 2020 2020 2020 2069 6620 6178  ...        if ax
+00033c90: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+00033ca0: 2020 2020 2020 2066 6967 2c20 6178 3d70         fig, ax=p
+00033cb0: 6c74 2e73 7562 706c 6f74 7328 290d 0a0d  lt.subplots()...
+00033cc0: 0a20 2020 2020 2020 206f 783d 7365 6c66  .        ox=self
+00033cd0: 2e6f 780d 0a20 2020 2020 2020 206f 793d  .ox..        oy=
+00033ce0: 7365 6c66 2e6f 790d 0a20 2020 2020 2020  self.oy..       
+00033cf0: 2078 313d 7365 6c66 2e78 675b 2d31 5d0d   x1=self.xg[-1].
+00033d00: 0a20 2020 2020 2020 2079 313d 7365 6c66  .        y1=self
+00033d10: 2e79 675b 2d31 5d0d 0a20 2020 2020 2020  .yg[-1]..       
+00033d20: 2061 782e 706c 6f74 2828 6f78 2c20 6f78   ax.plot((ox, ox
+00033d30: 2c20 7831 2c20 7831 2c20 6f78 292c 286f  , x1, x1, ox),(o
+00033d40: 792c 2079 312c 2079 312c 206f 792c 206f  y, y1, y1, oy, o
+00033d50: 7929 2c20 633d 226b 2229 2023 706c 6f74  y), c="k") #plot
+00033d60: 2064 6f6d 6169 6e0d 0a20 2020 2020 2020   domain..       
+00033d70: 2061 782e 7365 745f 6173 7065 6374 2822   ax.set_aspect("
+00033d80: 6571 7561 6c22 290d 0a0d 0a20 2020 2020  equal")....     
+00033d90: 2020 2069 3d31 0d0a 2020 2020 2020 2020     i=1..        
+00033da0: 666f 7220 6c69 6e65 2069 6e20 6c69 7374  for line in list
+00033db0: 5f6c 696e 6573 3a0d 0a20 2020 2020 2020  _lines:..       
+00033dc0: 2020 2020 2069 6620 6e61 6d65 7320 6973       if names is
+00033dd0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00033de0: 2020 2020 2020 2020 6c61 6265 6c3d 2263          label="c
+00033df0: 726f 7373 2022 202b 2073 7472 2869 290d  ross " + str(i).
+00033e00: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00033e10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00033e20: 2020 2020 6c61 6265 6c3d 6e61 6d65 735b      label=names[
+00033e30: 692d 315d 0d0a 2020 2020 2020 2020 2020  i-1]..          
+00033e40: 2020 6c69 6e65 3d6e 702e 6172 7261 7928    line=np.array(
+00033e50: 6c69 6e65 290d 0a20 2020 2020 2020 2020  line)..         
+00033e60: 2020 2061 782e 706c 6f74 286c 696e 655b     ax.plot(line[
+00033e70: 3a2c 305d 2c20 6c69 6e65 5b3a 2c31 5d2c  :,0], line[:,1],
+00033e80: 206c 6162 656c 3d6c 6162 656c 290d 0a20   label=label).. 
+00033e90: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
+00033ea0: 310d 0a0d 0a20 2020 2020 2020 2069 6620  1....        if 
+00033eb0: 6c65 6765 6e64 3a0d 0a20 2020 2020 2020  legend:..       
+00033ec0: 2020 2020 2061 782e 6c65 6765 6e64 2829       ax.legend()
+00033ed0: 0d0a 0d0a 0d0a 2320 434c 4153 5345 5320  ......# CLASSES 
+00033ee0: 5049 4c45 202b 2055 4e49 5420 2b20 5355  PILE + UNIT + SU
+00033ef0: 5246 4143 450d 0a63 6c61 7373 2050 696c  RFACE..class Pil
+00033f00: 6528 293a 0d0a 0d0a 2020 2020 2222 220d  e():....    """.
+00033f10: 0a20 2020 2054 6869 7320 636c 6173 7320  .    This class 
+00033f20: 6973 2061 206d 616a 6f72 206f 626a 6563  is a major objec
+00033f30: 7420 7468 6520 5374 7261 7469 6772 6170  t the Stratigrap
+00033f40: 6869 6320 5069 6c65 2028 5350 292e 0d0a  hic Pile (SP)...
+00033f50: 2020 2020 4974 2063 6f6e 7461 696e 7320      It contains 
+00033f60: 616c 6c20 7468 6520 756e 6974 7320 6f62  all the units ob
+00033f70: 6a65 6374 730d 0a20 2020 2061 6e64 2061  jects..    and a
+00033f80: 6c6c 6f77 2074 6f20 6b6e 6f77 2074 6865  llow to know the
+00033f90: 2073 7472 6174 6967 7261 7068 6963 616c   stratigraphical
+00033fa0: 2072 656c 6174 696f 6e73 2062 6574 7765   relations betwe
+00033fb0: 656e 2074 6865 2075 6e69 7473 2e0d 0a20  en the units... 
+00033fc0: 2020 204f 6e65 2050 696c 6520 6f62 6a65     One Pile obje
+00033fd0: 6374 206d 7573 7420 6265 2064 6566 696e  ct must be defin
+00033fe0: 6564 2066 6f72 2065 6163 6820 7375 6270  ed for each subp
+00033ff0: 696c 6520 2b20 3120 226d 6173 7465 7222  ile + 1 "master"
+00034000: 2070 696c 652e 0d0a 0d0a 2020 2020 5061   pile.....    Pa
+00034010: 7261 6d65 7465 7273 0d0a 2020 2020 2d2d  rameters..    --
+00034020: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6e61  --------..    na
+00034030: 6d65 3a20 7374 720d 0a20 2020 2020 2020  me: str..       
+00034040: 206e 616d 6520 6f66 2074 6865 2070 696c   name of the pil
+00034050: 650d 0a20 2020 206e 6174 7572 653a 2073  e..    nature: s
+00034060: 7472 0d0a 2020 2020 2020 2020 756e 6974  tr..        unit
+00034070: 7320 7479 7065 206f 6620 696e 7465 7270  s type of interp
+00034080: 6f6c 6174 696f 6e2c 2063 616e 2062 6520  olation, can be 
+00034090: 2273 7572 6661 6365 7322 206f 7220 2233  "surfaces" or "3
+000340a0: 645f 6361 7465 676f 7269 6361 6c22 0d0a  d_categorical"..
+000340b0: 2020 2020 2020 2020 6966 2022 7375 7266          if "surf
+000340c0: 6163 6573 2220 6973 2063 686f 7365 6e20  aces" is chosen 
+000340d0: 2864 6566 6175 6c74 292c 2032 4420 7375  (default), 2D su
+000340e0: 7266 6163 6573 2069 6e74 6572 706f 6c61  rfaces interpola
+000340f0: 7469 6f6e 7320 6f66 0d0a 2020 2020 2020  tions of..      
+00034100: 2020 7468 6520 7375 7266 6163 6573 2061    the surfaces a
+00034110: 7265 2070 6572 666f 726d 6564 2e20 5468  re performed. Th
+00034120: 6520 7375 7266 6163 6573 2061 7265 2074  e surfaces are t
+00034130: 6865 6e20 7573 6564 2074 6f20 6465 6c69  hen used to deli
+00034140: 6d69 7420 756e 6974 2064 6f6d 6169 6e73  mit unit domains
+00034150: 2e0d 0a20 2020 2020 2020 2069 6620 2233  ...        if "3
+00034160: 645f 6361 7465 676f 7269 6361 6c22 2c20  d_categorical", 
+00034170: 6120 6661 6369 6573 206d 6574 686f 6420  a facies method 
+00034180: 6973 2075 7365 6420 746f 2073 696d 756c  is used to simul
+00034190: 6174 6520 706f 7369 7469 6f6e 206f 6620  ate position of 
+000341a0: 7468 6520 756e 6974 732e 0d0a 2020 2020  the units...    
+000341b0: 2020 2020 5468 6520 6176 6169 6c61 626c      The availabl
+000341c0: 6520 6d65 7468 6f64 7320 6172 6520 7468  e methods are th
+000341d0: 6520 7361 6d65 2074 6f20 7369 6d75 6c61  e same to simula
+000341e0: 7465 2074 6865 2066 6163 6965 732e 0d0a  te the facies...
+000341f0: 2020 2020 7665 7262 6f73 653a 2069 6e74      verbose: int
+00034200: 0d0a 2020 2020 2020 2020 6c65 7665 6c20  ..        level 
+00034210: 6f66 2076 6572 626f 7369 7479 0d0a 2020  of verbosity..  
+00034220: 2020 7365 6564 3a20 696e 740d 0a20 2020    seed: int..   
+00034230: 2020 2020 2073 6565 6420 666f 7220 7261       seed for ra
+00034240: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
+00034250: 7261 7469 6f6e 0d0a 2020 2020 2222 220d  ration..    """.
+00034260: 0a0d 0a20 2020 2064 6566 205f 5f69 6e69  ...    def __ini
+00034270: 745f 5f28 7365 6c66 2c20 6e61 6d65 2c20  t__(self, name, 
+00034280: 6e61 7475 7265 3d22 7375 7266 6163 6573  nature="surfaces
+00034290: 222c 2076 6572 626f 7365 3d31 2c20 7365  ", verbose=1, se
+000342a0: 6564 3d31 293a 0d0a 0d0a 2020 2020 2020  ed=1):....      
+000342b0: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
+000342c0: 6e63 6528 6e61 6d65 2c20 7374 7229 2c20  nce(name, str), 
+000342d0: 2241 206e 616d 6520 7368 6f75 6c64 2062  "A name should b
+000342e0: 6520 7072 6f76 6964 6564 2061 6e64 206d  e provided and m
+000342f0: 7573 7420 6265 2061 2073 7472 696e 6722  ust be a string"
+00034300: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00034310: 6973 745f 756e 6974 733d 5b5d 0d0a 2020  ist_units=[]..  
+00034320: 2020 2020 2020 7365 6c66 2e6e 616d 653d        self.name=
+00034330: 6e61 6d65 0d0a 2020 2020 2020 2020 7365  name..        se
+00034340: 6c66 2e76 6572 626f 7365 3d76 6572 626f  lf.verbose=verbo
+00034350: 7365 0d0a 2020 2020 2020 2020 7365 6c66  se..        self
+00034360: 2e73 6565 643d 7365 6564 0d0a 2020 2020  .seed=seed..    
+00034370: 2020 2020 7365 6c66 2e6e 6174 7572 6520      self.nature 
+00034380: 3d20 6e61 7475 7265 0d0a 0d0a 0d0a 2020  = nature......  
+00034390: 2020 6465 6620 5f5f 7265 7072 5f5f 2873    def __repr__(s
+000343a0: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
+000343b0: 6574 7572 6e20 7365 6c66 2e6e 616d 650d  eturn self.name.
+000343c0: 0a0d 0a20 2020 2064 6566 2061 6464 5f75  ...    def add_u
+000343d0: 6e69 7428 7365 6c66 2c20 756e 6974 293a  nit(self, unit):
+000343e0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000343f0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00034400: 2041 6464 2061 2075 6e69 7420 746f 2074   Add a unit to t
+00034410: 6865 2070 696c 650d 0a0d 0a20 2020 2020  he pile....     
+00034420: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00034430: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00034440: 2d0d 0a20 2020 2020 2020 2075 6e69 743a  -..        unit:
+00034450: 2055 6e69 7420 6f62 6a65 6374 206f 7220   Unit object or 
+00034460: 6c69 7374 206f 6620 556e 6974 206f 626a  list of Unit obj
+00034470: 6563 7473 0d0a 2020 2020 2020 2020 2020  ects..          
+00034480: 2020 756e 6974 2873 2920 746f 2061 6464    unit(s) to add
+00034490: 2074 6f20 7468 6520 7069 6c65 0d0a 2020   to the pile..  
+000344a0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+000344b0: 2020 2020 2074 7279 3a20 2369 7465 7261       try: #itera
+000344c0: 626c 650d 0a20 2020 2020 2020 2020 2020  ble..           
+000344d0: 2066 6f72 2069 2069 6e20 756e 6974 3a0d   for i in unit:.
+000344e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000344f0: 2069 6620 2869 7369 6e73 7461 6e63 6528   if (isinstance(
+00034500: 692c 2055 6e69 7429 2920 616e 6420 2869  i, Unit)) and (i
+00034510: 206e 6f74 2069 6e20 7365 6c66 2e6c 6973   not in self.lis
+00034520: 745f 756e 6974 7329 3a0d 0a20 2020 2020  t_units):..     
+00034530: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00034540: 2e76 6572 626f 7365 203d 2073 656c 662e  .verbose = self.
+00034550: 7665 7262 6f73 650d 0a20 2020 2020 2020  verbose..       
+00034560: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00034570: 662e 6c69 7374 5f75 6e69 7473 2e61 7070  f.list_units.app
+00034580: 656e 6428 6929 0d0a 2020 2020 2020 2020  end(i)..        
+00034590: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000345a0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
+000345b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000345c0: 2020 2020 2020 7072 696e 7428 2253 7472        print("Str
+000345d0: 6174 6967 7261 7068 6963 2075 6e69 7420  atigraphic unit 
+000345e0: 7b7d 2061 6464 6564 222e 666f 726d 6174  {} added".format
+000345f0: 2869 2e6e 616d 6529 290d 0a20 2020 2020  (i.name))..     
+00034600: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00034610: 2869 7369 6e73 7461 6e63 6528 692c 2055  (isinstance(i, U
+00034620: 6e69 7429 293a 0d0a 2020 2020 2020 2020  nit)):..        
+00034630: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00034640: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
+00034650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034660: 2020 2020 2020 7072 696e 7428 226f 626a        print("obj
+00034670: 6563 7420 6973 2061 6c72 6561 6479 2069  ect is already i
+00034680: 6e20 7468 6520 6c69 7374 2229 0d0a 2020  n the list")..  
+00034690: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000346a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000346b0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000346c0: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+000346d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000346e0: 2020 2070 7269 6e74 2822 6f62 6a65 6374     print("object
+000346f0: 2069 736e 2774 2061 2075 6e69 7420 6f62   isn't a unit ob
+00034700: 6a65 6374 2229 0d0a 2020 2020 2020 2020  ject")..        
+00034710: 6578 6365 7074 3a20 2320 756e 6974 206e  except: # unit n
+00034720: 6f74 2069 6e20 6120 6c69 7374 0d0a 2020  ot in a list..  
+00034730: 2020 2020 2020 2020 2020 6966 2028 6973            if (is
+00034740: 696e 7374 616e 6365 2875 6e69 742c 2055  instance(unit, U
+00034750: 6e69 7429 2920 616e 6420 2875 6e69 7420  nit)) and (unit 
+00034760: 6e6f 7420 696e 2073 656c 662e 6c69 7374  not in self.list
+00034770: 5f75 6e69 7473 293a 0d0a 2020 2020 2020  _units):..      
+00034780: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00034790: 6973 745f 756e 6974 732e 6170 7065 6e64  ist_units.append
+000347a0: 2875 6e69 7429 0d0a 2020 2020 2020 2020  (unit)..        
+000347b0: 2020 2020 2020 2020 756e 6974 2e76 6572          unit.ver
+000347c0: 626f 7365 203d 2073 656c 662e 7665 7262  bose = self.verb
+000347d0: 6f73 650d 0a20 2020 2020 2020 2020 2020  ose..           
+000347e0: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+000347f0: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+00034800: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00034810: 2822 5374 7261 7469 6772 6170 6869 6320  ("Stratigraphic 
+00034820: 756e 6974 207b 7d20 6164 6465 6422 2e66  unit {} added".f
+00034830: 6f72 6d61 7428 756e 6974 2e6e 616d 6529  ormat(unit.name)
+00034840: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00034850: 6c69 6620 2869 7369 6e73 7461 6e63 6528  lif (isinstance(
+00034860: 756e 6974 2c20 556e 6974 2929 3a0d 0a20  unit, Unit)):.. 
+00034870: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00034880: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
+00034890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000348a0: 2020 2020 2070 7269 6e74 2822 6f62 6a65       print("obje
+000348b0: 6374 2069 7320 616c 7265 6164 7920 696e  ct is already in
+000348c0: 2074 6865 206c 6973 7422 290d 0a20 2020   the list")..   
+000348d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000348e0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000348f0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00034900: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
 00034910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034920: 2020 2020 7365 6c66 2e6c 6973 745f 756e      self.list_un
-00034930: 6974 735b 695d 2e6f 7264 6572 3d69 2b31  its[i].order=i+1
-00034940: 0d0a 0d0a 2020 2020 6465 6620 636f 6d70  ....    def comp
-00034950: 7574 655f 7375 7266 2873 656c 662c 2041  ute_surf(self, A
-00034960: 7263 6854 6162 6c65 2c20 6e72 6561 6c3d  rchTable, nreal=
-00034970: 312c 2066 6c5f 746f 703d 4661 6c73 652c  1, fl_top=False,
-00034980: 2073 7562 7069 6c65 3d46 616c 7365 2c20   subpile=False, 
-00034990: 746f 7073 3d4e 6f6e 652c 2062 6f74 733d  tops=None, bots=
-000349a0: 4e6f 6e65 2c20 7662 3d31 293a 0d0a 0d0a  None, vb=1):....
-000349b0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000349c0: 2020 2020 2043 6f6d 7075 7465 2074 6865       Compute the
-000349d0: 2065 6c65 7661 7469 6f6e 206f 6620 7468   elevation of th
-000349e0: 6520 7375 7266 6163 6573 2075 6e69 7473  e surfaces units
-000349f0: 2028 3173 7420 6869 6572 6172 6368 6963   (1st hierarchic
-00034a00: 206f 7264 6572 290d 0a20 2020 2020 2020   order)..       
-00034a10: 2063 6f6e 7461 696e 6564 2069 6e20 7468   contained in th
-00034a20: 6520 5069 6c65 206f 626a 6563 742e 0d0a  e Pile object...
-00034a30: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00034a40: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00034a50: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00034a60: 2020 4172 6368 5461 626c 653a 203a 636c    ArchTable: :cl
-00034a70: 6173 733a 6041 7263 685f 7461 626c 6560  ass:`Arch_table`
-00034a80: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-00034a90: 2020 2020 2041 7263 6854 6162 6c65 206f       ArchTable o
-00034aa0: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
-00034ab0: 2074 6865 2061 7263 6869 7465 6374 7572   the architectur
-00034ac0: 6520 6f66 2074 6865 2070 696c 650d 0a20  e of the pile.. 
-00034ad0: 2020 2020 2020 206e 7265 616c 3a20 696e         nreal: in
-00034ae0: 740d 0a20 2020 2020 2020 2020 2020 206e  t..            n
-00034af0: 756d 6265 7220 6f66 2072 6561 6c69 7a61  umber of realiza
-00034b00: 7469 6f6e 0d0a 2020 2020 2020 2020 666c  tion..        fl
-00034b10: 5f74 6f70 3a20 626f 6f6c 0d0a 2020 2020  _top: bool..    
-00034b20: 2020 2020 2020 2020 746f 206e 6f74 2069          to not i
-00034b30: 6e74 6572 706f 6c61 7465 2066 6972 7374  nterpolate first
-00034b40: 206c 6179 6572 2061 6e64 2061 7373 6967   layer and assig
-00034b50: 6e20 6974 3d74 6f70 0d0a 2020 2020 2020  n it=top..      
-00034b60: 2020 7375 6270 696c 653a 2062 6f6f 6c0d    subpile: bool.
-00034b70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00034b80: 7468 6520 7069 6c65 2069 7320 6120 7375  the pile is a su
-00034b90: 6270 696c 650d 0a20 2020 2020 2020 2074  bpile..        t
-00034ba0: 6f70 732c 2062 6f74 733a 2073 6571 7565  ops, bots: seque
-00034bb0: 6e63 6520 6f66 2032 4420 6172 7261 7973  nce of 2D arrays
-00034bc0: 206f 6620 7369 7a65 2028 6e79 2c20 6e78   of size (ny, nx
-00034bd0: 290d 0a20 2020 2020 2020 2020 2020 206f  )..            o
-00034be0: 6620 746f 702f 626f 7420 666f 7220 7375  f top/bot for su
-00034bf0: 6270 696c 6520 7375 7266 6163 650d 0a20  bpile surface.. 
-00034c00: 2020 2020 2020 2076 623a 2069 6e74 0d0a         vb: int..
-00034c10: 2020 2020 2020 2020 2020 2020 6c65 7665              leve
-00034c20: 6c20 6f66 2076 6572 626f 7369 7479 2c20  l of verbosity, 
-00034c30: 3020 666f 7220 6e6f 2070 7269 6e74 2c20  0 for no print, 
-00034c40: 3120 666f 7220 7072 696e 740d 0a0d 0a20  1 for print.... 
-00034c50: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00034c60: 2020 2020 2020 6465 6620 6164 645f 7374        def add_st
-00034c70: 6f5f 636f 6e74 6163 7428 732c 2078 2c20  o_contact(s, x, 
-00034c80: 792c 207a 2c20 7479 7065 3d22 6571 7561  y, z, type="equa
-00034c90: 6c69 7479 222c 207a 323d 4e6f 6e65 293a  lity", z2=None):
-00034ca0: 2023 6675 6e63 7469 6f6e 2074 6f20 6164   #function to ad
-00034cb0: 6420 6120 7374 6f63 6861 7374 6963 2068  d a stochastic h
-00034cc0: 6420 706f 696e 7420 746f 2061 2073 7572  d point to a sur
-00034cd0: 6661 6365 0d0a 2020 2020 2020 2020 2020  face..          
-00034ce0: 2020 2320 7761 726e 696e 6720 6e6f 2063    # warning no c
-00034cf0: 6865 636b 2074 6861 7420 706f 696e 7420  heck that point 
-00034d00: 6973 2069 6e73 6964 6520 646f 6d61 696e  is inside domain
-00034d10: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00034d20: 2074 7970 6520 3d3d 2022 6571 7561 6c69   type == "equali
-00034d30: 7479 223a 0d0a 2020 2020 2020 2020 2020  ty":..          
-00034d40: 2020 2020 2020 732e 7375 7266 6163 652e        s.surface.
-00034d50: 7374 6f5f 782e 6170 7065 6e64 2878 290d  sto_x.append(x).
-00034d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034d70: 2073 2e73 7572 6661 6365 2e73 746f 5f79   s.surface.sto_y
-00034d80: 2e61 7070 656e 6428 7929 0d0a 2020 2020  .append(y)..    
-00034d90: 2020 2020 2020 2020 2020 2020 732e 7375              s.su
-00034da0: 7266 6163 652e 7374 6f5f 7a2e 6170 7065  rface.sto_z.appe
-00034db0: 6e64 287a 290d 0a20 2020 2020 2020 2020  nd(z)..         
-00034dc0: 2020 2065 6c69 6620 7479 7065 203d 3d20     elif type == 
-00034dd0: 2269 6e65 715f 696e 6622 3a0d 0a20 2020  "ineq_inf":..   
-00034de0: 2020 2020 2020 2020 2020 2020 2073 2e73               s.s
-00034df0: 7572 6661 6365 2e73 746f 5f69 6e65 712e  urface.sto_ineq.
-00034e00: 6170 7065 6e64 285b 782c 2079 2c20 302c  append([x, y, 0,
-00034e10: 207a 2c20 6e70 2e6e 616e 5d29 0d0a 2020   z, np.nan])..  
-00034e20: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-00034e30: 7970 6520 3d3d 2022 696e 6571 5f73 7570  ype == "ineq_sup
-00034e40: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-00034e50: 2020 2020 732e 7375 7266 6163 652e 7374      s.surface.st
-00034e60: 6f5f 696e 6571 2e61 7070 656e 6428 5b78  o_ineq.append([x
-00034e70: 2c20 792c 2030 2c20 6e70 2e6e 616e 2c20  , y, 0, np.nan, 
-00034e80: 7a5d 290d 0a20 2020 2020 2020 2020 2020  z])..           
-00034e90: 2065 6c69 6620 7479 7065 203d 3d20 2264   elif type == "d
-00034ea0: 6f75 626c 655f 696e 6571 223a 0d0a 2020  ouble_ineq":..  
-00034eb0: 2020 2020 2020 2020 2020 2020 2020 732e                s.
-00034ec0: 7375 7266 6163 652e 7374 6f5f 696e 6571  surface.sto_ineq
-00034ed0: 2e61 7070 656e 6428 5b78 2c20 792c 2030  .append([x, y, 0
-00034ee0: 2c20 7a2c 207a 325d 2920 2023 2069 6e66  , z, z2])  # inf
-00034ef0: 6572 696f 7220 616e 6420 7570 7065 7220  erior and upper 
-00034f00: 696e 6571 0d0a 0d0a 0d0a 2020 2020 2020  ineq......      
-00034f10: 2020 6966 2041 7263 6854 6162 6c65 2e63    if ArchTable.c
-00034f20: 6865 636b 5f70 696c 6573 5f6e 616d 6528  heck_piles_name(
-00034f30: 2920 3d3d 2030 3a20 2320 6368 6563 6b20  ) == 0: # check 
-00034f40: 636f 6e73 6973 7465 6e63 7920 696e 2075  consistency in u
-00034f50: 6e69 740d 0a20 2020 2020 2020 2020 2020  nit..           
-00034f60: 2072 6574 7572 6e20 4e6f 6e65 0d0a 0d0a   return None....
-00034f70: 2020 2020 2020 2020 4172 6368 5461 626c          ArchTabl
-00034f80: 652e 6e72 6561 6c5f 756e 6974 733d 6e72  e.nreal_units=nr
-00034f90: 6561 6c20 2023 2073 746f 7265 206e 756d  eal  # store num
-00034fa0: 6265 7220 6f66 2072 6561 6c69 7a61 7469  ber of realizati
-00034fb0: 6f6e 730d 0a0d 0a20 2020 2020 2020 2023  ons....        #
-00034fc0: 7369 6d75 6c61 7469 6f6e 2067 7269 640d  simulation grid.
-00034fd0: 0a20 2020 2020 2020 2078 673d 4172 6368  .        xg=Arch
-00034fe0: 5461 626c 652e 6765 745f 7867 6328 290d  Table.get_xgc().
-00034ff0: 0a20 2020 2020 2020 206e 783d 7867 2e73  .        nx=xg.s
-00035000: 6861 7065 5b30 5d0d 0a20 2020 2020 2020  hape[0]..       
-00035010: 2079 673d 4172 6368 5461 626c 652e 6765   yg=ArchTable.ge
-00035020: 745f 7967 6328 290d 0a20 2020 2020 2020  t_ygc()..       
-00035030: 206e 793d 7967 2e73 6861 7065 5b30 5d0d   ny=yg.shape[0].
-00035040: 0a20 2020 2020 2020 207a 673d 4172 6368  .        zg=Arch
-00035050: 5461 626c 652e 6765 745f 7a67 2829 0d0a  Table.get_zg()..
-00035060: 2020 2020 2020 2020 6e7a 3d7a 672e 7368          nz=zg.sh
-00035070: 6170 655b 305d 202d 2031 0d0a 2020 2020  ape[0] - 1..    
-00035080: 2020 2020 6966 207e 7375 6270 696c 653a      if ~subpile:
-00035090: 0d0a 2020 2020 2020 2020 2020 2020 746f  ..            to
-000350a0: 703d 4172 6368 5461 626c 652e 746f 700d  p=ArchTable.top.
-000350b0: 0a20 2020 2020 2020 2020 2020 2062 6f74  .            bot
-000350c0: 3d41 7263 6854 6162 6c65 2e62 6f74 0d0a  =ArchTable.bot..
-000350d0: 2020 2020 2020 2020 6d61 736b 3d41 7263          mask=Arc
-000350e0: 6854 6162 6c65 2e6d 6173 6b20 2023 2073  hTable.mask  # s
-000350f0: 696d 756c 6174 696f 6e20 6d61 736b 0d0a  imulation mask..
-00035100: 2020 2020 2020 2020 6d61 736b 3244 203d          mask2D =
-00035110: 2041 7263 6854 6162 6c65 2e6d 6173 6b32   ArchTable.mask2
-00035120: 6420 2023 206d 6173 6b20 3244 0d0a 2020  d  # mask 2D..  
-00035130: 2020 2020 2020 6e6c 6179 3d6c 656e 2873        nlay=len(s
-00035140: 656c 662e 6c69 7374 5f75 6e69 7473 290d  elf.list_units).
-00035150: 0a0d 0a20 2020 2020 2020 2069 6620 7662  ...        if vb
-00035160: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00035170: 7269 6e74 2822 2323 2323 2323 2323 2323  rint("##########
-00035180: 2050 494c 4520 7b7d 2023 2323 2323 2323   PILE {} #######
-00035190: 2323 2322 2e66 6f72 6d61 7428 7365 6c66  ###".format(self
-000351a0: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
-000351b0: 2023 6d61 6b65 2073 7572 6520 746f 2068   #make sure to h
-000351c0: 6176 6520 6f72 6465 7265 6420 6c69 7468  ave ordered lith
-000351d0: 6f6c 6f67 6965 730d 0a20 2020 2020 2020  ologies..       
-000351e0: 2073 656c 662e 6f72 6465 725f 756e 6974   self.order_unit
-000351f0: 7328 7662 3d76 6229 0d0a 0d0a 2020 2020  s(vb=vb)....    
-00035200: 2020 2020 2323 2320 696e 6974 6961 6c69      ### initiali
-00035210: 7a65 2073 7572 6661 6365 7320 6279 2073  ze surfaces by s
-00035220: 6574 7469 6e67 2074 6f20 300d 0a0d 0a20  etting to 0.... 
-00035230: 2020 2020 2020 2073 7572 6673 3d6e 702e         surfs=np.
-00035240: 7a65 726f 7328 5b6e 7265 616c 2c20 6e6c  zeros([nreal, nl
-00035250: 6179 2c20 6e79 2c20 6e78 5d2c 2064 7479  ay, ny, nx], dty
-00035260: 7065 3d6e 702e 666c 6f61 7433 3229 0d0a  pe=np.float32)..
-00035270: 2020 2020 2020 2020 7375 7266 735f 626f          surfs_bo
-00035280: 743d 6e70 2e7a 6572 6f73 285b 6e72 6561  t=np.zeros([nrea
-00035290: 6c2c 206e 6c61 792c 206e 792c 206e 785d  l, nlay, ny, nx]
-000352a0: 2c20 6474 7970 653d 6e70 2e66 6c6f 6174  , dtype=np.float
-000352b0: 3332 290d 0a20 2020 2020 2020 206f 7267  32)..        org
-000352c0: 5f73 7572 6673 3d6e 702e 7a65 726f 7328  _surfs=np.zeros(
-000352d0: 5b6e 7265 616c 2c20 6e6c 6179 2c20 6e79  [nreal, nlay, ny
-000352e0: 2c20 6e78 5d2c 2064 7479 7065 3d6e 702e  , nx], dtype=np.
-000352f0: 666c 6f61 7433 3229 0d0a 2020 2020 2020  float32)..      
-00035300: 2020 7265 616c 5f64 6f6d 6169 6e73 3d6e    real_domains=n
-00035310: 702e 7a65 726f 7328 5b6e 7265 616c 2c20  p.zeros([nreal, 
-00035320: 6e6c 6179 2c20 6e7a 2c20 6e79 2c20 6e78  nlay, nz, ny, nx
-00035330: 5d2c 2064 7479 7065 3d6e 702e 696e 7438  ], dtype=np.int8
-00035340: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
-00035350: 2069 7265 616c 2069 6e20 7261 6e67 6528   ireal in range(
-00035360: 6e72 6561 6c29 3a20 2320 6c6f 6f70 206f  nreal): # loop o
-00035370: 7665 7220 7265 616c 0d0a 0d0a 2020 2020  ver real....    
-00035380: 2020 2020 2020 2020 2320 6572 6173 6520          # erase 
-00035390: 7374 6f63 6861 7374 6963 2064 6174 610d  stochastic data.
-000353a0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000353b0: 2073 2069 6e20 7365 6c66 2e6c 6973 745f   s in self.list_
-000353c0: 756e 6974 733a 0d0a 2020 2020 2020 2020  units:..        
-000353d0: 2020 2020 2020 2020 732e 7375 7266 6163          s.surfac
-000353e0: 652e 7374 6f5f 7820 3d20 5b5d 0d0a 2020  e.sto_x = []..  
-000353f0: 2020 2020 2020 2020 2020 2020 2020 732e                s.
-00035400: 7375 7266 6163 652e 7374 6f5f 7920 3d20  surface.sto_y = 
-00035410: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-00035420: 2020 2020 732e 7375 7266 6163 652e 7374      s.surface.st
-00035430: 6f5f 7a20 3d20 5b5d 0d0a 2020 2020 2020  o_z = []..      
-00035440: 2020 2020 2020 2020 2020 732e 7375 7266            s.surf
-00035450: 6163 652e 7374 6f5f 696e 6571 203d 205b  ace.sto_ineq = [
-00035460: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-00035470: 2023 2063 6f6d 7075 7465 2073 746f 2064   # compute sto d
-00035480: 6174 610d 0a20 2020 2020 2020 2020 2020  ata..           
-00035490: 2066 6f72 2067 2069 6e20 4172 6368 5461   for g in ArchTa
-000354a0: 626c 652e 7374 6f5f 6864 3a0d 0a20 2020  ble.sto_hd:..   
-000354b0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
-000354c0: 7264 203d 2067 5b30 5d0d 0a20 2020 2020  rd = g[0]..     
-000354d0: 2020 2020 2020 2020 2020 2078 2c79 2c7a             x,y,z
-000354e0: 203d 2063 6f6f 7264 0d0a 2020 2020 2020   = coord..      
-000354f0: 2020 2020 2020 2020 2020 6864 203d 2067            hd = g
-00035500: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
-00035510: 2020 2020 2070 203d 2067 5b32 5d0d 0a20       p = g[2].. 
-00035520: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00035530: 203d 206e 702e 7261 6e64 6f6d 2e63 686f   = np.random.cho
-00035540: 6963 6528 7261 6e67 6528 6c65 6e28 7029  ice(range(len(p)
-00035550: 292c 2070 3d70 290d 0a20 2020 2020 2020  ), p=p)..       
-00035560: 2020 2020 2020 2020 2066 6f72 2073 2c20           for s, 
-00035570: 7479 7020 696e 206e 702e 6172 7261 7928  typ in np.array(
-00035580: 6864 5b69 5d29 3a0d 0a20 2020 2020 2020  hd[i]):..       
-00035590: 2020 2020 2020 2020 2020 2020 2061 6464               add
-000355a0: 5f73 746f 5f63 6f6e 7461 6374 2873 2c20  _sto_contact(s, 
-000355b0: 782c 2079 2c20 7a2c 2074 7970 290d 0a0d  x, y, z, typ)...
-000355c0: 0a20 2020 2020 2020 2020 2020 2023 746f  .            #to
-000355d0: 702f 626f 740d 0a20 2020 2020 2020 2020  p/bot..         
-000355e0: 2020 2069 6620 7375 6270 696c 653a 0d0a     if subpile:..
-000355f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035600: 746f 703d 746f 7073 5b69 7265 616c 5d0d  top=tops[ireal].
-00035610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035620: 2062 6f74 3d62 6f74 735b 6972 6561 6c5d   bot=bots[ireal]
-00035630: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00035640: 2320 636f 756e 7465 7220 666f 7220 6375  # counter for cu
-00035650: 7272 656e 7420 7369 6d75 6c61 7465 6420  rrent simulated 
-00035660: 7375 7266 6163 650d 0a20 2020 2020 2020  surface..       
-00035670: 2020 2020 2069 3d2d 310d 0a0d 0a20 2020       i=-1....   
-00035680: 2020 2020 2020 2020 2066 6f72 206c 6974           for lit
-00035690: 686f 2069 6e20 7365 6c66 2e6c 6973 745f  ho in self.list_
-000356a0: 756e 6974 735b 3a3a 202d 315d 3a0d 0a20  units[:: -1]:.. 
-000356b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000356c0: 6620 7662 3a0d 0a20 2020 2020 2020 2020  f vb:..         
-000356d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000356e0: 2822 5c6e 2323 2323 2043 4f4d 5055 5449  ("\n#### COMPUTI
-000356f0: 4e47 2053 5552 4641 4345 204f 4620 554e  NG SURFACE OF UN
-00035700: 4954 207b 7d22 2e66 6f72 6d61 7428 6c69  IT {}".format(li
-00035710: 7468 6f2e 6e61 6d65 2929 0d0a 2020 2020  tho.name))..    
-00035720: 2020 2020 2020 2020 2020 2020 6920 2b3d              i +=
-00035730: 2031 2020 2320 696e 6465 7820 666f 7220   1  # index for 
-00035740: 7369 6d75 6c61 7465 6420 7375 7266 6163  simulated surfac
-00035750: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00035760: 2020 2073 7461 7274 3d74 696d 652e 7469     start=time.ti
-00035770: 6d65 2829 0d0a 2020 2020 2020 2020 2020  me()..          
-00035780: 2020 2020 2020 6966 2028 666c 5f74 6f70        if (fl_top
-00035790: 2920 616e 6420 2869 203d 3d20 6e6c 6179  ) and (i == nlay
-000357a0: 2d31 293a 2023 2066 6972 7374 206c 6179  -1): # first lay
-000357b0: 6572 2061 7373 6967 6e20 746f 2074 6f70  er assign to top
-000357c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000357d0: 2020 2020 2020 7331 3d74 6f70 0d0a 2020        s1=top..  
-000357e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000357f0: 6966 2028 6c69 7468 6f2e 7375 7266 6163  if (litho.surfac
-00035800: 652e 696e 745f 6d65 7468 6f64 2069 6e20  e.int_method in 
-00035810: 5b22 6b72 6967 696e 6722 2c20 226c 696e  ["kriging", "lin
-00035820: 6561 7222 2c20 2263 7562 6963 222c 2022  ear", "cubic", "
-00035830: 6e65 6172 6573 7422 5d29 2061 6e64 2028  nearest"]) and (
-00035840: 6972 6561 6c20 3e20 3029 3a20 2320 6465  ireal > 0): # de
-00035850: 7465 726d 696e 6973 7420 6d65 7468 6f64  terminist method
-00035860: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00035870: 2020 2020 2020 7331 3d6f 7267 5f73 7572        s1=org_sur
-00035880: 6673 5b30 2c20 286e 6c61 792d 3129 2d69  fs[0, (nlay-1)-i
-00035890: 5d2e 636f 7079 2829 0d0a 2020 2020 2020  ].copy()..      
-000358a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000358b0: 2076 623a 0d0a 2020 2020 2020 2020 2020   vb:..          
-000358c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000358d0: 696e 7428 227b 7d3a 2064 6574 6572 6d69  int("{}: determi
-000358e0: 6e69 7374 2069 6e74 6572 706f 6c61 7469  nist interpolati
-000358f0: 6f6e 206d 6574 686f 642c 2072 6575 7365  on method, reuse
-00035900: 2074 6865 2066 6972 7374 2073 7572 6661   the first surfa
-00035910: 6365 222e 666f 726d 6174 286c 6974 686f  ce".format(litho
-00035920: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
-00035930: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00035940: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00035950: 2020 2020 2020 2320 6368 616e 6765 206d        # change m
-00035960: 6561 6e20 6966 2074 6869 636b 6e65 7373  ean if thickness
-00035970: 206d 6f64 6520 6973 2061 6374 6976 6174   mode is activat
-00035980: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-00035990: 2020 2020 2020 2020 6966 2022 7468 6963          if "thic
-000359a0: 6b6e 6573 7322 2069 6e20 6c69 7468 6f2e  kness" in litho.
-000359b0: 7375 7266 6163 652e 6469 635f 7375 7266  surface.dic_surf
-000359c0: 2e6b 6579 7328 293a 0d0a 2020 2020 2020  .keys():..      
-000359d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000359e0: 2020 6966 206c 6974 686f 2e73 7572 6661    if litho.surfa
-000359f0: 6365 2e64 6963 5f73 7572 665b 2274 6869  ce.dic_surf["thi
-00035a00: 636b 6e65 7373 225d 2069 7320 6e6f 7420  ckness"] is not 
-00035a10: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00035a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a30: 2020 2069 6620 6920 3d3d 2030 3a0d 0a20     if i == 0:.. 
-00035a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00035a60: 6974 686f 2e73 7572 6661 6365 2e64 6963  itho.surface.dic
-00035a70: 5f73 7572 665b 226d 6561 6e22 5d20 3d20  _surf["mean"] = 
-00035a80: 4172 6368 5461 626c 652e 626f 7420 2b20  ArchTable.bot + 
-00035a90: 6c69 7468 6f2e 7375 7266 6163 652e 6469  litho.surface.di
-00035aa0: 635f 7375 7266 5b22 7468 6963 6b6e 6573  c_surf["thicknes
-00035ab0: 7322 5d0d 0a20 2020 2020 2020 2020 2020  s"]..           
-00035ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ad0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00035ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035af0: 2020 2020 2020 2020 6c69 7468 6f2e 7375          litho.su
-00035b00: 7266 6163 652e 6469 635f 7375 7266 5b22  rface.dic_surf["
-00035b10: 6d65 616e 225d 203d 2073 3120 2b20 6c69  mean"] = s1 + li
-00035b20: 7468 6f2e 7375 7266 6163 652e 6469 635f  tho.surface.dic_
-00035b30: 7375 7266 5b22 7468 6963 6b6e 6573 7322  surf["thickness"
-00035b40: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-00035b50: 2020 2020 2020 2020 2073 313d 696e 7465           s1=inte
-00035b60: 7270 3244 286c 6974 686f 2e73 7572 6661  rp2D(litho.surfa
-00035b70: 6365 2c20 4172 6368 5461 626c 652e 6765  ce, ArchTable.ge
-00035b80: 745f 7867 2829 2c20 4172 6368 5461 626c  t_xg(), ArchTabl
-00035b90: 652e 6765 745f 7967 2829 2c20 4172 6368  e.get_yg(), Arch
-00035ba0: 5461 626c 652e 7875 3244 2c0d 0a20 2020  Table.xu2D,..   
-00035bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035bc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00035bd0: 6564 3d41 7263 6854 6162 6c65 2e73 6565  ed=ArchTable.see
-00035be0: 6420 2b20 6c69 7468 6f2e 4944 202a 2031  d + litho.ID * 1
-00035bf0: 6533 202b 2069 7265 616c 2c20 7665 7262  e3 + ireal, verb
-00035c00: 6f73 653d 4172 6368 5461 626c 652e 7665  ose=ArchTable.ve
-00035c10: 7262 6f73 652c 206e 6370 753d 4172 6368  rbose, ncpu=Arch
-00035c20: 5461 626c 652e 6e63 7075 2c20 6d61 736b  Table.ncpu, mask
-00035c30: 3244 3d6d 6173 6b32 442c 0d0a 2020 2020  2D=mask2D,..    
-00035c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c50: 2020 2020 2020 2020 2020 2020 202a 2a6c               **l
-00035c60: 6974 686f 2e73 7572 6661 6365 2e64 6963  itho.surface.dic
-00035c70: 5f73 7572 6629 2023 2073 696d 756c 6174  _surf) # simulat
-00035c80: 696f 6e0d 0a0d 0a20 2020 2020 2020 2020  ion....         
-00035c90: 2020 2020 2020 2020 2020 2023 2072 656d             # rem
-00035ca0: 6f76 6520 6d65 616e 0d0a 2020 2020 2020  ove mean..      
-00035cb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00035cc0: 2022 7468 6963 6b6e 6573 7322 2069 6e20   "thickness" in 
-00035cd0: 6c69 7468 6f2e 7375 7266 6163 652e 6469  litho.surface.di
-00035ce0: 635f 7375 7266 2e6b 6579 7328 293a 0d0a  c_surf.keys():..
-00035cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035d00: 2020 2020 2020 2020 6966 206c 6974 686f          if litho
-00035d10: 2e73 7572 6661 6365 2e64 6963 5f73 7572  .surface.dic_sur
-00035d20: 665b 2274 6869 636b 6e65 7373 225d 2069  f["thickness"] i
-00035d30: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-00035d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035d50: 2020 2020 2020 2020 206c 6974 686f 2e73           litho.s
-00035d60: 7572 6661 6365 2e64 6963 5f73 7572 665b  urface.dic_surf[
-00035d70: 226d 6561 6e22 5d20 3d20 4e6f 6e65 0d0a  "mean"] = None..
-00035d80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00035d90: 2020 656e 643d 7469 6d65 2e74 696d 6528    end=time.time(
-00035da0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00035db0: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
-00035dc0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00035dd0: 7269 6e74 2822 7b7d 3a20 7469 6d65 2065  rint("{}: time e
-00035de0: 6c61 7073 6564 2066 6f72 2063 6f6d 7075  lapsed for compu
-00035df0: 7469 6e67 2073 7572 6661 6365 207b 7d20  ting surface {} 
-00035e00: 7322 2e66 6f72 6d61 7428 6c69 7468 6f2e  s".format(litho.
-00035e10: 6e61 6d65 2c20 2865 6e64 202d 2073 7461  name, (end - sta
-00035e20: 7274 2929 290d 0a0d 0a20 2020 2020 2020  rt)))....       
-00035e30: 2020 2020 2020 2020 2023 2320 6966 206e           ## if n
-00035e40: 616e 2069 6e73 6964 6520 7468 6520 646f  an inside the do
-00035e50: 6d61 696e 2028 6e6f 6e20 7369 6d75 6c61  main (non simula
-00035e60: 7465 6420 6172 6561 2920 2d2d 3e20 7365  ted area) --> se
-00035e70: 7420 7661 6c75 6573 2066 726f 6d20 7375  t values from su
-00035e80: 7266 6163 6520 6265 6c6f 770d 0a20 2020  rface below..   
-00035e90: 2020 2020 2020 2020 2020 2020 206d 6173               mas
-00035ea0: 6b5f 6e61 6e20 3d20 6e70 2e7a 6572 6f73  k_nan = np.zeros
-00035eb0: 285b 6e79 2c20 6e78 5d2c 2064 7479 7065  ([ny, nx], dtype
-00035ec0: 3d62 6f6f 6c29 0d0a 2020 2020 2020 2020  =bool)..        
-00035ed0: 2020 2020 2020 2020 6d61 736b 5f6e 616e          mask_nan
-00035ee0: 5b6d 6173 6b32 445d 203d 206e 702e 6973  [mask2D] = np.is
-00035ef0: 6e61 6e28 7331 5b6d 6173 6b32 445d 290d  nan(s1[mask2D]).
-00035f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035f10: 2069 6620 6d61 736b 5f6e 616e 2e61 6e79   if mask_nan.any
-00035f20: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-00035f30: 2020 2020 2020 2020 2069 6620 6920 3e20           if i > 
-00035f40: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00035f50: 2020 2020 2020 2020 2020 2020 7331 5b6d              s1[m
-00035f60: 6173 6b5f 6e61 6e5d 203d 206f 7267 5f73  ask_nan] = org_s
-00035f70: 7572 6673 5b69 7265 616c 2c20 286e 6c61  urfs[ireal, (nla
-00035f80: 792d 3129 2d69 2b31 5d5b 6d61 736b 5f6e  y-1)-i+1][mask_n
-00035f90: 616e 5d0d 0a20 2020 2020 2020 2020 2020  an]..           
-00035fa0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00035fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035fc0: 2020 2020 2020 2020 7331 5b6d 6173 6b5f          s1[mask_
-00035fd0: 6e61 6e5d 203d 2062 6f74 5b6d 6173 6b5f  nan] = bot[mask_
-00035fe0: 6e61 6e5d 0d0a 0d0a 2020 2020 2020 2020  nan]....        
-00035ff0: 2020 2020 2020 2020 6f72 675f 7375 7266          org_surf
-00036000: 735b 6972 6561 6c2c 2028 6e6c 6179 2d31  s[ireal, (nlay-1
-00036010: 292d 695d 3d73 312e 636f 7079 2829 0d0a  )-i]=s1.copy()..
-00036020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00036030: 2020 2320 6164 6170 7420 616c 7469 7475    # adapt altitu
-00036040: 6465 2069 6620 6162 6f76 652f 6265 6c6f  de if above/belo
-00036050: 7720 746f 702f 626f 740d 0a20 2020 2020  w top/bot..     
-00036060: 2020 2020 2020 2020 2020 2073 315b 7331             s1[s1
-00036070: 3e74 6f70 5d3d 746f 705b 7331 3e74 6f70  >top]=top[s1>top
-00036080: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00036090: 2020 2073 315b 7331 3c62 6f74 5d3d 626f     s1[s1<bot]=bo
-000360a0: 745b 7331 3c62 6f74 5d0d 0a0d 0a20 2020  t[s1<bot]....   
-000360b0: 2020 2020 2020 2020 2020 2020 2023 7374               #st
-000360c0: 7261 7469 2063 6f6e 7369 7374 656e 6379  rati consistency
-000360d0: 2061 6e64 2065 726f 7369 6f6e 2072 756c   and erosion rul
-000360e0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-000360f0: 2020 2020 6966 2069 203e 2030 3a0d 0a20      if i > 0:.. 
-00036100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036110: 2020 2066 6f72 206f 2069 6e20 7261 6e67     for o in rang
-00036120: 6528 6929 3a20 2320 696e 6465 7820 666f  e(i): # index fo
-00036130: 7220 6368 6563 6b69 6e67 2061 6c72 6561  r checking alrea
-00036140: 6479 2073 696d 756c 6174 6564 2073 7572  dy simulated sur
-00036150: 6661 6365 730d 0a20 2020 2020 2020 2020  faces..         
-00036160: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00036170: 6974 686f 323d 7365 6c66 2e6c 6973 745f  itho2=self.list_
-00036180: 756e 6974 735b 3a3a 202d 315d 5b6f 5d0d  units[:: -1][o].
-00036190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000361a0: 2020 2020 2020 2020 2073 323d 7375 7266           s2=surf
-000361b0: 735b 6972 6561 6c2c 2028 6e6c 6179 2d31  s[ireal, (nlay-1
-000361c0: 292d 6f5d 2023 6964 7820 6672 6f6d 206e  )-o] #idx from n
-000361d0: 6c61 792d 3120 746f 206e 6c61 792d 692d  lay-1 to nlay-i-
-000361e0: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
-000361f0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-00036200: 7468 6f20 213d 206c 6974 686f 323a 0d0a  tho != litho2:..
-00036210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036220: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-00036230: 6c69 7468 6f2e 6f72 6465 7220 3c20 6c69  litho.order < li
-00036240: 7468 6f32 2e6f 7264 6572 2920 2620 286c  tho2.order) & (l
-00036250: 6974 686f 2e73 7572 6661 6365 2e63 6f6e  itho.surface.con
-00036260: 7461 6374 203d 3d20 226f 6e6c 6170 2229  tact == "onlap")
-00036270: 3a20 2320 7369 2063 6f75 6368 6520 7369  : # si couche si
-00036280: 6d75 6cc3 a965 2073 7570 2065 7420 6f6e  mul..e sup et on
-00036290: 6c61 700d 0a20 2020 2020 2020 2020 2020  lap..           
-000362a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362b0: 2020 2020 2073 315b 7331 203c 2073 325d       s1[s1 < s2]
-000362c0: 3d73 325b 7331 203c 2073 325d 0d0a 2020  =s2[s1 < s2]..  
-000362d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362e0: 2020 2020 2020 2020 2020 656c 6966 2028            elif (
-000362f0: 6c69 7468 6f2e 6f72 6465 7220 3c20 6c69  litho.order < li
-00036300: 7468 6f32 2e6f 7264 6572 2920 2620 286c  tho2.order) & (l
-00036310: 6974 686f 2e73 7572 6661 6365 2e63 6f6e  itho.surface.con
-00036320: 7461 6374 203d 3d20 2265 726f 6465 2229  tact == "erode")
-00036330: 3a20 2320 7369 2063 6f75 6368 6520 7369  : # si couche si
-00036340: 6d75 6cc3 a965 20c3 a972 6f64 6520 756e  mul..e ..rode un
-00036350: 6520 616e 6369 656e 6e65 0d0a 2020 2020  e ancienne..    
-00036360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036370: 2020 2020 2020 2020 2020 2020 7332 5b73              s2[s
-00036380: 3220 3e20 7331 5d3d 7331 5b73 3220 3e20  2 > s1]=s1[s2 > 
-00036390: 7331 5d0d 0a20 2020 2020 2020 2020 2020  s1]..           
+00034920: 2020 7072 696e 7428 226f 626a 6563 7420    print("object 
+00034930: 6973 6e27 7420 6120 756e 6974 206f 626a  isn't a unit obj
+00034940: 6563 7422 290d 0a0d 0a20 2020 2064 6566  ect")....    def
+00034950: 2072 656d 6f76 655f 756e 6974 2873 656c   remove_unit(sel
+00034960: 662c 2075 6e69 745f 746f 5f72 656d 293a  f, unit_to_rem):
+00034970: 0d0a 0d0a 2020 2020 2020 2020 2222 2252  ....        """R
+00034980: 656d 6f76 6520 7468 6520 6769 7665 6e20  emove the given 
+00034990: 756e 6974 206f 626a 6563 7420 6672 6f6d  unit object from
+000349a0: 2050 696c 6520 6f62 6a65 6374 0d0a 2020   Pile object..  
+000349b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000349c0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+000349d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+000349e0: 2020 2020 2020 2020 756e 6974 5f74 6f5f          unit_to_
+000349f0: 7265 6d3a 203a 636c 6173 733a 6055 6e69  rem: :class:`Uni
+00034a00: 7460 206f 626a 6563 740d 0a20 2020 2020  t` object..     
+00034a10: 2020 2020 2020 2075 6e69 7420 746f 2072         unit to r
+00034a20: 656d 6f76 6520 6672 6f6d 2074 6865 2070  emove from the p
+00034a30: 696c 650d 0a20 2020 2020 2020 2022 2222  ile..        """
+00034a40: 0d0a 0d0a 2020 2020 2020 2020 6966 206c  ....        if l
+00034a50: 656e 2873 656c 662e 6c69 7374 5f75 6e69  en(self.list_uni
+00034a60: 7473 2920 3e20 303a 0d0a 2020 2020 2020  ts) > 0:..      
+00034a70: 2020 2020 2020 6966 2075 6e69 745f 746f        if unit_to
+00034a80: 5f72 656d 2069 6e20 7365 6c66 2e6c 6973  _rem in self.lis
+00034a90: 745f 756e 6974 733a 0d0a 2020 2020 2020  t_units:..      
+00034aa0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00034ab0: 6973 745f 756e 6974 732e 7265 6d6f 7665  ist_units.remove
+00034ac0: 2875 6e69 745f 746f 5f72 656d 290d 0a20  (unit_to_rem).. 
+00034ad0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00034ae0: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
+00034af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034b00: 2020 2020 2070 7269 6e74 2822 556e 6974       print("Unit
+00034b10: 207b 7d20 7265 6d6f 7665 6420 6672 6f6d   {} removed from
+00034b20: 2050 696c 6520 7b7d 222e 666f 726d 6174   Pile {}".format
+00034b30: 2875 6e69 745f 746f 5f72 656d 2e6e 616d  (unit_to_rem.nam
+00034b40: 652c 2073 656c 662e 6e61 6d65 2929 0d0a  e, self.name))..
+00034b50: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00034b60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00034b70: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
+00034b80: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00034b90: 7269 6e74 2822 6e6f 2075 6e69 7473 2066  rint("no units f
+00034ba0: 6f75 6e64 2069 6e20 7069 6c65 207b 7d22  ound in pile {}"
+00034bb0: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
+00034bc0: 6529 290d 0a0d 0a20 2020 2064 6566 206f  e))....    def o
+00034bd0: 7264 6572 5f75 6e69 7473 2873 656c 662c  rder_units(self,
+00034be0: 2076 623d 3129 3a0d 0a0d 0a20 2020 2020   vb=1):....     
+00034bf0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00034c00: 4f72 6465 7220 6c69 7374 5f6c 6974 6873  Order list_liths
+00034c10: 2061 6363 6f72 6469 6e67 2074 6865 206f   according the o
+00034c20: 7264 6572 2061 7474 7269 6275 7465 7320  rder attributes 
+00034c30: 6f66 2065 6163 6820 6c69 7468 6f6c 6f67  of each litholog
+00034c40: 6965 730d 0a0d 0a20 2020 2020 2020 2050  ies....        P
+00034c50: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00034c60: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00034c70: 2020 2020 2020 2076 623a 2069 6e74 0d0a         vb: int..
+00034c80: 2020 2020 2020 2020 2020 2020 6c65 7665              leve
+00034c90: 6c20 6f66 2076 6572 626f 7369 7479 2c20  l of verbosity, 
+00034ca0: 3020 666f 7220 6e6f 2070 7269 6e74 2c20  0 for no print, 
+00034cb0: 3120 666f 7220 7072 696e 740d 0a20 2020  1 for print..   
+00034cc0: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00034cd0: 2020 2020 6966 2076 623a 0d0a 2020 2020      if vb:..    
+00034ce0: 2020 2020 2020 2020 7072 696e 7428 2250          print("P
+00034cf0: 696c 6520 7b7d 3a20 6f72 6465 7269 6e67  ile {}: ordering
+00034d00: 2075 6e69 7473 222e 666f 726d 6174 2873   units".format(s
+00034d10: 656c 662e 6e61 6d65 2929 0d0a 0d0a 2020  elf.name))....  
+00034d20: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
+00034d30: 756e 6974 732e 736f 7274 286b 6579 3d6c  units.sort(key=l
+00034d40: 616d 6264 6120 783a 2078 2e6f 7264 6572  ambda x: x.order
+00034d50: 290d 0a20 2020 2020 2020 2069 6620 7662  )..        if vb
+00034d60: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00034d70: 7269 6e74 2822 5374 7261 7469 6772 6170  rint("Stratigrap
+00034d80: 6869 6320 756e 6974 7320 6861 7665 2062  hic units have b
+00034d90: 6565 6e20 736f 7274 6564 2061 6363 6f72  een sorted accor
+00034da0: 6469 6e67 2074 6f20 6f72 6465 7222 290d  ding to order").
+00034db0: 0a0d 0a20 2020 2020 2020 2069 3d30 0d0a  ...        i=0..
+00034dc0: 2020 2020 2020 2020 666c 6167 3d30 0d0a          flag=0..
+00034dd0: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
+00034de0: 6f72 6465 7273 206f 6620 756e 6974 0d0a  orders of unit..
+00034df0: 2020 2020 2020 2020 666f 7220 7320 696e          for s in
+00034e00: 2073 656c 662e 6c69 7374 5f75 6e69 7473   self.list_units
+00034e10: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00034e20: 6620 6920 3d3d 2030 3a0d 0a20 2020 2020  f i == 0:..     
+00034e30: 2020 2020 2020 2020 2020 2073 5f62 6566             s_bef
+00034e40: 3d73 0d0a 2020 2020 2020 2020 2020 2020  =s..            
+00034e50: 2020 2020 6966 2073 5f62 6566 2e6f 7264      if s_bef.ord
+00034e60: 6572 2021 3d20 313a 0d0a 2020 2020 2020  er != 1:..      
+00034e70: 2020 2020 2020 2020 2020 2020 2020 666c                fl
+00034e80: 6167 3d31 0d0a 2020 2020 2020 2020 2020  ag=1..          
+00034e90: 2020 2020 2020 2020 2020 6966 2076 623a            if vb:
+00034ea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00034eb0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00034ec0: 2266 6972 7374 2075 6e69 7420 6f72 6465  "first unit orde
+00034ed0: 7220 6973 206e 6f74 2065 7175 616c 2074  r is not equal t
+00034ee0: 6f20 3122 290d 0a0d 0a20 2020 2020 2020  o 1")....       
+00034ef0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00034f00: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00034f10: 2e6f 7264 6572 203d 3d20 735f 6265 662e  .order == s_bef.
+00034f20: 6f72 6465 723a 0d0a 2020 2020 2020 2020  order:..        
+00034f30: 2020 2020 2020 2020 2020 2020 666c 6167              flag
+00034f40: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
+00034f50: 2020 2020 2020 2020 6966 2076 623a 0d0a          if vb:..
+00034f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f70: 2020 2020 2020 2020 7072 696e 7428 2275          print("u
+00034f80: 6e69 7473 207b 7d20 616e 6420 7b7d 2068  nits {} and {} h
+00034f90: 6176 6520 7468 6520 7361 6d65 206f 7264  ave the same ord
+00034fa0: 6572 222e 666f 726d 6174 2873 2e6e 616d  er".format(s.nam
+00034fb0: 652c 2073 5f62 6566 2e6e 616d 6529 290d  e, s_bef.name)).
+00034fc0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00034fd0: 2020 2065 6c69 6620 732e 6f72 6465 7220     elif s.order 
+00034fe0: 213d 2073 5f62 6566 2e6f 7264 6572 202b  != s_bef.order +
+00034ff0: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+00035000: 2020 2020 2020 2020 2066 6c61 673d 310d           flag=1.
+00035010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035020: 2020 2020 2069 6620 7662 3a0d 0a20 2020       if vb:..   
+00035030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035040: 2020 2020 2070 7269 6e74 2822 4469 7363       print("Disc
+00035050: 7265 7065 6e63 7920 696e 2074 6865 206f  repency in the o
+00035060: 7264 6572 7320 666f 7220 756e 6974 7320  rders for units 
+00035070: 7b7d 2061 6e64 207b 7d22 2e66 6f72 6d61  {} and {}".forma
+00035080: 7428 732e 6e61 6d65 2c20 735f 6265 662e  t(s.name, s_bef.
+00035090: 6e61 6d65 2929 0d0a 0d0a 2020 2020 2020  name))....      
+000350a0: 2020 2020 2020 2020 2020 735f 6265 663d            s_bef=
+000350b0: 730d 0a20 2020 2020 2020 2020 2020 2069  s..            i
+000350c0: 202b 3d20 310d 0a0d 0a20 2020 2020 2020   += 1....       
+000350d0: 2069 6620 666c 6167 3a0d 0a20 2020 2020   if flag:..     
+000350e0: 2020 2020 2020 2069 6620 7662 3a0d 0a20         if vb:.. 
+000350f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00035100: 7269 6e74 2822 4368 616e 6769 6e67 206f  rint("Changing o
+00035110: 7264 6572 7320 666f 7220 7468 6174 2074  rders for that t
+00035120: 6865 7920 7261 6e67 6520 6672 6f6d 2031  hey range from 1
+00035130: 2074 6f20 6e22 290d 0a20 2020 2020 2020   to n")..       
+00035140: 2020 2020 2023 2063 6865 636b 206f 7264       # check ord
+00035150: 6572 2072 616e 6769 6e67 2066 726f 6d20  er ranging from 
+00035160: 3120 746f 206e 0d0a 2020 2020 2020 2020  1 to n..        
+00035170: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00035180: 6765 286c 656e 2873 656c 662e 6c69 7374  ge(len(self.list
+00035190: 5f75 6e69 7473 2929 3a0d 0a20 2020 2020  _units)):..     
+000351a0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000351b0: 6c66 2e6c 6973 745f 756e 6974 735b 695d  lf.list_units[i]
+000351c0: 2e6f 7264 6572 2021 3d20 692b 313a 0d0a  .order != i+1:..
+000351d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000351e0: 2020 2020 7365 6c66 2e6c 6973 745f 756e      self.list_un
+000351f0: 6974 735b 695d 2e6f 7264 6572 3d69 2b31  its[i].order=i+1
+00035200: 0d0a 0d0a 2020 2020 6465 6620 636f 6d70  ....    def comp
+00035210: 7574 655f 7375 7266 2873 656c 662c 2041  ute_surf(self, A
+00035220: 7263 6854 6162 6c65 2c20 6e72 6561 6c3d  rchTable, nreal=
+00035230: 312c 2066 6c5f 746f 703d 4661 6c73 652c  1, fl_top=False,
+00035240: 2073 7562 7069 6c65 3d46 616c 7365 2c20   subpile=False, 
+00035250: 746f 7073 3d4e 6f6e 652c 2062 6f74 733d  tops=None, bots=
+00035260: 4e6f 6e65 2c20 7662 3d31 293a 0d0a 0d0a  None, vb=1):....
+00035270: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00035280: 2020 2020 2043 6f6d 7075 7465 2074 6865       Compute the
+00035290: 2065 6c65 7661 7469 6f6e 206f 6620 7468   elevation of th
+000352a0: 6520 7375 7266 6163 6573 2075 6e69 7473  e surfaces units
+000352b0: 2028 3173 7420 6869 6572 6172 6368 6963   (1st hierarchic
+000352c0: 206f 7264 6572 290d 0a20 2020 2020 2020   order)..       
+000352d0: 2063 6f6e 7461 696e 6564 2069 6e20 7468   contained in th
+000352e0: 6520 5069 6c65 206f 626a 6563 742e 0d0a  e Pile object...
+000352f0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00035300: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00035310: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00035320: 2020 4172 6368 5461 626c 653a 203a 636c    ArchTable: :cl
+00035330: 6173 733a 6041 7263 685f 7461 626c 6560  ass:`Arch_table`
+00035340: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+00035350: 2020 2020 2041 7263 6854 6162 6c65 206f       ArchTable o
+00035360: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
+00035370: 2074 6865 2061 7263 6869 7465 6374 7572   the architectur
+00035380: 6520 6f66 2074 6865 2070 696c 650d 0a20  e of the pile.. 
+00035390: 2020 2020 2020 206e 7265 616c 3a20 696e         nreal: in
+000353a0: 740d 0a20 2020 2020 2020 2020 2020 206e  t..            n
+000353b0: 756d 6265 7220 6f66 2072 6561 6c69 7a61  umber of realiza
+000353c0: 7469 6f6e 0d0a 2020 2020 2020 2020 666c  tion..        fl
+000353d0: 5f74 6f70 3a20 626f 6f6c 0d0a 2020 2020  _top: bool..    
+000353e0: 2020 2020 2020 2020 746f 206e 6f74 2069          to not i
+000353f0: 6e74 6572 706f 6c61 7465 2066 6972 7374  nterpolate first
+00035400: 206c 6179 6572 2061 6e64 2061 7373 6967   layer and assig
+00035410: 6e20 6974 3d74 6f70 0d0a 2020 2020 2020  n it=top..      
+00035420: 2020 7375 6270 696c 653a 2062 6f6f 6c0d    subpile: bool.
+00035430: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00035440: 7468 6520 7069 6c65 2069 7320 6120 7375  the pile is a su
+00035450: 6270 696c 650d 0a20 2020 2020 2020 2074  bpile..        t
+00035460: 6f70 732c 2062 6f74 733a 2073 6571 7565  ops, bots: seque
+00035470: 6e63 6520 6f66 2032 4420 6172 7261 7973  nce of 2D arrays
+00035480: 206f 6620 7369 7a65 2028 6e79 2c20 6e78   of size (ny, nx
+00035490: 290d 0a20 2020 2020 2020 2020 2020 206f  )..            o
+000354a0: 6620 746f 702f 626f 7420 666f 7220 7375  f top/bot for su
+000354b0: 6270 696c 6520 7375 7266 6163 650d 0a20  bpile surface.. 
+000354c0: 2020 2020 2020 2076 623a 2069 6e74 0d0a         vb: int..
+000354d0: 2020 2020 2020 2020 2020 2020 6c65 7665              leve
+000354e0: 6c20 6f66 2076 6572 626f 7369 7479 2c20  l of verbosity, 
+000354f0: 3020 666f 7220 6e6f 2070 7269 6e74 2c20  0 for no print, 
+00035500: 3120 666f 7220 7072 696e 740d 0a0d 0a20  1 for print.... 
+00035510: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00035520: 2020 2020 2020 6465 6620 6164 645f 7374        def add_st
+00035530: 6f5f 636f 6e74 6163 7428 732c 2078 2c20  o_contact(s, x, 
+00035540: 792c 207a 2c20 7479 7065 3d22 6571 7561  y, z, type="equa
+00035550: 6c69 7479 222c 207a 323d 4e6f 6e65 293a  lity", z2=None):
+00035560: 2023 6675 6e63 7469 6f6e 2074 6f20 6164   #function to ad
+00035570: 6420 6120 7374 6f63 6861 7374 6963 2068  d a stochastic h
+00035580: 6420 706f 696e 7420 746f 2061 2073 7572  d point to a sur
+00035590: 6661 6365 0d0a 2020 2020 2020 2020 2020  face..          
+000355a0: 2020 2320 7761 726e 696e 6720 6e6f 2063    # warning no c
+000355b0: 6865 636b 2074 6861 7420 706f 696e 7420  heck that point 
+000355c0: 6973 2069 6e73 6964 6520 646f 6d61 696e  is inside domain
+000355d0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000355e0: 2074 7970 6520 3d3d 2022 6571 7561 6c69   type == "equali
+000355f0: 7479 223a 0d0a 2020 2020 2020 2020 2020  ty":..          
+00035600: 2020 2020 2020 732e 7375 7266 6163 652e        s.surface.
+00035610: 7374 6f5f 782e 6170 7065 6e64 2878 290d  sto_x.append(x).
+00035620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035630: 2073 2e73 7572 6661 6365 2e73 746f 5f79   s.surface.sto_y
+00035640: 2e61 7070 656e 6428 7929 0d0a 2020 2020  .append(y)..    
+00035650: 2020 2020 2020 2020 2020 2020 732e 7375              s.su
+00035660: 7266 6163 652e 7374 6f5f 7a2e 6170 7065  rface.sto_z.appe
+00035670: 6e64 287a 290d 0a20 2020 2020 2020 2020  nd(z)..         
+00035680: 2020 2065 6c69 6620 7479 7065 203d 3d20     elif type == 
+00035690: 2269 6e65 715f 696e 6622 3a0d 0a20 2020  "ineq_inf":..   
+000356a0: 2020 2020 2020 2020 2020 2020 2073 2e73               s.s
+000356b0: 7572 6661 6365 2e73 746f 5f69 6e65 712e  urface.sto_ineq.
+000356c0: 6170 7065 6e64 285b 782c 2079 2c20 302c  append([x, y, 0,
+000356d0: 207a 2c20 6e70 2e6e 616e 5d29 0d0a 2020   z, np.nan])..  
+000356e0: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
+000356f0: 7970 6520 3d3d 2022 696e 6571 5f73 7570  ype == "ineq_sup
+00035700: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00035710: 2020 2020 732e 7375 7266 6163 652e 7374      s.surface.st
+00035720: 6f5f 696e 6571 2e61 7070 656e 6428 5b78  o_ineq.append([x
+00035730: 2c20 792c 2030 2c20 6e70 2e6e 616e 2c20  , y, 0, np.nan, 
+00035740: 7a5d 290d 0a20 2020 2020 2020 2020 2020  z])..           
+00035750: 2065 6c69 6620 7479 7065 203d 3d20 2264   elif type == "d
+00035760: 6f75 626c 655f 696e 6571 223a 0d0a 2020  ouble_ineq":..  
+00035770: 2020 2020 2020 2020 2020 2020 2020 732e                s.
+00035780: 7375 7266 6163 652e 7374 6f5f 696e 6571  surface.sto_ineq
+00035790: 2e61 7070 656e 6428 5b78 2c20 792c 2030  .append([x, y, 0
+000357a0: 2c20 7a2c 207a 325d 2920 2023 2069 6e66  , z, z2])  # inf
+000357b0: 6572 696f 7220 616e 6420 7570 7065 7220  erior and upper 
+000357c0: 696e 6571 0d0a 0d0a 0d0a 2020 2020 2020  ineq......      
+000357d0: 2020 6966 2041 7263 6854 6162 6c65 2e63    if ArchTable.c
+000357e0: 6865 636b 5f70 696c 6573 5f6e 616d 6528  heck_piles_name(
+000357f0: 2920 3d3d 2030 3a20 2320 6368 6563 6b20  ) == 0: # check 
+00035800: 636f 6e73 6973 7465 6e63 7920 696e 2075  consistency in u
+00035810: 6e69 740d 0a20 2020 2020 2020 2020 2020  nit..           
+00035820: 2072 6574 7572 6e20 4e6f 6e65 0d0a 0d0a   return None....
+00035830: 2020 2020 2020 2020 4172 6368 5461 626c          ArchTabl
+00035840: 652e 6e72 6561 6c5f 756e 6974 733d 6e72  e.nreal_units=nr
+00035850: 6561 6c20 2023 2073 746f 7265 206e 756d  eal  # store num
+00035860: 6265 7220 6f66 2072 6561 6c69 7a61 7469  ber of realizati
+00035870: 6f6e 730d 0a0d 0a20 2020 2020 2020 2023  ons....        #
+00035880: 7369 6d75 6c61 7469 6f6e 2067 7269 640d  simulation grid.
+00035890: 0a20 2020 2020 2020 2078 673d 4172 6368  .        xg=Arch
+000358a0: 5461 626c 652e 6765 745f 7867 6328 290d  Table.get_xgc().
+000358b0: 0a20 2020 2020 2020 206e 783d 7867 2e73  .        nx=xg.s
+000358c0: 6861 7065 5b30 5d0d 0a20 2020 2020 2020  hape[0]..       
+000358d0: 2079 673d 4172 6368 5461 626c 652e 6765   yg=ArchTable.ge
+000358e0: 745f 7967 6328 290d 0a20 2020 2020 2020  t_ygc()..       
+000358f0: 206e 793d 7967 2e73 6861 7065 5b30 5d0d   ny=yg.shape[0].
+00035900: 0a20 2020 2020 2020 207a 673d 4172 6368  .        zg=Arch
+00035910: 5461 626c 652e 6765 745f 7a67 2829 0d0a  Table.get_zg()..
+00035920: 2020 2020 2020 2020 6e7a 3d7a 672e 7368          nz=zg.sh
+00035930: 6170 655b 305d 202d 2031 0d0a 2020 2020  ape[0] - 1..    
+00035940: 2020 2020 6966 207e 7375 6270 696c 653a      if ~subpile:
+00035950: 0d0a 2020 2020 2020 2020 2020 2020 746f  ..            to
+00035960: 703d 4172 6368 5461 626c 652e 746f 700d  p=ArchTable.top.
+00035970: 0a20 2020 2020 2020 2020 2020 2062 6f74  .            bot
+00035980: 3d41 7263 6854 6162 6c65 2e62 6f74 0d0a  =ArchTable.bot..
+00035990: 2020 2020 2020 2020 6d61 736b 3d41 7263          mask=Arc
+000359a0: 6854 6162 6c65 2e6d 6173 6b20 2023 2073  hTable.mask  # s
+000359b0: 696d 756c 6174 696f 6e20 6d61 736b 0d0a  imulation mask..
+000359c0: 2020 2020 2020 2020 6d61 736b 3244 203d          mask2D =
+000359d0: 2041 7263 6854 6162 6c65 2e6d 6173 6b32   ArchTable.mask2
+000359e0: 6420 2023 206d 6173 6b20 3244 0d0a 2020  d  # mask 2D..  
+000359f0: 2020 2020 2020 6e6c 6179 3d6c 656e 2873        nlay=len(s
+00035a00: 656c 662e 6c69 7374 5f75 6e69 7473 290d  elf.list_units).
+00035a10: 0a0d 0a20 2020 2020 2020 2069 6620 7662  ...        if vb
+00035a20: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00035a30: 7269 6e74 2822 2323 2323 2323 2323 2323  rint("##########
+00035a40: 2050 494c 4520 7b7d 2023 2323 2323 2323   PILE {} #######
+00035a50: 2323 2322 2e66 6f72 6d61 7428 7365 6c66  ###".format(self
+00035a60: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
+00035a70: 2023 6d61 6b65 2073 7572 6520 746f 2068   #make sure to h
+00035a80: 6176 6520 6f72 6465 7265 6420 6c69 7468  ave ordered lith
+00035a90: 6f6c 6f67 6965 730d 0a20 2020 2020 2020  ologies..       
+00035aa0: 2073 656c 662e 6f72 6465 725f 756e 6974   self.order_unit
+00035ab0: 7328 7662 3d76 6229 0d0a 0d0a 2020 2020  s(vb=vb)....    
+00035ac0: 2020 2020 2323 2320 696e 6974 6961 6c69      ### initiali
+00035ad0: 7a65 2073 7572 6661 6365 7320 6279 2073  ze surfaces by s
+00035ae0: 6574 7469 6e67 2074 6f20 300d 0a0d 0a20  etting to 0.... 
+00035af0: 2020 2020 2020 2073 7572 6673 3d6e 702e         surfs=np.
+00035b00: 7a65 726f 7328 5b6e 7265 616c 2c20 6e6c  zeros([nreal, nl
+00035b10: 6179 2c20 6e79 2c20 6e78 5d2c 2064 7479  ay, ny, nx], dty
+00035b20: 7065 3d6e 702e 666c 6f61 7433 3229 0d0a  pe=np.float32)..
+00035b30: 2020 2020 2020 2020 7375 7266 735f 626f          surfs_bo
+00035b40: 743d 6e70 2e7a 6572 6f73 285b 6e72 6561  t=np.zeros([nrea
+00035b50: 6c2c 206e 6c61 792c 206e 792c 206e 785d  l, nlay, ny, nx]
+00035b60: 2c20 6474 7970 653d 6e70 2e66 6c6f 6174  , dtype=np.float
+00035b70: 3332 290d 0a20 2020 2020 2020 206f 7267  32)..        org
+00035b80: 5f73 7572 6673 3d6e 702e 7a65 726f 7328  _surfs=np.zeros(
+00035b90: 5b6e 7265 616c 2c20 6e6c 6179 2c20 6e79  [nreal, nlay, ny
+00035ba0: 2c20 6e78 5d2c 2064 7479 7065 3d6e 702e  , nx], dtype=np.
+00035bb0: 666c 6f61 7433 3229 0d0a 2020 2020 2020  float32)..      
+00035bc0: 2020 7265 616c 5f64 6f6d 6169 6e73 3d6e    real_domains=n
+00035bd0: 702e 7a65 726f 7328 5b6e 7265 616c 2c20  p.zeros([nreal, 
+00035be0: 6e6c 6179 2c20 6e7a 2c20 6e79 2c20 6e78  nlay, nz, ny, nx
+00035bf0: 5d2c 2064 7479 7065 3d6e 702e 696e 7438  ], dtype=np.int8
+00035c00: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
+00035c10: 2069 7265 616c 2069 6e20 7261 6e67 6528   ireal in range(
+00035c20: 6e72 6561 6c29 3a20 2320 6c6f 6f70 206f  nreal): # loop o
+00035c30: 7665 7220 7265 616c 0d0a 0d0a 2020 2020  ver real....    
+00035c40: 2020 2020 2020 2020 2320 6572 6173 6520          # erase 
+00035c50: 7374 6f63 6861 7374 6963 2064 6174 610d  stochastic data.
+00035c60: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00035c70: 2073 2069 6e20 7365 6c66 2e6c 6973 745f   s in self.list_
+00035c80: 756e 6974 733a 0d0a 2020 2020 2020 2020  units:..        
+00035c90: 2020 2020 2020 2020 732e 7375 7266 6163          s.surfac
+00035ca0: 652e 7374 6f5f 7820 3d20 5b5d 0d0a 2020  e.sto_x = []..  
+00035cb0: 2020 2020 2020 2020 2020 2020 2020 732e                s.
+00035cc0: 7375 7266 6163 652e 7374 6f5f 7920 3d20  surface.sto_y = 
+00035cd0: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+00035ce0: 2020 2020 732e 7375 7266 6163 652e 7374      s.surface.st
+00035cf0: 6f5f 7a20 3d20 5b5d 0d0a 2020 2020 2020  o_z = []..      
+00035d00: 2020 2020 2020 2020 2020 732e 7375 7266            s.surf
+00035d10: 6163 652e 7374 6f5f 696e 6571 203d 205b  ace.sto_ineq = [
+00035d20: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+00035d30: 2023 2063 6f6d 7075 7465 2073 746f 2064   # compute sto d
+00035d40: 6174 610d 0a20 2020 2020 2020 2020 2020  ata..           
+00035d50: 2066 6f72 2067 2069 6e20 4172 6368 5461   for g in ArchTa
+00035d60: 626c 652e 7374 6f5f 6864 3a0d 0a20 2020  ble.sto_hd:..   
+00035d70: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+00035d80: 7264 203d 2067 5b30 5d0d 0a20 2020 2020  rd = g[0]..     
+00035d90: 2020 2020 2020 2020 2020 2078 2c79 2c7a             x,y,z
+00035da0: 203d 2063 6f6f 7264 0d0a 2020 2020 2020   = coord..      
+00035db0: 2020 2020 2020 2020 2020 6864 203d 2067            hd = g
+00035dc0: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
+00035dd0: 2020 2020 2070 203d 2067 5b32 5d0d 0a20       p = g[2].. 
+00035de0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00035df0: 203d 206e 702e 7261 6e64 6f6d 2e63 686f   = np.random.cho
+00035e00: 6963 6528 7261 6e67 6528 6c65 6e28 7029  ice(range(len(p)
+00035e10: 292c 2070 3d70 290d 0a20 2020 2020 2020  ), p=p)..       
+00035e20: 2020 2020 2020 2020 2066 6f72 2073 2c20           for s, 
+00035e30: 7479 7020 696e 206e 702e 6172 7261 7928  typ in np.array(
+00035e40: 6864 5b69 5d29 3a0d 0a20 2020 2020 2020  hd[i]):..       
+00035e50: 2020 2020 2020 2020 2020 2020 2061 6464               add
+00035e60: 5f73 746f 5f63 6f6e 7461 6374 2873 2c20  _sto_contact(s, 
+00035e70: 782c 2079 2c20 7a2c 2074 7970 290d 0a0d  x, y, z, typ)...
+00035e80: 0a20 2020 2020 2020 2020 2020 2023 746f  .            #to
+00035e90: 702f 626f 740d 0a20 2020 2020 2020 2020  p/bot..         
+00035ea0: 2020 2069 6620 7375 6270 696c 653a 0d0a     if subpile:..
+00035eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ec0: 746f 703d 746f 7073 5b69 7265 616c 5d0d  top=tops[ireal].
+00035ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035ee0: 2062 6f74 3d62 6f74 735b 6972 6561 6c5d   bot=bots[ireal]
+00035ef0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00035f00: 2320 636f 756e 7465 7220 666f 7220 6375  # counter for cu
+00035f10: 7272 656e 7420 7369 6d75 6c61 7465 6420  rrent simulated 
+00035f20: 7375 7266 6163 650d 0a20 2020 2020 2020  surface..       
+00035f30: 2020 2020 2069 3d2d 310d 0a0d 0a20 2020       i=-1....   
+00035f40: 2020 2020 2020 2020 2066 6f72 206c 6974           for lit
+00035f50: 686f 2069 6e20 7365 6c66 2e6c 6973 745f  ho in self.list_
+00035f60: 756e 6974 735b 3a3a 202d 315d 3a0d 0a20  units[:: -1]:.. 
+00035f70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00035f80: 6620 7662 3a0d 0a20 2020 2020 2020 2020  f vb:..         
+00035f90: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00035fa0: 2822 5c6e 2323 2323 2043 4f4d 5055 5449  ("\n#### COMPUTI
+00035fb0: 4e47 2053 5552 4641 4345 204f 4620 554e  NG SURFACE OF UN
+00035fc0: 4954 207b 7d22 2e66 6f72 6d61 7428 6c69  IT {}".format(li
+00035fd0: 7468 6f2e 6e61 6d65 2929 0d0a 2020 2020  tho.name))..    
+00035fe0: 2020 2020 2020 2020 2020 2020 6920 2b3d              i +=
+00035ff0: 2031 2020 2320 696e 6465 7820 666f 7220   1  # index for 
+00036000: 7369 6d75 6c61 7465 6420 7375 7266 6163  simulated surfac
+00036010: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00036020: 2020 2073 7461 7274 3d74 696d 652e 7469     start=time.ti
+00036030: 6d65 2829 0d0a 2020 2020 2020 2020 2020  me()..          
+00036040: 2020 2020 2020 6966 2028 666c 5f74 6f70        if (fl_top
+00036050: 2920 616e 6420 2869 203d 3d20 6e6c 6179  ) and (i == nlay
+00036060: 2d31 293a 2023 2066 6972 7374 206c 6179  -1): # first lay
+00036070: 6572 2061 7373 6967 6e20 746f 2074 6f70  er assign to top
+00036080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00036090: 2020 2020 2020 7331 3d74 6f70 0d0a 2020        s1=top..  
+000360a0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000360b0: 6966 2028 6c69 7468 6f2e 7375 7266 6163  if (litho.surfac
+000360c0: 652e 696e 745f 6d65 7468 6f64 2069 6e20  e.int_method in 
+000360d0: 5b22 6b72 6967 696e 6722 2c20 226c 696e  ["kriging", "lin
+000360e0: 6561 7222 2c20 2263 7562 6963 222c 2022  ear", "cubic", "
+000360f0: 6e65 6172 6573 7422 5d29 2061 6e64 2028  nearest"]) and (
+00036100: 6972 6561 6c20 3e20 3029 3a20 2320 6465  ireal > 0): # de
+00036110: 7465 726d 696e 6973 7420 6d65 7468 6f64  terminist method
+00036120: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00036130: 2020 2020 2020 7331 3d6f 7267 5f73 7572        s1=org_sur
+00036140: 6673 5b30 2c20 286e 6c61 792d 3129 2d69  fs[0, (nlay-1)-i
+00036150: 5d2e 636f 7079 2829 0d0a 2020 2020 2020  ].copy()..      
+00036160: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00036170: 2076 623a 0d0a 2020 2020 2020 2020 2020   vb:..          
+00036180: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00036190: 696e 7428 227b 7d3a 2064 6574 6572 6d69  int("{}: determi
+000361a0: 6e69 7374 2069 6e74 6572 706f 6c61 7469  nist interpolati
+000361b0: 6f6e 206d 6574 686f 642c 2072 6575 7365  on method, reuse
+000361c0: 2074 6865 2066 6972 7374 2073 7572 6661   the first surfa
+000361d0: 6365 222e 666f 726d 6174 286c 6974 686f  ce".format(litho
+000361e0: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
+000361f0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00036200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00036210: 2020 2020 2020 2320 6368 616e 6765 206d        # change m
+00036220: 6561 6e20 6966 2074 6869 636b 6e65 7373  ean if thickness
+00036230: 206d 6f64 6520 6973 2061 6374 6976 6174   mode is activat
+00036240: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
+00036250: 2020 2020 2020 2020 6966 2022 7468 6963          if "thic
+00036260: 6b6e 6573 7322 2069 6e20 6c69 7468 6f2e  kness" in litho.
+00036270: 7375 7266 6163 652e 6469 635f 7375 7266  surface.dic_surf
+00036280: 2e6b 6579 7328 293a 0d0a 2020 2020 2020  .keys():..      
+00036290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000362a0: 2020 6966 206c 6974 686f 2e73 7572 6661    if litho.surfa
+000362b0: 6365 2e64 6963 5f73 7572 665b 2274 6869  ce.dic_surf["thi
+000362c0: 636b 6e65 7373 225d 2069 7320 6e6f 7420  ckness"] is not 
+000362d0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+000362e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000362f0: 2020 2069 6620 6920 3d3d 2030 3a0d 0a20     if i == 0:.. 
+00036300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036310: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00036320: 6974 686f 2e73 7572 6661 6365 2e64 6963  itho.surface.dic
+00036330: 5f73 7572 665b 226d 6561 6e22 5d20 3d20  _surf["mean"] = 
+00036340: 4172 6368 5461 626c 652e 626f 7420 2b20  ArchTable.bot + 
+00036350: 6c69 7468 6f2e 7375 7266 6163 652e 6469  litho.surface.di
+00036360: 635f 7375 7266 5b22 7468 6963 6b6e 6573  c_surf["thicknes
+00036370: 7322 5d0d 0a20 2020 2020 2020 2020 2020  s"]..           
+00036380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036390: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
 000363a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363b0: 2020 2020 2069 6620 6f20 3d3d 2069 2d31       if o == i-1
-000363c0: 2061 6e64 206c 6974 686f 2e63 6f6e 7461   and litho.conta
-000363d0: 6374 203d 3d20 2265 726f 6465 223a 2023  ct == "erode": #
-000363e0: 2069 6620 696e 6465 7820 226f 2220 6973   if index "o" is
-000363f0: 2075 6e64 6572 6c79 696e 6720 6c61 7965   underlying laye
-00036400: 720d 0a20 2020 2020 2020 2020 2020 2020  r..             
-00036410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036420: 2020 2020 2020 2073 315b 7331 203e 2073         s1[s1 > s
-00036430: 325d 3d73 325b 7331 203e 2073 325d 2023  2]=s2[s1 > s2] #
-00036440: 2070 7265 7665 6e74 2065 726f 7369 6f6e   prevent erosion
-00036450: 206c 6179 6572 7320 6861 7669 6e67 2076   layers having v
-00036460: 6f6c 756d 650d 0a0d 0a20 2020 2020 2020  olume....       
-00036470: 2020 2020 2020 2020 2073 7572 6673 5b69           surfs[i
-00036480: 7265 616c 2c20 286e 6c61 792d 3129 2d69  real, (nlay-1)-i
-00036490: 5d3d 7331 2020 2361 6464 2073 7572 6661  ]=s1  #add surfa
-000364a0: 6365 0d0a 0d0a 2020 2020 2020 2020 2020  ce....          
-000364b0: 2020 2363 6f6d 7075 7465 2064 6f6d 6169    #compute domai
-000364c0: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
-000364d0: 7374 6172 743d 7469 6d65 2e74 696d 6528  start=time.time(
-000364e0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-000364f0: 7572 6673 5f69 723d 7375 7266 735b 6972  urfs_ir=surfs[ir
-00036500: 6561 6c5d 0d0a 0d0a 2020 2020 2020 2020  eal]....        
-00036510: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00036520: 6765 2873 7572 6673 5f69 722e 7368 6170  ge(surfs_ir.shap
-00036530: 655b 305d 293a 0d0a 2020 2020 2020 2020  e[0]):..        
-00036540: 2020 2020 2020 2020 6966 2069 203c 2073          if i < s
-00036550: 7572 6673 5f69 722e 7368 6170 655b 305d  urfs_ir.shape[0]
-00036560: 2d31 3a0d 0a20 2020 2020 2020 2020 2020  -1:..           
-00036570: 2020 2020 2020 2020 2073 5f62 6f74 3d73           s_bot=s
-00036580: 7572 6673 5f69 725b 692b 315d 2023 2062  urfs_ir[i+1] # b
-00036590: 6f74 746f 6d0d 0a20 2020 2020 2020 2020  ottom..         
-000365a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000363b0: 2020 2020 2020 2020 6c69 7468 6f2e 7375          litho.su
+000363c0: 7266 6163 652e 6469 635f 7375 7266 5b22  rface.dic_surf["
+000363d0: 6d65 616e 225d 203d 2073 3120 2b20 6c69  mean"] = s1 + li
+000363e0: 7468 6f2e 7375 7266 6163 652e 6469 635f  tho.surface.dic_
+000363f0: 7375 7266 5b22 7468 6963 6b6e 6573 7322  surf["thickness"
+00036400: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+00036410: 2020 2020 2020 2020 2073 313d 696e 7465           s1=inte
+00036420: 7270 3244 286c 6974 686f 2e73 7572 6661  rp2D(litho.surfa
+00036430: 6365 2c20 4172 6368 5461 626c 652e 6765  ce, ArchTable.ge
+00036440: 745f 7867 2829 2c20 4172 6368 5461 626c  t_xg(), ArchTabl
+00036450: 652e 6765 745f 7967 2829 2c20 4172 6368  e.get_yg(), Arch
+00036460: 5461 626c 652e 7875 3244 2c0d 0a20 2020  Table.xu2D,..   
+00036470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036480: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00036490: 6564 3d41 7263 6854 6162 6c65 2e73 6565  ed=ArchTable.see
+000364a0: 6420 2b20 6c69 7468 6f2e 4944 202a 2031  d + litho.ID * 1
+000364b0: 6533 202b 2069 7265 616c 2c20 7665 7262  e3 + ireal, verb
+000364c0: 6f73 653d 4172 6368 5461 626c 652e 7665  ose=ArchTable.ve
+000364d0: 7262 6f73 652c 206e 6370 753d 4172 6368  rbose, ncpu=Arch
+000364e0: 5461 626c 652e 6e63 7075 2c20 6d61 736b  Table.ncpu, mask
+000364f0: 3244 3d6d 6173 6b32 442c 0d0a 2020 2020  2D=mask2D,..    
+00036500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036510: 2020 2020 2020 2020 2020 2020 202a 2a6c               **l
+00036520: 6974 686f 2e73 7572 6661 6365 2e64 6963  itho.surface.dic
+00036530: 5f73 7572 6629 2023 2073 696d 756c 6174  _surf) # simulat
+00036540: 696f 6e0d 0a0d 0a20 2020 2020 2020 2020  ion....         
+00036550: 2020 2020 2020 2020 2020 2023 2072 656d             # rem
+00036560: 6f76 6520 6d65 616e 0d0a 2020 2020 2020  ove mean..      
+00036570: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00036580: 2022 7468 6963 6b6e 6573 7322 2069 6e20   "thickness" in 
+00036590: 6c69 7468 6f2e 7375 7266 6163 652e 6469  litho.surface.di
+000365a0: 635f 7375 7266 2e6b 6579 7328 293a 0d0a  c_surf.keys():..
 000365b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000365c0: 2020 735f 626f 743d 626f 740d 0a20 2020    s_bot=bot..   
-000365d0: 2020 2020 2020 2020 2020 2020 2073 5f74               s_t
-000365e0: 6f70 3d73 7572 6673 5f69 725b 695d 2023  op=surfs_ir[i] #
-000365f0: 2074 6f70 0d0a 2020 2020 2020 2020 2020   top..          
-00036600: 2020 2020 2020 613d 4172 6368 5461 626c        a=ArchTabl
-00036610: 652e 636f 6d70 7574 655f 646f 6d61 696e  e.compute_domain
-00036620: 2873 5f74 6f70 2c20 735f 626f 7429 0d0a  (s_top, s_bot)..
-00036630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036640: 7265 616c 5f64 6f6d 6169 6e73 5b69 7265  real_domains[ire
-00036650: 616c 2c20 695d 3d61 2a6d 6173 6b2a 7365  al, i]=a*mask*se
-00036660: 6c66 2e6c 6973 745f 756e 6974 735b 695d  lf.list_units[i]
-00036670: 2e49 440d 0a20 2020 2020 2020 2020 2020  .ID..           
-00036680: 2020 2020 2073 7572 6673 5f62 6f74 5b69       surfs_bot[i
-00036690: 7265 616c 2c20 695d 3d73 5f62 6f74 0d0a  real, i]=s_bot..
-000366a0: 0d0a 2020 2020 2020 2020 2020 2020 656e  ..            en
-000366b0: 643d 7469 6d65 2e74 696d 6528 290d 0a20  d=time.time().. 
-000366c0: 2020 2020 2020 2020 2020 2069 6620 7662             if vb
-000366d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000366e0: 2020 2070 7269 6e74 2822 5c6e 5469 6d65     print("\nTime
-000366f0: 2065 6c61 7073 6564 2066 6f72 2067 6574   elapsed for get
-00036700: 7469 6e67 2064 6f6d 6169 6e73 207b 7d20  ting domains {} 
-00036710: 7322 2e66 6f72 6d61 7428 2865 6e64 202d  s".format((end -
-00036720: 2073 7461 7274 2929 290d 0a0d 0a20 2020   start)))....   
-00036730: 2020 2020 2023 6f6e 6c79 2031 2062 6967       #only 1 big
-00036740: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
-00036750: 613d 6e70 2e73 756d 2872 6561 6c5f 646f  a=np.sum(real_do
-00036760: 6d61 696e 732c 2061 7869 733d 3129 0d0a  mains, axis=1)..
-00036770: 2020 2020 2020 2020 4172 6368 5461 626c          ArchTabl
-00036780: 652e 4765 6f6c 2e75 6e69 7473 5f64 6f6d  e.Geol.units_dom
-00036790: 6169 6e73 5b61 2021 3d20 305d 3d61 5b61  ains[a != 0]=a[a
-000367a0: 2021 3d20 305d 0d0a 2020 2020 2020 2020   != 0]..        
-000367b0: 4172 6368 5461 626c 652e 4765 6f6c 2e73  ArchTable.Geol.s
-000367c0: 7572 6661 6365 735f 6279 5f70 696c 6573  urfaces_by_piles
-000367d0: 5b73 656c 662e 6e61 6d65 5d3d 7375 7266  [self.name]=surf
-000367e0: 730d 0a20 2020 2020 2020 2041 7263 6854  s..        ArchT
-000367f0: 6162 6c65 2e47 656f 6c2e 7375 7266 6163  able.Geol.surfac
-00036800: 6573 5f62 6f74 5f62 795f 7069 6c65 735b  es_bot_by_piles[
-00036810: 7365 6c66 2e6e 616d 655d 3d73 7572 6673  self.name]=surfs
-00036820: 5f62 6f74 0d0a 2020 2020 2020 2020 4172  _bot..        Ar
-00036830: 6368 5461 626c 652e 4765 6f6c 2e6f 7267  chTable.Geol.org
-00036840: 5f73 7572 6661 6365 735f 6279 5f70 696c  _surfaces_by_pil
-00036850: 6573 5b73 656c 662e 6e61 6d65 5d3d 6f72  es[self.name]=or
-00036860: 675f 7375 7266 730d 0a0d 0a20 2020 2020  g_surfs....     
-00036870: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
-00036880: 2020 2020 2020 2070 7269 6e74 2822 2323         print("##
-00036890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000368a0: 2323 2323 2323 2323 5c6e 2229 0d0a 0d0a  ########\n")....
-000368b0: 2020 2020 6465 6620 6465 6669 6e65 5f64      def define_d
-000368c0: 6f6d 6169 6e73 2873 656c 662c 2041 7263  omains(self, Arc
-000368d0: 6854 6162 6c65 2c20 7375 7266 6163 6573  hTable, surfaces
-000368e0: 2c20 746f 7073 3d4e 6f6e 652c 2062 6f74  , tops=None, bot
-000368f0: 733d 4e6f 6e65 2c20 7375 6270 696c 653d  s=None, subpile=
-00036900: 4661 6c73 652c 2076 623d 302c 2066 6c5f  False, vb=0, fl_
-00036910: 746f 703d 5472 7565 293a 0d0a 0d0a 2020  top=True):....  
-00036920: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00036930: 2020 2044 6566 696e 6520 756e 6974 7320     Define units 
-00036940: 646f 6d61 696e 7320 6672 6f6d 2070 7265  domains from pre
-00036950: 636f 6d70 7574 6564 2073 7572 6661 6365  computed surface
-00036960: 732e 0d0a 2020 2020 2020 2020 5468 6973  s...        This
-00036970: 206d 6574 686f 6420 6973 2075 7365 6420   method is used 
-00036980: 7768 656e 2074 6865 2073 7572 6661 6365  when the surface
-00036990: 7320 6172 6520 7072 6563 6f6d 7075 7465  s are precompute
-000369a0: 6420 2865 2e67 2e20 6672 6f6d 2061 2070  d (e.g. from a p
-000369b0: 7265 7669 6f75 7320 7369 6d75 6c61 7469  revious simulati
-000369c0: 6f6e 2920 0d0a 2020 2020 2020 2020 696e  on) ..        in
-000369d0: 2070 6c61 6365 2074 6f20 7468 6520 636f   place to the co
-000369e0: 6d70 7574 655f 7375 7266 6163 6573 206d  mpute_surfaces m
-000369f0: 6574 686f 642e 0d0a 0d0a 2020 2020 2020  ethod.....      
-00036a00: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00036a10: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00036a20: 0d0a 2020 2020 2020 2020 4172 6368 5461  ..        ArchTa
-00036a30: 626c 6520 3a20 3a63 6c61 7373 3a60 4172  ble : :class:`Ar
-00036a40: 6368 5f74 6162 6c65 600d 0a20 2020 2020  ch_table`..     
-00036a50: 2020 2020 2020 2041 7263 6854 6162 6c65         ArchTable
-00036a60: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-00036a70: 2073 7572 6661 6365 7320 3a20 6172 7261   surfaces : arra
-00036a80: 790d 0a20 2020 2020 2020 2020 2020 2061  y..            a
-00036a90: 7272 6179 206f 6620 7375 7266 6163 6573  rray of surfaces
-00036aa0: 2028 6e72 6561 6c2c 206e 6c61 792c 206e   (nreal, nlay, n
-00036ab0: 792c 206e 7829 0d0a 2020 2020 2020 2020  y, nx)..        
-00036ac0: 746f 7073 203a 2061 7272 6179 0d0a 2020  tops : array..  
-00036ad0: 2020 2020 2020 2020 2020 6172 7261 7920            array 
-00036ae0: 6f66 2074 6f70 2065 6c65 7661 7469 6f6e  of top elevation
-00036af0: 7320 286e 792c 206e 7829 0d0a 2020 2020  s (ny, nx)..    
-00036b00: 2020 2020 626f 7473 203a 2061 7272 6179      bots : array
-00036b10: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-00036b20: 7261 7920 6f66 2062 6f74 746f 6d20 656c  ray of bottom el
-00036b30: 6576 6174 696f 6e73 2028 6e79 2c20 6e78  evations (ny, nx
-00036b40: 290d 0a20 2020 2020 2020 2073 7562 7069  )..        subpi
-00036b50: 6c65 203a 2062 6f6f 6c0d 0a20 2020 2020  le : bool..     
-00036b60: 2020 2020 2020 2069 6620 7468 6520 7069         if the pi
-00036b70: 6c65 2069 7320 6120 7375 6270 696c 652c  le is a subpile,
-00036b80: 2069 2e65 2e20 6966 2054 7275 652c 2074   i.e. if True, t
-00036b90: 6865 2074 6f70 2061 6e64 2062 6f74 746f  he top and botto
-00036ba0: 6d20 6f66 2074 6865 2070 696c 6520 6172  m of the pile ar
-00036bb0: 6520 6e6f 7420 7573 6564 0d0a 2020 2020  e not used..    
-00036bc0: 2020 2020 7662 203a 2069 6e74 0d0a 2020      vb : int..  
-00036bd0: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
-00036be0: 6974 7920 6c65 7665 6c2c 2030 2069 7320  ity level, 0 is 
-00036bf0: 7369 6c65 6e74 2c20 3120 6973 2076 6572  silent, 1 is ver
-00036c00: 626f 7365 0d0a 2020 2020 2020 2020 666c  bose..        fl
-00036c10: 5f74 6f70 203a 2062 6f6f 6c0d 0a20 2020  _top : bool..   
-00036c20: 2020 2020 2020 2020 2069 6620 5472 7565           if True
-00036c30: 2c20 7468 6520 746f 7020 6f66 2074 6865  , the top of the
-00036c40: 2070 696c 6520 6973 2075 7365 6420 746f   pile is used to
-00036c50: 2064 6566 696e 6520 7468 6520 746f 7020   define the top 
-00036c60: 6f66 2074 6865 2066 6972 7374 2075 6e69  of the first uni
-00036c70: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
-00036c80: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-00036c90: 2073 7572 6661 6365 732e 7368 6170 655b   surfaces.shape[
-00036ca0: 315d 203d 3d20 6c65 6e28 7365 6c66 2e6c  1] == len(self.l
-00036cb0: 6973 745f 756e 6974 7329 2c20 2274 6865  ist_units), "the
-00036cc0: 206e 756d 6265 7220 6f66 2073 7572 6661   number of surfa
-00036cd0: 6365 7320 7b7d 2070 726f 7669 6465 6420  ces {} provided 
-00036ce0: 6973 206e 6f74 2065 7175 616c 2074 6f20  is not equal to 
-00036cf0: 7468 6520 6e75 6d62 6572 206f 6620 756e  the number of un
-00036d00: 6974 7320 7b7d 222e 666f 726d 6174 2873  its {}".format(s
-00036d10: 7572 6661 6365 732e 7368 6170 655b 315d  urfaces.shape[1]
-00036d20: 2c20 6c65 6e28 7365 6c66 2e6c 6973 745f  , len(self.list_
-00036d30: 756e 6974 7329 290d 0a0d 0a20 2020 2020  units))....     
-00036d40: 2020 2023 206e 7265 616c 0d0a 2020 2020     # nreal..    
-00036d50: 2020 2020 6e72 6561 6c3d 7375 7266 6163      nreal=surfac
-00036d60: 6573 2e73 6861 7065 5b30 5d0d 0a0d 0a20  es.shape[0].... 
-00036d70: 2020 2020 2020 2041 7263 6854 6162 6c65         ArchTable
-00036d80: 2e6e 7265 616c 5f75 6e69 7473 3d6e 7265  .nreal_units=nre
-00036d90: 616c 2020 2320 7374 6f72 6520 6e75 6d62  al  # store numb
-00036da0: 6572 206f 6620 7265 616c 697a 6174 696f  er of realizatio
-00036db0: 6e73 0d0a 0d0a 2020 2020 2020 2020 2373  ns....        #s
-00036dc0: 696d 756c 6174 696f 6e20 6772 6964 0d0a  imulation grid..
-00036dd0: 2020 2020 2020 2020 7867 3d41 7263 6854          xg=ArchT
-00036de0: 6162 6c65 2e67 6574 5f78 6763 2829 0d0a  able.get_xgc()..
-00036df0: 2020 2020 2020 2020 6e78 3d78 672e 7368          nx=xg.sh
-00036e00: 6170 655b 305d 0d0a 2020 2020 2020 2020  ape[0]..        
-00036e10: 7967 3d41 7263 6854 6162 6c65 2e67 6574  yg=ArchTable.get
-00036e20: 5f79 6763 2829 0d0a 2020 2020 2020 2020  _ygc()..        
-00036e30: 6e79 3d79 672e 7368 6170 655b 305d 0d0a  ny=yg.shape[0]..
-00036e40: 2020 2020 2020 2020 7a67 3d41 7263 6854          zg=ArchT
-00036e50: 6162 6c65 2e67 6574 5f7a 6728 290d 0a20  able.get_zg().. 
-00036e60: 2020 2020 2020 206e 7a3d 7a67 2e73 6861         nz=zg.sha
-00036e70: 7065 5b30 5d20 2d20 310d 0a20 2020 2020  pe[0] - 1..     
-00036e80: 2020 2069 6620 7e73 7562 7069 6c65 3a0d     if ~subpile:.
-00036e90: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-00036ea0: 3d41 7263 6854 6162 6c65 2e74 6f70 0d0a  =ArchTable.top..
-00036eb0: 2020 2020 2020 2020 2020 2020 626f 743d              bot=
-00036ec0: 4172 6368 5461 626c 652e 626f 740d 0a20  ArchTable.bot.. 
-00036ed0: 2020 2020 2020 206d 6173 6b3d 4172 6368         mask=Arch
-00036ee0: 5461 626c 652e 6d61 736b 0d0a 2020 2020  Table.mask..    
-00036ef0: 2020 2020 6e6c 6179 3d6c 656e 2873 656c      nlay=len(sel
-00036f00: 662e 6c69 7374 5f75 6e69 7473 290d 0a0d  f.list_units)...
-00036f10: 0a20 2020 2020 2020 2023 6d61 6b65 2073  .        #make s
-00036f20: 7572 6520 746f 2068 6176 6520 6f72 6465  ure to have orde
-00036f30: 7265 6420 6c69 7468 6f6c 6f67 6965 730d  red lithologies.
-00036f40: 0a20 2020 2020 2020 2073 656c 662e 6f72  .        self.or
-00036f50: 6465 725f 756e 6974 7328 7662 3d76 6229  der_units(vb=vb)
-00036f60: 0d0a 0d0a 2020 2020 2020 2020 2323 2320  ....        ### 
-00036f70: 696e 6974 6961 6c69 7a65 2073 7572 6661  initialize surfa
-00036f80: 6365 7320 6279 2073 6574 7469 6e67 2074  ces by setting t
-00036f90: 6f20 300d 0a0d 0a20 2020 2020 2020 2073  o 0....        s
-00036fa0: 7572 6673 3d6e 702e 7a65 726f 7328 5b6e  urfs=np.zeros([n
-00036fb0: 7265 616c 2c20 6e6c 6179 2c20 6e79 2c20  real, nlay, ny, 
-00036fc0: 6e78 5d29 0d0a 2020 2020 2020 2020 7375  nx])..        su
-00036fd0: 7266 735f 626f 743d 6e70 2e7a 6572 6f73  rfs_bot=np.zeros
-00036fe0: 285b 6e72 6561 6c2c 206e 6c61 792c 206e  ([nreal, nlay, n
-00036ff0: 792c 206e 785d 290d 0a20 2020 2020 2020  y, nx])..       
-00037000: 206f 7267 5f73 7572 6673 3d73 7572 6661   org_surfs=surfa
-00037010: 6365 730d 0a20 2020 2020 2020 2072 6561  ces..        rea
-00037020: 6c5f 646f 6d61 696e 733d 6e70 2e7a 6572  l_domains=np.zer
-00037030: 6f73 285b 6e72 6561 6c2c 206e 6c61 792c  os([nreal, nlay,
-00037040: 206e 7a2c 206e 792c 206e 785d 290d 0a0d   nz, ny, nx])...
-00037050: 0a20 2020 2020 2020 2066 6f72 2069 7265  .        for ire
-00037060: 616c 2069 6e20 7261 6e67 6528 6e72 6561  al in range(nrea
-00037070: 6c29 3a20 2320 6c6f 6f70 206f 7665 7220  l): # loop over 
-00037080: 7265 616c 0d0a 0d0a 2020 2020 2020 2020  real....        
-00037090: 2020 2020 2374 6f70 2f62 6f74 0d0a 2020      #top/bot..  
-000370a0: 2020 2020 2020 2020 2020 6966 2073 7562            if sub
-000370b0: 7069 6c65 3a0d 0a20 2020 2020 2020 2020  pile:..         
-000370c0: 2020 2020 2020 2074 6f70 3d74 6f70 735b         top=tops[
-000370d0: 6972 6561 6c5d 0d0a 2020 2020 2020 2020  ireal]..        
-000370e0: 2020 2020 2020 2020 626f 743d 626f 7473          bot=bots
-000370f0: 5b69 7265 616c 5d0d 0a0d 0a20 2020 2020  [ireal]....     
-00037100: 2020 2020 2020 2023 2063 6f75 6e74 6572         # counter
-00037110: 2066 6f72 2063 7572 7265 6e74 2073 696d   for current sim
-00037120: 756c 6174 6564 2073 7572 6661 6365 0d0a  ulated surface..
-00037130: 2020 2020 2020 2020 2020 2020 693d 2d31              i=-1
-00037140: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00037150: 666f 7220 6c69 7468 6f20 696e 2073 656c  for litho in sel
-00037160: 662e 6c69 7374 5f75 6e69 7473 5b3a 3a20  f.list_units[:: 
-00037170: 2d31 5d3a 0d0a 0d0a 2020 2020 2020 2020  -1]:....        
-00037180: 2020 2020 2020 2020 6920 2b3d 2031 2020          i += 1  
-00037190: 2320 696e 6465 7820 666f 7220 7369 6d75  # index for simu
-000371a0: 6c61 7465 6420 7375 7266 6163 650d 0a20  lated surface.. 
-000371b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000371c0: 7461 7274 3d74 696d 652e 7469 6d65 2829  tart=time.time()
-000371d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000371e0: 2020 6966 2028 666c 5f74 6f70 2920 616e    if (fl_top) an
-000371f0: 6420 2869 203d 3d20 6e6c 6179 2d31 293a  d (i == nlay-1):
-00037200: 2023 2066 6972 7374 206c 6179 6572 2061   # first layer a
-00037210: 7373 6967 6e20 746f 2074 6f70 0d0a 2020  ssign to top..  
-00037220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037230: 2020 7331 3d74 6f70 0d0a 2020 2020 2020    s1=top..      
-00037240: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00037250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037260: 2020 2020 2073 313d 6f72 675f 7375 7266       s1=org_surf
-00037270: 735b 6972 6561 6c2c 2028 6e6c 6179 2d31  s[ireal, (nlay-1
-00037280: 292d 695d 2e63 6f70 7928 290d 0a0d 0a20  )-i].copy().... 
-00037290: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000372a0: 2061 6461 7074 2061 6c74 6974 7564 6520   adapt altitude 
-000372b0: 6966 2061 626f 7665 2f62 656c 6f77 2074  if above/below t
-000372c0: 6f70 2f62 6f74 0d0a 2020 2020 2020 2020  op/bot..        
-000372d0: 2020 2020 2020 2020 7331 5b73 313e 746f          s1[s1>to
-000372e0: 705d 3d74 6f70 5b73 313e 746f 705d 0d0a  p]=top[s1>top]..
-000372f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037300: 7331 5b73 313c 626f 745d 3d62 6f74 5b73  s1[s1<bot]=bot[s
-00037310: 313c 626f 745d 0d0a 0d0a 2020 2020 2020  1<bot]....      
-00037320: 2020 2020 2020 2020 2020 2320 7374 7261            # stra
-00037330: 7469 2063 6f6e 7369 7374 656e 6379 2061  ti consistency a
-00037340: 6e64 2065 726f 7369 6f6e 2072 756c 6573  nd erosion rules
-00037350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037360: 2020 6966 2069 203e 2030 3a0d 0a20 2020    if i > 0:..   
-00037370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037380: 2066 6f72 206f 2069 6e20 7261 6e67 6528   for o in range(
-00037390: 6929 3a20 2320 696e 6465 7820 666f 7220  i): # index for 
-000373a0: 6368 6563 6b69 6e67 2061 6c72 6561 6479  checking already
-000373b0: 2073 696d 756c 6174 6564 2073 7572 6661   simulated surfa
-000373c0: 6365 730d 0a20 2020 2020 2020 2020 2020  ces..           
-000373d0: 2020 2020 2020 2020 2020 2020 206c 6974               lit
-000373e0: 686f 323d 7365 6c66 2e6c 6973 745f 756e  ho2=self.list_un
-000373f0: 6974 735b 3a3a 202d 315d 5b6f 5d0d 0a20  its[:: -1][o].. 
-00037400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037410: 2020 2020 2020 2073 323d 7375 7266 735b         s2=surfs[
-00037420: 6972 6561 6c2c 2028 6e6c 6179 2d31 292d  ireal, (nlay-1)-
-00037430: 6f5d 2023 6964 7820 6672 6f6d 206e 6c61  o] #idx from nla
-00037440: 792d 3120 746f 206e 6c61 792d 692d 310d  y-1 to nlay-i-1.
-00037450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037460: 2020 2020 2020 2020 2069 6620 6c69 7468           if lith
-00037470: 6f20 213d 206c 6974 686f 323a 0d0a 2020  o != litho2:..  
-00037480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037490: 2020 2020 2020 2020 2020 6966 2028 6c69            if (li
-000374a0: 7468 6f2e 6f72 6465 7220 3c20 6c69 7468  tho.order < lith
-000374b0: 6f32 2e6f 7264 6572 2920 2620 286c 6974  o2.order) & (lit
-000374c0: 686f 2e73 7572 6661 6365 2e63 6f6e 7461  ho.surface.conta
-000374d0: 6374 203d 3d20 226f 6e6c 6170 2229 3a20  ct == "onlap"): 
-000374e0: 2320 7369 2063 6f75 6368 6520 7369 6d75  # si couche simu
-000374f0: 6cc3 a965 2073 7570 2065 7420 6f6e 6c61  l..e sup et onla
-00037500: 700d 0a20 2020 2020 2020 2020 2020 2020  p..             
-00037510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037520: 2020 2073 315b 7331 203c 2073 325d 3d73     s1[s1 < s2]=s
-00037530: 325b 7331 203c 2073 325d 0d0a 2020 2020  2[s1 < s2]..    
-00037540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037550: 2020 2020 2020 2020 656c 6966 2028 6c69          elif (li
-00037560: 7468 6f2e 6f72 6465 7220 3c20 6c69 7468  tho.order < lith
-00037570: 6f32 2e6f 7264 6572 2920 2620 286c 6974  o2.order) & (lit
-00037580: 686f 2e73 7572 6661 6365 2e63 6f6e 7461  ho.surface.conta
-00037590: 6374 203d 3d20 2265 726f 6465 2229 3a20  ct == "erode"): 
-000375a0: 2320 7369 2063 6f75 6368 6520 7369 6d75  # si couche simu
-000375b0: 6cc3 a965 20c3 a972 6f64 6520 756e 6520  l..e ..rode une 
-000375c0: 616e 6369 656e 6e65 0d0a 2020 2020 2020  ancienne..      
-000375d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000375e0: 2020 2020 2020 2020 2020 7332 5b73 3220            s2[s2 
-000375f0: 3e20 7331 5d3d 7331 5b73 3220 3e20 7331  > s1]=s1[s2 > s1
-00037600: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00037610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037620: 2020 2069 6620 6f20 3d3d 2069 2d31 2061     if o == i-1 a
-00037630: 6e64 206c 6974 686f 2e63 6f6e 7461 6374  nd litho.contact
-00037640: 203d 3d20 2265 726f 6465 223a 2023 2069   == "erode": # i
-00037650: 6620 696e 6465 7820 226f 2220 6973 2075  f index "o" is u
-00037660: 6e64 6572 6c79 696e 6720 6c61 7965 720d  nderlying layer.
-00037670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037690: 2020 2020 2073 315b 7331 203e 2073 325d       s1[s1 > s2]
-000376a0: 3d73 325b 7331 203e 2073 325d 2023 2070  =s2[s1 > s2] # p
-000376b0: 7265 7665 6e74 2065 726f 7369 6f6e 206c  revent erosion l
-000376c0: 6179 6572 7320 6861 7669 6e67 2076 6f6c  ayers having vol
-000376d0: 756d 650d 0a0d 0a20 2020 2020 2020 2020  ume....         
-000376e0: 2020 2020 2020 2073 7572 6673 5b69 7265         surfs[ire
-000376f0: 616c 2c20 286e 6c61 792d 3129 2d69 5d3d  al, (nlay-1)-i]=
-00037700: 7331 2020 2361 6464 2073 7572 6661 6365  s1  #add surface
-00037710: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00037720: 2363 6f6d 7075 7465 2064 6f6d 6169 6e73  #compute domains
-00037730: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00037740: 7375 7266 735f 6972 3d73 7572 6673 5b69  surfs_ir=surfs[i
-00037750: 7265 616c 5d0d 0a0d 0a20 2020 2020 2020  real]....       
-00037760: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00037770: 6e67 6528 7375 7266 735f 6972 2e73 6861  nge(surfs_ir.sha
-00037780: 7065 5b30 5d29 3a0d 0a20 2020 2020 2020  pe[0]):..       
-00037790: 2020 2020 2020 2020 2069 6620 6920 3c20           if i < 
-000377a0: 7375 7266 735f 6972 2e73 6861 7065 5b30  surfs_ir.shape[0
-000377b0: 5d2d 313a 0d0a 2020 2020 2020 2020 2020  ]-1:..          
-000377c0: 2020 2020 2020 2020 2020 735f 626f 743d            s_bot=
-000377d0: 7375 7266 735f 6972 5b69 2b31 5d20 2320  surfs_ir[i+1] # 
-000377e0: 626f 7474 6f6d 0d0a 2020 2020 2020 2020  bottom..        
-000377f0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00037800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037810: 2020 2073 5f62 6f74 3d62 6f74 0d0a 2020     s_bot=bot..  
-00037820: 2020 2020 2020 2020 2020 2020 2020 735f                s_
-00037830: 746f 703d 7375 7266 735f 6972 5b69 5d20  top=surfs_ir[i] 
-00037840: 2320 746f 700d 0a20 2020 2020 2020 2020  # top..         
-00037850: 2020 2020 2020 2061 3d41 7263 6854 6162         a=ArchTab
-00037860: 6c65 2e63 6f6d 7075 7465 5f64 6f6d 6169  le.compute_domai
-00037870: 6e28 735f 746f 702c 2073 5f62 6f74 290d  n(s_top, s_bot).
-00037880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037890: 2072 6561 6c5f 646f 6d61 696e 735b 6972   real_domains[ir
-000378a0: 6561 6c2c 2069 5d3d 612a 6d61 736b 2a73  eal, i]=a*mask*s
-000378b0: 656c 662e 6c69 7374 5f75 6e69 7473 5b69  elf.list_units[i
-000378c0: 5d2e 4944 0d0a 2020 2020 2020 2020 2020  ].ID..          
-000378d0: 2020 2020 2020 7375 7266 735f 626f 745b        surfs_bot[
-000378e0: 6972 6561 6c2c 2069 5d3d 735f 626f 740d  ireal, i]=s_bot.
-000378f0: 0a0d 0a0d 0a20 2020 2020 2020 2023 6f6e  .....        #on
-00037900: 6c79 2031 2062 6967 2061 7272 6179 0d0a  ly 1 big array..
-00037910: 2020 2020 2020 2020 613d 6e70 2e73 756d          a=np.sum
-00037920: 2872 6561 6c5f 646f 6d61 696e 732c 2061  (real_domains, a
-00037930: 7869 733d 3129 0d0a 2020 2020 2020 2020  xis=1)..        
-00037940: 4172 6368 5461 626c 652e 4765 6f6c 2e75  ArchTable.Geol.u
-00037950: 6e69 7473 5f64 6f6d 6169 6e73 5b61 2021  nits_domains[a !
-00037960: 3d20 305d 3d61 5b61 2021 3d20 305d 0d0a  = 0]=a[a != 0]..
-00037970: 2020 2020 2020 2020 6465 6c28 7265 616c          del(real
-00037980: 5f64 6f6d 6169 6e73 290d 0a20 2020 2020  _domains)..     
-00037990: 2020 2041 7263 6854 6162 6c65 2e47 656f     ArchTable.Geo
-000379a0: 6c2e 7375 7266 6163 6573 5f62 795f 7069  l.surfaces_by_pi
-000379b0: 6c65 735b 7365 6c66 2e6e 616d 655d 3d73  les[self.name]=s
-000379c0: 7572 6673 0d0a 2020 2020 2020 2020 4172  urfs..        Ar
-000379d0: 6368 5461 626c 652e 4765 6f6c 2e73 7572  chTable.Geol.sur
-000379e0: 6661 6365 735f 626f 745f 6279 5f70 696c  faces_bot_by_pil
-000379f0: 6573 5b73 656c 662e 6e61 6d65 5d3d 7375  es[self.name]=su
-00037a00: 7266 735f 626f 740d 0a20 2020 2020 2020  rfs_bot..       
-00037a10: 2041 7263 6854 6162 6c65 2e47 656f 6c2e   ArchTable.Geol.
-00037a20: 6f72 675f 7375 7266 6163 6573 5f62 795f  org_surfaces_by_
-00037a30: 7069 6c65 735b 7365 6c66 2e6e 616d 655d  piles[self.name]
-00037a40: 3d6f 7267 5f73 7572 6673 0d0a 0d0a 2020  =org_surfs....  
-00037a50: 2020 2020 2020 6966 2076 623a 0d0a 2020        if vb:..  
-00037a60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00037a70: 2223 2323 2323 2323 2323 2323 2323 2323  "###############
-00037a80: 2323 2323 2323 2323 2323 235c 6e22 290d  ###########\n").
-00037a90: 0a0d 0a0d 0a63 6c61 7373 2055 6e69 7428  .....class Unit(
-00037aa0: 293a 0d0a 0d0a 2020 2020 2222 220d 0a20  ):....    """.. 
-00037ab0: 2020 2054 6869 7320 636c 6173 7320 6465     This class de
-00037ac0: 6669 6e65 7320 556e 6974 206f 626a 6563  fines Unit objec
-00037ad0: 7473 2c20 7768 6963 6820 6172 6520 7468  ts, which are th
-00037ae0: 6520 6275 696c 6469 6e67 2062 6c6f 636b  e building block
-00037af0: 7320 6f66 2074 6865 2050 696c 6520 636c  s of the Pile cl
-00037b00: 6173 732e 0d0a 0d0a 2020 2020 5061 7261  ass.....    Para
-00037b10: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
-00037b20: 2d2d 2d2d 2d2d 0d0a 2020 2020 6e61 6d65  ------..    name
-00037b30: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
-00037b40: 2020 206e 616d 6520 6f66 2074 6865 2075     name of the u
-00037b50: 6e69 7420 7468 6174 2077 696c 6c20 6265  nit that will be
-00037b60: 2075 7365 6420 6173 2061 6e20 6964 656e   used as an iden
-00037b70: 7469 6669 6572 0d0a 2020 2020 6f72 6465  tifier..    orde
-00037b80: 7220 3a20 696e 740d 0a20 2020 2020 2020  r : int..       
-00037b90: 206f 7264 6572 206f 6620 7468 6520 756e   order of the un
-00037ba0: 6974 2069 6e20 7468 6520 7069 6c65 2028  it in the pile (
-00037bb0: 3120 2874 6f70 2920 746f 206e 2028 626f  1 (top) to n (bo
-00037bc0: 7474 6f6d 292c 2077 6865 7265 206e 2069  ttom), where n i
-00037bd0: 7320 7468 6520 746f 7461 6c20 6e75 6d62  s the total numb
-00037be0: 6572 206f 6620 756e 6974 7329 0d0a 2020  er of units)..  
-00037bf0: 2020 636f 6c6f 7220 3a20 7374 7269 6e67    color : string
-00037c00: 0d0a 2020 2020 2020 2020 636f 6c6f 7220  ..        color 
-00037c10: 746f 2075 7365 2066 6f72 2070 6c6f 7474  to use for plott
-00037c20: 696e 6720 616e 6420 7265 7072 6573 656e  ing and represen
-00037c30: 7461 7469 6f6e 2e0d 0a20 2020 2020 2020  tation...       
-00037c40: 2054 6865 2063 6f6c 6f72 2063 616e 2062   The color can b
-00037c50: 6520 616e 7920 636f 6c6f 7220 7468 6174  e any color that
-00037c60: 2069 7320 6163 6365 7074 6564 2062 7920   is accepted by 
-00037c70: 6d61 7470 6c6f 746c 6962 0d0a 2020 2020  matplotlib..    
-00037c80: 7375 7266 6163 6520 3a20 3a63 6c61 7373  surface : :class
-00037c90: 3a60 5375 7266 6163 6560 206f 626a 6563  :`Surface` objec
-00037ca0: 740d 0a20 2020 2020 2020 2073 7572 6661  t..        surfa
-00037cb0: 6365 206f 626a 6563 7420 7468 6174 2064  ce object that d
-00037cc0: 6566 696e 6573 2074 6865 2073 7572 6661  efines the surfa
-00037cd0: 6365 206f 6620 7468 6520 756e 6974 0d0a  ce of the unit..
-00037ce0: 2020 2020 4944 203a 2069 6e74 0d0a 2020      ID : int..  
-00037cf0: 2020 2020 2020 4944 206f 6620 7468 6520        ID of the 
-00037d00: 756e 6974 2c20 6966 204e 6f6e 652c 2074  unit, if None, t
-00037d10: 6865 2049 4420 7769 6c6c 2062 6520 7365  he ID will be se
-00037d20: 7420 746f 2074 6865 206f 7264 6572 206f  t to the order o
-00037d30: 6620 7468 6520 756e 6974 0d0a 2020 2020  f the unit..    
-00037d40: 6469 635f 6661 6369 6573 203a 2064 6963  dic_facies : dic
-00037d50: 740d 0a20 2020 2020 2020 2064 6963 7469  t..        dicti
-00037d60: 6f6e 6172 7920 7468 6174 2064 6566 696e  onary that defin
-00037d70: 6573 2074 6865 2066 6163 6965 7320 6f66  es the facies of
-00037d80: 2074 6865 2075 6e69 742e 2054 6865 206d   the unit. The m
-00037d90: 616e 6461 746f 7279 206b 6579 7320 666f  andatory keys fo
-00037da0: 7220 7468 6520 6469 6374 696f 6e61 7279  r the dictionary
-00037db0: 2061 7265 3a0d 0a0d 0a20 2020 2020 2020   are:....       
-00037dc0: 202d 2066 5f6d 6574 686f 6420 3a20 7374   - f_method : st
-00037dd0: 7269 6e67 2c20 7661 6c61 626c 6520 6d65  ring, valable me
-00037de0: 7468 6f64 2061 7265 3a20 0d0a 0d0a 2020  thod are: ....  
-00037df0: 2020 2020 2020 2020 2020 2d20 2268 6f6d            - "hom
-00037e00: 6f67 656e 6f75 7322 203a 2068 6f6d 6f67  ogenous" : homog
-00037e10: 656e 6f75 7320 6661 6369 6573 0d0a 2020  enous facies..  
-00037e20: 2020 2020 2020 2020 2020 2d20 2253 7562            - "Sub
-00037e30: 5069 6c65 2220 3a20 6661 6369 6573 2061  Pile" : facies a
-00037e40: 7265 2073 696d 756c 6174 6564 2077 6974  re simulated wit
-00037e50: 6820 6120 7375 6270 696c 650d 0a20 2020  h a subpile..   
-00037e60: 2020 2020 2020 2020 202d 2022 5349 5322           - "SIS"
-00037e70: 203a 2066 6163 6965 7320 6172 6520 7369   : facies are si
-00037e80: 6d75 6c61 7465 6420 7769 7468 2073 746f  mulated with sto
-00037e90: 6368 6173 7469 6320 696e 6469 6361 746f  chastic indicato
-00037ea0: 7220 7369 6d75 6c61 7469 6f6e 0d0a 2020  r simulation..  
-00037eb0: 2020 2020 2020 2020 2020 2d20 224d 5053            - "MPS
-00037ec0: 2220 3a20 6661 6369 6573 2061 7265 2073  " : facies are s
-00037ed0: 696d 756c 6174 6564 2077 6974 6820 4d75  imulated with Mu
-00037ee0: 6c74 6970 6c65 2070 6f69 6e74 7320 7374  ltiple points st
-00037ef0: 6174 6973 7469 6373 0d0a 2020 2020 2020  atistics..      
-00037f00: 2020 2020 2020 2d20 2254 5047 7322 3a20        - "TPGs": 
-00037f10: 6661 6369 6573 2061 7265 2073 696d 756c  facies are simul
-00037f20: 6174 6564 2077 6974 6820 5472 756e 6361  ated with Trunca
-00037f30: 7465 6420 706c 7572 692d 4761 7573 7369  ted pluri-Gaussi
-00037f40: 616e 206d 6574 686f 640d 0a20 2020 2020  an method..     
-00037f50: 2020 202d 2066 5f63 6f76 6d6f 6465 6c20     - f_covmodel 
-00037f60: 3a20 3344 2067 656f 6e65 2063 6f76 6172  : 3D geone covar
-00037f70: 6961 6e63 6520 6d6f 6465 6c20 6f62 6a65  iance model obje
-00037f80: 6374 206f 7220 6c69 7374 206f 6620 3344  ct or list of 3D
-00037f90: 2067 656f 6e65 2063 6f76 6172 6961 6e63   geone covarianc
-00037fa0: 6520 6d6f 6465 6c20 6f62 6a65 6374 7320  e model objects 
-00037fb0: 6f6e 6c79 2075 7365 6420 7769 7468 2022  only used with "
-00037fc0: 5349 5322 206d 6574 686f 640d 0a20 2020  SIS" method..   
-00037fd0: 2020 2020 202d 2054 4920 3a20 6765 6f6e       - TI : geon
-00037fe0: 652e 696d 6167 652c 2054 7261 696e 696e  e.image, Trainin
-00037ff0: 6720 696d 6167 6520 666f 7220 224d 5053  g image for "MPS
-00038000: 2220 6d65 7468 6f64 0d0a 2020 2020 2020  " method..      
-00038010: 2020 2d20 5375 6250 696c 6520 3a20 3a63    - SubPile : :c
-00038020: 6c61 7373 3a60 5069 6c65 6020 6f62 6a65  lass:`Pile` obje
-00038030: 6374 2c20 7375 6270 696c 6520 666f 7220  ct, subpile for 
-00038040: 2253 7562 5069 6c65 2220 6d65 7468 6f64  "SubPile" method
-00038050: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-00038060: 4661 6369 6573 206b 6579 776f 7264 2061  Facies keyword a
-00038070: 7267 756d 656e 7473 2074 6f20 7061 7373  rguments to pass
-00038080: 2074 6f20 7468 6520 6661 6369 6573 206d   to the facies m
-00038090: 6574 686f 6473 2028 7468 6573 6520 7368  ethods (these sh
-000380a0: 6f75 6c64 2062 6520 7061 7373 2074 6872  ould be pass thr
-000380b0: 6f75 6768 2064 6963 5f66 6163 6965 7320  ough dic_facies 
-000380c0: 2129 3a0d 0a20 2020 2020 2020 200d 0a20  !):..        .. 
-000380d0: 2020 2020 2020 2020 2020 202d 2022 5349             - "SI
-000380e0: 5322 203a 0d0a 2020 2020 2020 2020 2020  S" :..          
-000380f0: 2020 2020 2020 2d20 226e 6569 6768 2220        - "neigh" 
-00038100: 3a20 696e 742c 206e 756d 6265 7220 6f66  : int, number of
-00038110: 206e 6569 6768 626f 7273 2074 6f20 7573   neighbors to us
-00038120: 6520 666f 7220 7468 6520 5349 530d 0a20  e for the SIS.. 
-00038130: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-00038140: 2072 203a 2066 6c6f 6174 2c20 7261 6469   r : float, radi
-00038150: 7573 206f 6620 7468 6520 6e65 6967 6862  us of the neighb
-00038160: 6f72 686f 6f64 2074 6f20 7573 6520 666f  orhood to use fo
-00038170: 7220 7468 6520 5349 530d 0a20 2020 2020  r the SIS..     
-00038180: 2020 2020 2020 2020 2020 202d 2070 726f             - pro
-00038190: 6261 6269 6c69 7479 203a 206c 6973 7420  bability : list 
-000381a0: 6f66 2066 6c6f 6174 2c20 7072 6f70 6f72  of float, propor
-000381b0: 7469 6f6e 206f 6620 6561 6368 2066 6163  tion of each fac
-000381c0: 6965 7320 746f 2075 7365 2066 6f72 2074  ies to use for t
-000381d0: 6865 2053 4953 0d0a 2020 2020 2020 2020  he SIS..        
-000381e0: 2020 2020 2d20 5449 2020 2020 2020 2020      - TI        
-000381f0: 2020 2020 2020 2020 2020 2020 3a20 6765              : ge
-00038200: 6f6e 6520 696d 672c 2054 7261 696e 696e  one img, Trainin
-00038210: 6720 696d 6167 6528 7329 2074 6f20 7573  g image(s) to us
-00038220: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00038230: 2020 202d 206d 7073 2022 636c 6173 7369     - mps "classi
-00038240: 6322 2070 6172 616d 6574 6572 7320 286d  c" parameters (m
-00038250: 6178 7363 616e 2c20 7468 7265 7368 2c20  axscan, thresh, 
-00038260: 6e65 6967 2028 6e75 6d62 6572 206f 6620  neig (number of 
-00038270: 6e65 6967 6862 6f75 7273 2929 0d0a 2020  neighbours))..  
-00038280: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-00038290: 6e70 6f73 7420 2020 2020 2020 2020 2020  npost           
-000382a0: 2020 2020 2020 3a20 6e75 6d62 6572 206f        : number o
-000382b0: 6620 7061 7468 2070 6f73 7470 726f 6365  f path postproce
-000382c0: 7373 696e 672c 2064 6566 6175 6c74 2031  ssing, default 1
-000382d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000382e0: 2020 2d20 7261 6469 7573 4d6f 6465 2020    - radiusMode  
-000382f0: 2020 2020 2020 2020 2020 3a20 7261 6469            : radi
-00038300: 7573 206d 6f64 6520 746f 2075 7365 2028  us mode to use (
-00038310: 6368 6563 6b20 6465 6573 7365 206d 616e  check deesse man
-00038320: 7561 6c29 0d0a 2020 2020 2020 2020 2020  ual)..          
-00038330: 2020 2020 2020 2d20 616e 6973 6f74 726f        - anisotro
-00038340: 7079 5261 7469 6f4d 6f64 6520 2020 3a20  pyRatioMode   : 
-00038350: 416e 6973 6f74 726f 7079 2072 6174 696f  Anisotropy ratio
-00038360: 2074 6f20 7573 6520 696e 2072 6561 7365   to use in rease
-00038370: 6172 6368 206f 6620 6e65 6967 6862 6f75  arch of neighbou
-00038380: 7273 2028 6368 6563 6b20 6465 6573 7365  rs (check deesse
-00038390: 206d 616e 7561 6c29 0d0a 2020 2020 2020   manual)..      
-000383a0: 2020 2020 2020 2020 2020 2d20 7278 2c20            - rx, 
-000383b0: 7279 2c20 727a 2020 2020 2020 2020 2020  ry, rz          
-000383c0: 2020 3a20 7261 6469 7573 2069 6e20 782c    : radius in x,
-000383d0: 2079 2061 6e64 207a 2064 6972 6563 7469   y and z directi
-000383e0: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
-000383f0: 2020 2020 2d20 616e 676c 6531 2c20 616e      - angle1, an
-00038400: 676c 6532 2c20 616e 676c 6533 3a20 656c  gle2, angle3: el
-00038410: 6c69 7073 6f69 6420 6f66 2072 6573 6561  lipsoid of resea
-00038420: 7263 6820 726f 7461 7469 6f6e 2061 6e67  rch rotation ang
-00038430: 6c65 730d 0a20 2020 2020 2020 2020 2020  les..           
-00038440: 2020 2020 202d 2061 782c 2061 792c 2061       - ax, ay, a
-00038450: 7a20 2020 2020 2020 2020 2020 203a 2061  z            : a
-00038460: 6e69 736f 7472 6f70 7920 7261 7469 6f20  nisotropy ratio 
-00038470: 666f 7220 7265 7365 6172 6368 2065 6c6c  for research ell
-00038480: 6970 736f 6964 0d0a 2020 2020 2020 2020  ipsoid..        
-00038490: 2020 2020 2020 2020 2d20 726f 745f 7573          - rot_us
-000384a0: 6167 6520 2020 2020 2020 2020 2020 2020  age             
-000384b0: 3a20 302c 2031 206f 7220 3220 2863 6865  : 0, 1 or 2 (che
-000384c0: 636b 2064 6565 7373 6520 6d61 6e75 616c  ck deesse manual
-000384d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000384e0: 2020 202d 2072 6f74 417a 694c 6f63 2c20     - rotAziLoc, 
-000384f0: 726f 7444 6970 4c6f 632c 203a 206c 6f63  rotDipLoc, : loc
-00038500: 616c 2072 6f74 6174 696f 6e2c 2054 7275  al rotation, Tru
-00038510: 6520 6f72 2046 616c 7365 203f 0d0a 2020  e or False ?..  
-00038520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038530: 726f 7450 6c75 6e67 654c 6f63 0d0a 2020  rotPlungeLoc..  
-00038540: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-00038550: 726f 7441 7a69 2c20 726f 7444 6970 2c20  rotAzi, rotDip, 
-00038560: 2020 2020 2020 3a20 676c 6f62 616c 2072        : global r
-00038570: 6f74 6174 696f 6e20 616e 676c 6573 3a20  otation angles: 
-00038580: 7661 6c75 6573 2c20 6d69 6e2d 6d61 782c  values, min-max,
-00038590: 206d 6170 732c 2073 6565 2064 6565 7373   maps, see deess
-000385a0: 655f 696e 7075 7420 646f 630d 0a20 2020  e_input doc..   
-000385b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000385c0: 6f74 506c 756e 6765 2020 2020 2020 2020  otPlunge        
-000385d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000385e0: 2020 2020 2020 2020 2020 2d20 7872 2c20            - xr, 
-000385f0: 7972 2c20 7a72 2020 2020 2020 2020 2020  yr, zr          
-00038600: 2020 3a20 7261 7469 6f20 666f 7220 6765    : ratio for ge
-00038610: 6f6d 2074 7261 6e73 666f 726d 6174 696f  om transformatio
-00038620: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-00038630: 2020 202d 2078 6c6f 632c 2079 6c6f 632c     - xloc, yloc,
-00038640: 207a 6c6f 6320 2020 2020 203a 206c 6f63   zloc      : loc
-00038650: 616c 206f 7220 6e6f 7420 7472 616e 7366  al or not transf
-00038660: 6f72 6d61 7469 6f6e 0d0a 2020 2020 2020  ormation..      
-00038670: 2020 2020 2020 2020 2020 2d20 686f 6d6f            - homo
-00038680: 5f75 7361 6765 2020 2020 2020 2020 2020  _usage          
-00038690: 2020 3a20 686f 6d6f 7468 6574 7920 7573    : homothety us
-000386a0: 6167 650d 0a20 2020 2020 2020 2020 2020  age..           
-000386b0: 2020 2020 202d 2070 726f 6261 5573 6167       - probaUsag
-000386c0: 6520 2020 2020 2020 2020 2020 203a 2070  e            : p
-000386d0: 726f 6261 6269 6c69 7479 2063 6f6e 7374  robability const
-000386e0: 7261 696e 7420 7573 6167 652c 2030 2066  raint usage, 0 f
-000386f0: 6f72 206e 6f20 7072 6f62 6120 636f 6e73  or no proba cons
-00038700: 7472 6169 6e74 2c20 3120 666f 7220 676c  traint, 1 for gl
-00038710: 6f62 616c 2070 726f 706f 7274 696f 6e20  obal proportion 
-00038720: 6465 6669 6e65 6420 696e 2067 6c6f 6261  defined in globa
-00038730: 6c50 6466 2c20 3220 666f 7220 6c6f 6361  lPdf, 2 for loca
-00038740: 6c20 7072 6f70 6f72 7469 6f6e 2064 6566  l proportion def
-00038750: 696e 6564 2069 6e20 6c6f 6361 6c50 6466  ined in localPdf
-00038760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00038770: 2020 2d20 676c 6f62 616c 5064 6620 2020    - globalPdf   
-00038780: 2020 2020 2020 2020 2020 3a20 6172 7261            : arra
-00038790: 792d 6c69 6b65 206f 6620 666c 6f61 7420  y-like of float 
-000387a0: 6f66 206c 656e 6774 6820 6571 7561 6c20  of length equal 
-000387b0: 746f 2074 6865 206e 756d 6265 7220 6f66  to the number of
-000387c0: 2063 6c61 7373 2c20 7072 6f70 6f72 7469   class, proporti
-000387d0: 6f6e 2066 6f72 2065 6163 6820 636c 6173  on for each clas
-000387e0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-000387f0: 2020 202d 206c 6f63 616c 5064 6620 2020     - localPdf   
-00038800: 2020 2020 2020 2020 2020 203a 2028 6e63             : (nc
-00038810: 6c61 7373 2c20 6e7a 2c20 6e79 2c20 6e78  lass, nz, ny, nx
-00038820: 2920 6172 7261 7920 6f66 2066 6c6f 6174  ) array of float
-00038830: 7320 7072 6f62 6162 696c 6974 7920 666f  s probability fo
-00038840: 7220 6561 6368 2063 6c61 7373 2c20 6c6f  r each class, lo
-00038850: 6361 6c50 6466 5b69 5d20 6973 2074 6865  calPdf[i] is the
-00038860: 2022 6d61 7020 6465 6669 6e65 6420 6f6e   "map defined on
-00038870: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
-00038880: 6772 6964 0d0a 2020 2020 2020 2020 2020  grid..          
-00038890: 2020 2020 2020 2d20 6c6f 6361 6c50 6466        - localPdf
-000388a0: 5261 6469 7573 2020 2020 2020 2020 3a20  Radius        : 
-000388b0: 7375 7070 6f72 7420 7261 6469 7573 2066  support radius f
-000388c0: 6f72 206c 6f63 616c 2070 6466 2c20 6465  or local pdf, de
-000388d0: 6661 756c 7420 6973 2032 0d0a 2020 2020  fault is 2..    
-000388e0: 2020 2020 2020 2020 2020 2020 2d20 6465              - de
-000388f0: 6163 7469 7661 7469 6f6e 4469 7374 616e  activationDistan
-00038900: 6365 2020 3a20 666c 6f61 742c 2064 6973  ce  : float, dis
-00038910: 7461 6e63 6520 6174 2077 6869 6368 206c  tance at which l
-00038920: 6f63 616c 5064 6620 6172 6520 6465 6163  ocalPdf are deac
-00038930: 7469 7661 7465 6420 2873 6565 2044 6565  tivated (see Dee
-00038940: 7373 6520 646f 6329 0d0a 2020 2020 2020  sse doc)..      
-00038950: 2020 2020 2020 2020 2020 2d20 636f 6e73            - cons
-00038960: 7461 6e74 5468 7265 7368 6f6c 6420 2020  tantThreshold   
-00038970: 2020 3a20 666c 6f61 742c 2074 6872 6573    : float, thres
-00038980: 686f 6c64 2076 616c 7565 2066 6f72 2070  hold value for p
-00038990: 6466 2773 2063 6f6d 7061 7269 736f 6e0d  df's comparison.
-000389a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000389b0: 202d 2064 6174 6149 6d61 6765 2020 2020   - dataImage    
-000389c0: 2020 2020 2020 2020 203a 2067 656f 6e65           : geone
-000389d0: 2069 6d67 2075 7365 6420 6173 2064 6174   img used as dat
-000389e0: 612c 2073 6565 2064 6565 7373 652f 6765  a, see deesse/ge
-000389f0: 6f6e 6520 646f 6375 6d65 6e74 6174 696f  one documentatio
-00038a00: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-00038a10: 2020 202d 206f 7574 7075 7456 6172 466c     - outputVarFl
-00038a20: 6167 2020 2020 2020 2020 203a 2062 6f6f  ag         : boo
-00038a30: 6c20 6f72 206c 6973 7420 6f66 2062 6f6f  l or list of boo
-00038a40: 6c20 6f66 2073 697a 6520 6e76 2c20 746f  l of size nv, to
-00038a50: 206f 7574 7075 7420 6f72 206e 6f74 2074   output or not t
-00038a60: 6865 2076 6172 6961 626c 6573 0d0a 2020  he variables..  
-00038a70: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-00038a80: 6469 7374 616e 6365 5479 7065 2020 2020  distanceType    
-00038a90: 2020 2020 2020 3a20 7374 7269 6e67 206f        : string o
-00038aa0: 7220 6c69 7374 206f 6620 7374 7269 6e67  r list of string
-00038ab0: 732c 2022 6361 7465 676f 7269 6361 6c22  s, "categorical"
-00038ac0: 206f 7220 2263 6f6e 7469 6e75 6f75 7322   or "continuous"
-00038ad0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00038ae0: 2d20 5450 4773 3a0d 0a20 2020 2020 2020  - TPGs:..       
-00038af0: 2020 2020 2020 2020 202d 2066 6c61 673a           - flag:
-00038b00: 2064 6963 7469 6f6e 6172 7920 6f66 206c   dictionary of l
-00038b10: 696d 6974 7320 6f66 2063 7562 6f69 6473  imits of cuboids
-00038b20: 2064 6f6d 6169 6e73 2069 6e20 4761 7573   domains in Gaus
-00038b30: 7369 616e 2073 7061 6365 2c20 6368 6563  sian space, chec
-00038b40: 6b20 2e2e 2e20 666f 7220 7468 6520 7269  k ... for the ri
-00038b50: 6768 7420 666f 726d 6174 2e0d 0a20 2020  ght format...   
-00038b60: 2020 2020 2020 2020 2020 2020 202d 2049               - I
-00038b70: 6b5f 636d 3a20 696e 6469 6361 746f 7220  k_cm: indicator 
-00038b80: 636f 766d 6f64 656c 730d 0a20 2020 2020  covmodels..     
-00038b90: 2020 2020 2020 2020 2020 202d 2047 5f63             - G_c
-00038ba0: 6d3a 206c 6973 7420 6f66 2047 6175 7373  m: list of Gauss
-00038bb0: 6961 6e20 636f 766d 6f64 656c 7320 666f  ian covmodels fo
-00038bc0: 7220 7468 6520 7477 6f20 6761 7573 7369  r the two gaussi
-00038bd0: 616e 2066 6965 6c64 732c 2063 616e 2062  an fields, can b
-00038be0: 6520 696e 6665 7265 6420 6672 6f6d 2049  e infered from I
-00038bf0: 6b5f 636d 0d0a 2020 2020 2020 2020 2020  k_cm..          
-00038c00: 2020 2020 2020 2d20 7661 7269 6f75 7320        - various 
-00038c10: 7061 7261 6d65 7465 7273 3a20 2864 752c  parameters: (du,
-00038c20: 2064 7620 2d2d 3e20 7072 6563 6973 696f   dv --> precisio
-00038c30: 6e20 6f66 2069 6e74 6567 7261 6c73 2066  n of integrals f
-00038c40: 6f72 2047 5f63 6d20 696e 6665 7265 6e63  or G_cm inferenc
-00038c50: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
-00038c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038c70: 2020 2020 2020 2020 2020 2028 6469 6d3a             (dim:
-00038c80: 2064 696d 656e 7369 6f6e 2077 616e 7465   dimension wante
-00038c90: 6420 666f 7220 475f 636d 2069 6e66 6572  d for G_cm infer
-00038ca0: 656e 6365 2c0d 0a20 2020 2020 2020 2020  ence,..         
-00038cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038cc0: 2020 2020 2020 2020 2020 2020 2028 635f               (c_
-00038cd0: 7265 673a 2072 6567 756c 6172 6973 6174  reg: regularisat
-00038ce0: 696f 6e20 7465 726d 2066 6f72 2047 5f63  ion term for G_c
-00038cf0: 6d20 696e 6665 7265 6e63 6529 2c0d 0a20  m inference),.. 
-00038d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038d20: 2020 2020 2028 6e3a 206e 756d 6265 7220       (n: number 
-00038d30: 6f66 2063 6f6e 7472 6f6c 2070 6f69 6e74  of control point
-00038d40: 7320 666f 7220 475f 636d 2069 6e66 6572  s for G_cm infer
-00038d50: 656e 6365 2929 0d0a 0d0a 2020 2020 2222  ence))....    ""
-00038d60: 220d 0a0d 0a20 2020 2064 6566 205f 5f69  "....    def __i
-00038d70: 6e69 745f 5f28 7365 6c66 2c20 6e61 6d65  nit__(self, name
-00038d80: 2c20 6f72 6465 722c 2063 6f6c 6f72 2c20  , order, color, 
-00038d90: 7375 7266 6163 653d 4e6f 6e65 2c20 4944  surface=None, ID
-00038da0: 3d4e 6f6e 652c 0d0a 2020 2020 2020 2020  =None,..        
-00038db0: 2020 2020 2020 2020 6469 635f 6661 6369          dic_faci
-00038dc0: 6573 3d7b 2266 5f6d 6574 686f 6422 3a20  es={"f_method": 
-00038dd0: 2268 6f6d 6f67 656e 6f75 7322 2c20 2266  "homogenous", "f
-00038de0: 5f63 6f76 6d6f 6465 6c22 3a20 4e6f 6e65  _covmodel": None
-00038df0: 2c20 2254 4922 3a20 4e6f 6e65 2c20 2253  , "TI": None, "S
-00038e00: 7562 5069 6c65 223a 204e 6f6e 652c 2022  ubPile": None, "
-00038e10: 466c 6167 223a 204e 6f6e 652c 2022 475f  Flag": None, "G_
-00038e20: 636d 223a 204e 6f6e 657d 2c0d 0a20 2020  cm": None},..   
-00038e30: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00038e40: 7461 6374 3d22 6f6e 6c61 7022 2c20 7665  tact="onlap", ve
-00038e50: 7262 6f73 653d 3129 3a0d 0a20 2020 200d  rbose=1):..    .
-00038e60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00038e70: 4944 2021 3d20 302c 2022 4944 2063 616e  ID != 0, "ID can
-00038e80: 6e6f 7420 6265 2030 220d 0a20 2020 2020  not be 0"..     
-00038e90: 2020 2061 7373 6572 7420 6e61 6d65 2069     assert name i
-00038ea0: 7320 6e6f 7420 4e6f 6e65 2c20 2241 206e  s not None, "A n
-00038eb0: 616d 6520 6d75 7374 2062 6520 7072 6f76  ame must be prov
-00038ec0: 6964 6564 220d 0a20 2020 2020 2020 2061  ided"..        a
-00038ed0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-00038ee0: 2820 7375 7266 6163 652c 2053 7572 6661  ( surface, Surfa
-00038ef0: 6365 292c 2022 4120 7375 7266 6163 6520  ce), "A surface 
-00038f00: 6f62 6a65 6374 206d 7573 7420 6265 2070  object must be p
-00038f10: 726f 7669 6465 6420 666f 7220 6561 6368  rovided for each
-00038f20: 2075 6e69 7422 0d0a 0d0a 2020 2020 2020   unit"....      
-00038f30: 2020 7365 6c66 2e6e 616d 653d 6e61 6d65    self.name=name
-00038f40: 0d0a 2020 2020 2020 2020 7365 6c66 2e6f  ..        self.o
-00038f50: 7264 6572 3d6f 7264 6572 0d0a 2020 2020  rder=order..    
-00038f60: 2020 2020 7365 6c66 2e63 6f6e 7461 6374      self.contact
-00038f70: 3d63 6f6e 7461 6374 0d0a 2020 2020 2020  =contact..      
-00038f80: 2020 7365 6c66 2e63 3d63 6f6c 6f72 0d0a    self.c=color..
-00038f90: 0d0a 2020 2020 2020 2020 6966 2049 4420  ..        if ID 
-00038fa0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00038fb0: 2020 2020 2020 7365 6c66 2e49 443d 6f72        self.ID=or
-00038fc0: 6465 720d 0a20 2020 2020 2020 2065 6c73  der..        els
-00038fd0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00038fe0: 7365 6c66 2e49 443d 4944 0d0a 2020 2020  self.ID=ID..    
-00038ff0: 2020 2020 7365 6c66 2e53 7562 5069 6c65      self.SubPile
-00039000: 3d4e 6f6e 650d 0a20 2020 2020 2020 2073  =None..        s
-00039010: 656c 662e 7665 7262 6f73 653d 7665 7262  elf.verbose=verb
-00039020: 6f73 650d 0a20 2020 2020 2020 2073 656c  ose..        sel
-00039030: 662e 6c69 7374 5f66 6163 6965 733d 5b5d  f.list_facies=[]
-00039040: 0d0a 2020 2020 2020 2020 7365 6c66 2e62  ..        self.b
-00039050: 625f 756e 6974 7320 3d20 5b5d 0d0a 2020  b_units = []..  
-00039060: 2020 2020 2020 7365 6c66 2e78 203d 205b        self.x = [
-00039070: 5d20 2023 2064 6174 6120 636f 6f72 6469  ]  # data coordi
-00039080: 6e61 7465 7320 666f 7220 6361 7465 676f  nates for catego
-00039090: 7269 6361 6c20 7369 6d75 6c61 7469 6f6e  rical simulation
-000390a0: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
-000390b0: 7920 3d20 5b5d 2020 2320 6461 7461 2063  y = []  # data c
-000390c0: 6f6f 7264 696e 6174 6573 2066 6f72 2063  oordinates for c
-000390d0: 6174 6567 6f72 6963 616c 2073 696d 756c  ategorical simul
-000390e0: 6174 696f 6e73 0d0a 2020 2020 2020 2020  ations..        
-000390f0: 7365 6c66 2e7a 203d 205b 5d20 2023 2064  self.z = []  # d
-00039100: 6174 6120 636f 6f72 6469 6e61 7465 7320  ata coordinates 
-00039110: 666f 7220 6361 7465 676f 7269 6361 6c20  for categorical 
-00039120: 7369 6d75 6c61 7469 6f6e 730d 0a20 2020  simulations..   
-00039130: 2020 2020 2073 656c 662e 6d75 6d6d 795f       self.mummy_
-00039140: 756e 6974 3d4e 6f6e 650d 0a20 2020 2020  unit=None..     
-00039150: 2020 2073 656c 662e 7365 745f 6469 635f     self.set_dic_
-00039160: 6661 6369 6573 2864 6963 5f66 6163 6965  facies(dic_facie
-00039170: 7329 2023 7365 7420 6469 6320 6661 6369  s) #set dic faci
-00039180: 6573 2074 6f20 756e 6974 0d0a 0d0a 2020  es to unit....  
-00039190: 2020 2020 2020 6966 2073 7572 6661 6365        if surface
-000391a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-000391b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000391c0: 7365 745f 5375 7266 6163 6528 7375 7266  set_Surface(surf
-000391d0: 6163 6529 0d0a 0d0a 0d0a 2020 2020 6465  ace)......    de
-000391e0: 6620 7365 745f 6469 635f 6661 6369 6573  f set_dic_facies
-000391f0: 2873 656c 662c 2064 6963 5f66 6163 6965  (self, dic_facie
-00039200: 7329 3a0d 0a0d 0a20 2020 2020 2020 2022  s):....        "
-00039210: 2222 0d0a 2020 2020 2020 2020 5365 7420  ""..        Set 
-00039220: 6120 6469 6374 696f 6e61 7279 2066 6163  a dictionary fac
-00039230: 6965 7320 746f 2055 6e69 7420 6f62 6a65  ies to Unit obje
-00039240: 6374 0d0a 0d0a 2020 2020 2020 2020 5061  ct....        Pa
-00039250: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00039260: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00039270: 2020 2020 2020 6469 635f 6661 6369 6573        dic_facies
-00039280: 203a 2064 6963 740d 0a20 2020 2020 2020   : dict..       
-00039290: 2020 2020 2064 6963 7469 6f6e 6e61 7279       dictionnary
-000392a0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-000392b0: 7061 7261 6d65 7465 7273 2074 6f20 7061  parameters to pa
-000392c0: 7373 2061 7420 7468 6520 6661 6369 6573  ss at the facies
-000392d0: 206d 6574 686f 6473 0d0a 2020 2020 2020   methods..      
-000392e0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-000392f0: 2061 7373 6572 7420 6469 635f 6661 6369   assert dic_faci
-00039300: 6573 5b22 665f 6d65 7468 6f64 225d 2069  es["f_method"] i
-00039310: 6e20 2822 4d50 5322 2c20 2253 4953 222c  n ("MPS", "SIS",
-00039320: 2022 686f 6d6f 6765 6e6f 7573 222c 2022   "homogenous", "
-00039330: 5450 4773 222c 2022 5375 6250 696c 6522  TPGs", "SubPile"
-00039340: 292c 2027 4669 6c6c 696e 6720 6d65 7468  ), 'Filling meth
-00039350: 6f64 2075 6e6b 6e6f 776e 2c20 7661 6c69  od unknown, vali
-00039360: 6473 2061 7265 2022 4d50 5322 2c20 2253  ds are "MPS", "S
-00039370: 4953 222c 2022 686f 6d6f 6765 6e6f 7573  IS", "homogenous
-00039380: 222c 2022 5450 4773 222c 2022 5375 6250  ", "TPGs", "SubP
-00039390: 696c 6527 0d0a 0d0a 2020 2020 2020 2020  ile'....        
-000393a0: 7365 6c66 2e66 5f6d 6574 686f 643d 6469  self.f_method=di
-000393b0: 635f 6661 6369 6573 5b22 665f 6d65 7468  c_facies["f_meth
-000393c0: 6f64 225d 0d0a 2020 2020 2020 2020 2320  od"]..        # 
-000393d0: 6368 6563 6b20 696d 706f 7274 616e 7420  check important 
-000393e0: 696e 7075 7420 666f 7220 6661 6369 6573  input for facies
-000393f0: 206d 6574 686f 6473 0d0a 2020 2020 2020   methods..      
-00039400: 2020 234d 5053 0d0a 2020 2020 2020 2020    #MPS..        
-00039410: 6966 2073 656c 662e 665f 6d65 7468 6f64  if self.f_method
-00039420: 203d 3d20 224d 5053 223a 0d0a 2020 2020   == "MPS":..    
-00039430: 2020 2020 2020 2020 6966 2022 5449 2220          if "TI" 
-00039440: 6e6f 7420 696e 2064 6963 5f66 6163 6965  not in dic_facie
-00039450: 732e 6b65 7973 2829 3a0d 0a20 2020 2020  s.keys():..     
-00039460: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00039470: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
-00039480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039490: 2070 7269 6e74 2822 5741 524e 494e 4720   print("WARNING 
-000394a0: 4e4f 2054 4920 5041 5353 4544 2046 4f52  NO TI PASSED FOR
-000394b0: 204d 5053 2053 494d 554c 4154 494f 4e22   MPS SIMULATION"
-000394c0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-000394d0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000394e0: 2020 2020 2020 7365 6c66 2e73 6574 5f66        self.set_f
-000394f0: 5f54 4928 6469 635f 6661 6369 6573 5b22  _TI(dic_facies["
-00039500: 5449 225d 290d 0a0d 0a20 2020 2020 2020  TI"])....       
-00039510: 2023 5375 6270 696c 650d 0a20 2020 2020   #Subpile..     
-00039520: 2020 2065 6c69 6620 7365 6c66 2e66 5f6d     elif self.f_m
-00039530: 6574 686f 6420 3d3d 2022 5375 6250 696c  ethod == "SubPil
-00039540: 6522 3a0d 0a20 2020 2020 2020 2020 2020  e":..           
-00039550: 2069 6620 2253 7562 5069 6c65 2220 6e6f   if "SubPile" no
-00039560: 7420 696e 2064 6963 5f66 6163 6965 732e  t in dic_facies.
-00039570: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
-00039580: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00039590: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
-000395a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000395b0: 7269 6e74 2822 4e6f 2053 7562 5069 6c65  rint("No SubPile
-000395c0: 2070 6173 7365 6420 666f 7220 5375 6250   passed for SubP
-000395d0: 696c 6520 6669 6c6c 696e 672c 2063 6f6e  ile filling, con
-000395e0: 7369 6465 7220 6164 6469 6e67 206f 6e65  sider adding one
-000395f0: 2077 6974 6820 7365 745f 5375 6250 696c   with set_SubPil
-00039600: 6528 2920 6265 666f 7265 2070 726f 6365  e() before proce
-00039610: 6564 696e 6722 290d 0a20 2020 2020 2020  eding")..       
-00039620: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00039630: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00039640: 2e73 6574 5f53 7562 5069 6c65 2864 6963  .set_SubPile(dic
-00039650: 5f66 6163 6965 735b 2253 7562 5069 6c65  _facies["SubPile
-00039660: 225d 290d 0a0d 0a20 2020 2020 2020 2020  "])....         
-00039670: 2020 2069 6620 2275 6e69 7473 5f66 696c     if "units_fil
-00039680: 6c5f 6d65 7468 6f64 2220 696e 2064 6963  l_method" in dic
-00039690: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
-000396a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000396b0: 2069 6620 6469 635f 6661 6369 6573 5b22   if dic_facies["
-000396c0: 756e 6974 735f 6669 6c6c 5f6d 6574 686f  units_fill_metho
-000396d0: 6422 5d20 3d3d 2022 5349 5322 3a0d 0a20  d"] == "SIS":.. 
-000396e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000396f0: 2020 2073 656c 662e 7365 745f 665f 636f     self.set_f_co
-00039700: 766d 6f64 656c 7328 6469 635f 6661 6369  vmodels(dic_faci
-00039710: 6573 5b22 665f 636f 766d 6f64 656c 225d  es["f_covmodel"]
-00039720: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00039730: 2020 2020 2065 6c69 6620 6469 635f 6661       elif dic_fa
-00039740: 6369 6573 5b22 756e 6974 735f 6669 6c6c  cies["units_fill
-00039750: 5f6d 6574 686f 6422 5d20 3d3d 2022 4d50  _method"] == "MP
-00039760: 5322 3a0d 0a20 2020 2020 2020 2020 2020  S":..           
-00039770: 2020 2020 2020 2020 2069 6620 2254 4922           if "TI"
-00039780: 206e 6f74 2069 6e20 6469 635f 6661 6369   not in dic_faci
-00039790: 6573 2e6b 6579 7328 293a 0d0a 2020 2020  es.keys():..    
-000397a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000397b0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-000397c0: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
-000397d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000397e0: 2020 7072 696e 7428 2257 4152 4e49 4e47    print("WARNING
-000397f0: 204e 4f20 5449 2050 4153 5345 4420 464f   NO TI PASSED FO
-00039800: 5220 4d50 5320 5349 4d55 4c41 5449 4f4e  R MPS SIMULATION
-00039810: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00039820: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00039830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039840: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
-00039850: 665f 5449 2864 6963 5f66 6163 6965 735b  f_TI(dic_facies[
-00039860: 2254 4922 5d29 0d0a 0d0a 2020 2020 2020  "TI"])....      
-00039870: 2020 2020 2020 2020 2020 656c 6966 2064            elif d
-00039880: 6963 5f66 6163 6965 735b 2275 6e69 7473  ic_facies["units
-00039890: 5f66 696c 6c5f 6d65 7468 6f64 225d 203d  _fill_method"] =
-000398a0: 3d20 2254 5047 7322 3a0d 0a20 2020 2020  = "TPGs":..     
-000398b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000398c0: 6620 2246 6c61 6722 2069 6e20 6469 635f  f "Flag" in dic_
-000398d0: 6661 6369 6573 2e6b 6579 7328 293a 0d0a  facies.keys():..
-000398e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000398f0: 2020 2020 2020 2020 7365 6c66 2e66 6c61          self.fla
-00039900: 6720 3d20 6469 635f 6661 6369 6573 5b22  g = dic_facies["
-00039910: 466c 6167 225d 0d0a 2020 2020 2020 2020  Flag"]..        
-00039920: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-00039930: 475f 636d 2220 696e 2064 6963 5f66 6163  G_cm" in dic_fac
-00039940: 6965 732e 6b65 7973 2829 3a0d 0a20 2020  ies.keys():..   
-00039950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039960: 2020 2020 2073 656c 662e 475f 636d 203d       self.G_cm =
-00039970: 2064 6963 5f66 6163 6965 735b 2247 5f63   dic_facies["G_c
-00039980: 6d22 5d0d 0a0d 0a20 2020 2020 2020 2020  m"]....         
-00039990: 2020 2023 2054 4f20 434f 4d50 4c45 5445     # TO COMPLETE
-000399a0: 0d0a 0d0a 2020 2020 2020 2020 2354 7275  ....        #Tru
-000399b0: 6e63 6174 6564 2050 6c75 7269 6761 7573  ncated Plurigaus
-000399c0: 7369 616e 7320 4352 4541 5445 2043 4845  sians CREATE CHE
-000399d0: 434b 2046 554e 4354 494f 4e53 2054 4f20  CK FUNCTIONS TO 
-000399e0: 444f 0d0a 2020 2020 2020 2020 656c 6966  DO..        elif
-000399f0: 2073 656c 662e 665f 6d65 7468 6f64 203d   self.f_method =
-00039a00: 3d20 2254 5047 7322 3a0d 0a20 2020 2020  = "TPGs":..     
-00039a10: 2020 2020 2020 2023 6173 7365 7274 0d0a         #assert..
-00039a20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00039a30: 2e66 6c61 673d 6469 635f 6661 6369 6573  .flag=dic_facies
-00039a40: 5b22 466c 6167 225d 0d0a 2020 2020 2020  ["Flag"]..      
-00039a50: 2020 2020 2020 7365 6c66 2e47 5f63 6d3d        self.G_cm=
-00039a60: 6469 635f 6661 6369 6573 5b22 475f 636d  dic_facies["G_cm
-00039a70: 225d 0d0a 0d0a 2020 2020 2020 2020 2353  "]....        #S
-00039a80: 4953 0d0a 2020 2020 2020 2020 656c 6966  IS..        elif
-00039a90: 2073 656c 662e 665f 6d65 7468 6f64 203d   self.f_method =
-00039aa0: 3d20 2253 4953 223a 0d0a 2020 2020 2020  = "SIS":..      
-00039ab0: 2020 2020 2020 6966 2022 665f 636f 766d        if "f_covm
-00039ac0: 6f64 656c 2220 6e6f 7420 696e 2064 6963  odel" not in dic
-00039ad0: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
-00039ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039af0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-00039b00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00039b10: 2020 2020 2020 2070 7269 6e74 2822 556e         print("Un
-00039b20: 6974 207b 7d3a 2057 4152 4e49 4e47 204e  it {}: WARNING N
-00039b30: 4f20 434f 564d 4f44 454c 5320 5041 5353  O COVMODELS PASS
-00039b40: 4544 2046 4f52 2053 4953 2053 494d 554c  ED FOR SIS SIMUL
-00039b50: 4154 494f 4e22 2e66 6f72 6d61 7428 7365  ATION".format(se
-00039b60: 6c66 2e6e 616d 6529 290d 0a20 2020 2020  lf.name))..     
-00039b70: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00039b80: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00039b90: 6c66 2e73 6574 5f66 5f63 6f76 6d6f 6465  lf.set_f_covmode
-00039ba0: 6c73 2864 6963 5f66 6163 6965 735b 2266  ls(dic_facies["f
-00039bb0: 5f63 6f76 6d6f 6465 6c22 5d29 0d0a 0d0a  _covmodel"])....
-00039bc0: 2020 2020 2020 2020 7365 6c66 2e64 6963          self.dic
-00039bd0: 5f66 6163 6965 733d 6469 635f 6661 6369  _facies=dic_faci
-00039be0: 6573 0d0a 0d0a 0d0a 2020 2020 2323 206d  es......    ## m
-00039bf0: 6167 6963 2066 756e 0d0a 2020 2020 6465  agic fun..    de
-00039c00: 6620 5f5f 7265 7072 5f5f 2873 656c 6629  f __repr__(self)
-00039c10: 3a0d 0a20 2020 2020 2020 2073 3d73 656c  :..        s=sel
-00039c20: 662e 6e61 6d65 0d0a 2020 2020 2020 2020  f.name..        
-00039c30: 7265 7475 726e 2073 0d0a 0d0a 2020 2020  return s....    
-00039c40: 6465 6620 5f5f 6361 6c6c 5f5f 2873 656c  def __call__(sel
-00039c50: 6629 3a0d 0a20 2020 2020 2020 2072 6574  f):..        ret
-00039c60: 7572 6e20 7072 696e 7428 2255 6e69 7420  urn print("Unit 
-00039c70: 7b7d 222e 666f 726d 6174 2873 656c 662e  {}".format(self.
-00039c80: 6e61 6d65 2929 0d0a 0d0a 2020 2020 6465  name))....    de
-00039c90: 6620 5f5f 6571 5f5f 2873 656c 662c 206f  f __eq__(self, o
-00039ca0: 7468 6572 293a 0d0a 2020 2020 2020 2020  ther):..        
-00039cb0: 2222 220d 0a20 2020 2020 2020 2066 6f72  """..        for
-00039cc0: 2063 6f6d 7061 7269 736f 6e0d 0a20 2020   comparison..   
-00039cd0: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-00039ce0: 2020 2020 6966 206f 7468 6572 2069 7320      if other is 
-00039cf0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-00039d00: 2020 2020 2020 2069 6620 2873 656c 662e         if (self.
-00039d10: 6e61 6d65 203d 3d20 6f74 6865 722e 6e61  name == other.na
-00039d20: 6d65 2920 2620 2873 656c 662e 6f72 6465  me) & (self.orde
-00039d30: 7220 3d3d 206f 7468 6572 2e6f 7264 6572  r == other.order
-00039d40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00039d50: 2020 2020 7265 7475 726e 2054 7275 650d      return True.
-00039d60: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00039d70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00039d80: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-00039d90: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00039da0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00039db0: 7572 6e20 4661 6c73 650d 0a0d 0a20 2020  urn False....   
-00039dc0: 2064 6566 205f 5f69 745f 5f28 7365 6c66   def __it__(self
-00039dd0: 2c20 6f74 6865 7229 3a20 2320 696e 6571  , other): # ineq
-00039de0: 7561 6c69 7479 2063 6f6d 7061 7269 736f  uality compariso
-00039df0: 6e0d 0a20 2020 2020 2020 2069 6620 2873  n..        if (s
-00039e00: 656c 662e 6f72 6465 7220 3c20 6f74 6865  elf.order < othe
-00039e10: 722e 6f72 6465 7229 3a0d 0a20 2020 2020  r.order):..     
-00039e20: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00039e30: 7565 0d0a 2020 2020 2020 2020 656c 7365  ue..        else
-00039e40: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00039e50: 6574 7572 6e20 4661 6c73 650d 0a0d 0a20  eturn False.... 
-00039e60: 2020 2064 6566 205f 5f67 745f 5f28 7365     def __gt__(se
-00039e70: 6c66 2c20 6f74 6865 7229 3a20 2320 696e  lf, other): # in
-00039e80: 6571 7561 6c69 7479 2063 6f6d 7061 7269  equality compari
-00039e90: 736f 6e0d 0a20 2020 2020 2020 2069 6620  son..        if 
-00039ea0: 2873 656c 662e 6f72 6465 7220 3e20 6f74  (self.order > ot
-00039eb0: 6865 722e 6f72 6465 7229 3a0d 0a20 2020  her.order):..   
-00039ec0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00039ed0: 5472 7565 0d0a 2020 2020 2020 2020 656c  True..        el
-00039ee0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00039ef0: 2072 6574 7572 6e20 4661 6c73 650d 0a0d   return False...
-00039f00: 0a20 2020 2064 6566 205f 5f73 7472 5f5f  .    def __str__
-00039f10: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00039f20: 2072 6574 7572 6e20 7365 6c66 2e6e 616d   return self.nam
-00039f30: 650d 0a0d 0a20 2020 2023 636f 7079 2066  e....    #copy f
-00039f40: 756e 0d0a 2020 2020 6465 6620 636f 7079  un..    def copy
-00039f50: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00039f60: 2072 6574 7572 6e20 636f 7079 2e64 6565   return copy.dee
-00039f70: 7063 6f70 7928 7365 6c66 290d 0a0d 0a20  pcopy(self).... 
-00039f80: 2020 2064 6566 2073 6574 5f53 7562 5069     def set_SubPi
-00039f90: 6c65 2873 656c 662c 2053 7562 5069 6c65  le(self, SubPile
-00039fa0: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
-00039fb0: 220d 0a20 2020 2020 2020 2043 6861 6e67  "..        Chang
-00039fc0: 6520 6f72 2064 6566 696e 6520 6120 7375  e or define a su
-00039fd0: 6270 696c 6520 666f 7220 6669 6c6c 696e  bpile for fillin
-00039fe0: 670d 0a0d 0a20 2020 2020 2020 2050 6172  g....        Par
-00039ff0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0003a000: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0003a010: 2020 2020 2053 7562 5069 6c65 203a 203a       SubPile : :
-0003a020: 636c 6173 733a 6050 696c 6560 206f 626a  class:`Pile` obj
-0003a030: 6563 7409 0d0a 2020 2020 2020 2020 2222  ect...        ""
-0003a040: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
-0003a050: 6973 696e 7374 616e 6365 2853 7562 5069  isinstance(SubPi
-0003a060: 6c65 2c20 5069 6c65 293a 0d0a 2020 2020  le, Pile):..    
-0003a070: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0003a080: 665f 6d65 7468 6f64 203d 3d20 2253 7562  f_method == "Sub
-0003a090: 5069 6c65 223a 0d0a 2020 2020 2020 2020  Pile":..        
-0003a0a0: 2020 2020 2020 2020 7365 6c66 2e53 7562          self.Sub
-0003a0b0: 5069 6c65 3d53 7562 5069 6c65 0d0a 2020  Pile=SubPile..  
-0003a0c0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0003a0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a0e0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-0003a0f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003a100: 2020 2020 2020 2070 7269 6e74 2822 5265         print("Re
-0003a110: 616c 6c79 203f 2046 696c 6c69 6e67 206d  ally ? Filling m
-0003a120: 6574 686f 6420 6973 206e 6f74 2053 7562  ethod is not Sub
-0003a130: 5069 6c65 2229 0d0a 2020 2020 2020 2020  Pile")..        
-0003a140: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0003a150: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-0003a160: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0003a170: 2020 2020 2070 7269 6e74 2822 5468 6520       print("The 
-0003a180: 5375 6250 696c 6520 6f62 6a65 6374 2069  SubPile object i
-0003a190: 7320 6e6f 7420 616e 2041 7263 685f 7461  s not an Arch_ta
-0003a1a0: 626c 6520 6f62 6a65 6374 2229 0d0a 0d0a  ble object")....
-0003a1b0: 2020 2020 6465 6620 7365 745f 665f 5449      def set_f_TI
-0003a1c0: 2873 656c 662c 2054 4929 3a0d 0a0d 0a20  (self, TI):.... 
-0003a1d0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-0003a1e0: 2020 2020 4368 616e 6765 2074 7261 696e      Change train
-0003a1f0: 696e 6720 696d 6167 6520 666f 7220 6120  ing image for a 
-0003a200: 7374 7261 7469 2075 6e69 740d 0a0d 0a20  strati unit.... 
-0003a210: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0003a220: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0003a230: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2054  -----..        T
-0003a240: 493a 2067 656f 6e65 2e69 6d61 6765 0d0a  I: geone.image..
-0003a250: 2020 2020 2020 2020 2020 2020 5472 6169              Trai
-0003a260: 6e69 6e67 2069 6d61 6765 2074 6f20 7573  ning image to us
-0003a270: 6520 7769 7468 2074 6865 204d 5053 0d0a  e with the MPS..
-0003a280: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-0003a290: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0003a2a0: 616e 6365 2854 492c 2067 656f 6e65 2e69  ance(TI, geone.i
-0003a2b0: 6d67 2e49 6d67 293a 0d0a 2020 2020 2020  mg.Img):..      
-0003a2c0: 2020 2020 2020 7365 6c66 2e66 5f54 493d        self.f_TI=
-0003a2d0: 5449 0d0a 2020 2020 2020 2020 2020 2020  TI..            
-0003a2e0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-0003a2f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003a300: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
-0003a310: 3a20 5449 2061 6464 6564 222e 666f 726d  : TI added".form
-0003a320: 6174 2873 656c 662e 6e61 6d65 2929 0d0a  at(self.name))..
-0003a330: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0003a340: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0003a350: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
-0003a360: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0003a370: 6e74 2822 5449 204e 4f54 2041 2047 454f  nt("TI NOT A GEO
-0003a380: 4e45 2049 4d41 4745 2229 0d0a 0d0a 2020  NE IMAGE")....  
-0003a390: 2020 6465 6620 7365 745f 5375 7266 6163    def set_Surfac
-0003a3a0: 6528 7365 6c66 2c20 7375 7266 6163 6529  e(self, surface)
-0003a3b0: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-0003a3c0: 0d0a 2020 2020 2020 2020 4368 616e 6765  ..        Change
-0003a3d0: 206f 7220 6164 6420 6120 746f 7020 7375   or add a top su
-0003a3e0: 7266 6163 6520 666f 7220 556e 6974 206f  rface for Unit o
-0003a3f0: 626a 6563 742e 0d0a 2020 2020 2020 2020  bject...        
-0003a400: 5468 6973 2077 696c 6c20 6465 6669 6e65  This will define
-0003a410: 2068 6f77 2074 6865 2074 6f70 206f 6620   how the top of 
-0003a420: 7468 6520 666f 726d 6174 696f 6e20 7769  the formation wi
-0003a430: 6c6c 2062 6520 6d6f 6465 6c6c 6564 2e0d  ll be modelled..
-0003a440: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0003a450: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0003a460: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0003a470: 2020 2073 7572 6661 6365 3a20 3a63 6c61     surface: :cla
-0003a480: 7373 3a60 5375 7266 6163 6560 206f 626a  ss:`Surface` obj
-0003a490: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
-0003a4a0: 2053 7572 6661 6365 206f 626a 6563 7420   Surface object 
-0003a4b0: 746f 2075 7365 2066 6f72 2074 6865 2073  to use for the s
-0003a4c0: 696d 756c 6174 696f 6e20 6f66 2074 6865  imulation of the
-0003a4d0: 2074 6f70 206f 6620 7468 6520 666f 726d   top of the form
-0003a4e0: 6174 696f 6e0d 0a20 2020 2020 2020 2022  ation..        "
-0003a4f0: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
-0003a500: 2069 7369 6e73 7461 6e63 6528 7375 7266   isinstance(surf
-0003a510: 6163 652c 2053 7572 6661 6365 293a 0d0a  ace, Surface):..
-0003a520: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003a530: 2e73 7572 6661 6365 3d73 7572 6661 6365  .surface=surface
-0003a540: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003a550: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-0003a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a570: 7072 696e 7428 2255 6e69 7420 7b7d 3a20  print("Unit {}: 
-0003a580: 5375 7266 6163 6520 6164 6465 6420 666f  Surface added fo
-0003a590: 7220 696e 7465 7270 6f6c 6174 696f 6e22  r interpolation"
-0003a5a0: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
-0003a5b0: 6529 290d 0a20 2020 2020 2020 2065 6c73  e))..        els
-0003a5c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0003a5d0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0003a5e0: 2822 5375 7266 6163 6520 6f62 6a65 6374  ("Surface object
-0003a5f0: 206d 7573 7420 6265 2061 6e20 6f62 6a65   must be an obje
-0003a600: 6374 206f 6620 7468 6520 636c 6173 7320  ct of the class 
-0003a610: 5375 7266 6163 6520 6672 6f6d 2041 7263  Surface from Arc
-0003a620: 6850 7922 290d 0a0d 0a20 2020 2064 6566  hPy")....    def
-0003a630: 2073 6574 5f66 5f63 6f76 6d6f 6465 6c73   set_f_covmodels
-0003a640: 2873 656c 662c 2066 5f63 6f76 6d6f 6465  (self, f_covmode
-0003a650: 6c29 3a0d 0a0d 0a20 2020 2020 2020 2022  l):....        "
-0003a660: 2222 0d0a 2020 2020 2020 2020 5265 6d6f  ""..        Remo
-0003a670: 7665 2065 7869 7374 696e 6720 6661 6369  ve existing faci
-0003a680: 6573 2063 6f76 6d6f 6465 6c73 2061 6e64  es covmodels and
-0003a690: 206f 6e65 206f 7220 6d6f 7265 0d0a 2020   one or more..  
-0003a6a0: 2020 2020 2020 6465 7065 6e64 696e 6720        depending 
-0003a6b0: 6f66 2077 6861 7420 6973 2070 6173 7365  of what is passe
-0003a6c0: 6420 2861 7272 6179 206c 696b 6520 6f72  d (array like or
-0003a6d0: 206f 6e6c 7920 6f6e 6520 6f62 6a65 6374   only one object
-0003a6e0: 290d 0a0d 0a20 2020 2020 2020 2050 6172  )....        Par
-0003a6f0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0003a700: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a20   ----------.... 
-0003a710: 2020 2020 2020 2066 5f63 6f76 6d6f 6465         f_covmode
-0003a720: 6c3a 2067 656f 6e65 2e63 6f76 4d6f 6465  l: geone.covMode
-0003a730: 6c20 6f62 6a65 6374 200d 0a20 2020 2020  l object ..     
-0003a740: 2020 2020 2020 2074 6861 7420 7769 6c6c         that will
-0003a750: 2062 6520 7573 6564 2066 6f72 2074 6865   be used for the
-0003a760: 2069 6e74 6572 706f 6c61 7469 6f6e 206f   interpolation o
-0003a770: 6620 7468 6520 6661 6369 6573 2069 6620  f the facies if 
-0003a780: 6d65 7468 6f64 2069 7320 5349 532e 0d0a  method is SIS...
-0003a790: 2020 2020 2020 2020 2020 2020 4361 6e20              Can 
-0003a7a0: 6265 2061 206c 6973 7420 6f72 206f 6e6c  be a list or onl
-0003a7b0: 7920 6f6e 6520 6f62 6a65 6374 2e0d 0a20  y one object... 
-0003a7c0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-0003a7d0: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
-0003a7e0: 665f 636f 766d 6f64 656c 3d5b 5d0d 0a20  f_covmodel=[].. 
-0003a7f0: 2020 2020 2020 2063 6f76 6d6f 6465 6c73         covmodels
-0003a800: 5f63 6c61 7373 3d28 6765 6f6e 652e 636f  _class=(geone.co
-0003a810: 764d 6f64 656c 2e43 6f76 4d6f 6465 6c33  vModel.CovModel3
-0003a820: 4429 0d0a 2020 2020 2020 2020 7472 793a  D)..        try:
-0003a830: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0003a840: 7220 636f 766d 6f64 656c 2069 6e20 665f  r covmodel in f_
-0003a850: 636f 766d 6f64 656c 3a0d 0a20 2020 2020  covmodel:..     
-0003a860: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0003a870: 696e 7374 616e 6365 2863 6f76 6d6f 6465  instance(covmode
-0003a880: 6c2c 2063 6f76 6d6f 6465 6c73 5f63 6c61  l, covmodels_cla
-0003a890: 7373 293a 0d0a 2020 2020 2020 2020 2020  ss):..          
-0003a8a0: 2020 2020 2020 2020 2020 663d 310d 0a20            f=1.. 
-0003a8b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003a8c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0003a8d0: 2020 2020 2020 2020 2020 663d 300d 0a20            f=0.. 
-0003a8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a8f0: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
-0003a900: 2020 2020 2020 6966 2066 3a0d 0a20 2020        if f:..   
-0003a910: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0003a920: 662e 6c69 7374 5f66 5f63 6f76 6d6f 6465  f.list_f_covmode
-0003a930: 6c3d 665f 636f 766d 6f64 656c 0d0a 0d0a  l=f_covmodel....
-0003a940: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003a950: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003a960: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-0003a970: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0003a980: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-0003a990: 6174 206c 6561 7374 206f 6e65 2063 6f76  at least one cov
-0003a9a0: 6d6f 6465 6c20 6973 206e 6f74 2061 2033  model is not a 3
-0003a9b0: 4420 636f 766d 6f64 656c 2067 656f 6e65  D covmodel geone
-0003a9c0: 2c20 6e6f 7468 696e 6720 6861 7320 6368  , nothing has ch
-0003a9d0: 616e 6765 6422 290d 0a0d 0a20 2020 2020  anged")....     
-0003a9e0: 2020 2065 7863 6570 743a 2023 206f 6e6c     except: # onl
-0003a9f0: 7920 6f6e 6520 6f62 6a65 6374 2070 6173  y one object pas
-0003aa00: 7365 640d 0a20 2020 2020 2020 2020 2020  sed..           
-0003aa10: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
-0003aa20: 5f63 6f76 6d6f 6465 6c2c 2063 6f76 6d6f  _covmodel, covmo
-0003aa30: 6465 6c73 5f63 6c61 7373 293a 0d0a 2020  dels_class):..  
-0003aa40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0003aa50: 6c66 2e6c 6973 745f 665f 636f 766d 6f64  lf.list_f_covmod
-0003aa60: 656c 2e61 7070 656e 6428 665f 636f 766d  el.append(f_covm
-0003aa70: 6f64 656c 290d 0a20 2020 2020 2020 2020  odel)..         
-0003aa80: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-0003aa90: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-0003aaa0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0003aab0: 6e74 2822 556e 6974 207b 7d3a 2063 6f76  nt("Unit {}: cov
-0003aac0: 6d6f 6465 6c20 666f 7220 5349 5320 6164  model for SIS ad
-0003aad0: 6465 6422 2e66 6f72 6d61 7428 7365 6c66  ded".format(self
-0003aae0: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
-0003aaf0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0003ab00: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0003ab10: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-0003ab20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ab30: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
-0003ab40: 3a20 636f 766d 6f64 656c 206e 6f74 2061  : covmodel not a
-0003ab50: 2067 656f 6e65 2033 4420 636f 766d 6f64   geone 3D covmod
-0003ab60: 656c 222e 666f 726d 6174 2873 656c 662e  el".format(self.
-0003ab70: 6e61 6d65 2929 0d0a 0d0a 2020 2020 6465  name))....    de
-0003ab80: 6620 6765 745f 685f 6c65 7665 6c28 7365  f get_h_level(se
-0003ab90: 6c66 293a 0d0a 0d0a 2020 2020 2020 2020  lf):....        
-0003aba0: 2222 220d 0a20 2020 2020 2020 2052 6574  """..        Ret
-0003abb0: 7572 6e20 6869 6572 6172 6368 6963 616c  urn hierarchical
-0003abc0: 206c 6576 656c 206f 6620 7468 6520 756e   level of the un
-0003abd0: 6974 0d0a 2020 2020 2020 2020 2222 220d  it..        """.
-0003abe0: 0a0d 0a20 2020 2020 2020 2064 6566 2066  ...        def f
-0003abf0: 756e 6328 756e 6974 2c20 685f 6c65 7629  unc(unit, h_lev)
-0003ac00: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0003ac10: 6620 756e 6974 2e6d 756d 6d79 5f75 6e69  f unit.mummy_uni
-0003ac20: 7420 6973 206e 6f74 204e 6f6e 653a 0d0a  t is not None:..
-0003ac30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ac40: 685f 6c65 7620 2b3d 2031 0d0a 2020 2020  h_lev += 1..    
-0003ac50: 2020 2020 2020 2020 2020 2020 685f 6c65              h_le
-0003ac60: 763d 6675 6e63 2875 6e69 742e 6d75 6d6d  v=func(unit.mumm
-0003ac70: 795f 756e 6974 2c20 685f 6c65 7629 0d0a  y_unit, h_lev)..
-0003ac80: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0003ac90: 7475 726e 2068 5f6c 6576 0d0a 2020 2020  turn h_lev..    
-0003aca0: 2020 2020 685f 6c65 763d 310d 0a20 2020      h_lev=1..   
-0003acb0: 2020 2020 2068 5f6c 6576 3d66 756e 6328       h_lev=func(
-0003acc0: 7365 6c66 2c20 685f 6c65 7629 0d0a 2020  self, h_lev)..  
-0003acd0: 2020 2020 2020 7265 7475 726e 2068 5f6c        return h_l
-0003ace0: 6576 0d0a 0d0a 2020 2020 6465 6620 676f  ev....    def go
-0003acf0: 6573 5f75 705f 756e 7469 6c28 7365 6c66  es_up_until(self
-0003ad00: 2c20 756e 6974 5f74 6172 6765 7429 3a0d  , unit_target):.
-0003ad10: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0003ad20: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0003ad30: 436c 696d 6220 7468 6520 6869 6572 6172  Climb the hierar
-0003ad40: 6368 6963 616c 2074 7265 6520 6f66 2073  chical tree of s
-0003ad50: 656c 6620 756e 6974 2075 6e74 696c 2066  elf unit until f
-0003ad60: 696e 6469 6e67 2061 2073 7065 6369 6669  inding a specifi
-0003ad70: 6320 756e 6974 2061 6e64 2072 6574 7572  c unit and retur
-0003ad80: 6e20 6974 0d0a 0d0a 2020 2020 2020 2020  n it....        
-0003ad90: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-0003ada0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-0003adb0: 2020 2020 2020 2020 756e 6974 5f74 6172          unit_tar
-0003adc0: 6765 743a 203a 636c 6173 733a 6055 6e69  get: :class:`Uni
-0003add0: 7460 206f 626a 6563 740d 0a20 2020 2020  t` object..     
-0003ade0: 2020 2020 2020 2055 6e69 7420 6f62 6a65         Unit obje
-0003adf0: 6374 2074 6f20 6669 6e64 2069 6e20 7468  ct to find in th
-0003ae00: 6520 6869 6572 6172 6368 6963 616c 2074  e hierarchical t
-0003ae10: 7265 650d 0a0d 0a20 2020 2020 2020 2052  ree....        R
-0003ae20: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0003ae30: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0003ae40: 2075 6e69 743a 203a 636c 6173 733a 6055   unit: :class:`U
-0003ae50: 6e69 7460 206f 626a 6563 7420 6f72 204e  nit` object or N
-0003ae60: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
-0003ae70: 2055 6e69 7420 6f62 6a65 6374 2066 6f75   Unit object fou
-0003ae80: 6e64 2069 6e20 7468 6520 6869 6572 6172  nd in the hierar
-0003ae90: 6368 6963 616c 2074 7265 650d 0a20 2020  chical tree..   
-0003aea0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0003aeb0: 666f 756e 642c 2072 6574 7572 6e20 4e6f  found, return No
-0003aec0: 6e65 0d0a 2020 2020 2020 2020 2222 220d  ne..        """.
-0003aed0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0003aee0: 2020 2075 6e69 7420 3d20 7365 6c66 0d0a     unit = self..
-0003aef0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0003af00: 2072 616e 6765 2873 656c 662e 6765 745f   range(self.get_
-0003af10: 685f 6c65 7665 6c28 2929 3a0d 0a20 2020  h_level()):..   
-0003af20: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0003af30: 2020 2020 2020 2069 6620 756e 6974 2021         if unit !
-0003af40: 3d20 756e 6974 5f74 6172 6765 743a 0d0a  = unit_target:..
-0003af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003af60: 756e 6974 203d 2075 6e69 742e 6d75 6d6d  unit = unit.mumm
-0003af70: 795f 756e 6974 0d0a 2020 2020 2020 2020  y_unit..        
-0003af80: 2020 2020 2020 2020 6966 2075 6e69 7420          if unit 
-0003af90: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-0003afa0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0003afb0: 7475 726e 204e 6f6e 650d 0a20 2020 2020  turn None..     
-0003afc0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0003afd0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0003afe0: 7475 726e 2075 6e69 740d 0a20 2020 2020  turn unit..     
-0003aff0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0003b000: 2072 6574 7572 6e20 756e 6974 0d0a 0d0a   return unit....
-0003b010: 2020 2020 6465 6620 6765 745f 6269 675f      def get_big_
-0003b020: 6d75 6d6d 795f 756e 6974 2873 656c 6629  mummy_unit(self)
-0003b030: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-0003b040: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0003b050: 206c 6f77 6573 7420 756e 6974 2028 6d61   lowest unit (ma
-0003b060: 696e 2075 6e69 7429 2069 6e20 6869 6572  in unit) in hier
-0003b070: 6172 6368 6963 616c 206f 7264 6572 0d0a  archical order..
-0003b080: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-0003b090: 2020 2020 2020 2075 6e69 7420 3d20 7365         unit = se
-0003b0a0: 6c66 0d0a 2020 2020 2020 2020 666f 7220  lf..        for 
-0003b0b0: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
-0003b0c0: 6765 745f 685f 6c65 7665 6c28 2929 3a0d  get_h_level()):.
-0003b0d0: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-0003b0e0: 6620 756e 6974 2e6d 756d 6d79 5f75 6e69  f unit.mummy_uni
-0003b0f0: 7420 6973 206e 6f74 204e 6f6e 653a 0d0a  t is not None:..
-0003b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b110: 756e 6974 203d 2075 6e69 742e 6d75 6d6d  unit = unit.mumm
-0003b120: 795f 756e 6974 0d0a 2020 2020 2020 2020  y_unit..        
-0003b130: 2020 2020 0d0a 2020 2020 2020 2020 7265      ..        re
-0003b140: 7475 726e 2075 6e69 740d 0a0d 0a0d 0a20  turn unit...... 
-0003b150: 2020 2064 6566 2067 6574 5f62 6162 795f     def get_baby_
-0003b160: 756e 6974 7328 7365 6c66 2c20 7265 636f  units(self, reco
-0003b170: 6d70 7574 653d 4661 6c73 652c 2076 623d  mpute=False, vb=
-0003b180: 3129 3a0d 0a0d 0a0d 0a20 2020 2020 2020  1):......       
-0003b190: 2022 2222 0d0a 2020 2020 2020 2020 4d65   """..        Me
-0003b1a0: 7468 6f64 2074 6f20 7265 7475 726e 2061  thod to return a
-0003b1b0: 6c6c 2075 6e69 7473 2074 6861 7420 6172  ll units that ar
-0003b1c0: 6520 756e 6465 7220 7468 6520 6375 7272  e under the curr
-0003b1d0: 656e 7420 756e 6974 2069 6e20 7468 6520  ent unit in the 
-0003b1e0: 6869 6572 6172 6368 790d 0a0d 0a20 2020  hierarchy....   
-0003b1f0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0003b200: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0003b210: 2d2d 2d0d 0a20 2020 2020 2020 2072 6563  ---..        rec
-0003b220: 6f6d 7075 7465 3a20 626f 6f6c 0d0a 2020  ompute: bool..  
-0003b230: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-0003b240: 652c 2072 6563 6f6d 7075 7465 2074 6865  e, recompute the
-0003b250: 206c 6973 7420 6f66 2075 6e69 7473 2069   list of units i
-0003b260: 6620 7468 6572 6520 6861 6420 6265 656e  f there had been
-0003b270: 206d 6f64 6966 6963 6174 696f 6e73 2069   modifications i
-0003b280: 6e20 7468 6520 6869 6572 6172 6368 790d  n the hierarchy.
-0003b290: 0a20 2020 2020 2020 2076 623a 2069 6e74  .        vb: int
-0003b2a0: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
-0003b2b0: 7262 6f73 6974 7920 6c65 7665 6c2c 2030  rbosity level, 0
-0003b2c0: 2066 6f72 206e 6f20 7072 696e 742c 2031   for no print, 1
-0003b2d0: 2066 6f72 2070 7269 6e74 0d0a 0d0a 2020   for print....  
-0003b2e0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0003b2f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0003b300: 2020 2020 2020 2020 6c69 7374 0d0a 2020          list..  
-0003b310: 2020 2020 2020 6c69 7374 206f 6620 6368        list of ch
-0003b320: 696c 6473 203a 636c 6173 733a 6055 6e69  ilds :class:`Uni
-0003b330: 7460 206f 626a 6563 7473 206f 6620 7468  t` objects of th
-0003b340: 6520 6375 7272 656e 7420 756e 6974 0d0a  e current unit..
-0003b350: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-0003b360: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0003b370: 2069 6620 7365 6c66 2e53 7562 5069 6c65   if self.SubPile
-0003b380: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-0003b390: 2020 2020 2020 2069 6620 7662 3a0d 0a20         if vb:.. 
-0003b3a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003b3b0: 7269 6e74 2822 556e 6974 2068 6173 206e  rint("Unit has n
-0003b3c0: 6f20 6869 6572 6172 6368 7922 290d 0a20  o hierarchy").. 
-0003b3d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0003b3e0: 6e20 5b5d 0d0a 0d0a 2020 2020 2020 2020  n []....        
-0003b3f0: 6966 2072 6563 6f6d 7075 7465 3a0d 0a20  if recompute:.. 
-0003b400: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003b410: 6262 5f75 6e69 7473 203d 205b 5d0d 0a0d  bb_units = []...
-0003b420: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
-0003b430: 2066 756e 2875 6e69 7429 3a0d 0a0d 0a20   fun(unit):.... 
-0003b440: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003b450: 6620 756e 6974 2e53 7562 5069 6c65 2069  f unit.SubPile i
-0003b460: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0003b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b480: 206c 3d75 6e69 742e 5375 6250 696c 652e   l=unit.SubPile.
-0003b490: 6c69 7374 5f75 6e69 7473 0d0a 2020 2020  list_units..    
-0003b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b4b0: 7365 6c66 2e62 625f 756e 6974 7320 2b3d  self.bb_units +=
-0003b4c0: 206c 0d0a 0d0a 2020 2020 2020 2020 2020   l....          
-0003b4d0: 2020 2020 2020 2020 2020 666f 7220 756e            for un
-0003b4e0: 6974 2069 6e20 6c3a 0d0a 2020 2020 2020  it in l:..      
+000365c0: 2020 2020 2020 2020 6966 206c 6974 686f          if litho
+000365d0: 2e73 7572 6661 6365 2e64 6963 5f73 7572  .surface.dic_sur
+000365e0: 665b 2274 6869 636b 6e65 7373 225d 2069  f["thickness"] i
+000365f0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+00036600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036610: 2020 2020 2020 2020 206c 6974 686f 2e73           litho.s
+00036620: 7572 6661 6365 2e64 6963 5f73 7572 665b  urface.dic_surf[
+00036630: 226d 6561 6e22 5d20 3d20 4e6f 6e65 0d0a  "mean"] = None..
+00036640: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00036650: 2020 656e 643d 7469 6d65 2e74 696d 6528    end=time.time(
+00036660: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00036670: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
+00036680: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00036690: 7269 6e74 2822 7b7d 3a20 7469 6d65 2065  rint("{}: time e
+000366a0: 6c61 7073 6564 2066 6f72 2063 6f6d 7075  lapsed for compu
+000366b0: 7469 6e67 2073 7572 6661 6365 207b 7d20  ting surface {} 
+000366c0: 7322 2e66 6f72 6d61 7428 6c69 7468 6f2e  s".format(litho.
+000366d0: 6e61 6d65 2c20 2865 6e64 202d 2073 7461  name, (end - sta
+000366e0: 7274 2929 290d 0a0d 0a20 2020 2020 2020  rt)))....       
+000366f0: 2020 2020 2020 2020 2023 2320 6966 206e           ## if n
+00036700: 616e 2069 6e73 6964 6520 7468 6520 646f  an inside the do
+00036710: 6d61 696e 2028 6e6f 6e20 7369 6d75 6c61  main (non simula
+00036720: 7465 6420 6172 6561 2920 2d2d 3e20 7365  ted area) --> se
+00036730: 7420 7661 6c75 6573 2066 726f 6d20 7375  t values from su
+00036740: 7266 6163 6520 6265 6c6f 770d 0a20 2020  rface below..   
+00036750: 2020 2020 2020 2020 2020 2020 206d 6173               mas
+00036760: 6b5f 6e61 6e20 3d20 6e70 2e7a 6572 6f73  k_nan = np.zeros
+00036770: 285b 6e79 2c20 6e78 5d2c 2064 7479 7065  ([ny, nx], dtype
+00036780: 3d62 6f6f 6c29 0d0a 2020 2020 2020 2020  =bool)..        
+00036790: 2020 2020 2020 2020 6d61 736b 5f6e 616e          mask_nan
+000367a0: 5b6d 6173 6b32 445d 203d 206e 702e 6973  [mask2D] = np.is
+000367b0: 6e61 6e28 7331 5b6d 6173 6b32 445d 290d  nan(s1[mask2D]).
+000367c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000367d0: 2069 6620 6d61 736b 5f6e 616e 2e61 6e79   if mask_nan.any
+000367e0: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+000367f0: 2020 2020 2020 2020 2069 6620 6920 3e20           if i > 
+00036800: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+00036810: 2020 2020 2020 2020 2020 2020 7331 5b6d              s1[m
+00036820: 6173 6b5f 6e61 6e5d 203d 206f 7267 5f73  ask_nan] = org_s
+00036830: 7572 6673 5b69 7265 616c 2c20 286e 6c61  urfs[ireal, (nla
+00036840: 792d 3129 2d69 2b31 5d5b 6d61 736b 5f6e  y-1)-i+1][mask_n
+00036850: 616e 5d0d 0a20 2020 2020 2020 2020 2020  an]..           
+00036860: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00036870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036880: 2020 2020 2020 2020 7331 5b6d 6173 6b5f          s1[mask_
+00036890: 6e61 6e5d 203d 2062 6f74 5b6d 6173 6b5f  nan] = bot[mask_
+000368a0: 6e61 6e5d 0d0a 0d0a 2020 2020 2020 2020  nan]....        
+000368b0: 2020 2020 2020 2020 6f72 675f 7375 7266          org_surf
+000368c0: 735b 6972 6561 6c2c 2028 6e6c 6179 2d31  s[ireal, (nlay-1
+000368d0: 292d 695d 3d73 312e 636f 7079 2829 0d0a  )-i]=s1.copy()..
+000368e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000368f0: 2020 2320 6164 6170 7420 616c 7469 7475    # adapt altitu
+00036900: 6465 2069 6620 6162 6f76 652f 6265 6c6f  de if above/belo
+00036910: 7720 746f 702f 626f 740d 0a20 2020 2020  w top/bot..     
+00036920: 2020 2020 2020 2020 2020 2073 315b 7331             s1[s1
+00036930: 3e74 6f70 5d3d 746f 705b 7331 3e74 6f70  >top]=top[s1>top
+00036940: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00036950: 2020 2073 315b 7331 3c62 6f74 5d3d 626f     s1[s1<bot]=bo
+00036960: 745b 7331 3c62 6f74 5d0d 0a0d 0a20 2020  t[s1<bot]....   
+00036970: 2020 2020 2020 2020 2020 2020 2023 7374               #st
+00036980: 7261 7469 2063 6f6e 7369 7374 656e 6379  rati consistency
+00036990: 2061 6e64 2065 726f 7369 6f6e 2072 756c   and erosion rul
+000369a0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
+000369b0: 2020 2020 6966 2069 203e 2030 3a0d 0a20      if i > 0:.. 
+000369c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000369d0: 2020 2066 6f72 206f 2069 6e20 7261 6e67     for o in rang
+000369e0: 6528 6929 3a20 2320 696e 6465 7820 666f  e(i): # index fo
+000369f0: 7220 6368 6563 6b69 6e67 2061 6c72 6561  r checking alrea
+00036a00: 6479 2073 696d 756c 6174 6564 2073 7572  dy simulated sur
+00036a10: 6661 6365 730d 0a20 2020 2020 2020 2020  faces..         
+00036a20: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00036a30: 6974 686f 323d 7365 6c66 2e6c 6973 745f  itho2=self.list_
+00036a40: 756e 6974 735b 3a3a 202d 315d 5b6f 5d0d  units[:: -1][o].
+00036a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036a60: 2020 2020 2020 2020 2073 323d 7375 7266           s2=surf
+00036a70: 735b 6972 6561 6c2c 2028 6e6c 6179 2d31  s[ireal, (nlay-1
+00036a80: 292d 6f5d 2023 6964 7820 6672 6f6d 206e  )-o] #idx from n
+00036a90: 6c61 792d 3120 746f 206e 6c61 792d 692d  lay-1 to nlay-i-
+00036aa0: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
+00036ab0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
+00036ac0: 7468 6f20 213d 206c 6974 686f 323a 0d0a  tho != litho2:..
+00036ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ae0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+00036af0: 6c69 7468 6f2e 6f72 6465 7220 3c20 6c69  litho.order < li
+00036b00: 7468 6f32 2e6f 7264 6572 2920 2620 286c  tho2.order) & (l
+00036b10: 6974 686f 2e73 7572 6661 6365 2e63 6f6e  itho.surface.con
+00036b20: 7461 6374 203d 3d20 226f 6e6c 6170 2229  tact == "onlap")
+00036b30: 3a20 2320 7369 2063 6f75 6368 6520 7369  : # si couche si
+00036b40: 6d75 6cc3 a965 2073 7570 2065 7420 6f6e  mul..e sup et on
+00036b50: 6c61 700d 0a20 2020 2020 2020 2020 2020  lap..           
+00036b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b70: 2020 2020 2073 315b 7331 203c 2073 325d       s1[s1 < s2]
+00036b80: 3d73 325b 7331 203c 2073 325d 0d0a 2020  =s2[s1 < s2]..  
+00036b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ba0: 2020 2020 2020 2020 2020 656c 6966 2028            elif (
+00036bb0: 6c69 7468 6f2e 6f72 6465 7220 3c20 6c69  litho.order < li
+00036bc0: 7468 6f32 2e6f 7264 6572 2920 2620 286c  tho2.order) & (l
+00036bd0: 6974 686f 2e73 7572 6661 6365 2e63 6f6e  itho.surface.con
+00036be0: 7461 6374 203d 3d20 2265 726f 6465 2229  tact == "erode")
+00036bf0: 3a20 2320 7369 2063 6f75 6368 6520 7369  : # si couche si
+00036c00: 6d75 6cc3 a965 20c3 a972 6f64 6520 756e  mul..e ..rode un
+00036c10: 6520 616e 6369 656e 6e65 0d0a 2020 2020  e ancienne..    
+00036c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c30: 2020 2020 2020 2020 2020 2020 7332 5b73              s2[s
+00036c40: 3220 3e20 7331 5d3d 7331 5b73 3220 3e20  2 > s1]=s1[s2 > 
+00036c50: 7331 5d0d 0a20 2020 2020 2020 2020 2020  s1]..           
+00036c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c70: 2020 2020 2069 6620 6f20 3d3d 2069 2d31       if o == i-1
+00036c80: 2061 6e64 206c 6974 686f 2e63 6f6e 7461   and litho.conta
+00036c90: 6374 203d 3d20 2265 726f 6465 223a 2023  ct == "erode": #
+00036ca0: 2069 6620 696e 6465 7820 226f 2220 6973   if index "o" is
+00036cb0: 2075 6e64 6572 6c79 696e 6720 6c61 7965   underlying laye
+00036cc0: 720d 0a20 2020 2020 2020 2020 2020 2020  r..             
+00036cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ce0: 2020 2020 2020 2073 315b 7331 203e 2073         s1[s1 > s
+00036cf0: 325d 3d73 325b 7331 203e 2073 325d 2023  2]=s2[s1 > s2] #
+00036d00: 2070 7265 7665 6e74 2065 726f 7369 6f6e   prevent erosion
+00036d10: 206c 6179 6572 7320 6861 7669 6e67 2076   layers having v
+00036d20: 6f6c 756d 650d 0a0d 0a20 2020 2020 2020  olume....       
+00036d30: 2020 2020 2020 2020 2073 7572 6673 5b69           surfs[i
+00036d40: 7265 616c 2c20 286e 6c61 792d 3129 2d69  real, (nlay-1)-i
+00036d50: 5d3d 7331 2020 2361 6464 2073 7572 6661  ]=s1  #add surfa
+00036d60: 6365 0d0a 0d0a 2020 2020 2020 2020 2020  ce....          
+00036d70: 2020 2363 6f6d 7075 7465 2064 6f6d 6169    #compute domai
+00036d80: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
+00036d90: 7374 6172 743d 7469 6d65 2e74 696d 6528  start=time.time(
+00036da0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00036db0: 7572 6673 5f69 723d 7375 7266 735b 6972  urfs_ir=surfs[ir
+00036dc0: 6561 6c5d 0d0a 0d0a 2020 2020 2020 2020  eal]....        
+00036dd0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00036de0: 6765 2873 7572 6673 5f69 722e 7368 6170  ge(surfs_ir.shap
+00036df0: 655b 305d 293a 0d0a 2020 2020 2020 2020  e[0]):..        
+00036e00: 2020 2020 2020 2020 6966 2069 203c 2073          if i < s
+00036e10: 7572 6673 5f69 722e 7368 6170 655b 305d  urfs_ir.shape[0]
+00036e20: 2d31 3a0d 0a20 2020 2020 2020 2020 2020  -1:..           
+00036e30: 2020 2020 2020 2020 2073 5f62 6f74 3d73           s_bot=s
+00036e40: 7572 6673 5f69 725b 692b 315d 2023 2062  urfs_ir[i+1] # b
+00036e50: 6f74 746f 6d0d 0a20 2020 2020 2020 2020  ottom..         
+00036e60: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00036e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e80: 2020 735f 626f 743d 626f 740d 0a20 2020    s_bot=bot..   
+00036e90: 2020 2020 2020 2020 2020 2020 2073 5f74               s_t
+00036ea0: 6f70 3d73 7572 6673 5f69 725b 695d 2023  op=surfs_ir[i] #
+00036eb0: 2074 6f70 0d0a 2020 2020 2020 2020 2020   top..          
+00036ec0: 2020 2020 2020 613d 4172 6368 5461 626c        a=ArchTabl
+00036ed0: 652e 636f 6d70 7574 655f 646f 6d61 696e  e.compute_domain
+00036ee0: 2873 5f74 6f70 2c20 735f 626f 7429 0d0a  (s_top, s_bot)..
+00036ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036f00: 7265 616c 5f64 6f6d 6169 6e73 5b69 7265  real_domains[ire
+00036f10: 616c 2c20 695d 3d61 2a6d 6173 6b2a 7365  al, i]=a*mask*se
+00036f20: 6c66 2e6c 6973 745f 756e 6974 735b 695d  lf.list_units[i]
+00036f30: 2e49 440d 0a20 2020 2020 2020 2020 2020  .ID..           
+00036f40: 2020 2020 2073 7572 6673 5f62 6f74 5b69       surfs_bot[i
+00036f50: 7265 616c 2c20 695d 3d73 5f62 6f74 0d0a  real, i]=s_bot..
+00036f60: 0d0a 2020 2020 2020 2020 2020 2020 656e  ..            en
+00036f70: 643d 7469 6d65 2e74 696d 6528 290d 0a20  d=time.time().. 
+00036f80: 2020 2020 2020 2020 2020 2069 6620 7662             if vb
+00036f90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00036fa0: 2020 2070 7269 6e74 2822 5c6e 5469 6d65     print("\nTime
+00036fb0: 2065 6c61 7073 6564 2066 6f72 2067 6574   elapsed for get
+00036fc0: 7469 6e67 2064 6f6d 6169 6e73 207b 7d20  ting domains {} 
+00036fd0: 7322 2e66 6f72 6d61 7428 2865 6e64 202d  s".format((end -
+00036fe0: 2073 7461 7274 2929 290d 0a0d 0a20 2020   start)))....   
+00036ff0: 2020 2020 2023 6f6e 6c79 2031 2062 6967       #only 1 big
+00037000: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
+00037010: 613d 6e70 2e73 756d 2872 6561 6c5f 646f  a=np.sum(real_do
+00037020: 6d61 696e 732c 2061 7869 733d 3129 0d0a  mains, axis=1)..
+00037030: 2020 2020 2020 2020 4172 6368 5461 626c          ArchTabl
+00037040: 652e 4765 6f6c 2e75 6e69 7473 5f64 6f6d  e.Geol.units_dom
+00037050: 6169 6e73 5b61 2021 3d20 305d 3d61 5b61  ains[a != 0]=a[a
+00037060: 2021 3d20 305d 0d0a 2020 2020 2020 2020   != 0]..        
+00037070: 4172 6368 5461 626c 652e 4765 6f6c 2e73  ArchTable.Geol.s
+00037080: 7572 6661 6365 735f 6279 5f70 696c 6573  urfaces_by_piles
+00037090: 5b73 656c 662e 6e61 6d65 5d3d 7375 7266  [self.name]=surf
+000370a0: 730d 0a20 2020 2020 2020 2041 7263 6854  s..        ArchT
+000370b0: 6162 6c65 2e47 656f 6c2e 7375 7266 6163  able.Geol.surfac
+000370c0: 6573 5f62 6f74 5f62 795f 7069 6c65 735b  es_bot_by_piles[
+000370d0: 7365 6c66 2e6e 616d 655d 3d73 7572 6673  self.name]=surfs
+000370e0: 5f62 6f74 0d0a 2020 2020 2020 2020 4172  _bot..        Ar
+000370f0: 6368 5461 626c 652e 4765 6f6c 2e6f 7267  chTable.Geol.org
+00037100: 5f73 7572 6661 6365 735f 6279 5f70 696c  _surfaces_by_pil
+00037110: 6573 5b73 656c 662e 6e61 6d65 5d3d 6f72  es[self.name]=or
+00037120: 675f 7375 7266 730d 0a0d 0a20 2020 2020  g_surfs....     
+00037130: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
+00037140: 2020 2020 2020 2070 7269 6e74 2822 2323         print("##
+00037150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00037160: 2323 2323 2323 2323 5c6e 2229 0d0a 0d0a  ########\n")....
+00037170: 2020 2020 6465 6620 6465 6669 6e65 5f64      def define_d
+00037180: 6f6d 6169 6e73 2873 656c 662c 2041 7263  omains(self, Arc
+00037190: 6854 6162 6c65 2c20 7375 7266 6163 6573  hTable, surfaces
+000371a0: 2c20 746f 7073 3d4e 6f6e 652c 2062 6f74  , tops=None, bot
+000371b0: 733d 4e6f 6e65 2c20 7375 6270 696c 653d  s=None, subpile=
+000371c0: 4661 6c73 652c 2076 623d 302c 2066 6c5f  False, vb=0, fl_
+000371d0: 746f 703d 5472 7565 293a 0d0a 0d0a 2020  top=True):....  
+000371e0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+000371f0: 2020 2044 6566 696e 6520 756e 6974 7320     Define units 
+00037200: 646f 6d61 696e 7320 6672 6f6d 2070 7265  domains from pre
+00037210: 636f 6d70 7574 6564 2073 7572 6661 6365  computed surface
+00037220: 732e 0d0a 2020 2020 2020 2020 5468 6973  s...        This
+00037230: 206d 6574 686f 6420 6973 2075 7365 6420   method is used 
+00037240: 7768 656e 2074 6865 2073 7572 6661 6365  when the surface
+00037250: 7320 6172 6520 7072 6563 6f6d 7075 7465  s are precompute
+00037260: 6420 2865 2e67 2e20 6672 6f6d 2061 2070  d (e.g. from a p
+00037270: 7265 7669 6f75 7320 7369 6d75 6c61 7469  revious simulati
+00037280: 6f6e 2920 0d0a 2020 2020 2020 2020 696e  on) ..        in
+00037290: 2070 6c61 6365 2074 6f20 7468 6520 636f   place to the co
+000372a0: 6d70 7574 655f 7375 7266 6163 6573 206d  mpute_surfaces m
+000372b0: 6574 686f 642e 0d0a 0d0a 2020 2020 2020  ethod.....      
+000372c0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+000372d0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000372e0: 0d0a 2020 2020 2020 2020 4172 6368 5461  ..        ArchTa
+000372f0: 626c 6520 3a20 3a63 6c61 7373 3a60 4172  ble : :class:`Ar
+00037300: 6368 5f74 6162 6c65 600d 0a20 2020 2020  ch_table`..     
+00037310: 2020 2020 2020 2041 7263 6854 6162 6c65         ArchTable
+00037320: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+00037330: 2073 7572 6661 6365 7320 3a20 6172 7261   surfaces : arra
+00037340: 790d 0a20 2020 2020 2020 2020 2020 2061  y..            a
+00037350: 7272 6179 206f 6620 7375 7266 6163 6573  rray of surfaces
+00037360: 2028 6e72 6561 6c2c 206e 6c61 792c 206e   (nreal, nlay, n
+00037370: 792c 206e 7829 0d0a 2020 2020 2020 2020  y, nx)..        
+00037380: 746f 7073 203a 2061 7272 6179 0d0a 2020  tops : array..  
+00037390: 2020 2020 2020 2020 2020 6172 7261 7920            array 
+000373a0: 6f66 2074 6f70 2065 6c65 7661 7469 6f6e  of top elevation
+000373b0: 7320 286e 792c 206e 7829 0d0a 2020 2020  s (ny, nx)..    
+000373c0: 2020 2020 626f 7473 203a 2061 7272 6179      bots : array
+000373d0: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+000373e0: 7261 7920 6f66 2062 6f74 746f 6d20 656c  ray of bottom el
+000373f0: 6576 6174 696f 6e73 2028 6e79 2c20 6e78  evations (ny, nx
+00037400: 290d 0a20 2020 2020 2020 2073 7562 7069  )..        subpi
+00037410: 6c65 203a 2062 6f6f 6c0d 0a20 2020 2020  le : bool..     
+00037420: 2020 2020 2020 2069 6620 7468 6520 7069         if the pi
+00037430: 6c65 2069 7320 6120 7375 6270 696c 652c  le is a subpile,
+00037440: 2069 2e65 2e20 6966 2054 7275 652c 2074   i.e. if True, t
+00037450: 6865 2074 6f70 2061 6e64 2062 6f74 746f  he top and botto
+00037460: 6d20 6f66 2074 6865 2070 696c 6520 6172  m of the pile ar
+00037470: 6520 6e6f 7420 7573 6564 0d0a 2020 2020  e not used..    
+00037480: 2020 2020 7662 203a 2069 6e74 0d0a 2020      vb : int..  
+00037490: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
+000374a0: 6974 7920 6c65 7665 6c2c 2030 2069 7320  ity level, 0 is 
+000374b0: 7369 6c65 6e74 2c20 3120 6973 2076 6572  silent, 1 is ver
+000374c0: 626f 7365 0d0a 2020 2020 2020 2020 666c  bose..        fl
+000374d0: 5f74 6f70 203a 2062 6f6f 6c0d 0a20 2020  _top : bool..   
+000374e0: 2020 2020 2020 2020 2069 6620 5472 7565           if True
+000374f0: 2c20 7468 6520 746f 7020 6f66 2074 6865  , the top of the
+00037500: 2070 696c 6520 6973 2075 7365 6420 746f   pile is used to
+00037510: 2064 6566 696e 6520 7468 6520 746f 7020   define the top 
+00037520: 6f66 2074 6865 2066 6972 7374 2075 6e69  of the first uni
+00037530: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+00037540: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00037550: 2073 7572 6661 6365 732e 7368 6170 655b   surfaces.shape[
+00037560: 315d 203d 3d20 6c65 6e28 7365 6c66 2e6c  1] == len(self.l
+00037570: 6973 745f 756e 6974 7329 2c20 2274 6865  ist_units), "the
+00037580: 206e 756d 6265 7220 6f66 2073 7572 6661   number of surfa
+00037590: 6365 7320 7b7d 2070 726f 7669 6465 6420  ces {} provided 
+000375a0: 6973 206e 6f74 2065 7175 616c 2074 6f20  is not equal to 
+000375b0: 7468 6520 6e75 6d62 6572 206f 6620 756e  the number of un
+000375c0: 6974 7320 7b7d 222e 666f 726d 6174 2873  its {}".format(s
+000375d0: 7572 6661 6365 732e 7368 6170 655b 315d  urfaces.shape[1]
+000375e0: 2c20 6c65 6e28 7365 6c66 2e6c 6973 745f  , len(self.list_
+000375f0: 756e 6974 7329 290d 0a0d 0a20 2020 2020  units))....     
+00037600: 2020 2023 206e 7265 616c 0d0a 2020 2020     # nreal..    
+00037610: 2020 2020 6e72 6561 6c3d 7375 7266 6163      nreal=surfac
+00037620: 6573 2e73 6861 7065 5b30 5d0d 0a0d 0a20  es.shape[0].... 
+00037630: 2020 2020 2020 2041 7263 6854 6162 6c65         ArchTable
+00037640: 2e6e 7265 616c 5f75 6e69 7473 3d6e 7265  .nreal_units=nre
+00037650: 616c 2020 2320 7374 6f72 6520 6e75 6d62  al  # store numb
+00037660: 6572 206f 6620 7265 616c 697a 6174 696f  er of realizatio
+00037670: 6e73 0d0a 0d0a 2020 2020 2020 2020 2373  ns....        #s
+00037680: 696d 756c 6174 696f 6e20 6772 6964 0d0a  imulation grid..
+00037690: 2020 2020 2020 2020 7867 3d41 7263 6854          xg=ArchT
+000376a0: 6162 6c65 2e67 6574 5f78 6763 2829 0d0a  able.get_xgc()..
+000376b0: 2020 2020 2020 2020 6e78 3d78 672e 7368          nx=xg.sh
+000376c0: 6170 655b 305d 0d0a 2020 2020 2020 2020  ape[0]..        
+000376d0: 7967 3d41 7263 6854 6162 6c65 2e67 6574  yg=ArchTable.get
+000376e0: 5f79 6763 2829 0d0a 2020 2020 2020 2020  _ygc()..        
+000376f0: 6e79 3d79 672e 7368 6170 655b 305d 0d0a  ny=yg.shape[0]..
+00037700: 2020 2020 2020 2020 7a67 3d41 7263 6854          zg=ArchT
+00037710: 6162 6c65 2e67 6574 5f7a 6728 290d 0a20  able.get_zg().. 
+00037720: 2020 2020 2020 206e 7a3d 7a67 2e73 6861         nz=zg.sha
+00037730: 7065 5b30 5d20 2d20 310d 0a20 2020 2020  pe[0] - 1..     
+00037740: 2020 2069 6620 7e73 7562 7069 6c65 3a0d     if ~subpile:.
+00037750: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
+00037760: 3d41 7263 6854 6162 6c65 2e74 6f70 0d0a  =ArchTable.top..
+00037770: 2020 2020 2020 2020 2020 2020 626f 743d              bot=
+00037780: 4172 6368 5461 626c 652e 626f 740d 0a20  ArchTable.bot.. 
+00037790: 2020 2020 2020 206d 6173 6b3d 4172 6368         mask=Arch
+000377a0: 5461 626c 652e 6d61 736b 0d0a 2020 2020  Table.mask..    
+000377b0: 2020 2020 6e6c 6179 3d6c 656e 2873 656c      nlay=len(sel
+000377c0: 662e 6c69 7374 5f75 6e69 7473 290d 0a0d  f.list_units)...
+000377d0: 0a20 2020 2020 2020 2023 6d61 6b65 2073  .        #make s
+000377e0: 7572 6520 746f 2068 6176 6520 6f72 6465  ure to have orde
+000377f0: 7265 6420 6c69 7468 6f6c 6f67 6965 730d  red lithologies.
+00037800: 0a20 2020 2020 2020 2073 656c 662e 6f72  .        self.or
+00037810: 6465 725f 756e 6974 7328 7662 3d76 6229  der_units(vb=vb)
+00037820: 0d0a 0d0a 2020 2020 2020 2020 2323 2320  ....        ### 
+00037830: 696e 6974 6961 6c69 7a65 2073 7572 6661  initialize surfa
+00037840: 6365 7320 6279 2073 6574 7469 6e67 2074  ces by setting t
+00037850: 6f20 300d 0a0d 0a20 2020 2020 2020 2073  o 0....        s
+00037860: 7572 6673 3d6e 702e 7a65 726f 7328 5b6e  urfs=np.zeros([n
+00037870: 7265 616c 2c20 6e6c 6179 2c20 6e79 2c20  real, nlay, ny, 
+00037880: 6e78 5d29 0d0a 2020 2020 2020 2020 7375  nx])..        su
+00037890: 7266 735f 626f 743d 6e70 2e7a 6572 6f73  rfs_bot=np.zeros
+000378a0: 285b 6e72 6561 6c2c 206e 6c61 792c 206e  ([nreal, nlay, n
+000378b0: 792c 206e 785d 290d 0a20 2020 2020 2020  y, nx])..       
+000378c0: 206f 7267 5f73 7572 6673 3d73 7572 6661   org_surfs=surfa
+000378d0: 6365 730d 0a20 2020 2020 2020 2072 6561  ces..        rea
+000378e0: 6c5f 646f 6d61 696e 733d 6e70 2e7a 6572  l_domains=np.zer
+000378f0: 6f73 285b 6e72 6561 6c2c 206e 6c61 792c  os([nreal, nlay,
+00037900: 206e 7a2c 206e 792c 206e 785d 290d 0a0d   nz, ny, nx])...
+00037910: 0a20 2020 2020 2020 2066 6f72 2069 7265  .        for ire
+00037920: 616c 2069 6e20 7261 6e67 6528 6e72 6561  al in range(nrea
+00037930: 6c29 3a20 2320 6c6f 6f70 206f 7665 7220  l): # loop over 
+00037940: 7265 616c 0d0a 0d0a 2020 2020 2020 2020  real....        
+00037950: 2020 2020 2374 6f70 2f62 6f74 0d0a 2020      #top/bot..  
+00037960: 2020 2020 2020 2020 2020 6966 2073 7562            if sub
+00037970: 7069 6c65 3a0d 0a20 2020 2020 2020 2020  pile:..         
+00037980: 2020 2020 2020 2074 6f70 3d74 6f70 735b         top=tops[
+00037990: 6972 6561 6c5d 0d0a 2020 2020 2020 2020  ireal]..        
+000379a0: 2020 2020 2020 2020 626f 743d 626f 7473          bot=bots
+000379b0: 5b69 7265 616c 5d0d 0a0d 0a20 2020 2020  [ireal]....     
+000379c0: 2020 2020 2020 2023 2063 6f75 6e74 6572         # counter
+000379d0: 2066 6f72 2063 7572 7265 6e74 2073 696d   for current sim
+000379e0: 756c 6174 6564 2073 7572 6661 6365 0d0a  ulated surface..
+000379f0: 2020 2020 2020 2020 2020 2020 693d 2d31              i=-1
+00037a00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00037a10: 666f 7220 6c69 7468 6f20 696e 2073 656c  for litho in sel
+00037a20: 662e 6c69 7374 5f75 6e69 7473 5b3a 3a20  f.list_units[:: 
+00037a30: 2d31 5d3a 0d0a 0d0a 2020 2020 2020 2020  -1]:....        
+00037a40: 2020 2020 2020 2020 6920 2b3d 2031 2020          i += 1  
+00037a50: 2320 696e 6465 7820 666f 7220 7369 6d75  # index for simu
+00037a60: 6c61 7465 6420 7375 7266 6163 650d 0a20  lated surface.. 
+00037a70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00037a80: 7461 7274 3d74 696d 652e 7469 6d65 2829  tart=time.time()
+00037a90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037aa0: 2020 6966 2028 666c 5f74 6f70 2920 616e    if (fl_top) an
+00037ab0: 6420 2869 203d 3d20 6e6c 6179 2d31 293a  d (i == nlay-1):
+00037ac0: 2023 2066 6972 7374 206c 6179 6572 2061   # first layer a
+00037ad0: 7373 6967 6e20 746f 2074 6f70 0d0a 2020  ssign to top..  
+00037ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037af0: 2020 7331 3d74 6f70 0d0a 2020 2020 2020    s1=top..      
+00037b00: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00037b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037b20: 2020 2020 2073 313d 6f72 675f 7375 7266       s1=org_surf
+00037b30: 735b 6972 6561 6c2c 2028 6e6c 6179 2d31  s[ireal, (nlay-1
+00037b40: 292d 695d 2e63 6f70 7928 290d 0a0d 0a20  )-i].copy().... 
+00037b50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00037b60: 2061 6461 7074 2061 6c74 6974 7564 6520   adapt altitude 
+00037b70: 6966 2061 626f 7665 2f62 656c 6f77 2074  if above/below t
+00037b80: 6f70 2f62 6f74 0d0a 2020 2020 2020 2020  op/bot..        
+00037b90: 2020 2020 2020 2020 7331 5b73 313e 746f          s1[s1>to
+00037ba0: 705d 3d74 6f70 5b73 313e 746f 705d 0d0a  p]=top[s1>top]..
+00037bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037bc0: 7331 5b73 313c 626f 745d 3d62 6f74 5b73  s1[s1<bot]=bot[s
+00037bd0: 313c 626f 745d 0d0a 0d0a 2020 2020 2020  1<bot]....      
+00037be0: 2020 2020 2020 2020 2020 2320 7374 7261            # stra
+00037bf0: 7469 2063 6f6e 7369 7374 656e 6379 2061  ti consistency a
+00037c00: 6e64 2065 726f 7369 6f6e 2072 756c 6573  nd erosion rules
+00037c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037c20: 2020 6966 2069 203e 2030 3a0d 0a20 2020    if i > 0:..   
+00037c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c40: 2066 6f72 206f 2069 6e20 7261 6e67 6528   for o in range(
+00037c50: 6929 3a20 2320 696e 6465 7820 666f 7220  i): # index for 
+00037c60: 6368 6563 6b69 6e67 2061 6c72 6561 6479  checking already
+00037c70: 2073 696d 756c 6174 6564 2073 7572 6661   simulated surfa
+00037c80: 6365 730d 0a20 2020 2020 2020 2020 2020  ces..           
+00037c90: 2020 2020 2020 2020 2020 2020 206c 6974               lit
+00037ca0: 686f 323d 7365 6c66 2e6c 6973 745f 756e  ho2=self.list_un
+00037cb0: 6974 735b 3a3a 202d 315d 5b6f 5d0d 0a20  its[:: -1][o].. 
+00037cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037cd0: 2020 2020 2020 2073 323d 7375 7266 735b         s2=surfs[
+00037ce0: 6972 6561 6c2c 2028 6e6c 6179 2d31 292d  ireal, (nlay-1)-
+00037cf0: 6f5d 2023 6964 7820 6672 6f6d 206e 6c61  o] #idx from nla
+00037d00: 792d 3120 746f 206e 6c61 792d 692d 310d  y-1 to nlay-i-1.
+00037d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037d20: 2020 2020 2020 2020 2069 6620 6c69 7468           if lith
+00037d30: 6f20 213d 206c 6974 686f 323a 0d0a 2020  o != litho2:..  
+00037d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d50: 2020 2020 2020 2020 2020 6966 2028 6c69            if (li
+00037d60: 7468 6f2e 6f72 6465 7220 3c20 6c69 7468  tho.order < lith
+00037d70: 6f32 2e6f 7264 6572 2920 2620 286c 6974  o2.order) & (lit
+00037d80: 686f 2e73 7572 6661 6365 2e63 6f6e 7461  ho.surface.conta
+00037d90: 6374 203d 3d20 226f 6e6c 6170 2229 3a20  ct == "onlap"): 
+00037da0: 2320 7369 2063 6f75 6368 6520 7369 6d75  # si couche simu
+00037db0: 6cc3 a965 2073 7570 2065 7420 6f6e 6c61  l..e sup et onla
+00037dc0: 700d 0a20 2020 2020 2020 2020 2020 2020  p..             
+00037dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037de0: 2020 2073 315b 7331 203c 2073 325d 3d73     s1[s1 < s2]=s
+00037df0: 325b 7331 203c 2073 325d 0d0a 2020 2020  2[s1 < s2]..    
+00037e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e10: 2020 2020 2020 2020 656c 6966 2028 6c69          elif (li
+00037e20: 7468 6f2e 6f72 6465 7220 3c20 6c69 7468  tho.order < lith
+00037e30: 6f32 2e6f 7264 6572 2920 2620 286c 6974  o2.order) & (lit
+00037e40: 686f 2e73 7572 6661 6365 2e63 6f6e 7461  ho.surface.conta
+00037e50: 6374 203d 3d20 2265 726f 6465 2229 3a20  ct == "erode"): 
+00037e60: 2320 7369 2063 6f75 6368 6520 7369 6d75  # si couche simu
+00037e70: 6cc3 a965 20c3 a972 6f64 6520 756e 6520  l..e ..rode une 
+00037e80: 616e 6369 656e 6e65 0d0a 2020 2020 2020  ancienne..      
+00037e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037ea0: 2020 2020 2020 2020 2020 7332 5b73 3220            s2[s2 
+00037eb0: 3e20 7331 5d3d 7331 5b73 3220 3e20 7331  > s1]=s1[s2 > s1
+00037ec0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00037ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037ee0: 2020 2069 6620 6f20 3d3d 2069 2d31 2061     if o == i-1 a
+00037ef0: 6e64 206c 6974 686f 2e63 6f6e 7461 6374  nd litho.contact
+00037f00: 203d 3d20 2265 726f 6465 223a 2023 2069   == "erode": # i
+00037f10: 6620 696e 6465 7820 226f 2220 6973 2075  f index "o" is u
+00037f20: 6e64 6572 6c79 696e 6720 6c61 7965 720d  nderlying layer.
+00037f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037f50: 2020 2020 2073 315b 7331 203e 2073 325d       s1[s1 > s2]
+00037f60: 3d73 325b 7331 203e 2073 325d 2023 2070  =s2[s1 > s2] # p
+00037f70: 7265 7665 6e74 2065 726f 7369 6f6e 206c  revent erosion l
+00037f80: 6179 6572 7320 6861 7669 6e67 2076 6f6c  ayers having vol
+00037f90: 756d 650d 0a0d 0a20 2020 2020 2020 2020  ume....         
+00037fa0: 2020 2020 2020 2073 7572 6673 5b69 7265         surfs[ire
+00037fb0: 616c 2c20 286e 6c61 792d 3129 2d69 5d3d  al, (nlay-1)-i]=
+00037fc0: 7331 2020 2361 6464 2073 7572 6661 6365  s1  #add surface
+00037fd0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00037fe0: 2363 6f6d 7075 7465 2064 6f6d 6169 6e73  #compute domains
+00037ff0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00038000: 7375 7266 735f 6972 3d73 7572 6673 5b69  surfs_ir=surfs[i
+00038010: 7265 616c 5d0d 0a0d 0a20 2020 2020 2020  real]....       
+00038020: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00038030: 6e67 6528 7375 7266 735f 6972 2e73 6861  nge(surfs_ir.sha
+00038040: 7065 5b30 5d29 3a0d 0a20 2020 2020 2020  pe[0]):..       
+00038050: 2020 2020 2020 2020 2069 6620 6920 3c20           if i < 
+00038060: 7375 7266 735f 6972 2e73 6861 7065 5b30  surfs_ir.shape[0
+00038070: 5d2d 313a 0d0a 2020 2020 2020 2020 2020  ]-1:..          
+00038080: 2020 2020 2020 2020 2020 735f 626f 743d            s_bot=
+00038090: 7375 7266 735f 6972 5b69 2b31 5d20 2320  surfs_ir[i+1] # 
+000380a0: 626f 7474 6f6d 0d0a 2020 2020 2020 2020  bottom..        
+000380b0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000380c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000380d0: 2020 2073 5f62 6f74 3d62 6f74 0d0a 2020     s_bot=bot..  
+000380e0: 2020 2020 2020 2020 2020 2020 2020 735f                s_
+000380f0: 746f 703d 7375 7266 735f 6972 5b69 5d20  top=surfs_ir[i] 
+00038100: 2320 746f 700d 0a20 2020 2020 2020 2020  # top..         
+00038110: 2020 2020 2020 2061 3d41 7263 6854 6162         a=ArchTab
+00038120: 6c65 2e63 6f6d 7075 7465 5f64 6f6d 6169  le.compute_domai
+00038130: 6e28 735f 746f 702c 2073 5f62 6f74 290d  n(s_top, s_bot).
+00038140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038150: 2072 6561 6c5f 646f 6d61 696e 735b 6972   real_domains[ir
+00038160: 6561 6c2c 2069 5d3d 612a 6d61 736b 2a73  eal, i]=a*mask*s
+00038170: 656c 662e 6c69 7374 5f75 6e69 7473 5b69  elf.list_units[i
+00038180: 5d2e 4944 0d0a 2020 2020 2020 2020 2020  ].ID..          
+00038190: 2020 2020 2020 7375 7266 735f 626f 745b        surfs_bot[
+000381a0: 6972 6561 6c2c 2069 5d3d 735f 626f 740d  ireal, i]=s_bot.
+000381b0: 0a0d 0a0d 0a20 2020 2020 2020 2023 6f6e  .....        #on
+000381c0: 6c79 2031 2062 6967 2061 7272 6179 0d0a  ly 1 big array..
+000381d0: 2020 2020 2020 2020 613d 6e70 2e73 756d          a=np.sum
+000381e0: 2872 6561 6c5f 646f 6d61 696e 732c 2061  (real_domains, a
+000381f0: 7869 733d 3129 0d0a 2020 2020 2020 2020  xis=1)..        
+00038200: 4172 6368 5461 626c 652e 4765 6f6c 2e75  ArchTable.Geol.u
+00038210: 6e69 7473 5f64 6f6d 6169 6e73 5b61 2021  nits_domains[a !
+00038220: 3d20 305d 3d61 5b61 2021 3d20 305d 0d0a  = 0]=a[a != 0]..
+00038230: 2020 2020 2020 2020 6465 6c28 7265 616c          del(real
+00038240: 5f64 6f6d 6169 6e73 290d 0a20 2020 2020  _domains)..     
+00038250: 2020 2041 7263 6854 6162 6c65 2e47 656f     ArchTable.Geo
+00038260: 6c2e 7375 7266 6163 6573 5f62 795f 7069  l.surfaces_by_pi
+00038270: 6c65 735b 7365 6c66 2e6e 616d 655d 3d73  les[self.name]=s
+00038280: 7572 6673 0d0a 2020 2020 2020 2020 4172  urfs..        Ar
+00038290: 6368 5461 626c 652e 4765 6f6c 2e73 7572  chTable.Geol.sur
+000382a0: 6661 6365 735f 626f 745f 6279 5f70 696c  faces_bot_by_pil
+000382b0: 6573 5b73 656c 662e 6e61 6d65 5d3d 7375  es[self.name]=su
+000382c0: 7266 735f 626f 740d 0a20 2020 2020 2020  rfs_bot..       
+000382d0: 2041 7263 6854 6162 6c65 2e47 656f 6c2e   ArchTable.Geol.
+000382e0: 6f72 675f 7375 7266 6163 6573 5f62 795f  org_surfaces_by_
+000382f0: 7069 6c65 735b 7365 6c66 2e6e 616d 655d  piles[self.name]
+00038300: 3d6f 7267 5f73 7572 6673 0d0a 0d0a 2020  =org_surfs....  
+00038310: 2020 2020 2020 6966 2076 623a 0d0a 2020        if vb:..  
+00038320: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00038330: 2223 2323 2323 2323 2323 2323 2323 2323  "###############
+00038340: 2323 2323 2323 2323 2323 235c 6e22 290d  ###########\n").
+00038350: 0a0d 0a0d 0a63 6c61 7373 2055 6e69 7428  .....class Unit(
+00038360: 293a 0d0a 0d0a 2020 2020 2222 220d 0a20  ):....    """.. 
+00038370: 2020 2054 6869 7320 636c 6173 7320 6465     This class de
+00038380: 6669 6e65 7320 556e 6974 206f 626a 6563  fines Unit objec
+00038390: 7473 2c20 7768 6963 6820 6172 6520 7468  ts, which are th
+000383a0: 6520 6275 696c 6469 6e67 2062 6c6f 636b  e building block
+000383b0: 7320 6f66 2074 6865 2050 696c 6520 636c  s of the Pile cl
+000383c0: 6173 732e 0d0a 0d0a 2020 2020 5061 7261  ass.....    Para
+000383d0: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
+000383e0: 2d2d 2d2d 2d2d 0d0a 2020 2020 6e61 6d65  ------..    name
+000383f0: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
+00038400: 2020 206e 616d 6520 6f66 2074 6865 2075     name of the u
+00038410: 6e69 7420 7468 6174 2077 696c 6c20 6265  nit that will be
+00038420: 2075 7365 6420 6173 2061 6e20 6964 656e   used as an iden
+00038430: 7469 6669 6572 0d0a 2020 2020 6f72 6465  tifier..    orde
+00038440: 7220 3a20 696e 740d 0a20 2020 2020 2020  r : int..       
+00038450: 206f 7264 6572 206f 6620 7468 6520 756e   order of the un
+00038460: 6974 2069 6e20 7468 6520 7069 6c65 2028  it in the pile (
+00038470: 3120 2874 6f70 2920 746f 206e 2028 626f  1 (top) to n (bo
+00038480: 7474 6f6d 292c 2077 6865 7265 206e 2069  ttom), where n i
+00038490: 7320 7468 6520 746f 7461 6c20 6e75 6d62  s the total numb
+000384a0: 6572 206f 6620 756e 6974 7329 0d0a 2020  er of units)..  
+000384b0: 2020 636f 6c6f 7220 3a20 7374 7269 6e67    color : string
+000384c0: 0d0a 2020 2020 2020 2020 636f 6c6f 7220  ..        color 
+000384d0: 746f 2075 7365 2066 6f72 2070 6c6f 7474  to use for plott
+000384e0: 696e 6720 616e 6420 7265 7072 6573 656e  ing and represen
+000384f0: 7461 7469 6f6e 2e0d 0a20 2020 2020 2020  tation...       
+00038500: 2054 6865 2063 6f6c 6f72 2063 616e 2062   The color can b
+00038510: 6520 616e 7920 636f 6c6f 7220 7468 6174  e any color that
+00038520: 2069 7320 6163 6365 7074 6564 2062 7920   is accepted by 
+00038530: 6d61 7470 6c6f 746c 6962 0d0a 2020 2020  matplotlib..    
+00038540: 7375 7266 6163 6520 3a20 3a63 6c61 7373  surface : :class
+00038550: 3a60 5375 7266 6163 6560 206f 626a 6563  :`Surface` objec
+00038560: 740d 0a20 2020 2020 2020 2073 7572 6661  t..        surfa
+00038570: 6365 206f 626a 6563 7420 7468 6174 2064  ce object that d
+00038580: 6566 696e 6573 2074 6865 2073 7572 6661  efines the surfa
+00038590: 6365 206f 6620 7468 6520 756e 6974 0d0a  ce of the unit..
+000385a0: 2020 2020 4944 203a 2069 6e74 0d0a 2020      ID : int..  
+000385b0: 2020 2020 2020 4944 206f 6620 7468 6520        ID of the 
+000385c0: 756e 6974 2c20 6966 204e 6f6e 652c 2074  unit, if None, t
+000385d0: 6865 2049 4420 7769 6c6c 2062 6520 7365  he ID will be se
+000385e0: 7420 746f 2074 6865 206f 7264 6572 206f  t to the order o
+000385f0: 6620 7468 6520 756e 6974 0d0a 2020 2020  f the unit..    
+00038600: 6469 635f 6661 6369 6573 203a 2064 6963  dic_facies : dic
+00038610: 740d 0a20 2020 2020 2020 2064 6963 7469  t..        dicti
+00038620: 6f6e 6172 7920 7468 6174 2064 6566 696e  onary that defin
+00038630: 6573 2074 6865 2066 6163 6965 7320 6f66  es the facies of
+00038640: 2074 6865 2075 6e69 742e 2054 6865 206d   the unit. The m
+00038650: 616e 6461 746f 7279 206b 6579 7320 666f  andatory keys fo
+00038660: 7220 7468 6520 6469 6374 696f 6e61 7279  r the dictionary
+00038670: 2061 7265 3a0d 0a0d 0a20 2020 2020 2020   are:....       
+00038680: 202d 2066 5f6d 6574 686f 6420 3a20 7374   - f_method : st
+00038690: 7269 6e67 2c20 7661 6c61 626c 6520 6d65  ring, valable me
+000386a0: 7468 6f64 2061 7265 3a20 0d0a 0d0a 2020  thod are: ....  
+000386b0: 2020 2020 2020 2020 2020 2d20 2268 6f6d            - "hom
+000386c0: 6f67 656e 6f75 7322 203a 2068 6f6d 6f67  ogenous" : homog
+000386d0: 656e 6f75 7320 6661 6369 6573 0d0a 2020  enous facies..  
+000386e0: 2020 2020 2020 2020 2020 2d20 2253 7562            - "Sub
+000386f0: 5069 6c65 2220 3a20 6661 6369 6573 2061  Pile" : facies a
+00038700: 7265 2073 696d 756c 6174 6564 2077 6974  re simulated wit
+00038710: 6820 6120 7375 6270 696c 650d 0a20 2020  h a subpile..   
+00038720: 2020 2020 2020 2020 202d 2022 5349 5322           - "SIS"
+00038730: 203a 2066 6163 6965 7320 6172 6520 7369   : facies are si
+00038740: 6d75 6c61 7465 6420 7769 7468 2073 746f  mulated with sto
+00038750: 6368 6173 7469 6320 696e 6469 6361 746f  chastic indicato
+00038760: 7220 7369 6d75 6c61 7469 6f6e 0d0a 2020  r simulation..  
+00038770: 2020 2020 2020 2020 2020 2d20 224d 5053            - "MPS
+00038780: 2220 3a20 6661 6369 6573 2061 7265 2073  " : facies are s
+00038790: 696d 756c 6174 6564 2077 6974 6820 4d75  imulated with Mu
+000387a0: 6c74 6970 6c65 2070 6f69 6e74 7320 7374  ltiple points st
+000387b0: 6174 6973 7469 6373 0d0a 2020 2020 2020  atistics..      
+000387c0: 2020 2020 2020 2d20 2254 5047 7322 3a20        - "TPGs": 
+000387d0: 6661 6369 6573 2061 7265 2073 696d 756c  facies are simul
+000387e0: 6174 6564 2077 6974 6820 5472 756e 6361  ated with Trunca
+000387f0: 7465 6420 706c 7572 692d 4761 7573 7369  ted pluri-Gaussi
+00038800: 616e 206d 6574 686f 640d 0a20 2020 2020  an method..     
+00038810: 2020 202d 2066 5f63 6f76 6d6f 6465 6c20     - f_covmodel 
+00038820: 3a20 3344 2067 656f 6e65 2063 6f76 6172  : 3D geone covar
+00038830: 6961 6e63 6520 6d6f 6465 6c20 6f62 6a65  iance model obje
+00038840: 6374 206f 7220 6c69 7374 206f 6620 3344  ct or list of 3D
+00038850: 2067 656f 6e65 2063 6f76 6172 6961 6e63   geone covarianc
+00038860: 6520 6d6f 6465 6c20 6f62 6a65 6374 7320  e model objects 
+00038870: 6f6e 6c79 2075 7365 6420 7769 7468 2022  only used with "
+00038880: 5349 5322 206d 6574 686f 640d 0a20 2020  SIS" method..   
+00038890: 2020 2020 202d 2054 4920 3a20 6765 6f6e       - TI : geon
+000388a0: 652e 696d 6167 652c 2054 7261 696e 696e  e.image, Trainin
+000388b0: 6720 696d 6167 6520 666f 7220 224d 5053  g image for "MPS
+000388c0: 2220 6d65 7468 6f64 0d0a 2020 2020 2020  " method..      
+000388d0: 2020 2d20 5375 6250 696c 6520 3a20 3a63    - SubPile : :c
+000388e0: 6c61 7373 3a60 5069 6c65 6020 6f62 6a65  lass:`Pile` obje
+000388f0: 6374 2c20 7375 6270 696c 6520 666f 7220  ct, subpile for 
+00038900: 2253 7562 5069 6c65 2220 6d65 7468 6f64  "SubPile" method
+00038910: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+00038920: 4661 6369 6573 206b 6579 776f 7264 2061  Facies keyword a
+00038930: 7267 756d 656e 7473 2074 6f20 7061 7373  rguments to pass
+00038940: 2074 6f20 7468 6520 6661 6369 6573 206d   to the facies m
+00038950: 6574 686f 6473 2028 7468 6573 6520 7368  ethods (these sh
+00038960: 6f75 6c64 2062 6520 7061 7373 2074 6872  ould be pass thr
+00038970: 6f75 6768 2064 6963 5f66 6163 6965 7320  ough dic_facies 
+00038980: 2129 3a0d 0a20 2020 2020 2020 200d 0a20  !):..        .. 
+00038990: 2020 2020 2020 2020 2020 202d 2022 5349             - "SI
+000389a0: 5322 203a 0d0a 2020 2020 2020 2020 2020  S" :..          
+000389b0: 2020 2020 2020 2d20 226e 6569 6768 2220        - "neigh" 
+000389c0: 3a20 696e 742c 206e 756d 6265 7220 6f66  : int, number of
+000389d0: 206e 6569 6768 626f 7273 2074 6f20 7573   neighbors to us
+000389e0: 6520 666f 7220 7468 6520 5349 530d 0a20  e for the SIS.. 
+000389f0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+00038a00: 2072 203a 2066 6c6f 6174 2c20 7261 6469   r : float, radi
+00038a10: 7573 206f 6620 7468 6520 6e65 6967 6862  us of the neighb
+00038a20: 6f72 686f 6f64 2074 6f20 7573 6520 666f  orhood to use fo
+00038a30: 7220 7468 6520 5349 530d 0a20 2020 2020  r the SIS..     
+00038a40: 2020 2020 2020 2020 2020 202d 2070 726f             - pro
+00038a50: 6261 6269 6c69 7479 203a 206c 6973 7420  bability : list 
+00038a60: 6f66 2066 6c6f 6174 2c20 7072 6f70 6f72  of float, propor
+00038a70: 7469 6f6e 206f 6620 6561 6368 2066 6163  tion of each fac
+00038a80: 6965 7320 746f 2075 7365 2066 6f72 2074  ies to use for t
+00038a90: 6865 2053 4953 0d0a 2020 2020 2020 2020  he SIS..        
+00038aa0: 2020 2020 2d20 5449 2020 2020 2020 2020      - TI        
+00038ab0: 2020 2020 2020 2020 2020 2020 3a20 6765              : ge
+00038ac0: 6f6e 6520 696d 672c 2054 7261 696e 696e  one img, Trainin
+00038ad0: 6720 696d 6167 6528 7329 2074 6f20 7573  g image(s) to us
+00038ae0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00038af0: 2020 202d 206d 7073 2022 636c 6173 7369     - mps "classi
+00038b00: 6322 2070 6172 616d 6574 6572 7320 286d  c" parameters (m
+00038b10: 6178 7363 616e 2c20 7468 7265 7368 2c20  axscan, thresh, 
+00038b20: 6e65 6967 2028 6e75 6d62 6572 206f 6620  neig (number of 
+00038b30: 6e65 6967 6862 6f75 7273 2929 0d0a 2020  neighbours))..  
+00038b40: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+00038b50: 6e70 6f73 7420 2020 2020 2020 2020 2020  npost           
+00038b60: 2020 2020 2020 3a20 6e75 6d62 6572 206f        : number o
+00038b70: 6620 7061 7468 2070 6f73 7470 726f 6365  f path postproce
+00038b80: 7373 696e 672c 2064 6566 6175 6c74 2031  ssing, default 1
+00038b90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00038ba0: 2020 2d20 7261 6469 7573 4d6f 6465 2020    - radiusMode  
+00038bb0: 2020 2020 2020 2020 2020 3a20 7261 6469            : radi
+00038bc0: 7573 206d 6f64 6520 746f 2075 7365 2028  us mode to use (
+00038bd0: 6368 6563 6b20 6465 6573 7365 206d 616e  check deesse man
+00038be0: 7561 6c29 0d0a 2020 2020 2020 2020 2020  ual)..          
+00038bf0: 2020 2020 2020 2d20 616e 6973 6f74 726f        - anisotro
+00038c00: 7079 5261 7469 6f4d 6f64 6520 2020 3a20  pyRatioMode   : 
+00038c10: 416e 6973 6f74 726f 7079 2072 6174 696f  Anisotropy ratio
+00038c20: 2074 6f20 7573 6520 696e 2072 6561 7365   to use in rease
+00038c30: 6172 6368 206f 6620 6e65 6967 6862 6f75  arch of neighbou
+00038c40: 7273 2028 6368 6563 6b20 6465 6573 7365  rs (check deesse
+00038c50: 206d 616e 7561 6c29 0d0a 2020 2020 2020   manual)..      
+00038c60: 2020 2020 2020 2020 2020 2d20 7278 2c20            - rx, 
+00038c70: 7279 2c20 727a 2020 2020 2020 2020 2020  ry, rz          
+00038c80: 2020 3a20 7261 6469 7573 2069 6e20 782c    : radius in x,
+00038c90: 2079 2061 6e64 207a 2064 6972 6563 7469   y and z directi
+00038ca0: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+00038cb0: 2020 2020 2d20 616e 676c 6531 2c20 616e      - angle1, an
+00038cc0: 676c 6532 2c20 616e 676c 6533 3a20 656c  gle2, angle3: el
+00038cd0: 6c69 7073 6f69 6420 6f66 2072 6573 6561  lipsoid of resea
+00038ce0: 7263 6820 726f 7461 7469 6f6e 2061 6e67  rch rotation ang
+00038cf0: 6c65 730d 0a20 2020 2020 2020 2020 2020  les..           
+00038d00: 2020 2020 202d 2061 782c 2061 792c 2061       - ax, ay, a
+00038d10: 7a20 2020 2020 2020 2020 2020 203a 2061  z            : a
+00038d20: 6e69 736f 7472 6f70 7920 7261 7469 6f20  nisotropy ratio 
+00038d30: 666f 7220 7265 7365 6172 6368 2065 6c6c  for research ell
+00038d40: 6970 736f 6964 0d0a 2020 2020 2020 2020  ipsoid..        
+00038d50: 2020 2020 2020 2020 2d20 726f 745f 7573          - rot_us
+00038d60: 6167 6520 2020 2020 2020 2020 2020 2020  age             
+00038d70: 3a20 302c 2031 206f 7220 3220 2863 6865  : 0, 1 or 2 (che
+00038d80: 636b 2064 6565 7373 6520 6d61 6e75 616c  ck deesse manual
+00038d90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00038da0: 2020 202d 2072 6f74 417a 694c 6f63 2c20     - rotAziLoc, 
+00038db0: 726f 7444 6970 4c6f 632c 203a 206c 6f63  rotDipLoc, : loc
+00038dc0: 616c 2072 6f74 6174 696f 6e2c 2054 7275  al rotation, Tru
+00038dd0: 6520 6f72 2046 616c 7365 203f 0d0a 2020  e or False ?..  
+00038de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038df0: 726f 7450 6c75 6e67 654c 6f63 0d0a 2020  rotPlungeLoc..  
+00038e00: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+00038e10: 726f 7441 7a69 2c20 726f 7444 6970 2c20  rotAzi, rotDip, 
+00038e20: 2020 2020 2020 3a20 676c 6f62 616c 2072        : global r
+00038e30: 6f74 6174 696f 6e20 616e 676c 6573 3a20  otation angles: 
+00038e40: 7661 6c75 6573 2c20 6d69 6e2d 6d61 782c  values, min-max,
+00038e50: 206d 6170 732c 2073 6565 2064 6565 7373   maps, see deess
+00038e60: 655f 696e 7075 7420 646f 630d 0a20 2020  e_input doc..   
+00038e70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00038e80: 6f74 506c 756e 6765 2020 2020 2020 2020  otPlunge        
+00038e90: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00038ea0: 2020 2020 2020 2020 2020 2d20 7872 2c20            - xr, 
+00038eb0: 7972 2c20 7a72 2020 2020 2020 2020 2020  yr, zr          
+00038ec0: 2020 3a20 7261 7469 6f20 666f 7220 6765    : ratio for ge
+00038ed0: 6f6d 2074 7261 6e73 666f 726d 6174 696f  om transformatio
+00038ee0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+00038ef0: 2020 202d 2078 6c6f 632c 2079 6c6f 632c     - xloc, yloc,
+00038f00: 207a 6c6f 6320 2020 2020 203a 206c 6f63   zloc      : loc
+00038f10: 616c 206f 7220 6e6f 7420 7472 616e 7366  al or not transf
+00038f20: 6f72 6d61 7469 6f6e 0d0a 2020 2020 2020  ormation..      
+00038f30: 2020 2020 2020 2020 2020 2d20 686f 6d6f            - homo
+00038f40: 5f75 7361 6765 2020 2020 2020 2020 2020  _usage          
+00038f50: 2020 3a20 686f 6d6f 7468 6574 7920 7573    : homothety us
+00038f60: 6167 650d 0a20 2020 2020 2020 2020 2020  age..           
+00038f70: 2020 2020 202d 2070 726f 6261 5573 6167       - probaUsag
+00038f80: 6520 2020 2020 2020 2020 2020 203a 2070  e            : p
+00038f90: 726f 6261 6269 6c69 7479 2063 6f6e 7374  robability const
+00038fa0: 7261 696e 7420 7573 6167 652c 2030 2066  raint usage, 0 f
+00038fb0: 6f72 206e 6f20 7072 6f62 6120 636f 6e73  or no proba cons
+00038fc0: 7472 6169 6e74 2c20 3120 666f 7220 676c  traint, 1 for gl
+00038fd0: 6f62 616c 2070 726f 706f 7274 696f 6e20  obal proportion 
+00038fe0: 6465 6669 6e65 6420 696e 2067 6c6f 6261  defined in globa
+00038ff0: 6c50 6466 2c20 3220 666f 7220 6c6f 6361  lPdf, 2 for loca
+00039000: 6c20 7072 6f70 6f72 7469 6f6e 2064 6566  l proportion def
+00039010: 696e 6564 2069 6e20 6c6f 6361 6c50 6466  ined in localPdf
+00039020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00039030: 2020 2d20 676c 6f62 616c 5064 6620 2020    - globalPdf   
+00039040: 2020 2020 2020 2020 2020 3a20 6172 7261            : arra
+00039050: 792d 6c69 6b65 206f 6620 666c 6f61 7420  y-like of float 
+00039060: 6f66 206c 656e 6774 6820 6571 7561 6c20  of length equal 
+00039070: 746f 2074 6865 206e 756d 6265 7220 6f66  to the number of
+00039080: 2063 6c61 7373 2c20 7072 6f70 6f72 7469   class, proporti
+00039090: 6f6e 2066 6f72 2065 6163 6820 636c 6173  on for each clas
+000390a0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+000390b0: 2020 202d 206c 6f63 616c 5064 6620 2020     - localPdf   
+000390c0: 2020 2020 2020 2020 2020 203a 2028 6e63             : (nc
+000390d0: 6c61 7373 2c20 6e7a 2c20 6e79 2c20 6e78  lass, nz, ny, nx
+000390e0: 2920 6172 7261 7920 6f66 2066 6c6f 6174  ) array of float
+000390f0: 7320 7072 6f62 6162 696c 6974 7920 666f  s probability fo
+00039100: 7220 6561 6368 2063 6c61 7373 2c20 6c6f  r each class, lo
+00039110: 6361 6c50 6466 5b69 5d20 6973 2074 6865  calPdf[i] is the
+00039120: 2022 6d61 7020 6465 6669 6e65 6420 6f6e   "map defined on
+00039130: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
+00039140: 6772 6964 0d0a 2020 2020 2020 2020 2020  grid..          
+00039150: 2020 2020 2020 2d20 6c6f 6361 6c50 6466        - localPdf
+00039160: 5261 6469 7573 2020 2020 2020 2020 3a20  Radius        : 
+00039170: 7375 7070 6f72 7420 7261 6469 7573 2066  support radius f
+00039180: 6f72 206c 6f63 616c 2070 6466 2c20 6465  or local pdf, de
+00039190: 6661 756c 7420 6973 2032 0d0a 2020 2020  fault is 2..    
+000391a0: 2020 2020 2020 2020 2020 2020 2d20 6465              - de
+000391b0: 6163 7469 7661 7469 6f6e 4469 7374 616e  activationDistan
+000391c0: 6365 2020 3a20 666c 6f61 742c 2064 6973  ce  : float, dis
+000391d0: 7461 6e63 6520 6174 2077 6869 6368 206c  tance at which l
+000391e0: 6f63 616c 5064 6620 6172 6520 6465 6163  ocalPdf are deac
+000391f0: 7469 7661 7465 6420 2873 6565 2044 6565  tivated (see Dee
+00039200: 7373 6520 646f 6329 0d0a 2020 2020 2020  sse doc)..      
+00039210: 2020 2020 2020 2020 2020 2d20 636f 6e73            - cons
+00039220: 7461 6e74 5468 7265 7368 6f6c 6420 2020  tantThreshold   
+00039230: 2020 3a20 666c 6f61 742c 2074 6872 6573    : float, thres
+00039240: 686f 6c64 2076 616c 7565 2066 6f72 2070  hold value for p
+00039250: 6466 2773 2063 6f6d 7061 7269 736f 6e0d  df's comparison.
+00039260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039270: 202d 2064 6174 6149 6d61 6765 2020 2020   - dataImage    
+00039280: 2020 2020 2020 2020 203a 2067 656f 6e65           : geone
+00039290: 2069 6d67 2075 7365 6420 6173 2064 6174   img used as dat
+000392a0: 612c 2073 6565 2064 6565 7373 652f 6765  a, see deesse/ge
+000392b0: 6f6e 6520 646f 6375 6d65 6e74 6174 696f  one documentatio
+000392c0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+000392d0: 2020 202d 206f 7574 7075 7456 6172 466c     - outputVarFl
+000392e0: 6167 2020 2020 2020 2020 203a 2062 6f6f  ag         : boo
+000392f0: 6c20 6f72 206c 6973 7420 6f66 2062 6f6f  l or list of boo
+00039300: 6c20 6f66 2073 697a 6520 6e76 2c20 746f  l of size nv, to
+00039310: 206f 7574 7075 7420 6f72 206e 6f74 2074   output or not t
+00039320: 6865 2076 6172 6961 626c 6573 0d0a 2020  he variables..  
+00039330: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+00039340: 6469 7374 616e 6365 5479 7065 2020 2020  distanceType    
+00039350: 2020 2020 2020 3a20 7374 7269 6e67 206f        : string o
+00039360: 7220 6c69 7374 206f 6620 7374 7269 6e67  r list of string
+00039370: 732c 2022 6361 7465 676f 7269 6361 6c22  s, "categorical"
+00039380: 206f 7220 2263 6f6e 7469 6e75 6f75 7322   or "continuous"
+00039390: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000393a0: 2d20 5450 4773 3a0d 0a20 2020 2020 2020  - TPGs:..       
+000393b0: 2020 2020 2020 2020 202d 2066 6c61 673a           - flag:
+000393c0: 2064 6963 7469 6f6e 6172 7920 6f66 206c   dictionary of l
+000393d0: 696d 6974 7320 6f66 2063 7562 6f69 6473  imits of cuboids
+000393e0: 2064 6f6d 6169 6e73 2069 6e20 4761 7573   domains in Gaus
+000393f0: 7369 616e 2073 7061 6365 2c20 6368 6563  sian space, chec
+00039400: 6b20 2e2e 2e20 666f 7220 7468 6520 7269  k ... for the ri
+00039410: 6768 7420 666f 726d 6174 2e0d 0a20 2020  ght format...   
+00039420: 2020 2020 2020 2020 2020 2020 202d 2049               - I
+00039430: 6b5f 636d 3a20 696e 6469 6361 746f 7220  k_cm: indicator 
+00039440: 636f 766d 6f64 656c 730d 0a20 2020 2020  covmodels..     
+00039450: 2020 2020 2020 2020 2020 202d 2047 5f63             - G_c
+00039460: 6d3a 206c 6973 7420 6f66 2047 6175 7373  m: list of Gauss
+00039470: 6961 6e20 636f 766d 6f64 656c 7320 666f  ian covmodels fo
+00039480: 7220 7468 6520 7477 6f20 6761 7573 7369  r the two gaussi
+00039490: 616e 2066 6965 6c64 732c 2063 616e 2062  an fields, can b
+000394a0: 6520 696e 6665 7265 6420 6672 6f6d 2049  e infered from I
+000394b0: 6b5f 636d 0d0a 2020 2020 2020 2020 2020  k_cm..          
+000394c0: 2020 2020 2020 2d20 7661 7269 6f75 7320        - various 
+000394d0: 7061 7261 6d65 7465 7273 3a20 2864 752c  parameters: (du,
+000394e0: 2064 7620 2d2d 3e20 7072 6563 6973 696f   dv --> precisio
+000394f0: 6e20 6f66 2069 6e74 6567 7261 6c73 2066  n of integrals f
+00039500: 6f72 2047 5f63 6d20 696e 6665 7265 6e63  or G_cm inferenc
+00039510: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
+00039520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039530: 2020 2020 2020 2020 2020 2028 6469 6d3a             (dim:
+00039540: 2064 696d 656e 7369 6f6e 2077 616e 7465   dimension wante
+00039550: 6420 666f 7220 475f 636d 2069 6e66 6572  d for G_cm infer
+00039560: 656e 6365 2c0d 0a20 2020 2020 2020 2020  ence,..         
+00039570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039580: 2020 2020 2020 2020 2020 2020 2028 635f               (c_
+00039590: 7265 673a 2072 6567 756c 6172 6973 6174  reg: regularisat
+000395a0: 696f 6e20 7465 726d 2066 6f72 2047 5f63  ion term for G_c
+000395b0: 6d20 696e 6665 7265 6e63 6529 2c0d 0a20  m inference),.. 
+000395c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000395d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000395e0: 2020 2020 2028 6e3a 206e 756d 6265 7220       (n: number 
+000395f0: 6f66 2063 6f6e 7472 6f6c 2070 6f69 6e74  of control point
+00039600: 7320 666f 7220 475f 636d 2069 6e66 6572  s for G_cm infer
+00039610: 656e 6365 2929 0d0a 0d0a 2020 2020 2222  ence))....    ""
+00039620: 220d 0a0d 0a20 2020 2064 6566 205f 5f69  "....    def __i
+00039630: 6e69 745f 5f28 7365 6c66 2c20 6e61 6d65  nit__(self, name
+00039640: 2c20 6f72 6465 722c 2063 6f6c 6f72 2c20  , order, color, 
+00039650: 7375 7266 6163 653d 4e6f 6e65 2c20 4944  surface=None, ID
+00039660: 3d4e 6f6e 652c 0d0a 2020 2020 2020 2020  =None,..        
+00039670: 2020 2020 2020 2020 6469 635f 6661 6369          dic_faci
+00039680: 6573 3d7b 2266 5f6d 6574 686f 6422 3a20  es={"f_method": 
+00039690: 2268 6f6d 6f67 656e 6f75 7322 2c20 2266  "homogenous", "f
+000396a0: 5f63 6f76 6d6f 6465 6c22 3a20 4e6f 6e65  _covmodel": None
+000396b0: 2c20 2254 4922 3a20 4e6f 6e65 2c20 2253  , "TI": None, "S
+000396c0: 7562 5069 6c65 223a 204e 6f6e 652c 2022  ubPile": None, "
+000396d0: 466c 6167 223a 204e 6f6e 652c 2022 475f  Flag": None, "G_
+000396e0: 636d 223a 204e 6f6e 657d 2c0d 0a20 2020  cm": None},..   
+000396f0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00039700: 7461 6374 3d22 6f6e 6c61 7022 2c20 7665  tact="onlap", ve
+00039710: 7262 6f73 653d 3129 3a0d 0a20 2020 200d  rbose=1):..    .
+00039720: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00039730: 4944 2021 3d20 302c 2022 4944 2063 616e  ID != 0, "ID can
+00039740: 6e6f 7420 6265 2030 220d 0a20 2020 2020  not be 0"..     
+00039750: 2020 2061 7373 6572 7420 6e61 6d65 2069     assert name i
+00039760: 7320 6e6f 7420 4e6f 6e65 2c20 2241 206e  s not None, "A n
+00039770: 616d 6520 6d75 7374 2062 6520 7072 6f76  ame must be prov
+00039780: 6964 6564 220d 0a20 2020 2020 2020 2061  ided"..        a
+00039790: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+000397a0: 2820 7375 7266 6163 652c 2053 7572 6661  ( surface, Surfa
+000397b0: 6365 292c 2022 4120 7375 7266 6163 6520  ce), "A surface 
+000397c0: 6f62 6a65 6374 206d 7573 7420 6265 2070  object must be p
+000397d0: 726f 7669 6465 6420 666f 7220 6561 6368  rovided for each
+000397e0: 2075 6e69 7422 0d0a 0d0a 2020 2020 2020   unit"....      
+000397f0: 2020 7365 6c66 2e6e 616d 653d 6e61 6d65    self.name=name
+00039800: 0d0a 2020 2020 2020 2020 7365 6c66 2e6f  ..        self.o
+00039810: 7264 6572 3d6f 7264 6572 0d0a 2020 2020  rder=order..    
+00039820: 2020 2020 7365 6c66 2e63 6f6e 7461 6374      self.contact
+00039830: 3d63 6f6e 7461 6374 0d0a 2020 2020 2020  =contact..      
+00039840: 2020 7365 6c66 2e63 3d63 6f6c 6f72 0d0a    self.c=color..
+00039850: 0d0a 2020 2020 2020 2020 6966 2049 4420  ..        if ID 
+00039860: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+00039870: 2020 2020 2020 7365 6c66 2e49 443d 6f72        self.ID=or
+00039880: 6465 720d 0a20 2020 2020 2020 2065 6c73  der..        els
+00039890: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000398a0: 7365 6c66 2e49 443d 4944 0d0a 2020 2020  self.ID=ID..    
+000398b0: 2020 2020 7365 6c66 2e53 7562 5069 6c65      self.SubPile
+000398c0: 3d4e 6f6e 650d 0a20 2020 2020 2020 2073  =None..        s
+000398d0: 656c 662e 7665 7262 6f73 653d 7665 7262  elf.verbose=verb
+000398e0: 6f73 650d 0a20 2020 2020 2020 2073 656c  ose..        sel
+000398f0: 662e 6c69 7374 5f66 6163 6965 733d 5b5d  f.list_facies=[]
+00039900: 0d0a 2020 2020 2020 2020 7365 6c66 2e62  ..        self.b
+00039910: 625f 756e 6974 7320 3d20 5b5d 0d0a 2020  b_units = []..  
+00039920: 2020 2020 2020 7365 6c66 2e78 203d 205b        self.x = [
+00039930: 5d20 2023 2064 6174 6120 636f 6f72 6469  ]  # data coordi
+00039940: 6e61 7465 7320 666f 7220 6361 7465 676f  nates for catego
+00039950: 7269 6361 6c20 7369 6d75 6c61 7469 6f6e  rical simulation
+00039960: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
+00039970: 7920 3d20 5b5d 2020 2320 6461 7461 2063  y = []  # data c
+00039980: 6f6f 7264 696e 6174 6573 2066 6f72 2063  oordinates for c
+00039990: 6174 6567 6f72 6963 616c 2073 696d 756c  ategorical simul
+000399a0: 6174 696f 6e73 0d0a 2020 2020 2020 2020  ations..        
+000399b0: 7365 6c66 2e7a 203d 205b 5d20 2023 2064  self.z = []  # d
+000399c0: 6174 6120 636f 6f72 6469 6e61 7465 7320  ata coordinates 
+000399d0: 666f 7220 6361 7465 676f 7269 6361 6c20  for categorical 
+000399e0: 7369 6d75 6c61 7469 6f6e 730d 0a20 2020  simulations..   
+000399f0: 2020 2020 2073 656c 662e 6d75 6d6d 795f       self.mummy_
+00039a00: 756e 6974 3d4e 6f6e 650d 0a20 2020 2020  unit=None..     
+00039a10: 2020 2073 656c 662e 7365 745f 6469 635f     self.set_dic_
+00039a20: 6661 6369 6573 2864 6963 5f66 6163 6965  facies(dic_facie
+00039a30: 7329 2023 7365 7420 6469 6320 6661 6369  s) #set dic faci
+00039a40: 6573 2074 6f20 756e 6974 0d0a 0d0a 2020  es to unit....  
+00039a50: 2020 2020 2020 6966 2073 7572 6661 6365        if surface
+00039a60: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+00039a70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00039a80: 7365 745f 5375 7266 6163 6528 7375 7266  set_Surface(surf
+00039a90: 6163 6529 0d0a 0d0a 0d0a 2020 2020 6465  ace)......    de
+00039aa0: 6620 7365 745f 6469 635f 6661 6369 6573  f set_dic_facies
+00039ab0: 2873 656c 662c 2064 6963 5f66 6163 6965  (self, dic_facie
+00039ac0: 7329 3a0d 0a0d 0a20 2020 2020 2020 2022  s):....        "
+00039ad0: 2222 0d0a 2020 2020 2020 2020 5365 7420  ""..        Set 
+00039ae0: 6120 6469 6374 696f 6e61 7279 2066 6163  a dictionary fac
+00039af0: 6965 7320 746f 2055 6e69 7420 6f62 6a65  ies to Unit obje
+00039b00: 6374 0d0a 0d0a 2020 2020 2020 2020 5061  ct....        Pa
+00039b10: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00039b20: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00039b30: 2020 2020 2020 6469 635f 6661 6369 6573        dic_facies
+00039b40: 203a 2064 6963 740d 0a20 2020 2020 2020   : dict..       
+00039b50: 2020 2020 2064 6963 7469 6f6e 6e61 7279       dictionnary
+00039b60: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00039b70: 7061 7261 6d65 7465 7273 2074 6f20 7061  parameters to pa
+00039b80: 7373 2061 7420 7468 6520 6661 6369 6573  ss at the facies
+00039b90: 206d 6574 686f 6473 0d0a 2020 2020 2020   methods..      
+00039ba0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+00039bb0: 2061 7373 6572 7420 6469 635f 6661 6369   assert dic_faci
+00039bc0: 6573 5b22 665f 6d65 7468 6f64 225d 2069  es["f_method"] i
+00039bd0: 6e20 2822 4d50 5322 2c20 2253 4953 222c  n ("MPS", "SIS",
+00039be0: 2022 686f 6d6f 6765 6e6f 7573 222c 2022   "homogenous", "
+00039bf0: 5450 4773 222c 2022 5375 6250 696c 6522  TPGs", "SubPile"
+00039c00: 292c 2027 4669 6c6c 696e 6720 6d65 7468  ), 'Filling meth
+00039c10: 6f64 2075 6e6b 6e6f 776e 2c20 7661 6c69  od unknown, vali
+00039c20: 6473 2061 7265 2022 4d50 5322 2c20 2253  ds are "MPS", "S
+00039c30: 4953 222c 2022 686f 6d6f 6765 6e6f 7573  IS", "homogenous
+00039c40: 222c 2022 5450 4773 222c 2022 5375 6250  ", "TPGs", "SubP
+00039c50: 696c 6527 0d0a 0d0a 2020 2020 2020 2020  ile'....        
+00039c60: 7365 6c66 2e66 5f6d 6574 686f 643d 6469  self.f_method=di
+00039c70: 635f 6661 6369 6573 5b22 665f 6d65 7468  c_facies["f_meth
+00039c80: 6f64 225d 0d0a 2020 2020 2020 2020 2320  od"]..        # 
+00039c90: 6368 6563 6b20 696d 706f 7274 616e 7420  check important 
+00039ca0: 696e 7075 7420 666f 7220 6661 6369 6573  input for facies
+00039cb0: 206d 6574 686f 6473 0d0a 2020 2020 2020   methods..      
+00039cc0: 2020 234d 5053 0d0a 2020 2020 2020 2020    #MPS..        
+00039cd0: 6966 2073 656c 662e 665f 6d65 7468 6f64  if self.f_method
+00039ce0: 203d 3d20 224d 5053 223a 0d0a 2020 2020   == "MPS":..    
+00039cf0: 2020 2020 2020 2020 6966 2022 5449 2220          if "TI" 
+00039d00: 6e6f 7420 696e 2064 6963 5f66 6163 6965  not in dic_facie
+00039d10: 732e 6b65 7973 2829 3a0d 0a20 2020 2020  s.keys():..     
+00039d20: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00039d30: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+00039d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039d50: 2070 7269 6e74 2822 5741 524e 494e 4720   print("WARNING 
+00039d60: 4e4f 2054 4920 5041 5353 4544 2046 4f52  NO TI PASSED FOR
+00039d70: 204d 5053 2053 494d 554c 4154 494f 4e22   MPS SIMULATION"
+00039d80: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00039d90: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00039da0: 2020 2020 2020 7365 6c66 2e73 6574 5f66        self.set_f
+00039db0: 5f54 4928 6469 635f 6661 6369 6573 5b22  _TI(dic_facies["
+00039dc0: 5449 225d 290d 0a0d 0a20 2020 2020 2020  TI"])....       
+00039dd0: 2023 5375 6270 696c 650d 0a20 2020 2020   #Subpile..     
+00039de0: 2020 2065 6c69 6620 7365 6c66 2e66 5f6d     elif self.f_m
+00039df0: 6574 686f 6420 3d3d 2022 5375 6250 696c  ethod == "SubPil
+00039e00: 6522 3a0d 0a20 2020 2020 2020 2020 2020  e":..           
+00039e10: 2069 6620 2253 7562 5069 6c65 2220 6e6f   if "SubPile" no
+00039e20: 7420 696e 2064 6963 5f66 6163 6965 732e  t in dic_facies.
+00039e30: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
+00039e40: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00039e50: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+00039e60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00039e70: 7269 6e74 2822 4e6f 2053 7562 5069 6c65  rint("No SubPile
+00039e80: 2070 6173 7365 6420 666f 7220 5375 6250   passed for SubP
+00039e90: 696c 6520 6669 6c6c 696e 672c 2063 6f6e  ile filling, con
+00039ea0: 7369 6465 7220 6164 6469 6e67 206f 6e65  sider adding one
+00039eb0: 2077 6974 6820 7365 745f 5375 6250 696c   with set_SubPil
+00039ec0: 6528 2920 6265 666f 7265 2070 726f 6365  e() before proce
+00039ed0: 6564 696e 6722 290d 0a20 2020 2020 2020  eding")..       
+00039ee0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00039ef0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00039f00: 2e73 6574 5f53 7562 5069 6c65 2864 6963  .set_SubPile(dic
+00039f10: 5f66 6163 6965 735b 2253 7562 5069 6c65  _facies["SubPile
+00039f20: 225d 290d 0a0d 0a20 2020 2020 2020 2020  "])....         
+00039f30: 2020 2069 6620 2275 6e69 7473 5f66 696c     if "units_fil
+00039f40: 6c5f 6d65 7468 6f64 2220 696e 2064 6963  l_method" in dic
+00039f50: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
+00039f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039f70: 2069 6620 6469 635f 6661 6369 6573 5b22   if dic_facies["
+00039f80: 756e 6974 735f 6669 6c6c 5f6d 6574 686f  units_fill_metho
+00039f90: 6422 5d20 3d3d 2022 5349 5322 3a0d 0a20  d"] == "SIS":.. 
+00039fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039fb0: 2020 2073 656c 662e 7365 745f 665f 636f     self.set_f_co
+00039fc0: 766d 6f64 656c 7328 6469 635f 6661 6369  vmodels(dic_faci
+00039fd0: 6573 5b22 665f 636f 766d 6f64 656c 225d  es["f_covmodel"]
+00039fe0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00039ff0: 2020 2020 2065 6c69 6620 6469 635f 6661       elif dic_fa
+0003a000: 6369 6573 5b22 756e 6974 735f 6669 6c6c  cies["units_fill
+0003a010: 5f6d 6574 686f 6422 5d20 3d3d 2022 4d50  _method"] == "MP
+0003a020: 5322 3a0d 0a20 2020 2020 2020 2020 2020  S":..           
+0003a030: 2020 2020 2020 2020 2069 6620 2254 4922           if "TI"
+0003a040: 206e 6f74 2069 6e20 6469 635f 6661 6369   not in dic_faci
+0003a050: 6573 2e6b 6579 7328 293a 0d0a 2020 2020  es.keys():..    
+0003a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a070: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+0003a080: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+0003a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a0a0: 2020 7072 696e 7428 2257 4152 4e49 4e47    print("WARNING
+0003a0b0: 204e 4f20 5449 2050 4153 5345 4420 464f   NO TI PASSED FO
+0003a0c0: 5220 4d50 5320 5349 4d55 4c41 5449 4f4e  R MPS SIMULATION
+0003a0d0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0003a0e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0003a0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a100: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
+0003a110: 665f 5449 2864 6963 5f66 6163 6965 735b  f_TI(dic_facies[
+0003a120: 2254 4922 5d29 0d0a 0d0a 2020 2020 2020  "TI"])....      
+0003a130: 2020 2020 2020 2020 2020 656c 6966 2064            elif d
+0003a140: 6963 5f66 6163 6965 735b 2275 6e69 7473  ic_facies["units
+0003a150: 5f66 696c 6c5f 6d65 7468 6f64 225d 203d  _fill_method"] =
+0003a160: 3d20 2254 5047 7322 3a0d 0a20 2020 2020  = "TPGs":..     
+0003a170: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003a180: 6620 2246 6c61 6722 2069 6e20 6469 635f  f "Flag" in dic_
+0003a190: 6661 6369 6573 2e6b 6579 7328 293a 0d0a  facies.keys():..
+0003a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a1b0: 2020 2020 2020 2020 7365 6c66 2e66 6c61          self.fla
+0003a1c0: 6720 3d20 6469 635f 6661 6369 6573 5b22  g = dic_facies["
+0003a1d0: 466c 6167 225d 0d0a 2020 2020 2020 2020  Flag"]..        
+0003a1e0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
+0003a1f0: 475f 636d 2220 696e 2064 6963 5f66 6163  G_cm" in dic_fac
+0003a200: 6965 732e 6b65 7973 2829 3a0d 0a20 2020  ies.keys():..   
+0003a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a220: 2020 2020 2073 656c 662e 475f 636d 203d       self.G_cm =
+0003a230: 2064 6963 5f66 6163 6965 735b 2247 5f63   dic_facies["G_c
+0003a240: 6d22 5d0d 0a0d 0a20 2020 2020 2020 2020  m"]....         
+0003a250: 2020 2023 2054 4f20 434f 4d50 4c45 5445     # TO COMPLETE
+0003a260: 0d0a 0d0a 2020 2020 2020 2020 2354 7275  ....        #Tru
+0003a270: 6e63 6174 6564 2050 6c75 7269 6761 7573  ncated Plurigaus
+0003a280: 7369 616e 7320 4352 4541 5445 2043 4845  sians CREATE CHE
+0003a290: 434b 2046 554e 4354 494f 4e53 2054 4f20  CK FUNCTIONS TO 
+0003a2a0: 444f 0d0a 2020 2020 2020 2020 656c 6966  DO..        elif
+0003a2b0: 2073 656c 662e 665f 6d65 7468 6f64 203d   self.f_method =
+0003a2c0: 3d20 2254 5047 7322 3a0d 0a20 2020 2020  = "TPGs":..     
+0003a2d0: 2020 2020 2020 2023 6173 7365 7274 0d0a         #assert..
+0003a2e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003a2f0: 2e66 6c61 673d 6469 635f 6661 6369 6573  .flag=dic_facies
+0003a300: 5b22 466c 6167 225d 0d0a 2020 2020 2020  ["Flag"]..      
+0003a310: 2020 2020 2020 7365 6c66 2e47 5f63 6d3d        self.G_cm=
+0003a320: 6469 635f 6661 6369 6573 5b22 475f 636d  dic_facies["G_cm
+0003a330: 225d 0d0a 0d0a 2020 2020 2020 2020 2353  "]....        #S
+0003a340: 4953 0d0a 2020 2020 2020 2020 656c 6966  IS..        elif
+0003a350: 2073 656c 662e 665f 6d65 7468 6f64 203d   self.f_method =
+0003a360: 3d20 2253 4953 223a 0d0a 2020 2020 2020  = "SIS":..      
+0003a370: 2020 2020 2020 6966 2022 665f 636f 766d        if "f_covm
+0003a380: 6f64 656c 2220 6e6f 7420 696e 2064 6963  odel" not in dic
+0003a390: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
+0003a3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a3b0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+0003a3c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003a3d0: 2020 2020 2020 2070 7269 6e74 2822 556e         print("Un
+0003a3e0: 6974 207b 7d3a 2057 4152 4e49 4e47 204e  it {}: WARNING N
+0003a3f0: 4f20 434f 564d 4f44 454c 5320 5041 5353  O COVMODELS PASS
+0003a400: 4544 2046 4f52 2053 4953 2053 494d 554c  ED FOR SIS SIMUL
+0003a410: 4154 494f 4e22 2e66 6f72 6d61 7428 7365  ATION".format(se
+0003a420: 6c66 2e6e 616d 6529 290d 0a20 2020 2020  lf.name))..     
+0003a430: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0003a440: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0003a450: 6c66 2e73 6574 5f66 5f63 6f76 6d6f 6465  lf.set_f_covmode
+0003a460: 6c73 2864 6963 5f66 6163 6965 735b 2266  ls(dic_facies["f
+0003a470: 5f63 6f76 6d6f 6465 6c22 5d29 0d0a 0d0a  _covmodel"])....
+0003a480: 2020 2020 2020 2020 7365 6c66 2e64 6963          self.dic
+0003a490: 5f66 6163 6965 733d 6469 635f 6661 6369  _facies=dic_faci
+0003a4a0: 6573 0d0a 0d0a 0d0a 2020 2020 2323 206d  es......    ## m
+0003a4b0: 6167 6963 2066 756e 0d0a 2020 2020 6465  agic fun..    de
+0003a4c0: 6620 5f5f 7265 7072 5f5f 2873 656c 6629  f __repr__(self)
+0003a4d0: 3a0d 0a20 2020 2020 2020 2073 3d73 656c  :..        s=sel
+0003a4e0: 662e 6e61 6d65 0d0a 2020 2020 2020 2020  f.name..        
+0003a4f0: 7265 7475 726e 2073 0d0a 0d0a 2020 2020  return s....    
+0003a500: 6465 6620 5f5f 6361 6c6c 5f5f 2873 656c  def __call__(sel
+0003a510: 6629 3a0d 0a20 2020 2020 2020 2072 6574  f):..        ret
+0003a520: 7572 6e20 7072 696e 7428 2255 6e69 7420  urn print("Unit 
+0003a530: 7b7d 222e 666f 726d 6174 2873 656c 662e  {}".format(self.
+0003a540: 6e61 6d65 2929 0d0a 0d0a 2020 2020 6465  name))....    de
+0003a550: 6620 5f5f 6571 5f5f 2873 656c 662c 206f  f __eq__(self, o
+0003a560: 7468 6572 293a 0d0a 2020 2020 2020 2020  ther):..        
+0003a570: 2222 220d 0a20 2020 2020 2020 2066 6f72  """..        for
+0003a580: 2063 6f6d 7061 7269 736f 6e0d 0a20 2020   comparison..   
+0003a590: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+0003a5a0: 2020 2020 6966 206f 7468 6572 2069 7320      if other is 
+0003a5b0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+0003a5c0: 2020 2020 2020 2069 6620 2873 656c 662e         if (self.
+0003a5d0: 6e61 6d65 203d 3d20 6f74 6865 722e 6e61  name == other.na
+0003a5e0: 6d65 2920 2620 2873 656c 662e 6f72 6465  me) & (self.orde
+0003a5f0: 7220 3d3d 206f 7468 6572 2e6f 7264 6572  r == other.order
+0003a600: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0003a610: 2020 2020 7265 7475 726e 2054 7275 650d      return True.
+0003a620: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0003a630: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0003a640: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0003a650: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0003a660: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0003a670: 7572 6e20 4661 6c73 650d 0a0d 0a20 2020  urn False....   
+0003a680: 2064 6566 205f 5f69 745f 5f28 7365 6c66   def __it__(self
+0003a690: 2c20 6f74 6865 7229 3a20 2320 696e 6571  , other): # ineq
+0003a6a0: 7561 6c69 7479 2063 6f6d 7061 7269 736f  uality compariso
+0003a6b0: 6e0d 0a20 2020 2020 2020 2069 6620 2873  n..        if (s
+0003a6c0: 656c 662e 6f72 6465 7220 3c20 6f74 6865  elf.order < othe
+0003a6d0: 722e 6f72 6465 7229 3a0d 0a20 2020 2020  r.order):..     
+0003a6e0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+0003a6f0: 7565 0d0a 2020 2020 2020 2020 656c 7365  ue..        else
+0003a700: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0003a710: 6574 7572 6e20 4661 6c73 650d 0a0d 0a20  eturn False.... 
+0003a720: 2020 2064 6566 205f 5f67 745f 5f28 7365     def __gt__(se
+0003a730: 6c66 2c20 6f74 6865 7229 3a20 2320 696e  lf, other): # in
+0003a740: 6571 7561 6c69 7479 2063 6f6d 7061 7269  equality compari
+0003a750: 736f 6e0d 0a20 2020 2020 2020 2069 6620  son..        if 
+0003a760: 2873 656c 662e 6f72 6465 7220 3e20 6f74  (self.order > ot
+0003a770: 6865 722e 6f72 6465 7229 3a0d 0a20 2020  her.order):..   
+0003a780: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0003a790: 5472 7565 0d0a 2020 2020 2020 2020 656c  True..        el
+0003a7a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003a7b0: 2072 6574 7572 6e20 4661 6c73 650d 0a0d   return False...
+0003a7c0: 0a20 2020 2064 6566 205f 5f73 7472 5f5f  .    def __str__
+0003a7d0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+0003a7e0: 2072 6574 7572 6e20 7365 6c66 2e6e 616d   return self.nam
+0003a7f0: 650d 0a0d 0a20 2020 2023 636f 7079 2066  e....    #copy f
+0003a800: 756e 0d0a 2020 2020 6465 6620 636f 7079  un..    def copy
+0003a810: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+0003a820: 2072 6574 7572 6e20 636f 7079 2e64 6565   return copy.dee
+0003a830: 7063 6f70 7928 7365 6c66 290d 0a0d 0a20  pcopy(self).... 
+0003a840: 2020 2064 6566 2073 6574 5f53 7562 5069     def set_SubPi
+0003a850: 6c65 2873 656c 662c 2053 7562 5069 6c65  le(self, SubPile
+0003a860: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+0003a870: 220d 0a20 2020 2020 2020 2043 6861 6e67  "..        Chang
+0003a880: 6520 6f72 2064 6566 696e 6520 6120 7375  e or define a su
+0003a890: 6270 696c 6520 666f 7220 6669 6c6c 696e  bpile for fillin
+0003a8a0: 670d 0a0d 0a20 2020 2020 2020 2050 6172  g....        Par
+0003a8b0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0003a8c0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0003a8d0: 2020 2020 2053 7562 5069 6c65 203a 203a       SubPile : :
+0003a8e0: 636c 6173 733a 6050 696c 6560 206f 626a  class:`Pile` obj
+0003a8f0: 6563 7409 0d0a 2020 2020 2020 2020 2222  ect...        ""
+0003a900: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
+0003a910: 6973 696e 7374 616e 6365 2853 7562 5069  isinstance(SubPi
+0003a920: 6c65 2c20 5069 6c65 293a 0d0a 2020 2020  le, Pile):..    
+0003a930: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0003a940: 665f 6d65 7468 6f64 203d 3d20 2253 7562  f_method == "Sub
+0003a950: 5069 6c65 223a 0d0a 2020 2020 2020 2020  Pile":..        
+0003a960: 2020 2020 2020 2020 7365 6c66 2e53 7562          self.Sub
+0003a970: 5069 6c65 3d53 7562 5069 6c65 0d0a 2020  Pile=SubPile..  
+0003a980: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0003a990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a9a0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+0003a9b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003a9c0: 2020 2020 2020 2070 7269 6e74 2822 5265         print("Re
+0003a9d0: 616c 6c79 203f 2046 696c 6c69 6e67 206d  ally ? Filling m
+0003a9e0: 6574 686f 6420 6973 206e 6f74 2053 7562  ethod is not Sub
+0003a9f0: 5069 6c65 2229 0d0a 2020 2020 2020 2020  Pile")..        
+0003aa00: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0003aa10: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0003aa20: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003aa30: 2020 2020 2070 7269 6e74 2822 5468 6520       print("The 
+0003aa40: 5375 6250 696c 6520 6f62 6a65 6374 2069  SubPile object i
+0003aa50: 7320 6e6f 7420 616e 2041 7263 685f 7461  s not an Arch_ta
+0003aa60: 626c 6520 6f62 6a65 6374 2229 0d0a 0d0a  ble object")....
+0003aa70: 2020 2020 6465 6620 7365 745f 665f 5449      def set_f_TI
+0003aa80: 2873 656c 662c 2054 4929 3a0d 0a0d 0a20  (self, TI):.... 
+0003aa90: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0003aaa0: 2020 2020 4368 616e 6765 2074 7261 696e      Change train
+0003aab0: 696e 6720 696d 6167 6520 666f 7220 6120  ing image for a 
+0003aac0: 7374 7261 7469 2075 6e69 740d 0a0d 0a20  strati unit.... 
+0003aad0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0003aae0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0003aaf0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2054  -----..        T
+0003ab00: 493a 2067 656f 6e65 2e69 6d61 6765 0d0a  I: geone.image..
+0003ab10: 2020 2020 2020 2020 2020 2020 5472 6169              Trai
+0003ab20: 6e69 6e67 2069 6d61 6765 2074 6f20 7573  ning image to us
+0003ab30: 6520 7769 7468 2074 6865 204d 5053 0d0a  e with the MPS..
+0003ab40: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0003ab50: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0003ab60: 616e 6365 2854 492c 2067 656f 6e65 2e69  ance(TI, geone.i
+0003ab70: 6d67 2e49 6d67 293a 0d0a 2020 2020 2020  mg.Img):..      
+0003ab80: 2020 2020 2020 7365 6c66 2e66 5f54 493d        self.f_TI=
+0003ab90: 5449 0d0a 2020 2020 2020 2020 2020 2020  TI..            
+0003aba0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+0003abb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003abc0: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
+0003abd0: 3a20 5449 2061 6464 6564 222e 666f 726d  : TI added".form
+0003abe0: 6174 2873 656c 662e 6e61 6d65 2929 0d0a  at(self.name))..
+0003abf0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0003ac00: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0003ac10: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+0003ac20: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0003ac30: 6e74 2822 5449 204e 4f54 2041 2047 454f  nt("TI NOT A GEO
+0003ac40: 4e45 2049 4d41 4745 2229 0d0a 0d0a 2020  NE IMAGE")....  
+0003ac50: 2020 6465 6620 7365 745f 5375 7266 6163    def set_Surfac
+0003ac60: 6528 7365 6c66 2c20 7375 7266 6163 6529  e(self, surface)
+0003ac70: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+0003ac80: 0d0a 2020 2020 2020 2020 4368 616e 6765  ..        Change
+0003ac90: 206f 7220 6164 6420 6120 746f 7020 7375   or add a top su
+0003aca0: 7266 6163 6520 666f 7220 556e 6974 206f  rface for Unit o
+0003acb0: 626a 6563 742e 0d0a 2020 2020 2020 2020  bject...        
+0003acc0: 5468 6973 2077 696c 6c20 6465 6669 6e65  This will define
+0003acd0: 2068 6f77 2074 6865 2074 6f70 206f 6620   how the top of 
+0003ace0: 7468 6520 666f 726d 6174 696f 6e20 7769  the formation wi
+0003acf0: 6c6c 2062 6520 6d6f 6465 6c6c 6564 2e0d  ll be modelled..
+0003ad00: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+0003ad10: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0003ad20: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0003ad30: 2020 2073 7572 6661 6365 3a20 3a63 6c61     surface: :cla
+0003ad40: 7373 3a60 5375 7266 6163 6560 206f 626a  ss:`Surface` obj
+0003ad50: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
+0003ad60: 2053 7572 6661 6365 206f 626a 6563 7420   Surface object 
+0003ad70: 746f 2075 7365 2066 6f72 2074 6865 2073  to use for the s
+0003ad80: 696d 756c 6174 696f 6e20 6f66 2074 6865  imulation of the
+0003ad90: 2074 6f70 206f 6620 7468 6520 666f 726d   top of the form
+0003ada0: 6174 696f 6e0d 0a20 2020 2020 2020 2022  ation..        "
+0003adb0: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
+0003adc0: 2069 7369 6e73 7461 6e63 6528 7375 7266   isinstance(surf
+0003add0: 6163 652c 2053 7572 6661 6365 293a 0d0a  ace, Surface):..
+0003ade0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003adf0: 2e73 7572 6661 6365 3d73 7572 6661 6365  .surface=surface
+0003ae00: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0003ae10: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
+0003ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ae30: 7072 696e 7428 2255 6e69 7420 7b7d 3a20  print("Unit {}: 
+0003ae40: 5375 7266 6163 6520 6164 6465 6420 666f  Surface added fo
+0003ae50: 7220 696e 7465 7270 6f6c 6174 696f 6e22  r interpolation"
+0003ae60: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
+0003ae70: 6529 290d 0a20 2020 2020 2020 2065 6c73  e))..        els
+0003ae80: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0003ae90: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0003aea0: 2822 5375 7266 6163 6520 6f62 6a65 6374  ("Surface object
+0003aeb0: 206d 7573 7420 6265 2061 6e20 6f62 6a65   must be an obje
+0003aec0: 6374 206f 6620 7468 6520 636c 6173 7320  ct of the class 
+0003aed0: 5375 7266 6163 6520 6672 6f6d 2041 7263  Surface from Arc
+0003aee0: 6850 7922 290d 0a0d 0a20 2020 2064 6566  hPy")....    def
+0003aef0: 2073 6574 5f66 5f63 6f76 6d6f 6465 6c73   set_f_covmodels
+0003af00: 2873 656c 662c 2066 5f63 6f76 6d6f 6465  (self, f_covmode
+0003af10: 6c29 3a0d 0a0d 0a20 2020 2020 2020 2022  l):....        "
+0003af20: 2222 0d0a 2020 2020 2020 2020 5265 6d6f  ""..        Remo
+0003af30: 7665 2065 7869 7374 696e 6720 6661 6369  ve existing faci
+0003af40: 6573 2063 6f76 6d6f 6465 6c73 2061 6e64  es covmodels and
+0003af50: 206f 6e65 206f 7220 6d6f 7265 0d0a 2020   one or more..  
+0003af60: 2020 2020 2020 6465 7065 6e64 696e 6720        depending 
+0003af70: 6f66 2077 6861 7420 6973 2070 6173 7365  of what is passe
+0003af80: 6420 2861 7272 6179 206c 696b 6520 6f72  d (array like or
+0003af90: 206f 6e6c 7920 6f6e 6520 6f62 6a65 6374   only one object
+0003afa0: 290d 0a0d 0a20 2020 2020 2020 2050 6172  )....        Par
+0003afb0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0003afc0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a20   ----------.... 
+0003afd0: 2020 2020 2020 2066 5f63 6f76 6d6f 6465         f_covmode
+0003afe0: 6c3a 2067 656f 6e65 2e63 6f76 4d6f 6465  l: geone.covMode
+0003aff0: 6c20 6f62 6a65 6374 200d 0a20 2020 2020  l object ..     
+0003b000: 2020 2020 2020 2074 6861 7420 7769 6c6c         that will
+0003b010: 2062 6520 7573 6564 2066 6f72 2074 6865   be used for the
+0003b020: 2069 6e74 6572 706f 6c61 7469 6f6e 206f   interpolation o
+0003b030: 6620 7468 6520 6661 6369 6573 2069 6620  f the facies if 
+0003b040: 6d65 7468 6f64 2069 7320 5349 532e 0d0a  method is SIS...
+0003b050: 2020 2020 2020 2020 2020 2020 4361 6e20              Can 
+0003b060: 6265 2061 206c 6973 7420 6f72 206f 6e6c  be a list or onl
+0003b070: 7920 6f6e 6520 6f62 6a65 6374 2e0d 0a20  y one object... 
+0003b080: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+0003b090: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
+0003b0a0: 665f 636f 766d 6f64 656c 3d5b 5d0d 0a20  f_covmodel=[].. 
+0003b0b0: 2020 2020 2020 2063 6f76 6d6f 6465 6c73         covmodels
+0003b0c0: 5f63 6c61 7373 3d28 6765 6f6e 652e 636f  _class=(geone.co
+0003b0d0: 764d 6f64 656c 2e43 6f76 4d6f 6465 6c33  vModel.CovModel3
+0003b0e0: 4429 0d0a 2020 2020 2020 2020 7472 793a  D)..        try:
+0003b0f0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+0003b100: 7220 636f 766d 6f64 656c 2069 6e20 665f  r covmodel in f_
+0003b110: 636f 766d 6f64 656c 3a0d 0a20 2020 2020  covmodel:..     
+0003b120: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0003b130: 696e 7374 616e 6365 2863 6f76 6d6f 6465  instance(covmode
+0003b140: 6c2c 2063 6f76 6d6f 6465 6c73 5f63 6c61  l, covmodels_cla
+0003b150: 7373 293a 0d0a 2020 2020 2020 2020 2020  ss):..          
+0003b160: 2020 2020 2020 2020 2020 663d 310d 0a20            f=1.. 
+0003b170: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003b180: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0003b190: 2020 2020 2020 2020 2020 663d 300d 0a20            f=0.. 
+0003b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b1b0: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
+0003b1c0: 2020 2020 2020 6966 2066 3a0d 0a20 2020        if f:..   
+0003b1d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003b1e0: 662e 6c69 7374 5f66 5f63 6f76 6d6f 6465  f.list_f_covmode
+0003b1f0: 6c3d 665f 636f 766d 6f64 656c 0d0a 0d0a  l=f_covmodel....
+0003b200: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003b210: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003b220: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0003b230: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003b240: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0003b250: 6174 206c 6561 7374 206f 6e65 2063 6f76  at least one cov
+0003b260: 6d6f 6465 6c20 6973 206e 6f74 2061 2033  model is not a 3
+0003b270: 4420 636f 766d 6f64 656c 2067 656f 6e65  D covmodel geone
+0003b280: 2c20 6e6f 7468 696e 6720 6861 7320 6368  , nothing has ch
+0003b290: 616e 6765 6422 290d 0a0d 0a20 2020 2020  anged")....     
+0003b2a0: 2020 2065 7863 6570 743a 2023 206f 6e6c     except: # onl
+0003b2b0: 7920 6f6e 6520 6f62 6a65 6374 2070 6173  y one object pas
+0003b2c0: 7365 640d 0a20 2020 2020 2020 2020 2020  sed..           
+0003b2d0: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+0003b2e0: 5f63 6f76 6d6f 6465 6c2c 2063 6f76 6d6f  _covmodel, covmo
+0003b2f0: 6465 6c73 5f63 6c61 7373 293a 0d0a 2020  dels_class):..  
+0003b300: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0003b310: 6c66 2e6c 6973 745f 665f 636f 766d 6f64  lf.list_f_covmod
+0003b320: 656c 2e61 7070 656e 6428 665f 636f 766d  el.append(f_covm
+0003b330: 6f64 656c 290d 0a20 2020 2020 2020 2020  odel)..         
+0003b340: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+0003b350: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+0003b360: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0003b370: 6e74 2822 556e 6974 207b 7d3a 2063 6f76  nt("Unit {}: cov
+0003b380: 6d6f 6465 6c20 666f 7220 5349 5320 6164  model for SIS ad
+0003b390: 6465 6422 2e66 6f72 6d61 7428 7365 6c66  ded".format(self
+0003b3a0: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
+0003b3b0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0003b3c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0003b3d0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
+0003b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b3f0: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
+0003b400: 3a20 636f 766d 6f64 656c 206e 6f74 2061  : covmodel not a
+0003b410: 2067 656f 6e65 2033 4420 636f 766d 6f64   geone 3D covmod
+0003b420: 656c 222e 666f 726d 6174 2873 656c 662e  el".format(self.
+0003b430: 6e61 6d65 2929 0d0a 0d0a 2020 2020 6465  name))....    de
+0003b440: 6620 6765 745f 685f 6c65 7665 6c28 7365  f get_h_level(se
+0003b450: 6c66 293a 0d0a 0d0a 2020 2020 2020 2020  lf):....        
+0003b460: 2222 220d 0a20 2020 2020 2020 2052 6574  """..        Ret
+0003b470: 7572 6e20 6869 6572 6172 6368 6963 616c  urn hierarchical
+0003b480: 206c 6576 656c 206f 6620 7468 6520 756e   level of the un
+0003b490: 6974 0d0a 2020 2020 2020 2020 2222 220d  it..        """.
+0003b4a0: 0a0d 0a20 2020 2020 2020 2064 6566 2066  ...        def f
+0003b4b0: 756e 6328 756e 6974 2c20 685f 6c65 7629  unc(unit, h_lev)
+0003b4c0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+0003b4d0: 6620 756e 6974 2e6d 756d 6d79 5f75 6e69  f unit.mummy_uni
+0003b4e0: 7420 6973 206e 6f74 204e 6f6e 653a 0d0a  t is not None:..
 0003b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b500: 2020 6675 6e28 756e 6974 290d 0a0d 0a20    fun(unit).... 
-0003b510: 2020 2020 2020 2020 2020 2066 756e 2873             fun(s
-0003b520: 656c 6629 0d0a 2020 2020 2020 2020 7265  elf)..        re
-0003b530: 7475 726e 2073 656c 662e 6262 5f75 6e69  turn self.bb_uni
-0003b540: 7473 0d0a 0d0a 2020 2020 6465 6620 6164  ts....    def ad
-0003b550: 645f 6661 6369 6573 2873 656c 662c 2066  d_facies(self, f
-0003b560: 6163 6965 7329 3a0d 0a0d 0a20 2020 2020  acies):....     
-0003b570: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0003b580: 4164 6420 6661 6369 6573 206f 626a 6563  Add facies objec
-0003b590: 7420 746f 2073 7472 6174 690d 0a0d 0a20  t to strati.... 
-0003b5a0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0003b5b0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0003b5c0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
-0003b5d0: 6163 6965 733a 203a 636c 6173 733a 6046  acies: :class:`F
-0003b5e0: 6163 6965 7360 206f 626a 6563 7420 6f72  acies` object or
-0003b5f0: 206c 6973 7420 6f66 2074 6865 6d0d 0a20   list of them.. 
-0003b600: 2020 2020 2020 2020 2020 2046 6163 6965             Facie
-0003b610: 7320 6f62 6a65 6374 2074 6f20 6d6f 6465  s object to mode
-0003b620: 6c20 696e 7369 6465 2074 6865 2075 6e69  l inside the uni
-0003b630: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
-0003b640: 0d0a 2020 2020 2020 2020 6966 2074 7970  ..        if typ
-0003b650: 6528 6661 6369 6573 2920 3d3d 206c 6973  e(facies) == lis
-0003b660: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-0003b670: 666f 7220 6920 696e 2066 6163 6965 733a  for i in facies:
-0003b680: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b690: 2020 6966 2028 6973 696e 7374 616e 6365    if (isinstance
-0003b6a0: 2869 2c20 4661 6369 6573 2929 2061 6e64  (i, Facies)) and
-0003b6b0: 2028 6920 6e6f 7420 696e 2073 656c 662e   (i not in self.
-0003b6c0: 6c69 7374 5f66 6163 6965 7329 3a20 2320  list_facies): # 
-0003b6d0: 6368 6563 6b20 4661 6369 6573 206f 626a  check Facies obj
-0003b6e0: 6563 7420 6265 6c6f 6e67 2074 6f20 4661  ect belong to Fa
-0003b6f0: 6369 6573 2063 6c61 7373 0d0a 2020 2020  cies class..    
-0003b700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b710: 7365 6c66 2e6c 6973 745f 6661 6369 6573  self.list_facies
-0003b720: 2e61 7070 656e 6428 6929 0d0a 2020 2020  .append(i)..    
-0003b730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b740: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-0003b750: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b760: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0003b770: 2246 6163 6965 7320 7b7d 2061 6464 6564  "Facies {} added
-0003b780: 2074 6f20 756e 6974 207b 7d22 2e66 6f72   to unit {}".for
-0003b790: 6d61 7428 692e 6e61 6d65 2c20 7365 6c66  mat(i.name, self
-0003b7a0: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
-0003b7b0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0003b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b7d0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-0003b7e0: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
-0003b7f0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0003b800: 696e 7428 226f 626a 6563 7420 6973 6e27  int("object isn'
-0003b810: 7420 6120 4661 6369 6573 206f 626a 6563  t a Facies objec
-0003b820: 7420 6f72 2046 6163 6965 7320 6f62 6a65  t or Facies obje
-0003b830: 6374 2068 6173 2061 6c72 6561 6479 2062  ct has already b
-0003b840: 6565 6e20 6164 6465 6422 290d 0a20 2020  een added")..   
-0003b850: 2020 2020 2065 6c73 653a 2023 2066 6163       else: # fac
-0003b860: 6965 7320 6e6f 7420 696e 2061 206c 6973  ies not in a lis
-0003b870: 740d 0a20 2020 2020 2020 2020 2020 2069  t..            i
-0003b880: 6620 2869 7369 6e73 7461 6e63 6528 6661  f (isinstance(fa
-0003b890: 6369 6573 2c20 4661 6369 6573 2929 2020  cies, Facies))  
-0003b8a0: 616e 6420 2866 6163 6965 7320 6e6f 7420  and (facies not 
-0003b8b0: 696e 2073 656c 662e 6c69 7374 5f66 6163  in self.list_fac
-0003b8c0: 6965 7329 3a0d 0a20 2020 2020 2020 2020  ies):..         
-0003b8d0: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
-0003b8e0: 5f66 6163 6965 732e 6170 7065 6e64 2866  _facies.append(f
-0003b8f0: 6163 6965 7329 0d0a 2020 2020 2020 2020  acies)..        
-0003b900: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0003b910: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-0003b920: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0003b930: 696e 7428 2246 6163 6965 7320 7b7d 2061  int("Facies {} a
-0003b940: 6464 6564 2074 6f20 756e 6974 207b 7d22  dded to unit {}"
-0003b950: 2e66 6f72 6d61 7428 6661 6369 6573 2e6e  .format(facies.n
-0003b960: 616d 652c 2073 656c 662e 6e61 6d65 2929  ame, self.name))
-0003b970: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0003b980: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0003b990: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-0003b9a0: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-0003b9b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0003b9c0: 2822 6f62 6a65 6374 2069 736e 2774 2061  ("object isn't a
-0003b9d0: 2046 6163 6965 7320 6f62 6a65 6374 206f   Facies object o
-0003b9e0: 7220 4661 6369 6573 206f 626a 6563 7420  r Facies object 
-0003b9f0: 6861 7320 616c 7265 6164 7920 6265 656e  has already been
-0003ba00: 2061 6464 6564 2229 0d0a 0d0a 2020 2020   added")....    
-0003ba10: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
-0003ba20: 2020 6465 6620 7265 6d5f 6661 6369 6573    def rem_facies
-0003ba30: 2873 656c 662c 2066 6163 6965 733d 4e6f  (self, facies=No
-0003ba40: 6e65 2c20 616c 6c5f 6661 6369 6573 3d54  ne, all_facies=T
-0003ba50: 7275 6529 3a0d 0a0d 0a20 2020 2020 2020  rue):....       
-0003ba60: 2022 2222 0d0a 2020 2020 2020 2020 546f   """..        To
-0003ba70: 2072 656d 6f76 6520 6661 6369 6573 2066   remove facies f
-0003ba80: 726f 6d20 756e 6974 2c20 6279 2064 6566  rom unit, by def
-0003ba90: 6175 6c74 2061 6c6c 2066 6163 6965 7320  ault all facies 
-0003baa0: 6172 6520 7265 6d6f 7665 640d 0a0d 0a20  are removed.... 
-0003bab0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0003bac0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0003bad0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
-0003bae0: 6163 6965 733a 203a 636c 6173 733a 6046  acies: :class:`F
-0003baf0: 6163 6965 7360 206f 626a 6563 7420 6f72  acies` object or
-0003bb00: 206c 6973 7420 6f66 2074 6865 6d0d 0a20   list of them.. 
-0003bb10: 2020 2020 2020 2020 2020 2046 6163 6965             Facie
-0003bb20: 7320 6f62 6a65 6374 2074 6f20 7265 6d6f  s object to remo
-0003bb30: 7665 2066 726f 6d20 7468 6520 756e 6974  ve from the unit
-0003bb40: 0d0a 2020 2020 2020 2020 616c 6c5f 6661  ..        all_fa
-0003bb50: 6369 6573 3a20 626f 6f6c 0d0a 2020 2020  cies: bool..    
-0003bb60: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-0003bb70: 2061 6c6c 2066 6163 6965 7320 6172 6520   all facies are 
-0003bb80: 7265 6d6f 7665 640d 0a20 2020 2020 2020  removed..       
-0003bb90: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
-0003bba0: 6966 2061 6c6c 5f66 6163 6965 733a 0d0a  if all_facies:..
-0003bbb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003bbc0: 2e6c 6973 745f 6661 6369 6573 3d5b 5d0d  .list_facies=[].
-0003bbd0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0003bbe0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003bbf0: 2e6c 6973 745f 6661 6369 6573 2e72 656d  .list_facies.rem
-0003bc00: 6f76 6528 6661 6369 6573 290d 0a0d 0a20  ove(facies).... 
-0003bc10: 2020 2064 6566 2063 6f6d 7075 7465 5f66     def compute_f
-0003bc20: 6163 6965 7328 7365 6c66 2c20 4172 6368  acies(self, Arch
-0003bc30: 5461 626c 652c 206e 7265 616c 3d31 2c20  Table, nreal=1, 
-0003bc40: 6d6f 6465 3d22 6661 6369 6573 222c 2076  mode="facies", v
-0003bc50: 6572 626f 7365 3d30 293a 0d0a 0d0a 2020  erbose=0):....  
-0003bc60: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0003bc70: 2020 2043 6f6d 7075 7465 2066 6163 6965     Compute facie
-0003bc80: 7320 646f 6d61 696e 2066 6f72 2074 6865  s domain for the
-0003bc90: 2073 7065 6369 6669 6320 756e 6974 0d0a   specific unit..
-0003bca0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0003bcb0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0003bcc0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0003bcd0: 2020 4172 6368 5461 626c 653a 203a 636c    ArchTable: :cl
-0003bce0: 6173 733a 6041 7263 685f 7461 626c 6560  ass:`Arch_table`
-0003bcf0: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-0003bd00: 2020 2020 2041 7263 6854 6162 6c65 2063       ArchTable c
-0003bd10: 6f6e 7461 696e 696e 6720 756e 6974 732c  ontaining units,
-0003bd20: 2073 7572 6661 6365 2c0d 0a20 2020 2020   surface,..     
-0003bd30: 2020 2020 2020 2066 6163 6965 7320 616e         facies an
-0003bd40: 6420 6174 206c 6561 7374 2061 2050 696c  d at least a Pil
-0003bd50: 6520 2873 6565 2065 7861 6d70 6c65 206f  e (see example o
-0003bd60: 6e20 7468 6520 6769 7468 7562 290d 0a20  n the github).. 
-0003bd70: 2020 2020 2020 206e 7265 616c 2020 203a         nreal   :
-0003bd80: 2069 6e74 0d0a 2020 2020 2020 2020 2020   int..          
-0003bd90: 2020 6e75 6d62 6572 206f 6620 7265 616c    number of real
-0003bda0: 697a 6174 696f 6e20 2870 6572 2075 6e69  ization (per uni
-0003bdb0: 7420 7265 616c 697a 6174 696f 6e73 2920  t realizations) 
-0003bdc0: 746f 206d 616b 650d 0a20 2020 2020 2020  to make..       
-0003bdd0: 206d 6f64 653a 2073 7472 0d0a 2020 2020   mode: str..    
-0003bde0: 2020 2020 2020 2020 2266 6163 6965 7322          "facies"
-0003bdf0: 206f 7220 2273 7472 6174 6922 0d0a 2020   or "strati"..  
-0003be00: 2020 2020 2020 7665 7262 6f73 6520 3a20        verbose : 
-0003be10: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
-0003be20: 2076 6572 626f 7369 7479 206c 6576 656c   verbosity level
-0003be30: 2c20 3020 666f 7220 6e6f 2070 7269 6e74  , 0 for no print
-0003be40: 2c20 3120 666f 7220 7072 696e 740d 0a20  , 1 for print.. 
-0003be50: 2020 2020 2020 2022 2222 0d0a 200d 0a0d         """.. ...
-0003be60: 0a20 2020 2020 2020 2078 673d 4172 6368  .        xg=Arch
-0003be70: 5461 626c 652e 6765 745f 7867 2829 0d0a  Table.get_xg()..
-0003be80: 2020 2020 2020 2020 7967 3d41 7263 6854          yg=ArchT
-0003be90: 6162 6c65 2e67 6574 5f79 6728 290d 0a20  able.get_yg().. 
-0003bea0: 2020 2020 2020 207a 673d 4172 6368 5461         zg=ArchTa
-0003beb0: 626c 652e 6765 745f 7a67 2829 0d0a 0d0a  ble.get_zg()....
-0003bec0: 2020 2020 2020 2020 7365 6564 3d41 7263          seed=Arc
-0003bed0: 6854 6162 6c65 2e73 6565 640d 0a20 2020  hTable.seed..   
-0003bee0: 2020 2020 206e 702e 7261 6e64 6f6d 2e73       np.random.s
-0003bef0: 6565 6428 7365 6564 290d 0a0d 0a20 2020  eed(seed)....   
-0003bf00: 2020 2020 2023 2320 6772 6964 2070 6172       ## grid par
-0003bf10: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0003bf20: 206e 783d 6c65 6e28 7867 292d 310d 0a20   nx=len(xg)-1.. 
-0003bf30: 2020 2020 2020 206e 793d 6c65 6e28 7967         ny=len(yg
-0003bf40: 292d 310d 0a20 2020 2020 2020 206e 7a3d  )-1..        nz=
-0003bf50: 6c65 6e28 7a67 292d 310d 0a20 2020 2020  len(zg)-1..     
-0003bf60: 2020 2064 696d 656e 7369 6f6e 733d 286e     dimensions=(n
-0003bf70: 782c 206e 792c 206e 7a29 0d0a 2020 2020  x, ny, nz)..    
-0003bf80: 2020 2020 6f78 3d6e 702e 6d69 6e28 7867      ox=np.min(xg
-0003bf90: 5b30 5d29 0d0a 2020 2020 2020 2020 6f79  [0])..        oy
-0003bfa0: 3d6e 702e 6d69 6e28 7967 5b30 5d29 0d0a  =np.min(yg[0])..
-0003bfb0: 2020 2020 2020 2020 6f7a 3d6e 702e 6d69          oz=np.mi
-0003bfc0: 6e28 7a67 5b30 5d29 0d0a 2020 2020 2020  n(zg[0])..      
-0003bfd0: 2020 6f72 6967 696e 3d28 6f78 2c20 6f79    origin=(ox, oy
-0003bfe0: 2c20 6f7a 290d 0a20 2020 2020 2020 2073  , oz)..        s
-0003bff0: 783d 6e70 2e64 6966 6628 7867 295b 305d  x=np.diff(xg)[0]
-0003c000: 0d0a 2020 2020 2020 2020 7379 3d6e 702e  ..        sy=np.
-0003c010: 6469 6666 2879 6729 5b30 5d0d 0a20 2020  diff(yg)[0]..   
-0003c020: 2020 2020 2073 7a3d 6e70 2e64 6966 6628       sz=np.diff(
-0003c030: 7a67 295b 305d 0d0a 2020 2020 2020 2020  zg)[0]..        
-0003c040: 7370 6163 696e 673d 2873 782c 2073 792c  spacing=(sx, sy,
-0003c050: 2073 7a29 0d0a 0d0a 2020 2020 2020 2020   sz)....        
-0003c060: 6e72 6561 6c5f 756e 6974 7320 3d20 4172  nreal_units = Ar
-0003c070: 6368 5461 626c 652e 6e72 6561 6c5f 756e  chTable.nreal_un
-0003c080: 6974 730d 0a0d 0a20 2020 2020 2020 2066  its....        f
-0003c090: 6163 6965 735f 646f 6d61 696e 733d 6e70  acies_domains=np
-0003c0a0: 2e7a 6572 6f73 285b 6e72 6561 6c5f 756e  .zeros([nreal_un
-0003c0b0: 6974 732c 206e 7265 616c 2c20 6e7a 2c20  its, nreal, nz, 
-0003c0c0: 6e79 2c20 6e78 5d2c 2064 7479 7065 3d6e  ny, nx], dtype=n
-0003c0d0: 702e 696e 7438 290d 0a0d 0a20 2020 2020  p.int8)....     
-0003c0e0: 2020 2069 6620 6d6f 6465 203d 3d20 2266     if mode == "f
-0003c0f0: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
-0003c100: 2020 2020 206d 6574 686f 643d 7365 6c66       method=self
-0003c110: 2e66 5f6d 6574 686f 6420 2023 206d 6574  .f_method  # met
-0003c120: 686f 6420 6f66 2073 696d 756c 6174 696f  hod of simulatio
-0003c130: 6e0d 0a20 2020 2020 2020 2065 6c69 6620  n..        elif 
-0003c140: 6d6f 6465 203d 3d20 2275 6e69 7473 223a  mode == "units":
-0003c150: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003c160: 2022 756e 6974 735f 6669 6c6c 5f6d 6574   "units_fill_met
-0003c170: 686f 6422 2069 6e20 7365 6c66 2e64 6963  hod" in self.dic
-0003c180: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
-0003c190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c1a0: 206d 6574 686f 6420 3d20 7365 6c66 2e64   method = self.d
-0003c1b0: 6963 5f66 6163 6965 735b 2275 6e69 7473  ic_facies["units
-0003c1c0: 5f66 696c 6c5f 6d65 7468 6f64 225d 0d0a  _fill_method"]..
-0003c1d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003c1e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003c1f0: 2020 206d 6574 686f 6420 3d20 2268 6f6d     method = "hom
-0003c200: 6f67 656e 6f75 7322 0d0a 0d0a 2020 2020  ogenous"....    
-0003c210: 2020 2020 6b77 6172 6773 3d73 656c 662e      kwargs=self.
-0003c220: 6469 635f 6661 6369 6573 2020 2320 7265  dic_facies  # re
-0003c230: 7472 6965 7665 206b 6579 776f 7264 2061  trieve keyword a
-0003c240: 7267 756d 656e 7473 0d0a 0d0a 2020 2020  rguments....    
-0003c250: 2020 2020 2364 6566 6175 6c74 206b 7761      #default kwa
-0003c260: 7267 7320 666f 7220 5349 530d 0a20 2020  rgs for SIS..   
-0003c270: 2020 2020 206b 7761 7267 735f 6465 665f       kwargs_def_
-0003c280: 5349 533d 7b22 6e65 6967 223a 2031 302c  SIS={"neig": 10,
-0003c290: 2022 7222 3a20 312c 2022 7072 6f62 6162   "r": 1, "probab
-0003c2a0: 696c 6974 7922 3a20 4e6f 6e65 2c22 5349  ility": None,"SI
-0003c2b0: 535f 6f72 6965 6e74 6174 696f 6e22 3a20  S_orientation": 
-0003c2c0: 4661 6c73 652c 2261 7a69 6d75 7468 223a  False,"azimuth":
-0003c2d0: 2030 2c22 6469 7022 3a20 302c 2270 6c75   0,"dip": 0,"plu
-0003c2e0: 6e67 6522 3a20 307d 0d0a 0d0a 2020 2020  nge": 0}....    
-0003c2f0: 2020 2020 6b77 6172 6773 5f64 6566 5f4d      kwargs_def_M
-0003c300: 5053 3d7b 2276 6172 6e61 6d65 223a 2263  PS={"varname":"c
-0003c310: 6f64 6522 2c20 226e 7622 3a31 2c20 2264  ode", "nv":1, "d
-0003c320: 6174 6149 6d61 6765 223a 4e6f 6e65 2c20  ataImage":None, 
-0003c330: 2264 6973 7461 6e63 6554 7970 6522 3a5b  "distanceType":[
-0003c340: 2263 6174 6567 6f72 6963 616c 225d 2c20  "categorical"], 
-0003c350: 226f 7574 7075 7456 6172 466c 6167 223a  "outputVarFlag":
-0003c360: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-0003c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c380: 2278 7222 3a20 312c 2022 7972 223a 2031  "xr": 1, "yr": 1
-0003c390: 2c20 227a 7222 3a20 312c 2022 6d61 7873  , "zr": 1, "maxs
-0003c3a0: 6361 6e22 3a20 302e 3235 2c20 226e 6569  can": 0.25, "nei
-0003c3b0: 6722 3a20 3234 2c20 2274 6872 6573 6822  g": 24, "thresh"
-0003c3c0: 3a20 302e 3035 2c20 2278 6c6f 6322 3a20  : 0.05, "xloc": 
-0003c3d0: 4661 6c73 652c 2022 796c 6f63 223a 2046  False, "yloc": F
-0003c3e0: 616c 7365 2c20 227a 6c6f 6322 3a20 4661  alse, "zloc": Fa
-0003c3f0: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-0003c400: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003c410: 686f 6d6f 5f75 7361 6765 223a 2031 2c20  homo_usage": 1, 
-0003c420: 2272 6f74 5f75 7361 6765 223a 2031 2c20  "rot_usage": 1, 
-0003c430: 2272 6f74 417a 694c 6f63 223a 2046 616c  "rotAziLoc": Fal
-0003c440: 7365 2c20 2272 6f74 417a 6922 3a20 302c  se, "rotAzi": 0,
-0003c450: 2022 726f 7444 6970 4c6f 6322 3a20 4661   "rotDipLoc": Fa
-0003c460: 6c73 652c 2022 726f 7444 6970 223a 2030  lse, "rotDip": 0
-0003c470: 2c20 2272 6f74 506c 756e 6765 4c6f 6322  , "rotPlungeLoc"
-0003c480: 3a20 4661 6c73 652c 2022 726f 7450 6c75  : False, "rotPlu
-0003c490: 6e67 6522 3a20 302c 0d0a 2020 2020 2020  nge": 0,..      
-0003c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c4b0: 2020 2022 617a 695f 746f 7022 3a22 6772     "azi_top":"gr
-0003c4c0: 6164 6965 6e74 222c 2022 617a 695f 626f  adient", "azi_bo
-0003c4d0: 7422 3a22 6772 6164 6965 6e74 222c 2022  t":"gradient", "
-0003c4e0: 6469 705f 746f 7022 3a22 6772 6164 6965  dip_top":"gradie
-0003c4f0: 6e74 222c 2022 6469 705f 626f 7422 3a22  nt", "dip_bot":"
-0003c500: 6772 6164 6965 6e74 222c 0d0a 2020 2020  gradient",..    
-0003c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c520: 2020 2020 2022 7261 6469 7573 4d6f 6465       "radiusMode
-0003c530: 223a 2022 6c61 7267 655f 6465 6661 756c  ": "large_defaul
-0003c540: 7422 2c20 2272 7822 3a20 6e78 2a73 782c  t", "rx": nx*sx,
-0003c550: 2022 7279 223a 206e 792a 7379 2c20 2272   "ry": ny*sy, "r
-0003c560: 7a22 3a20 6e7a 2a73 7a2c 2022 616e 6973  z": nz*sz, "anis
-0003c570: 6f74 726f 7079 5261 7469 6f4d 6f64 6522  otropyRatioMode"
-0003c580: 3a20 226f 6e65 222c 2022 6178 223a 2031  : "one", "ax": 1
-0003c590: 2c20 2261 7922 3a20 312c 2022 617a 223a  , "ay": 1, "az":
-0003c5a0: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
-0003c5b0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-0003c5c0: 6e67 6c65 3122 3a20 302c 2022 616e 676c  ngle1": 0, "angl
-0003c5d0: 6532 223a 2030 2c20 2261 6e67 6c65 3322  e2": 0, "angle3"
-0003c5e0: 3a20 302c 0d0a 2020 2020 2020 2020 2020  : 0,..          
-0003c5f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003c600: 676c 6f62 616c 5064 6622 3a20 4e6f 6e65  globalPdf": None
-0003c610: 2c20 226c 6f63 616c 5064 6622 3a20 4e6f  , "localPdf": No
-0003c620: 6e65 2c20 2270 726f 6261 5573 6167 6522  ne, "probaUsage"
-0003c630: 3a20 302c 2022 6c6f 6361 6c50 6466 5261  : 0, "localPdfRa
-0003c640: 6469 7573 223a 2031 322e 2c20 2264 6561  dius": 12., "dea
-0003c650: 6374 6976 6174 696f 6e44 6973 7461 6e63  ctivationDistanc
-0003c660: 6522 3a20 342e 2c20 2263 6f6e 7374 616e  e": 4., "constan
-0003c670: 7454 6872 6573 686f 6c64 223a 2031 652d  tThreshold": 1e-
-0003c680: 332c 2022 6e70 6f73 7422 3a31 7d0d 0a0d  3, "npost":1}...
-0003c690: 0a20 2020 2020 2020 206b 7761 7267 735f  .        kwargs_
-0003c6a0: 6465 665f 5450 4773 3d7b 226e 6569 6722  def_TPGs={"neig"
-0003c6b0: 3a20 3230 2c20 226e 6974 223a 2031 3030  : 20, "nit": 100
-0003c6c0: 2c20 2267 7266 5f6d 6574 686f 6422 3a20  , "grf_method": 
-0003c6d0: 2266 6674 227d 0d0a 0d0a 2020 2020 2020  "fft"}....      
-0003c6e0: 2020 6d65 7468 6f64 733d 5b22 5349 5322    methods=["SIS"
-0003c6f0: 2c20 224d 5053 222c 2022 5450 4773 222c  , "MPS", "TPGs",
-0003c700: 2022 5375 6250 696c 6522 5d0d 0a20 2020   "SubPile"]..   
-0003c710: 2020 2020 206b 7761 7267 735f 6465 663d       kwargs_def=
-0003c720: 5b6b 7761 7267 735f 6465 665f 5349 532c  [kwargs_def_SIS,
-0003c730: 206b 7761 7267 735f 6465 665f 4d50 532c   kwargs_def_MPS,
-0003c740: 206b 7761 7267 735f 6465 665f 5450 4773   kwargs_def_TPGs
-0003c750: 5d0d 0a0d 0a20 2020 2020 2020 2066 6f72  ]....        for
-0003c760: 2066 5f6d 6574 686f 642c 206b 7720 696e   f_method, kw in
-0003c770: 207a 6970 286d 6574 686f 6473 2c20 6b77   zip(methods, kw
-0003c780: 6172 6773 5f64 6566 293a 0d0a 2020 2020  args_def):..    
-0003c790: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
-0003c7a0: 6420 3d3d 2066 5f6d 6574 686f 643a 0d0a  d == f_method:..
-0003c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c7c0: 6966 206c 656e 286b 7761 7267 7329 203d  if len(kwargs) =
-0003c7d0: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-0003c7e0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0003c7f0: 3d6b 770d 0a20 2020 2020 2020 2020 2020  =kw..           
-0003c800: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0003c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c820: 666f 7220 6b2c 2076 2069 6e20 6b77 2e69  for k, v in kw.i
-0003c830: 7465 6d73 2829 3a0d 0a20 2020 2020 2020  tems():..       
-0003c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c850: 2069 6620 6b20 6e6f 7420 696e 206b 7761   if k not in kwa
-0003c860: 7267 732e 6b65 7973 2829 3a0d 0a20 2020  rgs.keys():..   
-0003c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c880: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-0003c890: 6b5d 3d76 0d0a 0d0a 2020 2020 2020 2020  k]=v....        
-0003c8a0: 2320 6c69 7374 206f 626a 6563 7473 0d0a  # list objects..
-0003c8b0: 2020 2020 2020 2020 6966 206d 6f64 6520          if mode 
-0003c8c0: 3d3d 2022 6661 6369 6573 223a 0d0a 2020  == "facies":..  
-0003c8d0: 2020 2020 2020 2020 2020 6c69 7374 5f6f            list_o
-0003c8e0: 626a 203d 2073 656c 662e 6c69 7374 5f66  bj = self.list_f
-0003c8f0: 6163 6965 730d 0a20 2020 2020 2020 2065  acies..        e
-0003c900: 6c69 6620 6d6f 6465 203d 3d20 2275 6e69  lif mode == "uni
-0003c910: 7473 223a 0d0a 2020 2020 2020 2020 2020  ts":..          
-0003c920: 2020 6c69 7374 5f6f 626a 203d 2073 656c    list_obj = sel
-0003c930: 662e 5375 6250 696c 652e 6c69 7374 5f75  f.SubPile.list_u
-0003c940: 6e69 7473 0d0a 0d0a 2020 2020 2020 2020  nits....        
-0003c950: 2363 6865 636b 2069 6620 6f6e 6c79 2031  #check if only 1
-0003c960: 2066 6163 6965 7320 2d2d 3e20 686f 6d6f   facies --> homo
-0003c970: 6765 6e6f 7573 0d0a 2020 2020 2020 2020  genous..        
-0003c980: 6966 206c 656e 286c 6973 745f 6f62 6a29  if len(list_obj)
-0003c990: 203c 2032 2061 6e64 206d 6574 686f 6420   < 2 and method 
-0003c9a0: 213d 2022 686f 6d6f 6765 6e6f 7573 223a  != "homogenous":
-0003c9b0: 0d0a 2020 2020 2020 2020 2020 2020 6d65  ..            me
-0003c9c0: 7468 6f64 203d 2268 6f6d 6f67 656e 6f75  thod ="homogenou
-0003c9d0: 7322 0d0a 2020 2020 2020 2020 2020 2020  s"..            
-0003c9e0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-0003c9f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ca00: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
-0003ca10: 2068 6173 206f 6e6c 7920 6f6e 6520 6661   has only one fa
-0003ca20: 6369 6573 2c20 6661 6369 6573 206d 6574  cies, facies met
-0003ca30: 686f 6420 7365 7473 2074 6f20 686f 6d6f  hod sets to homo
-0003ca40: 6765 6e6f 7573 222e 666f 726d 6174 2873  genous".format(s
-0003ca50: 656c 662e 6e61 6d65 2929 0d0a 0d0a 2020  elf.name))....  
-0003ca60: 2020 2020 2020 2323 2320 5369 6d75 6c61        ### Simula
-0003ca70: 7469 6f6e 7320 2323 230d 0a20 2020 2020  tions ###..     
-0003ca80: 2020 2069 6620 6d65 7468 6f64 2021 3d20     if method != 
-0003ca90: 2253 7562 5069 6c65 2220 6f72 206d 6f64  "SubPile" or mod
-0003caa0: 6520 3d3d 2022 756e 6974 7322 3a0d 0a20  e == "units":.. 
-0003cab0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0003cac0: 7520 696e 2072 616e 6765 286e 7265 616c  u in range(nreal
-0003cad0: 5f75 6e69 7473 293a 2023 206c 6f6f 7020  _units): # loop 
-0003cae0: 6f76 6572 2065 7869 7374 696e 6720 7375  over existing su
-0003caf0: 7266 6163 6573 0d0a 2020 2020 2020 2020  rfaces..        
-0003cb00: 2020 2020 2020 2020 6966 2041 7263 6854          if ArchT
-0003cb10: 6162 6c65 2e76 6572 626f 7365 3a0d 0a20  able.verbose:.. 
-0003cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb30: 2020 2070 7269 6e74 2822 2323 2320 556e     print("### Un
-0003cb40: 6974 207b 7d20 2d20 7265 616c 697a 6174  it {} - realizat
-0003cb50: 696f 6e20 7b7d 2023 2323 222e 666f 726d  ion {} ###".form
-0003cb60: 6174 2873 656c 662e 6e61 6d65 2c20 6975  at(self.name, iu
-0003cb70: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0003cb80: 2020 2020 6966 2073 656c 662e 636f 6e74      if self.cont
-0003cb90: 6163 7420 3d3d 2022 6f6e 6c61 7022 3a0d  act == "onlap":.
-0003cba0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0003cbb0: 2020 2020 2020 206d 6173 6b3d 4172 6368         mask=Arch
-0003cbc0: 5461 626c 652e 6765 745f 756e 6974 735f  Table.get_units_
-0003cbd0: 646f 6d61 696e 735f 7265 616c 697a 6174  domains_realizat
-0003cbe0: 696f 6e73 2869 7529 203d 3d20 7365 6c66  ions(iu) == self
-0003cbf0: 2e49 440d 0a0d 0a20 2020 2020 2020 2020  .ID....         
-0003cc00: 2020 2020 2020 2020 2020 2023 2320 484f             ## HO
-0003cc10: 4d4f 4745 4e4f 5553 2023 230d 0a20 2020  MOGENOUS ##..   
-0003cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc30: 2069 6620 6d65 7468 6f64 2e6c 6f77 6572   if method.lower
-0003cc40: 2829 203d 3d20 2268 6f6d 6f67 656e 6f75  () == "homogenou
-0003cc50: 7322 3a0d 0a0d 0a20 2020 2020 2020 2020  s":....         
-0003cc60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003cc70: 6620 6c65 6e28 6c69 7374 5f6f 626a 2920  f len(list_obj) 
-0003cc80: 3e20 313a 2023 206d 6f72 6520 7468 616e  > 1: # more than
-0003cc90: 206f 6e65 0d0a 2020 2020 2020 2020 2020   one..          
-0003cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ccb0: 2020 6966 2041 7263 6854 6162 6c65 2e76    if ArchTable.v
-0003ccc0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-0003ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cce0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-0003ccf0: 5741 524e 494e 4720 2121 204d 6f72 6520  WARNING !! More 
-0003cd00: 7468 616e 206f 6e65 2066 6163 6965 7320  than one facies 
-0003cd10: 6861 7320 6265 656e 2070 6173 7365 6420  has been passed 
-0003cd20: 746f 2068 6f6d 6f67 656e 6f75 7320 756e  to homogenous un
-0003cd30: 6974 207b 7d5c 6e46 6972 7374 2069 6e20  it {}\nFirst in 
-0003cd40: 7468 6520 6c69 7374 2069 7320 7461 6b65  the list is take
-0003cd50: 6e22 2e66 6f72 6d61 7428 7365 6c66 2e6e  n".format(self.n
-0003cd60: 616d 6529 290d 0a20 2020 2020 2020 2020  ame))..         
-0003cd70: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003cd80: 6c69 6620 6c65 6e28 6c69 7374 5f6f 626a  lif len(list_obj
-0003cd90: 2920 3c20 313a 2023 206e 6f20 6661 6369  ) < 1: # no faci
-0003cda0: 6573 2061 6464 6564 0d0a 2020 2020 2020  es added..      
-0003cdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cdc0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0003cdd0: 6545 7272 6f72 2028 224e 6f20 6661 6369  eError ("No faci
-0003cde0: 6573 2070 6173 7365 6420 746f 2068 6f6d  es passed to hom
-0003cdf0: 6f67 656e 6f75 7320 756e 6974 207b 7d22  ogenous unit {}"
-0003ce00: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
-0003ce10: 6529 290d 0a0d 0a20 2020 2020 2020 2020  e))....         
-0003ce20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003ce30: 2320 7365 7475 7020 6120 3344 2061 7272  # setup a 3D arr
-0003ce40: 6179 206f 6620 7468 6520 7369 6d75 6c61  ay of the simula
-0003ce50: 7469 6f6e 2067 7269 6420 7369 7a65 2061  tion grid size a
-0003ce60: 6e64 2061 7373 6967 6e20 6f6e 6520 6661  nd assign one fa
-0003ce70: 6369 6573 2074 6f20 7468 6520 756e 6974  cies to the unit
-0003ce80: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-0003ce90: 2020 2020 2020 2020 2020 2020 2066 6163               fac
-0003cea0: 6965 733d 6c69 7374 5f6f 626a 5b30 5d0d  ies=list_obj[0].
-0003ceb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003cec0: 2020 2020 2020 2020 2066 6f72 2069 7265           for ire
-0003ced0: 616c 2069 6e20 7261 6e67 6528 6e72 6561  al in range(nrea
-0003cee0: 6c29 3a0d 0a20 2020 2020 2020 2020 2020  l):..           
-0003cef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf00: 2066 6163 6965 735f 646f 6d61 696e 735b   facies_domains[
-0003cf10: 6975 2c20 6972 6561 6c5d 5b6d 6173 6b5d  iu, ireal][mask]
-0003cf20: 3d66 6163 6965 732e 4944 0d0a 0d0a 2020  =facies.ID....  
-0003cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf40: 2020 2323 2053 4953 2023 230d 0a20 2020    ## SIS ##..   
-0003cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf60: 2065 6c69 6620 6d65 7468 6f64 2e75 7070   elif method.upp
-0003cf70: 6572 2829 203d 3d20 2253 4953 223a 0d0a  er() == "SIS":..
-0003cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf90: 2020 2020 2020 2020 2323 2073 6574 7570          ## setup
-0003cfa0: 2053 4953 2023 230d 0a0d 0a20 2020 2020   SIS ##....     
-0003cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cfc0: 2020 2069 6620 6d6f 6465 203d 3d20 2266     if mode == "f
-0003cfd0: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
-0003cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cff0: 2020 2020 2068 642c 2066 6163 6965 7320       hd, facies 
-0003d000: 3d20 4172 6368 5461 626c 652e 6864 5f66  = ArchTable.hd_f
-0003d010: 615f 696e 5f75 6e69 7428 7365 6c66 2c20  a_in_unit(self, 
-0003d020: 6975 3d69 7529 0d0a 2020 2020 2020 2020  iu=iu)..        
-0003d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d040: 656c 6966 206d 6f64 6520 3d3d 2022 756e  elif mode == "un
-0003d050: 6974 7322 3a0d 0a20 2020 2020 2020 2020  its":..         
-0003d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d070: 2020 2068 642c 2066 6163 6965 7320 3d20     hd, facies = 
-0003d080: 4172 6368 5461 626c 652e 6864 5f75 6e5f  ArchTable.hd_un_
-0003d090: 696e 5f75 6e69 7428 7365 6c66 2c20 6975  in_unit(self, iu
-0003d0a0: 3d69 7529 0d0a 0d0a 2020 2020 2020 2020  =iu)....        
-0003d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d0c0: 6361 745f 7661 6c75 6573 3d5b 692e 4944  cat_values=[i.ID
-0003d0d0: 2066 6f72 2069 2069 6e20 6c69 7374 5f6f   for i in list_o
-0003d0e0: 626a 5d20 2023 2049 4420 7661 6c75 6573  bj]  # ID values
-0003d0f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003d100: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0003d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d120: 2020 2020 6864 3d6e 702e 6172 7261 7928      hd=np.array(
-0003d130: 6864 290d 0a20 2020 2020 2020 2020 2020  hd)..           
-0003d140: 2020 2020 2020 2020 2020 2020 2066 6163               fac
-0003d150: 6965 733d 6e70 2e61 7272 6179 2866 6163  ies=np.array(fac
-0003d160: 6965 7329 0d0a 2020 2020 2020 2020 2020  ies)..          
-0003d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d180: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0003d190: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0003d1a0: 6f72 6965 6e74 6174 696f 6e20 6d61 7020  orientation map 
-0003d1b0: 2323 2320 202d 3e20 746f 206d 6f64 6966  ###  -> to modif
-0003d1c0: 7920 2121 2121 0d0a 2020 2020 2020 2020  y !!!!..        
-0003d1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d1e0: 6966 2028 6b77 6172 6773 5b22 5349 535f  if (kwargs["SIS_
-0003d1f0: 6f72 6965 6e74 6174 696f 6e22 5d29 203d  orientation"]) =
-0003d200: 3d20 2266 6f6c 6c6f 775f 7375 7266 6163  = "follow_surfac
-0003d210: 6573 223a 2023 2069 6620 6f72 6965 6e74  es": # if orient
-0003d220: 6174 696f 6e73 206d 7573 7420 666f 6c6c  ations must foll
-0003d230: 6f77 2073 7572 6661 6365 730d 0a20 2020  ow surfaces..   
-0003d240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d250: 2020 2020 2020 2020 2023 2057 6172 6e69           # Warni
-0003d260: 6e67 3a20 5468 6973 206f 7074 696f 6e20  ng: This option 
-0003d270: 6368 616e 6765 7320 616c 7068 6120 616e  changes alpha an
-0003d280: 6420 6265 7461 2061 6e67 6c65 7320 6173  d beta angles as
-0003d290: 7375 6d69 6e67 2074 6861 7420 727a 2069  suming that rz i
-0003d2a0: 7320 736d 616c 6c65 7220 7468 616e 2072  s smaller than r
-0003d2b0: 7820 616e 6420 7279 2e20 4d6f 7265 6f76  x and ry. Moreov
-0003d2c0: 6572 2c20 7278 2061 6e64 2072 7920 6d75  er, rx and ry mu
-0003d2d0: 7374 2062 6520 7369 6d69 6c61 722e 0d0a  st be similar...
-0003d2e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003d2f0: 2020 2020 2020 2020 2020 2020 2020 617a                az
-0003d300: 692c 6469 703d 4172 6368 5461 626c 652e  i,dip=ArchTable.
-0003d310: 6f72 6965 6e74 6174 696f 6e5f 6d61 7028  orientation_map(
-0003d320: 7365 6c66 2c20 736d 6f6f 7468 3d35 290d  self, smooth=5).
-0003d330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d340: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003d350: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
-0003d360: 5f66 5f63 6f76 6d6f 6465 6c3a 2023 2069  _f_covmodel: # i
-0003d370: 7465 7261 7465 2074 6872 6f75 6768 2061  terate through a
-0003d380: 6c6c 2066 6163 6965 7320 636f 766d 6f64  ll facies covmod
-0003d390: 656c 7320 616e 6420 6368 616e 6765 2061  els and change a
-0003d3a0: 6e67 6c65 730d 0a20 2020 2020 2020 2020  ngles..         
-0003d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3c0: 2020 2020 2020 2063 6d2e 616c 7068 613d         cm.alpha=
-0003d3d0: 617a 690d 0a20 2020 2020 2020 2020 2020  azi..           
+0003b500: 685f 6c65 7620 2b3d 2031 0d0a 2020 2020  h_lev += 1..    
+0003b510: 2020 2020 2020 2020 2020 2020 685f 6c65              h_le
+0003b520: 763d 6675 6e63 2875 6e69 742e 6d75 6d6d  v=func(unit.mumm
+0003b530: 795f 756e 6974 2c20 685f 6c65 7629 0d0a  y_unit, h_lev)..
+0003b540: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0003b550: 7475 726e 2068 5f6c 6576 0d0a 2020 2020  turn h_lev..    
+0003b560: 2020 2020 685f 6c65 763d 310d 0a20 2020      h_lev=1..   
+0003b570: 2020 2020 2068 5f6c 6576 3d66 756e 6328       h_lev=func(
+0003b580: 7365 6c66 2c20 685f 6c65 7629 0d0a 2020  self, h_lev)..  
+0003b590: 2020 2020 2020 7265 7475 726e 2068 5f6c        return h_l
+0003b5a0: 6576 0d0a 0d0a 2020 2020 6465 6620 676f  ev....    def go
+0003b5b0: 6573 5f75 705f 756e 7469 6c28 7365 6c66  es_up_until(self
+0003b5c0: 2c20 756e 6974 5f74 6172 6765 7429 3a0d  , unit_target):.
+0003b5d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0003b5e0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+0003b5f0: 436c 696d 6220 7468 6520 6869 6572 6172  Climb the hierar
+0003b600: 6368 6963 616c 2074 7265 6520 6f66 2073  chical tree of s
+0003b610: 656c 6620 756e 6974 2075 6e74 696c 2066  elf unit until f
+0003b620: 696e 6469 6e67 2061 2073 7065 6369 6669  inding a specifi
+0003b630: 6320 756e 6974 2061 6e64 2072 6574 7572  c unit and retur
+0003b640: 6e20 6974 0d0a 0d0a 2020 2020 2020 2020  n it....        
+0003b650: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0003b660: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0003b670: 2020 2020 2020 2020 756e 6974 5f74 6172          unit_tar
+0003b680: 6765 743a 203a 636c 6173 733a 6055 6e69  get: :class:`Uni
+0003b690: 7460 206f 626a 6563 740d 0a20 2020 2020  t` object..     
+0003b6a0: 2020 2020 2020 2055 6e69 7420 6f62 6a65         Unit obje
+0003b6b0: 6374 2074 6f20 6669 6e64 2069 6e20 7468  ct to find in th
+0003b6c0: 6520 6869 6572 6172 6368 6963 616c 2074  e hierarchical t
+0003b6d0: 7265 650d 0a0d 0a20 2020 2020 2020 2052  ree....        R
+0003b6e0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0003b6f0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0003b700: 2075 6e69 743a 203a 636c 6173 733a 6055   unit: :class:`U
+0003b710: 6e69 7460 206f 626a 6563 7420 6f72 204e  nit` object or N
+0003b720: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
+0003b730: 2055 6e69 7420 6f62 6a65 6374 2066 6f75   Unit object fou
+0003b740: 6e64 2069 6e20 7468 6520 6869 6572 6172  nd in the hierar
+0003b750: 6368 6963 616c 2074 7265 650d 0a20 2020  chical tree..   
+0003b760: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0003b770: 666f 756e 642c 2072 6574 7572 6e20 4e6f  found, return No
+0003b780: 6e65 0d0a 2020 2020 2020 2020 2222 220d  ne..        """.
+0003b790: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0003b7a0: 2020 2075 6e69 7420 3d20 7365 6c66 0d0a     unit = self..
+0003b7b0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0003b7c0: 2072 616e 6765 2873 656c 662e 6765 745f   range(self.get_
+0003b7d0: 685f 6c65 7665 6c28 2929 3a0d 0a20 2020  h_level()):..   
+0003b7e0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0003b7f0: 2020 2020 2020 2069 6620 756e 6974 2021         if unit !
+0003b800: 3d20 756e 6974 5f74 6172 6765 743a 0d0a  = unit_target:..
+0003b810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b820: 756e 6974 203d 2075 6e69 742e 6d75 6d6d  unit = unit.mumm
+0003b830: 795f 756e 6974 0d0a 2020 2020 2020 2020  y_unit..        
+0003b840: 2020 2020 2020 2020 6966 2075 6e69 7420          if unit 
+0003b850: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+0003b860: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0003b870: 7475 726e 204e 6f6e 650d 0a20 2020 2020  turn None..     
+0003b880: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0003b890: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0003b8a0: 7475 726e 2075 6e69 740d 0a20 2020 2020  turn unit..     
+0003b8b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0003b8c0: 2072 6574 7572 6e20 756e 6974 0d0a 0d0a   return unit....
+0003b8d0: 2020 2020 6465 6620 6765 745f 6269 675f      def get_big_
+0003b8e0: 6d75 6d6d 795f 756e 6974 2873 656c 6629  mummy_unit(self)
+0003b8f0: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+0003b900: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0003b910: 206c 6f77 6573 7420 756e 6974 2028 6d61   lowest unit (ma
+0003b920: 696e 2075 6e69 7429 2069 6e20 6869 6572  in unit) in hier
+0003b930: 6172 6368 6963 616c 206f 7264 6572 0d0a  archical order..
+0003b940: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0003b950: 2020 2020 2020 2075 6e69 7420 3d20 7365         unit = se
+0003b960: 6c66 0d0a 2020 2020 2020 2020 666f 7220  lf..        for 
+0003b970: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
+0003b980: 6765 745f 685f 6c65 7665 6c28 2929 3a0d  get_h_level()):.
+0003b990: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+0003b9a0: 6620 756e 6974 2e6d 756d 6d79 5f75 6e69  f unit.mummy_uni
+0003b9b0: 7420 6973 206e 6f74 204e 6f6e 653a 0d0a  t is not None:..
+0003b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b9d0: 756e 6974 203d 2075 6e69 742e 6d75 6d6d  unit = unit.mumm
+0003b9e0: 795f 756e 6974 0d0a 2020 2020 2020 2020  y_unit..        
+0003b9f0: 2020 2020 0d0a 2020 2020 2020 2020 7265      ..        re
+0003ba00: 7475 726e 2075 6e69 740d 0a0d 0a0d 0a20  turn unit...... 
+0003ba10: 2020 2064 6566 2067 6574 5f62 6162 795f     def get_baby_
+0003ba20: 756e 6974 7328 7365 6c66 2c20 7265 636f  units(self, reco
+0003ba30: 6d70 7574 653d 4661 6c73 652c 2076 623d  mpute=False, vb=
+0003ba40: 3129 3a0d 0a0d 0a0d 0a20 2020 2020 2020  1):......       
+0003ba50: 2022 2222 0d0a 2020 2020 2020 2020 4d65   """..        Me
+0003ba60: 7468 6f64 2074 6f20 7265 7475 726e 2061  thod to return a
+0003ba70: 6c6c 2075 6e69 7473 2074 6861 7420 6172  ll units that ar
+0003ba80: 6520 756e 6465 7220 7468 6520 6375 7272  e under the curr
+0003ba90: 656e 7420 756e 6974 2069 6e20 7468 6520  ent unit in the 
+0003baa0: 6869 6572 6172 6368 790d 0a0d 0a20 2020  hierarchy....   
+0003bab0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+0003bac0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0003bad0: 2d2d 2d0d 0a20 2020 2020 2020 2072 6563  ---..        rec
+0003bae0: 6f6d 7075 7465 3a20 626f 6f6c 0d0a 2020  ompute: bool..  
+0003baf0: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
+0003bb00: 652c 2072 6563 6f6d 7075 7465 2074 6865  e, recompute the
+0003bb10: 206c 6973 7420 6f66 2075 6e69 7473 2069   list of units i
+0003bb20: 6620 7468 6572 6520 6861 6420 6265 656e  f there had been
+0003bb30: 206d 6f64 6966 6963 6174 696f 6e73 2069   modifications i
+0003bb40: 6e20 7468 6520 6869 6572 6172 6368 790d  n the hierarchy.
+0003bb50: 0a20 2020 2020 2020 2076 623a 2069 6e74  .        vb: int
+0003bb60: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+0003bb70: 7262 6f73 6974 7920 6c65 7665 6c2c 2030  rbosity level, 0
+0003bb80: 2066 6f72 206e 6f20 7072 696e 742c 2031   for no print, 1
+0003bb90: 2066 6f72 2070 7269 6e74 0d0a 0d0a 2020   for print....  
+0003bba0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+0003bbb0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+0003bbc0: 2020 2020 2020 2020 6c69 7374 0d0a 2020          list..  
+0003bbd0: 2020 2020 2020 6c69 7374 206f 6620 6368        list of ch
+0003bbe0: 696c 6473 203a 636c 6173 733a 6055 6e69  ilds :class:`Uni
+0003bbf0: 7460 206f 626a 6563 7473 206f 6620 7468  t` objects of th
+0003bc00: 6520 6375 7272 656e 7420 756e 6974 0d0a  e current unit..
+0003bc10: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0003bc20: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0003bc30: 2069 6620 7365 6c66 2e53 7562 5069 6c65   if self.SubPile
+0003bc40: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+0003bc50: 2020 2020 2020 2069 6620 7662 3a0d 0a20         if vb:.. 
+0003bc60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003bc70: 7269 6e74 2822 556e 6974 2068 6173 206e  rint("Unit has n
+0003bc80: 6f20 6869 6572 6172 6368 7922 290d 0a20  o hierarchy").. 
+0003bc90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0003bca0: 6e20 5b5d 0d0a 0d0a 2020 2020 2020 2020  n []....        
+0003bcb0: 6966 2072 6563 6f6d 7075 7465 3a0d 0a20  if recompute:.. 
+0003bcc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003bcd0: 6262 5f75 6e69 7473 203d 205b 5d0d 0a0d  bb_units = []...
+0003bce0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+0003bcf0: 2066 756e 2875 6e69 7429 3a0d 0a0d 0a20   fun(unit):.... 
+0003bd00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003bd10: 6620 756e 6974 2e53 7562 5069 6c65 2069  f unit.SubPile i
+0003bd20: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+0003bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bd40: 206c 3d75 6e69 742e 5375 6250 696c 652e   l=unit.SubPile.
+0003bd50: 6c69 7374 5f75 6e69 7473 0d0a 2020 2020  list_units..    
+0003bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bd70: 7365 6c66 2e62 625f 756e 6974 7320 2b3d  self.bb_units +=
+0003bd80: 206c 0d0a 0d0a 2020 2020 2020 2020 2020   l....          
+0003bd90: 2020 2020 2020 2020 2020 666f 7220 756e            for un
+0003bda0: 6974 2069 6e20 6c3a 0d0a 2020 2020 2020  it in l:..      
+0003bdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bdc0: 2020 6675 6e28 756e 6974 290d 0a0d 0a20    fun(unit).... 
+0003bdd0: 2020 2020 2020 2020 2020 2066 756e 2873             fun(s
+0003bde0: 656c 6629 0d0a 2020 2020 2020 2020 7265  elf)..        re
+0003bdf0: 7475 726e 2073 656c 662e 6262 5f75 6e69  turn self.bb_uni
+0003be00: 7473 0d0a 0d0a 2020 2020 6465 6620 6164  ts....    def ad
+0003be10: 645f 6661 6369 6573 2873 656c 662c 2066  d_facies(self, f
+0003be20: 6163 6965 7329 3a0d 0a0d 0a20 2020 2020  acies):....     
+0003be30: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+0003be40: 4164 6420 6661 6369 6573 206f 626a 6563  Add facies objec
+0003be50: 7420 746f 2073 7472 6174 690d 0a0d 0a20  t to strati.... 
+0003be60: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0003be70: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0003be80: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
+0003be90: 6163 6965 733a 203a 636c 6173 733a 6046  acies: :class:`F
+0003bea0: 6163 6965 7360 206f 626a 6563 7420 6f72  acies` object or
+0003beb0: 206c 6973 7420 6f66 2074 6865 6d0d 0a20   list of them.. 
+0003bec0: 2020 2020 2020 2020 2020 2046 6163 6965             Facie
+0003bed0: 7320 6f62 6a65 6374 2074 6f20 6d6f 6465  s object to mode
+0003bee0: 6c20 696e 7369 6465 2074 6865 2075 6e69  l inside the uni
+0003bef0: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+0003bf00: 0d0a 2020 2020 2020 2020 6966 2074 7970  ..        if typ
+0003bf10: 6528 6661 6369 6573 2920 3d3d 206c 6973  e(facies) == lis
+0003bf20: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+0003bf30: 666f 7220 6920 696e 2066 6163 6965 733a  for i in facies:
+0003bf40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003bf50: 2020 6966 2028 6973 696e 7374 616e 6365    if (isinstance
+0003bf60: 2869 2c20 4661 6369 6573 2929 2061 6e64  (i, Facies)) and
+0003bf70: 2028 6920 6e6f 7420 696e 2073 656c 662e   (i not in self.
+0003bf80: 6c69 7374 5f66 6163 6965 7329 3a20 2320  list_facies): # 
+0003bf90: 6368 6563 6b20 4661 6369 6573 206f 626a  check Facies obj
+0003bfa0: 6563 7420 6265 6c6f 6e67 2074 6f20 4661  ect belong to Fa
+0003bfb0: 6369 6573 2063 6c61 7373 0d0a 2020 2020  cies class..    
+0003bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bfd0: 7365 6c66 2e6c 6973 745f 6661 6369 6573  self.list_facies
+0003bfe0: 2e61 7070 656e 6428 6929 0d0a 2020 2020  .append(i)..    
+0003bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c000: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+0003c010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003c020: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0003c030: 2246 6163 6965 7320 7b7d 2061 6464 6564  "Facies {} added
+0003c040: 2074 6f20 756e 6974 207b 7d22 2e66 6f72   to unit {}".for
+0003c050: 6d61 7428 692e 6e61 6d65 2c20 7365 6c66  mat(i.name, self
+0003c060: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
+0003c070: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0003c080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c090: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+0003c0a0: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+0003c0b0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0003c0c0: 696e 7428 226f 626a 6563 7420 6973 6e27  int("object isn'
+0003c0d0: 7420 6120 4661 6369 6573 206f 626a 6563  t a Facies objec
+0003c0e0: 7420 6f72 2046 6163 6965 7320 6f62 6a65  t or Facies obje
+0003c0f0: 6374 2068 6173 2061 6c72 6561 6479 2062  ct has already b
+0003c100: 6565 6e20 6164 6465 6422 290d 0a20 2020  een added")..   
+0003c110: 2020 2020 2065 6c73 653a 2023 2066 6163       else: # fac
+0003c120: 6965 7320 6e6f 7420 696e 2061 206c 6973  ies not in a lis
+0003c130: 740d 0a20 2020 2020 2020 2020 2020 2069  t..            i
+0003c140: 6620 2869 7369 6e73 7461 6e63 6528 6661  f (isinstance(fa
+0003c150: 6369 6573 2c20 4661 6369 6573 2929 2020  cies, Facies))  
+0003c160: 616e 6420 2866 6163 6965 7320 6e6f 7420  and (facies not 
+0003c170: 696e 2073 656c 662e 6c69 7374 5f66 6163  in self.list_fac
+0003c180: 6965 7329 3a0d 0a20 2020 2020 2020 2020  ies):..         
+0003c190: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
+0003c1a0: 5f66 6163 6965 732e 6170 7065 6e64 2866  _facies.append(f
+0003c1b0: 6163 6965 7329 0d0a 2020 2020 2020 2020  acies)..        
+0003c1c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0003c1d0: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
+0003c1e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0003c1f0: 696e 7428 2246 6163 6965 7320 7b7d 2061  int("Facies {} a
+0003c200: 6464 6564 2074 6f20 756e 6974 207b 7d22  dded to unit {}"
+0003c210: 2e66 6f72 6d61 7428 6661 6369 6573 2e6e  .format(facies.n
+0003c220: 616d 652c 2073 656c 662e 6e61 6d65 2929  ame, self.name))
+0003c230: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0003c240: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003c250: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+0003c260: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+0003c270: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0003c280: 2822 6f62 6a65 6374 2069 736e 2774 2061  ("object isn't a
+0003c290: 2046 6163 6965 7320 6f62 6a65 6374 206f   Facies object o
+0003c2a0: 7220 4661 6369 6573 206f 626a 6563 7420  r Facies object 
+0003c2b0: 6861 7320 616c 7265 6164 7920 6265 656e  has already been
+0003c2c0: 2061 6464 6564 2229 0d0a 0d0a 2020 2020   added")....    
+0003c2d0: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
+0003c2e0: 2020 6465 6620 7265 6d5f 6661 6369 6573    def rem_facies
+0003c2f0: 2873 656c 662c 2066 6163 6965 733d 4e6f  (self, facies=No
+0003c300: 6e65 2c20 616c 6c5f 6661 6369 6573 3d54  ne, all_facies=T
+0003c310: 7275 6529 3a0d 0a0d 0a20 2020 2020 2020  rue):....       
+0003c320: 2022 2222 0d0a 2020 2020 2020 2020 546f   """..        To
+0003c330: 2072 656d 6f76 6520 6661 6369 6573 2066   remove facies f
+0003c340: 726f 6d20 756e 6974 2c20 6279 2064 6566  rom unit, by def
+0003c350: 6175 6c74 2061 6c6c 2066 6163 6965 7320  ault all facies 
+0003c360: 6172 6520 7265 6d6f 7665 640d 0a0d 0a20  are removed.... 
+0003c370: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0003c380: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0003c390: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
+0003c3a0: 6163 6965 733a 203a 636c 6173 733a 6046  acies: :class:`F
+0003c3b0: 6163 6965 7360 206f 626a 6563 7420 6f72  acies` object or
+0003c3c0: 206c 6973 7420 6f66 2074 6865 6d0d 0a20   list of them.. 
+0003c3d0: 2020 2020 2020 2020 2020 2046 6163 6965             Facie
+0003c3e0: 7320 6f62 6a65 6374 2074 6f20 7265 6d6f  s object to remo
+0003c3f0: 7665 2066 726f 6d20 7468 6520 756e 6974  ve from the unit
+0003c400: 0d0a 2020 2020 2020 2020 616c 6c5f 6661  ..        all_fa
+0003c410: 6369 6573 3a20 626f 6f6c 0d0a 2020 2020  cies: bool..    
+0003c420: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+0003c430: 2061 6c6c 2066 6163 6965 7320 6172 6520   all facies are 
+0003c440: 7265 6d6f 7665 640d 0a20 2020 2020 2020  removed..       
+0003c450: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+0003c460: 6966 2061 6c6c 5f66 6163 6965 733a 0d0a  if all_facies:..
+0003c470: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003c480: 2e6c 6973 745f 6661 6369 6573 3d5b 5d0d  .list_facies=[].
+0003c490: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0003c4a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003c4b0: 2e6c 6973 745f 6661 6369 6573 2e72 656d  .list_facies.rem
+0003c4c0: 6f76 6528 6661 6369 6573 290d 0a0d 0a20  ove(facies).... 
+0003c4d0: 2020 2064 6566 2063 6f6d 7075 7465 5f66     def compute_f
+0003c4e0: 6163 6965 7328 7365 6c66 2c20 4172 6368  acies(self, Arch
+0003c4f0: 5461 626c 652c 206e 7265 616c 3d31 2c20  Table, nreal=1, 
+0003c500: 6d6f 6465 3d22 6661 6369 6573 222c 2076  mode="facies", v
+0003c510: 6572 626f 7365 3d30 293a 0d0a 0d0a 2020  erbose=0):....  
+0003c520: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0003c530: 2020 2043 6f6d 7075 7465 2066 6163 6965     Compute facie
+0003c540: 7320 646f 6d61 696e 2066 6f72 2074 6865  s domain for the
+0003c550: 2073 7065 6369 6669 6320 756e 6974 0d0a   specific unit..
+0003c560: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0003c570: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0003c580: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0003c590: 2020 4172 6368 5461 626c 653a 203a 636c    ArchTable: :cl
+0003c5a0: 6173 733a 6041 7263 685f 7461 626c 6560  ass:`Arch_table`
+0003c5b0: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+0003c5c0: 2020 2020 2041 7263 6854 6162 6c65 2063       ArchTable c
+0003c5d0: 6f6e 7461 696e 696e 6720 756e 6974 732c  ontaining units,
+0003c5e0: 2073 7572 6661 6365 2c0d 0a20 2020 2020   surface,..     
+0003c5f0: 2020 2020 2020 2066 6163 6965 7320 616e         facies an
+0003c600: 6420 6174 206c 6561 7374 2061 2050 696c  d at least a Pil
+0003c610: 6520 2873 6565 2065 7861 6d70 6c65 206f  e (see example o
+0003c620: 6e20 7468 6520 6769 7468 7562 290d 0a20  n the github).. 
+0003c630: 2020 2020 2020 206e 7265 616c 2020 203a         nreal   :
+0003c640: 2069 6e74 0d0a 2020 2020 2020 2020 2020   int..          
+0003c650: 2020 6e75 6d62 6572 206f 6620 7265 616c    number of real
+0003c660: 697a 6174 696f 6e20 2870 6572 2075 6e69  ization (per uni
+0003c670: 7420 7265 616c 697a 6174 696f 6e73 2920  t realizations) 
+0003c680: 746f 206d 616b 650d 0a20 2020 2020 2020  to make..       
+0003c690: 206d 6f64 653a 2073 7472 0d0a 2020 2020   mode: str..    
+0003c6a0: 2020 2020 2020 2020 2266 6163 6965 7322          "facies"
+0003c6b0: 206f 7220 2273 7472 6174 6922 0d0a 2020   or "strati"..  
+0003c6c0: 2020 2020 2020 7665 7262 6f73 6520 3a20        verbose : 
+0003c6d0: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
+0003c6e0: 2076 6572 626f 7369 7479 206c 6576 656c   verbosity level
+0003c6f0: 2c20 3020 666f 7220 6e6f 2070 7269 6e74  , 0 for no print
+0003c700: 2c20 3120 666f 7220 7072 696e 740d 0a20  , 1 for print.. 
+0003c710: 2020 2020 2020 2022 2222 0d0a 200d 0a0d         """.. ...
+0003c720: 0a20 2020 2020 2020 2078 673d 4172 6368  .        xg=Arch
+0003c730: 5461 626c 652e 6765 745f 7867 2829 0d0a  Table.get_xg()..
+0003c740: 2020 2020 2020 2020 7967 3d41 7263 6854          yg=ArchT
+0003c750: 6162 6c65 2e67 6574 5f79 6728 290d 0a20  able.get_yg().. 
+0003c760: 2020 2020 2020 207a 673d 4172 6368 5461         zg=ArchTa
+0003c770: 626c 652e 6765 745f 7a67 2829 0d0a 0d0a  ble.get_zg()....
+0003c780: 2020 2020 2020 2020 7365 6564 3d41 7263          seed=Arc
+0003c790: 6854 6162 6c65 2e73 6565 640d 0a20 2020  hTable.seed..   
+0003c7a0: 2020 2020 206e 702e 7261 6e64 6f6d 2e73       np.random.s
+0003c7b0: 6565 6428 7365 6564 290d 0a0d 0a20 2020  eed(seed)....   
+0003c7c0: 2020 2020 2023 2320 6772 6964 2070 6172       ## grid par
+0003c7d0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0003c7e0: 206e 783d 6c65 6e28 7867 292d 310d 0a20   nx=len(xg)-1.. 
+0003c7f0: 2020 2020 2020 206e 793d 6c65 6e28 7967         ny=len(yg
+0003c800: 292d 310d 0a20 2020 2020 2020 206e 7a3d  )-1..        nz=
+0003c810: 6c65 6e28 7a67 292d 310d 0a20 2020 2020  len(zg)-1..     
+0003c820: 2020 2064 696d 656e 7369 6f6e 733d 286e     dimensions=(n
+0003c830: 782c 206e 792c 206e 7a29 0d0a 2020 2020  x, ny, nz)..    
+0003c840: 2020 2020 6f78 3d6e 702e 6d69 6e28 7867      ox=np.min(xg
+0003c850: 5b30 5d29 0d0a 2020 2020 2020 2020 6f79  [0])..        oy
+0003c860: 3d6e 702e 6d69 6e28 7967 5b30 5d29 0d0a  =np.min(yg[0])..
+0003c870: 2020 2020 2020 2020 6f7a 3d6e 702e 6d69          oz=np.mi
+0003c880: 6e28 7a67 5b30 5d29 0d0a 2020 2020 2020  n(zg[0])..      
+0003c890: 2020 6f72 6967 696e 3d28 6f78 2c20 6f79    origin=(ox, oy
+0003c8a0: 2c20 6f7a 290d 0a20 2020 2020 2020 2073  , oz)..        s
+0003c8b0: 783d 6e70 2e64 6966 6628 7867 295b 305d  x=np.diff(xg)[0]
+0003c8c0: 0d0a 2020 2020 2020 2020 7379 3d6e 702e  ..        sy=np.
+0003c8d0: 6469 6666 2879 6729 5b30 5d0d 0a20 2020  diff(yg)[0]..   
+0003c8e0: 2020 2020 2073 7a3d 6e70 2e64 6966 6628       sz=np.diff(
+0003c8f0: 7a67 295b 305d 0d0a 2020 2020 2020 2020  zg)[0]..        
+0003c900: 7370 6163 696e 673d 2873 782c 2073 792c  spacing=(sx, sy,
+0003c910: 2073 7a29 0d0a 0d0a 2020 2020 2020 2020   sz)....        
+0003c920: 6e72 6561 6c5f 756e 6974 7320 3d20 4172  nreal_units = Ar
+0003c930: 6368 5461 626c 652e 6e72 6561 6c5f 756e  chTable.nreal_un
+0003c940: 6974 730d 0a0d 0a20 2020 2020 2020 2066  its....        f
+0003c950: 6163 6965 735f 646f 6d61 696e 733d 6e70  acies_domains=np
+0003c960: 2e7a 6572 6f73 285b 6e72 6561 6c5f 756e  .zeros([nreal_un
+0003c970: 6974 732c 206e 7265 616c 2c20 6e7a 2c20  its, nreal, nz, 
+0003c980: 6e79 2c20 6e78 5d2c 2064 7479 7065 3d6e  ny, nx], dtype=n
+0003c990: 702e 696e 7438 290d 0a0d 0a20 2020 2020  p.int8)....     
+0003c9a0: 2020 2069 6620 6d6f 6465 203d 3d20 2266     if mode == "f
+0003c9b0: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
+0003c9c0: 2020 2020 206d 6574 686f 643d 7365 6c66       method=self
+0003c9d0: 2e66 5f6d 6574 686f 6420 2023 206d 6574  .f_method  # met
+0003c9e0: 686f 6420 6f66 2073 696d 756c 6174 696f  hod of simulatio
+0003c9f0: 6e0d 0a20 2020 2020 2020 2065 6c69 6620  n..        elif 
+0003ca00: 6d6f 6465 203d 3d20 2275 6e69 7473 223a  mode == "units":
+0003ca10: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0003ca20: 2022 756e 6974 735f 6669 6c6c 5f6d 6574   "units_fill_met
+0003ca30: 686f 6422 2069 6e20 7365 6c66 2e64 6963  hod" in self.dic
+0003ca40: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
+0003ca50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ca60: 206d 6574 686f 6420 3d20 7365 6c66 2e64   method = self.d
+0003ca70: 6963 5f66 6163 6965 735b 2275 6e69 7473  ic_facies["units
+0003ca80: 5f66 696c 6c5f 6d65 7468 6f64 225d 0d0a  _fill_method"]..
+0003ca90: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003caa0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003cab0: 2020 206d 6574 686f 6420 3d20 2268 6f6d     method = "hom
+0003cac0: 6f67 656e 6f75 7322 0d0a 0d0a 2020 2020  ogenous"....    
+0003cad0: 2020 2020 6b77 6172 6773 3d73 656c 662e      kwargs=self.
+0003cae0: 6469 635f 6661 6369 6573 2020 2320 7265  dic_facies  # re
+0003caf0: 7472 6965 7665 206b 6579 776f 7264 2061  trieve keyword a
+0003cb00: 7267 756d 656e 7473 0d0a 0d0a 2020 2020  rguments....    
+0003cb10: 2020 2020 2364 6566 6175 6c74 206b 7761      #default kwa
+0003cb20: 7267 7320 666f 7220 5349 530d 0a20 2020  rgs for SIS..   
+0003cb30: 2020 2020 206b 7761 7267 735f 6465 665f       kwargs_def_
+0003cb40: 5349 533d 7b22 6e65 6967 223a 2031 302c  SIS={"neig": 10,
+0003cb50: 2022 7222 3a20 312c 2022 7072 6f62 6162   "r": 1, "probab
+0003cb60: 696c 6974 7922 3a20 4e6f 6e65 2c22 5349  ility": None,"SI
+0003cb70: 535f 6f72 6965 6e74 6174 696f 6e22 3a20  S_orientation": 
+0003cb80: 4661 6c73 652c 2261 7a69 6d75 7468 223a  False,"azimuth":
+0003cb90: 2030 2c22 6469 7022 3a20 302c 2270 6c75   0,"dip": 0,"plu
+0003cba0: 6e67 6522 3a20 307d 0d0a 0d0a 2020 2020  nge": 0}....    
+0003cbb0: 2020 2020 6b77 6172 6773 5f64 6566 5f4d      kwargs_def_M
+0003cbc0: 5053 3d7b 2276 6172 6e61 6d65 223a 2263  PS={"varname":"c
+0003cbd0: 6f64 6522 2c20 226e 7622 3a31 2c20 2264  ode", "nv":1, "d
+0003cbe0: 6174 6149 6d61 6765 223a 4e6f 6e65 2c20  ataImage":None, 
+0003cbf0: 2264 6973 7461 6e63 6554 7970 6522 3a5b  "distanceType":[
+0003cc00: 2263 6174 6567 6f72 6963 616c 225d 2c20  "categorical"], 
+0003cc10: 226f 7574 7075 7456 6172 466c 6167 223a  "outputVarFlag":
+0003cc20: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+0003cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cc40: 2278 7222 3a20 312c 2022 7972 223a 2031  "xr": 1, "yr": 1
+0003cc50: 2c20 227a 7222 3a20 312c 2022 6d61 7873  , "zr": 1, "maxs
+0003cc60: 6361 6e22 3a20 302e 3235 2c20 226e 6569  can": 0.25, "nei
+0003cc70: 6722 3a20 3234 2c20 2274 6872 6573 6822  g": 24, "thresh"
+0003cc80: 3a20 302e 3035 2c20 2278 6c6f 6322 3a20  : 0.05, "xloc": 
+0003cc90: 4661 6c73 652c 2022 796c 6f63 223a 2046  False, "yloc": F
+0003cca0: 616c 7365 2c20 227a 6c6f 6322 3a20 4661  alse, "zloc": Fa
+0003ccb0: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
+0003ccc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003ccd0: 686f 6d6f 5f75 7361 6765 223a 2031 2c20  homo_usage": 1, 
+0003cce0: 2272 6f74 5f75 7361 6765 223a 2031 2c20  "rot_usage": 1, 
+0003ccf0: 2272 6f74 417a 694c 6f63 223a 2046 616c  "rotAziLoc": Fal
+0003cd00: 7365 2c20 2272 6f74 417a 6922 3a20 302c  se, "rotAzi": 0,
+0003cd10: 2022 726f 7444 6970 4c6f 6322 3a20 4661   "rotDipLoc": Fa
+0003cd20: 6c73 652c 2022 726f 7444 6970 223a 2030  lse, "rotDip": 0
+0003cd30: 2c20 2272 6f74 506c 756e 6765 4c6f 6322  , "rotPlungeLoc"
+0003cd40: 3a20 4661 6c73 652c 2022 726f 7450 6c75  : False, "rotPlu
+0003cd50: 6e67 6522 3a20 302c 0d0a 2020 2020 2020  nge": 0,..      
+0003cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cd70: 2020 2022 617a 695f 746f 7022 3a22 6772     "azi_top":"gr
+0003cd80: 6164 6965 6e74 222c 2022 617a 695f 626f  adient", "azi_bo
+0003cd90: 7422 3a22 6772 6164 6965 6e74 222c 2022  t":"gradient", "
+0003cda0: 6469 705f 746f 7022 3a22 6772 6164 6965  dip_top":"gradie
+0003cdb0: 6e74 222c 2022 6469 705f 626f 7422 3a22  nt", "dip_bot":"
+0003cdc0: 6772 6164 6965 6e74 222c 0d0a 2020 2020  gradient",..    
+0003cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cde0: 2020 2020 2022 7261 6469 7573 4d6f 6465       "radiusMode
+0003cdf0: 223a 2022 6c61 7267 655f 6465 6661 756c  ": "large_defaul
+0003ce00: 7422 2c20 2272 7822 3a20 6e78 2a73 782c  t", "rx": nx*sx,
+0003ce10: 2022 7279 223a 206e 792a 7379 2c20 2272   "ry": ny*sy, "r
+0003ce20: 7a22 3a20 6e7a 2a73 7a2c 2022 616e 6973  z": nz*sz, "anis
+0003ce30: 6f74 726f 7079 5261 7469 6f4d 6f64 6522  otropyRatioMode"
+0003ce40: 3a20 226f 6e65 222c 2022 6178 223a 2031  : "one", "ax": 1
+0003ce50: 2c20 2261 7922 3a20 312c 2022 617a 223a  , "ay": 1, "az":
+0003ce60: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
+0003ce70: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0003ce80: 6e67 6c65 3122 3a20 302c 2022 616e 676c  ngle1": 0, "angl
+0003ce90: 6532 223a 2030 2c20 2261 6e67 6c65 3322  e2": 0, "angle3"
+0003cea0: 3a20 302c 0d0a 2020 2020 2020 2020 2020  : 0,..          
+0003ceb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003cec0: 676c 6f62 616c 5064 6622 3a20 4e6f 6e65  globalPdf": None
+0003ced0: 2c20 226c 6f63 616c 5064 6622 3a20 4e6f  , "localPdf": No
+0003cee0: 6e65 2c20 2270 726f 6261 5573 6167 6522  ne, "probaUsage"
+0003cef0: 3a20 302c 2022 6c6f 6361 6c50 6466 5261  : 0, "localPdfRa
+0003cf00: 6469 7573 223a 2031 322e 2c20 2264 6561  dius": 12., "dea
+0003cf10: 6374 6976 6174 696f 6e44 6973 7461 6e63  ctivationDistanc
+0003cf20: 6522 3a20 342e 2c20 2263 6f6e 7374 616e  e": 4., "constan
+0003cf30: 7454 6872 6573 686f 6c64 223a 2031 652d  tThreshold": 1e-
+0003cf40: 332c 2022 6e70 6f73 7422 3a31 7d0d 0a0d  3, "npost":1}...
+0003cf50: 0a20 2020 2020 2020 206b 7761 7267 735f  .        kwargs_
+0003cf60: 6465 665f 5450 4773 3d7b 226e 6569 6722  def_TPGs={"neig"
+0003cf70: 3a20 3230 2c20 226e 6974 223a 2031 3030  : 20, "nit": 100
+0003cf80: 2c20 2267 7266 5f6d 6574 686f 6422 3a20  , "grf_method": 
+0003cf90: 2266 6674 227d 0d0a 0d0a 2020 2020 2020  "fft"}....      
+0003cfa0: 2020 6d65 7468 6f64 733d 5b22 5349 5322    methods=["SIS"
+0003cfb0: 2c20 224d 5053 222c 2022 5450 4773 222c  , "MPS", "TPGs",
+0003cfc0: 2022 5375 6250 696c 6522 5d0d 0a20 2020   "SubPile"]..   
+0003cfd0: 2020 2020 206b 7761 7267 735f 6465 663d       kwargs_def=
+0003cfe0: 5b6b 7761 7267 735f 6465 665f 5349 532c  [kwargs_def_SIS,
+0003cff0: 206b 7761 7267 735f 6465 665f 4d50 532c   kwargs_def_MPS,
+0003d000: 206b 7761 7267 735f 6465 665f 5450 4773   kwargs_def_TPGs
+0003d010: 5d0d 0a0d 0a20 2020 2020 2020 2066 6f72  ]....        for
+0003d020: 2066 5f6d 6574 686f 642c 206b 7720 696e   f_method, kw in
+0003d030: 207a 6970 286d 6574 686f 6473 2c20 6b77   zip(methods, kw
+0003d040: 6172 6773 5f64 6566 293a 0d0a 2020 2020  args_def):..    
+0003d050: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
+0003d060: 6420 3d3d 2066 5f6d 6574 686f 643a 0d0a  d == f_method:..
+0003d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d080: 6966 206c 656e 286b 7761 7267 7329 203d  if len(kwargs) =
+0003d090: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+0003d0a0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+0003d0b0: 3d6b 770d 0a20 2020 2020 2020 2020 2020  =kw..           
+0003d0c0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0003d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d0e0: 666f 7220 6b2c 2076 2069 6e20 6b77 2e69  for k, v in kw.i
+0003d0f0: 7465 6d73 2829 3a0d 0a20 2020 2020 2020  tems():..       
+0003d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d110: 2069 6620 6b20 6e6f 7420 696e 206b 7761   if k not in kwa
+0003d120: 7267 732e 6b65 7973 2829 3a0d 0a20 2020  rgs.keys():..   
+0003d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d140: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
+0003d150: 6b5d 3d76 0d0a 0d0a 2020 2020 2020 2020  k]=v....        
+0003d160: 2320 6c69 7374 206f 626a 6563 7473 0d0a  # list objects..
+0003d170: 2020 2020 2020 2020 6966 206d 6f64 6520          if mode 
+0003d180: 3d3d 2022 6661 6369 6573 223a 0d0a 2020  == "facies":..  
+0003d190: 2020 2020 2020 2020 2020 6c69 7374 5f6f            list_o
+0003d1a0: 626a 203d 2073 656c 662e 6c69 7374 5f66  bj = self.list_f
+0003d1b0: 6163 6965 730d 0a20 2020 2020 2020 2065  acies..        e
+0003d1c0: 6c69 6620 6d6f 6465 203d 3d20 2275 6e69  lif mode == "uni
+0003d1d0: 7473 223a 0d0a 2020 2020 2020 2020 2020  ts":..          
+0003d1e0: 2020 6c69 7374 5f6f 626a 203d 2073 656c    list_obj = sel
+0003d1f0: 662e 5375 6250 696c 652e 6c69 7374 5f75  f.SubPile.list_u
+0003d200: 6e69 7473 0d0a 0d0a 2020 2020 2020 2020  nits....        
+0003d210: 2363 6865 636b 2069 6620 6f6e 6c79 2031  #check if only 1
+0003d220: 2066 6163 6965 7320 2d2d 3e20 686f 6d6f   facies --> homo
+0003d230: 6765 6e6f 7573 0d0a 2020 2020 2020 2020  genous..        
+0003d240: 6966 206c 656e 286c 6973 745f 6f62 6a29  if len(list_obj)
+0003d250: 203c 2032 2061 6e64 206d 6574 686f 6420   < 2 and method 
+0003d260: 213d 2022 686f 6d6f 6765 6e6f 7573 223a  != "homogenous":
+0003d270: 0d0a 2020 2020 2020 2020 2020 2020 6d65  ..            me
+0003d280: 7468 6f64 203d 2268 6f6d 6f67 656e 6f75  thod ="homogenou
+0003d290: 7322 0d0a 2020 2020 2020 2020 2020 2020  s"..            
+0003d2a0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+0003d2b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003d2c0: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
+0003d2d0: 2068 6173 206f 6e6c 7920 6f6e 6520 6661   has only one fa
+0003d2e0: 6369 6573 2c20 6661 6369 6573 206d 6574  cies, facies met
+0003d2f0: 686f 6420 7365 7473 2074 6f20 686f 6d6f  hod sets to homo
+0003d300: 6765 6e6f 7573 222e 666f 726d 6174 2873  genous".format(s
+0003d310: 656c 662e 6e61 6d65 2929 0d0a 0d0a 2020  elf.name))....  
+0003d320: 2020 2020 2020 2323 2320 5369 6d75 6c61        ### Simula
+0003d330: 7469 6f6e 7320 2323 230d 0a20 2020 2020  tions ###..     
+0003d340: 2020 2069 6620 6d65 7468 6f64 2021 3d20     if method != 
+0003d350: 2253 7562 5069 6c65 2220 6f72 206d 6f64  "SubPile" or mod
+0003d360: 6520 3d3d 2022 756e 6974 7322 3a0d 0a20  e == "units":.. 
+0003d370: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0003d380: 7520 696e 2072 616e 6765 286e 7265 616c  u in range(nreal
+0003d390: 5f75 6e69 7473 293a 2023 206c 6f6f 7020  _units): # loop 
+0003d3a0: 6f76 6572 2065 7869 7374 696e 6720 7375  over existing su
+0003d3b0: 7266 6163 6573 0d0a 2020 2020 2020 2020  rfaces..        
+0003d3c0: 2020 2020 2020 2020 6966 2041 7263 6854          if ArchT
+0003d3d0: 6162 6c65 2e76 6572 626f 7365 3a0d 0a20  able.verbose:.. 
 0003d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3f0: 2020 2020 2063 6d2e 6265 7461 3d64 6970       cm.beta=dip
-0003d400: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003d410: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0003d420: 206b 7761 7267 735b 2253 4953 5f6f 7269   kwargs["SIS_ori
-0003d430: 656e 7461 7469 6f6e 225d 3a20 2320 6966  entation"]: # if
-0003d440: 2073 6574 2054 7275 652c 2063 6861 6e67   set True, chang
-0003d450: 6520 616e 676c 6573 2077 6974 6820 696e  e angles with in
-0003d460: 7075 7473 2061 6e67 6c65 730d 0a20 2020  puts angles..   
-0003d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d480: 2020 2020 2020 2020 2061 6c3d 6b77 6172           al=kwar
-0003d490: 6773 5b22 616c 7068 6122 5d0d 0a20 2020  gs["alpha"]..   
-0003d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d4b0: 2020 2020 2020 2020 2062 653d 6b77 6172           be=kwar
-0003d4c0: 6773 5b22 6265 7461 225d 0d0a 2020 2020  gs["beta"]..    
-0003d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d4e0: 2020 2020 2020 2020 6761 3d6b 7761 7267          ga=kwarg
-0003d4f0: 735b 2267 616d 6d61 225d 0d0a 2020 2020  s["gamma"]..    
-0003d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d510: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
-0003d520: 616c 2920 6973 206c 6973 7420 616e 6420  al) is list and 
-0003d530: 7479 7065 2862 6529 2069 7320 6c69 7374  type(be) is list
-0003d540: 2061 6e64 2074 7970 6528 6761 2920 6973   and type(ga) is
-0003d550: 206c 6973 743a 0d0a 2020 2020 2020 2020   list:..        
+0003d3f0: 2020 2070 7269 6e74 2822 2323 2320 556e     print("### Un
+0003d400: 6974 207b 7d20 2d20 7265 616c 697a 6174  it {} - realizat
+0003d410: 696f 6e20 7b7d 2023 2323 222e 666f 726d  ion {} ###".form
+0003d420: 6174 2873 656c 662e 6e61 6d65 2c20 6975  at(self.name, iu
+0003d430: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0003d440: 2020 2020 6966 2073 656c 662e 636f 6e74      if self.cont
+0003d450: 6163 7420 3d3d 2022 6f6e 6c61 7022 3a0d  act == "onlap":.
+0003d460: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0003d470: 2020 2020 2020 206d 6173 6b3d 4172 6368         mask=Arch
+0003d480: 5461 626c 652e 6765 745f 756e 6974 735f  Table.get_units_
+0003d490: 646f 6d61 696e 735f 7265 616c 697a 6174  domains_realizat
+0003d4a0: 696f 6e73 2869 7529 203d 3d20 7365 6c66  ions(iu) == self
+0003d4b0: 2e49 440d 0a0d 0a20 2020 2020 2020 2020  .ID....         
+0003d4c0: 2020 2020 2020 2020 2020 2023 2320 484f             ## HO
+0003d4d0: 4d4f 4745 4e4f 5553 2023 230d 0a20 2020  MOGENOUS ##..   
+0003d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d4f0: 2069 6620 6d65 7468 6f64 2e6c 6f77 6572   if method.lower
+0003d500: 2829 203d 3d20 2268 6f6d 6f67 656e 6f75  () == "homogenou
+0003d510: 7322 3a0d 0a0d 0a20 2020 2020 2020 2020  s":....         
+0003d520: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003d530: 6620 6c65 6e28 6c69 7374 5f6f 626a 2920  f len(list_obj) 
+0003d540: 3e20 313a 2023 206d 6f72 6520 7468 616e  > 1: # more than
+0003d550: 206f 6e65 0d0a 2020 2020 2020 2020 2020   one..          
 0003d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d570: 2020 2020 2369 6620 6861 7361 7474 7228      #if hasattr(
-0003d580: 616c 2c22 5f5f 6974 6572 5f5f 2229 2061  al,"__iter__") a
-0003d590: 6e64 2068 6173 6174 7472 2862 652c 225f  nd hasattr(be,"_
-0003d5a0: 5f69 7465 725f 5f22 2920 616e 6420 6861  _iter__") and ha
-0003d5b0: 7361 7474 7228 6761 2c22 5f5f 6974 6572  sattr(ga,"__iter
-0003d5c0: 5f5f 2229 3a20 2369 6620 6120 6c69 7374  __"): #if a list
-0003d5d0: 2069 7320 6769 7665 6e0d 0a20 2020 2020   is given..     
-0003d5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d5f0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-0003d600: 7420 6c65 6e28 616c 2920 3d3d 206c 656e  t len(al) == len
-0003d610: 2862 6529 203d 3d20 6c65 6e28 6761 292c  (be) == len(ga),
-0003d620: 2022 4572 726f 723a 206e 756d 6265 7220   "Error: number 
-0003d630: 6f66 2067 6976 656e 2076 616c 7565 732f  of given values/
-0003d640: 6172 7261 7973 2069 6e20 616c 7068 612c  arrays in alpha,
-0003d650: 2062 6574 6120 616e 6420 6761 6d6d 6120   beta and gamma 
-0003d660: 6d75 7374 2062 6520 7468 6520 7361 6d65  must be the same
-0003d670: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0003d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d690: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0003d6a0: 6528 6c65 6e28 616c 2929 3a20 2320 6c6f  e(len(al)): # lo
-0003d6b0: 6f70 206f 7665 720d 0a20 2020 2020 2020  op over..       
-0003d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d6d0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003d6e0: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
-0003d6f0: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
-0003d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d720: 2020 2020 2020 2020 2020 636d 2e61 6c70            cm.alp
-0003d730: 6861 3d61 6c5b 695d 0d0a 2020 2020 2020  ha=al[i]..      
-0003d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d760: 2020 2020 2020 636d 2e62 6574 613d 6265        cm.beta=be
-0003d770: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
-0003d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d7a0: 2063 6d2e 6761 6d6d 613d 6761 5b69 5d0d   cm.gamma=ga[i].
-0003d7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d7c0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0003d7d0: 653a 2023 2069 6620 6f6e 6c79 2061 206e  e: # if only a n
-0003d7e0: 6461 7272 6179 206f 7220 6120 7661 6c75  darray or a valu
-0003d7f0: 6520 6172 6520 6769 7665 6e0d 0a20 2020  e are given..   
-0003d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d810: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003d820: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
-0003d830: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
+0003d570: 2020 6966 2041 7263 6854 6162 6c65 2e76    if ArchTable.v
+0003d580: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+0003d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d5a0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0003d5b0: 5741 524e 494e 4720 2121 204d 6f72 6520  WARNING !! More 
+0003d5c0: 7468 616e 206f 6e65 2066 6163 6965 7320  than one facies 
+0003d5d0: 6861 7320 6265 656e 2070 6173 7365 6420  has been passed 
+0003d5e0: 746f 2068 6f6d 6f67 656e 6f75 7320 756e  to homogenous un
+0003d5f0: 6974 207b 7d5c 6e46 6972 7374 2069 6e20  it {}\nFirst in 
+0003d600: 7468 6520 6c69 7374 2069 7320 7461 6b65  the list is take
+0003d610: 6e22 2e66 6f72 6d61 7428 7365 6c66 2e6e  n".format(self.n
+0003d620: 616d 6529 290d 0a20 2020 2020 2020 2020  ame))..         
+0003d630: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003d640: 6c69 6620 6c65 6e28 6c69 7374 5f6f 626a  lif len(list_obj
+0003d650: 2920 3c20 313a 2023 206e 6f20 6661 6369  ) < 1: # no faci
+0003d660: 6573 2061 6464 6564 0d0a 2020 2020 2020  es added..      
+0003d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d680: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0003d690: 6545 7272 6f72 2028 224e 6f20 6661 6369  eError ("No faci
+0003d6a0: 6573 2070 6173 7365 6420 746f 2068 6f6d  es passed to hom
+0003d6b0: 6f67 656e 6f75 7320 756e 6974 207b 7d22  ogenous unit {}"
+0003d6c0: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
+0003d6d0: 6529 290d 0a0d 0a20 2020 2020 2020 2020  e))....         
+0003d6e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003d6f0: 2320 7365 7475 7020 6120 3344 2061 7272  # setup a 3D arr
+0003d700: 6179 206f 6620 7468 6520 7369 6d75 6c61  ay of the simula
+0003d710: 7469 6f6e 2067 7269 6420 7369 7a65 2061  tion grid size a
+0003d720: 6e64 2061 7373 6967 6e20 6f6e 6520 6661  nd assign one fa
+0003d730: 6369 6573 2074 6f20 7468 6520 756e 6974  cies to the unit
+0003d740: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+0003d750: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+0003d760: 6965 733d 6c69 7374 5f6f 626a 5b30 5d0d  ies=list_obj[0].
+0003d770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d780: 2020 2020 2020 2020 2066 6f72 2069 7265           for ire
+0003d790: 616c 2069 6e20 7261 6e67 6528 6e72 6561  al in range(nrea
+0003d7a0: 6c29 3a0d 0a20 2020 2020 2020 2020 2020  l):..           
+0003d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d7c0: 2066 6163 6965 735f 646f 6d61 696e 735b   facies_domains[
+0003d7d0: 6975 2c20 6972 6561 6c5d 5b6d 6173 6b5d  iu, ireal][mask]
+0003d7e0: 3d66 6163 6965 732e 4944 0d0a 0d0a 2020  =facies.ID....  
+0003d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d800: 2020 2323 2053 4953 2023 230d 0a20 2020    ## SIS ##..   
+0003d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d820: 2065 6c69 6620 6d65 7468 6f64 2e75 7070   elif method.upp
+0003d830: 6572 2829 203d 3d20 2253 4953 223a 0d0a  er() == "SIS":..
 0003d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d860: 2020 636d 2e61 6c70 6861 3d61 6c0d 0a20    cm.alpha=al.. 
+0003d850: 2020 2020 2020 2020 2323 2073 6574 7570          ## setup
+0003d860: 2053 4953 2023 230d 0a0d 0a20 2020 2020   SIS ##....     
 0003d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d890: 2020 2063 6d2e 6265 7461 3d62 650d 0a20     cm.beta=be.. 
+0003d880: 2020 2069 6620 6d6f 6465 203d 3d20 2266     if mode == "f
+0003d890: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
 0003d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d8c0: 2020 2063 6d2e 6761 6d6d 613d 6761 0d0a     cm.gamma=ga..
-0003d8d0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003d8e0: 2020 2020 2020 2020 2020 2020 234d 6f64              #Mod
-0003d8f0: 6966 7920 7369 6c6c 206f 6620 636f 766d  ify sill of covm
-0003d900: 6f64 656c 2069 6620 7468 6572 6520 6973  odel if there is
-0003d910: 206f 6e6c 7920 6f6e 650d 0a20 2020 2020   only one..     
+0003d8b0: 2020 2020 2068 642c 2066 6163 6965 7320       hd, facies 
+0003d8c0: 3d20 4172 6368 5461 626c 652e 6864 5f66  = ArchTable.hd_f
+0003d8d0: 615f 696e 5f75 6e69 7428 7365 6c66 2c20  a_in_unit(self, 
+0003d8e0: 6975 3d69 7529 0d0a 2020 2020 2020 2020  iu=iu)..        
+0003d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d900: 656c 6966 206d 6f64 6520 3d3d 2022 756e  elif mode == "un
+0003d910: 6974 7322 3a0d 0a20 2020 2020 2020 2020  its":..         
 0003d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d930: 2020 2069 6620 6c65 6e28 7365 6c66 2e6c     if len(self.l
-0003d940: 6973 745f 665f 636f 766d 6f64 656c 2920  ist_f_covmodel) 
-0003d950: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
-0003d960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d970: 2020 2069 6620 4172 6368 5461 626c 652e     if ArchTable.
-0003d980: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-0003d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d9a0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0003d9b0: 224f 6e6c 7920 6f6e 6520 6661 6369 6573  "Only one facies
-0003d9c0: 2063 6f76 6d6f 6465 6c73 2066 6f72 206d   covmodels for m
-0003d9d0: 756c 7469 706c 6573 2066 6163 6965 732c  ultiples facies,
-0003d9e0: 2061 6461 7074 2073 696c 6c20 746f 2072   adapt sill to r
-0003d9f0: 6967 6874 2070 726f 706f 7274 696f 6e73  ight proportions
-0003da00: 2229 0d0a 0d0a 2020 2020 2020 2020 2020  ")....          
-0003da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003da20: 2020 636d 3d73 656c 662e 6c69 7374 5f66    cm=self.list_f
-0003da30: 5f63 6f76 6d6f 6465 6c5b 305d 0d0a 0d0a  _covmodel[0]....
-0003da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003da50: 2020 2020 2020 2020 2020 2020 7369 6c6c              sill
-0003da60: 3d63 6d2e 7369 6c6c 2829 2023 6765 7420  =cm.sill() #get 
-0003da70: 7369 6c6c 0d0a 0d0a 2020 2020 2020 2020  sill....        
-0003da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003da90: 2020 2020 7365 6c66 2e6c 6973 745f 665f      self.list_f_
-0003daa0: 636f 766d 6f64 656c 3d5b 5d20 2372 6573  covmodel=[] #res
-0003dab0: 6574 206c 6973 740d 0a0d 0a20 2020 2020  et list....     
-0003dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dad0: 2020 2020 2020 2069 6661 3d30 0d0a 2020         ifa=0..  
-0003dae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003daf0: 2020 2020 2020 2020 2020 666f 7220 6661            for fa
-0003db00: 2069 6e20 6c69 7374 5f6f 626a 3a20 236c   in list_obj: #l
-0003db10: 6f6f 7020 6f76 6572 2066 6163 6965 730d  oop over facies.
-0003db20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003db40: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0003db50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003db60: 2020 2063 6d5f 636f 7079 3d63 6f70 792e     cm_copy=copy.
-0003db70: 6465 6570 636f 7079 2863 6d29 2023 6d61  deepcopy(cm) #ma
-0003db80: 6b65 2061 2063 6f70 790d 0a0d 0a20 2020  ke a copy....   
-0003db90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dba0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0003dbb0: 2270 726f 6261 6269 6c69 7479 2220 696e  "probability" in
-0003dbc0: 206b 7761 7267 732e 6b65 7973 2829 3a0d   kwargs.keys():.
-0003dbd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dbf0: 2020 2020 2069 6620 6b77 6172 6773 5b22       if kwargs["
-0003dc00: 7072 6f62 6162 696c 6974 7922 5d20 6973  probability"] is
-0003dc10: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0003dc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dc40: 2020 2020 7020 3d20 6b77 6172 6773 5b22      p = kwargs["
-0003dc50: 7072 6f62 6162 696c 6974 7922 5d5b 6966  probability"][if
-0003dc60: 615d 0d0a 2020 2020 2020 2020 2020 2020  a]..            
+0003d930: 2020 2068 642c 2066 6163 6965 7320 3d20     hd, facies = 
+0003d940: 4172 6368 5461 626c 652e 6864 5f75 6e5f  ArchTable.hd_un_
+0003d950: 696e 5f75 6e69 7428 7365 6c66 2c20 6975  in_unit(self, iu
+0003d960: 3d69 7529 0d0a 0d0a 2020 2020 2020 2020  =iu)....        
+0003d970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d980: 6361 745f 7661 6c75 6573 3d5b 692e 4944  cat_values=[i.ID
+0003d990: 2066 6f72 2069 2069 6e20 6c69 7374 5f6f   for i in list_o
+0003d9a0: 626a 5d20 2023 2049 4420 7661 6c75 6573  bj]  # ID values
+0003d9b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003d9c0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0003d9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d9e0: 2020 2020 6864 3d6e 702e 6172 7261 7928      hd=np.array(
+0003d9f0: 6864 290d 0a20 2020 2020 2020 2020 2020  hd)..           
+0003da00: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+0003da10: 6965 733d 6e70 2e61 7272 6179 2866 6163  ies=np.array(fac
+0003da20: 6965 7329 0d0a 2020 2020 2020 2020 2020  ies)..          
+0003da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003da40: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0003da50: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0003da60: 6f72 6965 6e74 6174 696f 6e20 6d61 7020  orientation map 
+0003da70: 2323 2320 202d 3e20 746f 206d 6f64 6966  ###  -> to modif
+0003da80: 7920 2121 2121 0d0a 2020 2020 2020 2020  y !!!!..        
+0003da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003daa0: 6966 2028 6b77 6172 6773 5b22 5349 535f  if (kwargs["SIS_
+0003dab0: 6f72 6965 6e74 6174 696f 6e22 5d29 203d  orientation"]) =
+0003dac0: 3d20 2266 6f6c 6c6f 775f 7375 7266 6163  = "follow_surfac
+0003dad0: 6573 223a 2023 2069 6620 6f72 6965 6e74  es": # if orient
+0003dae0: 6174 696f 6e73 206d 7573 7420 666f 6c6c  ations must foll
+0003daf0: 6f77 2073 7572 6661 6365 730d 0a20 2020  ow surfaces..   
+0003db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003db10: 2020 2020 2020 2020 2023 2057 6172 6e69           # Warni
+0003db20: 6e67 3a20 5468 6973 206f 7074 696f 6e20  ng: This option 
+0003db30: 6368 616e 6765 7320 616c 7068 6120 616e  changes alpha an
+0003db40: 6420 6265 7461 2061 6e67 6c65 7320 6173  d beta angles as
+0003db50: 7375 6d69 6e67 2074 6861 7420 727a 2069  suming that rz i
+0003db60: 7320 736d 616c 6c65 7220 7468 616e 2072  s smaller than r
+0003db70: 7820 616e 6420 7279 2e20 4d6f 7265 6f76  x and ry. Moreov
+0003db80: 6572 2c20 7278 2061 6e64 2072 7920 6d75  er, rx and ry mu
+0003db90: 7374 2062 6520 7369 6d69 6c61 722e 0d0a  st be similar...
+0003dba0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003dbb0: 2020 2020 2020 2020 2020 2020 2020 617a                az
+0003dbc0: 692c 6469 703d 4172 6368 5461 626c 652e  i,dip=ArchTable.
+0003dbd0: 6f72 6965 6e74 6174 696f 6e5f 6d61 7028  orientation_map(
+0003dbe0: 7365 6c66 2c20 736d 6f6f 7468 3d35 290d  self, smooth=5).
+0003dbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003dc00: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003dc10: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
+0003dc20: 5f66 5f63 6f76 6d6f 6465 6c3a 2023 2069  _f_covmodel: # i
+0003dc30: 7465 7261 7465 2074 6872 6f75 6768 2061  terate through a
+0003dc40: 6c6c 2066 6163 6965 7320 636f 766d 6f64  ll facies covmod
+0003dc50: 656c 7320 616e 6420 6368 616e 6765 2061  els and change a
+0003dc60: 6e67 6c65 730d 0a20 2020 2020 2020 2020  ngles..         
 0003dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dc80: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0003dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dc80: 2020 2020 2020 2063 6d2e 616c 7068 613d         cm.alpha=
+0003dc90: 617a 690d 0a20 2020 2020 2020 2020 2020  azi..           
 0003dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dcb0: 2020 2020 2020 2070 3d6e 702e 7375 6d28         p=np.sum(
-0003dcc0: 6661 6369 6573 203d 3d20 6661 2e49 4429  facies == fa.ID)
-0003dcd0: 2f6c 656e 2866 6163 6965 7320 3d3d 2066  /len(facies == f
-0003dce0: 612e 4944 2920 2363 616c 6375 6c61 7465  a.ID) #calculate
-0003dcf0: 2070 726f 706f 7274 696f 6e20 6f66 2066   proportion of f
-0003dd00: 6163 6965 730d 0a20 2020 2020 2020 2020  acies..         
-0003dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd20: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0003dcb0: 2020 2020 2063 6d2e 6265 7461 3d64 6970       cm.beta=dip
+0003dcc0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0003dcd0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0003dce0: 206b 7761 7267 735b 2253 4953 5f6f 7269   kwargs["SIS_ori
+0003dcf0: 656e 7461 7469 6f6e 225d 3a20 2320 6966  entation"]: # if
+0003dd00: 2073 6574 2054 7275 652c 2063 6861 6e67   set True, chang
+0003dd10: 6520 616e 676c 6573 2077 6974 6820 696e  e angles with in
+0003dd20: 7075 7473 2061 6e67 6c65 730d 0a20 2020  puts angles..   
 0003dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd50: 2020 703d 6e70 2e73 756d 2866 6163 6965    p=np.sum(facie
-0003dd60: 7320 3d3d 2066 612e 4944 292f 6c65 6e28  s == fa.ID)/len(
-0003dd70: 6661 6369 6573 203d 3d20 6661 2e49 4429  facies == fa.ID)
-0003dd80: 2023 6361 6c63 756c 6174 6520 7072 6f70   #calculate prop
-0003dd90: 6f72 7469 6f6e 206f 6620 6661 6369 6573  ortion of facies
-0003dda0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ddc0: 2020 2020 6966 2070 203e 2030 3a0d 0a20      if p > 0:.. 
-0003ddd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ddf0: 2020 2076 6172 3d70 2a28 312d 7029 2023     var=p*(1-p) #
-0003de00: 7661 7269 616e 6365 0d0a 2020 2020 2020  variance..      
-0003de10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003de20: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0003de30: 7469 6f3d 7661 722f 7369 6c6c 2020 2372  tio=var/sill  #r
-0003de40: 6174 696f 2062 7477 2063 6f76 6d6f 6465  atio btw covmode
-0003de50: 6c20 616e 6420 7265 616c 2076 6172 6961  l and real varia
-0003de60: 6e63 650d 0a0d 0a20 2020 2020 2020 2020  nce....         
-0003de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003de80: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-0003de90: 2069 6e20 636d 5f63 6f70 792e 656c 656d   in cm_copy.elem
-0003dea0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dec0: 2020 2020 2020 2020 2020 2065 5b31 5d5b             e[1][
-0003ded0: 2277 225d 202a 3d20 7261 7469 6f0d 0a20  "w"] *= ratio.. 
-0003dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003def0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003df00: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0003df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003df20: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-0003df30: 696e 2063 6d5f 636f 7079 2e65 6c65 6d3a  in cm_copy.elem:
-0003df40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003df50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003df60: 2020 2020 2020 2020 2020 655b 315d 5b22            e[1]["
-0003df70: 7722 5d20 2a3d 2031 0d0a 2020 2020 2020  w"] *= 1..      
+0003dd40: 2020 2020 2020 2020 2061 6c3d 6b77 6172           al=kwar
+0003dd50: 6773 5b22 616c 7068 6122 5d0d 0a20 2020  gs["alpha"]..   
+0003dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dd70: 2020 2020 2020 2020 2062 653d 6b77 6172           be=kwar
+0003dd80: 6773 5b22 6265 7461 225d 0d0a 2020 2020  gs["beta"]..    
+0003dd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dda0: 2020 2020 2020 2020 6761 3d6b 7761 7267          ga=kwarg
+0003ddb0: 735b 2267 616d 6d61 225d 0d0a 2020 2020  s["gamma"]..    
+0003ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ddd0: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+0003dde0: 616c 2920 6973 206c 6973 7420 616e 6420  al) is list and 
+0003ddf0: 7479 7065 2862 6529 2069 7320 6c69 7374  type(be) is list
+0003de00: 2061 6e64 2074 7970 6528 6761 2920 6973   and type(ga) is
+0003de10: 206c 6973 743a 0d0a 2020 2020 2020 2020   list:..        
+0003de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003de30: 2020 2020 2369 6620 6861 7361 7474 7228      #if hasattr(
+0003de40: 616c 2c22 5f5f 6974 6572 5f5f 2229 2061  al,"__iter__") a
+0003de50: 6e64 2068 6173 6174 7472 2862 652c 225f  nd hasattr(be,"_
+0003de60: 5f69 7465 725f 5f22 2920 616e 6420 6861  _iter__") and ha
+0003de70: 7361 7474 7228 6761 2c22 5f5f 6974 6572  sattr(ga,"__iter
+0003de80: 5f5f 2229 3a20 2369 6620 6120 6c69 7374  __"): #if a list
+0003de90: 2069 7320 6769 7665 6e0d 0a20 2020 2020   is given..     
+0003dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003deb0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0003dec0: 7420 6c65 6e28 616c 2920 3d3d 206c 656e  t len(al) == len
+0003ded0: 2862 6529 203d 3d20 6c65 6e28 6761 292c  (be) == len(ga),
+0003dee0: 2022 4572 726f 723a 206e 756d 6265 7220   "Error: number 
+0003def0: 6f66 2067 6976 656e 2076 616c 7565 732f  of given values/
+0003df00: 6172 7261 7973 2069 6e20 616c 7068 612c  arrays in alpha,
+0003df10: 2062 6574 6120 616e 6420 6761 6d6d 6120   beta and gamma 
+0003df20: 6d75 7374 2062 6520 7468 6520 7361 6d65  must be the same
+0003df30: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0003df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df50: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0003df60: 6528 6c65 6e28 616c 2929 3a20 2320 6c6f  e(len(al)): # lo
+0003df70: 6f70 206f 7665 720d 0a20 2020 2020 2020  op over..       
 0003df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003df90: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-0003dfa0: 6973 745f 665f 636f 766d 6f64 656c 2e61  ist_f_covmodel.a
-0003dfb0: 7070 656e 6428 636d 5f63 6f70 7929 0d0a  ppend(cm_copy)..
+0003df90: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003dfa0: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
+0003dfb0: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
 0003dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dfe0: 6966 6120 2b3d 2031 0d0a 0d0a 2020 2020  ifa += 1....    
-0003dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e000: 2020 2020 2323 2053 696d 756c 6174 696f      ## Simulatio
-0003e010: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-0003e020: 2020 2020 2020 2020 2020 2073 696d 7573             simus
-0003e030: 203d 2067 6369 2e73 696d 756c 6174 6549   = gci.simulateI
-0003e040: 6e64 6963 6174 6f72 3344 2863 6174 5f76  ndicator3D(cat_v
-0003e050: 616c 7565 732c 2073 656c 662e 6c69 7374  alues, self.list
-0003e060: 5f66 5f63 6f76 6d6f 6465 6c2c 2064 696d  _f_covmodel, dim
-0003e070: 656e 7369 6f6e 732c 2073 7061 6369 6e67  ensions, spacing
-0003e080: 2c20 6f72 6967 696e 2c0d 0a20 2020 2020  , origin,..     
-0003e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e0c0: 2020 206e 7265 616c 3d6e 7265 616c 2c20     nreal=nreal, 
-0003e0d0: 6d65 7468 6f64 3d22 7369 6d70 6c65 5f6b  method="simple_k
-0003e0e0: 7269 6769 6e67 222c 2078 3d68 642c 2076  riging", x=hd, v
-0003e0f0: 3d66 6163 6965 732c 206d 6173 6b3d 6d61  =facies, mask=ma
-0003e100: 736b 2c0d 0a20 2020 2020 2020 2020 2020  sk,..           
+0003dfe0: 2020 2020 2020 2020 2020 636d 2e61 6c70            cm.alp
+0003dff0: 6861 3d61 6c5b 695d 0d0a 2020 2020 2020  ha=al[i]..      
+0003e000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e020: 2020 2020 2020 636d 2e62 6574 613d 6265        cm.beta=be
+0003e030: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
+0003e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e060: 2063 6d2e 6761 6d6d 613d 6761 5b69 5d0d   cm.gamma=ga[i].
+0003e070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e080: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0003e090: 653a 2023 2069 6620 6f6e 6c79 2061 206e  e: # if only a n
+0003e0a0: 6461 7272 6179 206f 7220 6120 7661 6c75  darray or a valu
+0003e0b0: 6520 6172 6520 6769 7665 6e0d 0a20 2020  e are given..   
+0003e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e0d0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003e0e0: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
+0003e0f0: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
+0003e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e130: 2020 2020 2020 2020 2020 2020 2073 6561               sea
-0003e140: 7263 6852 6164 6975 7352 656c 6174 6976  rchRadiusRelativ
-0003e150: 653d 6b77 6172 6773 5b22 7222 5d2c 206e  e=kwargs["r"], n
-0003e160: 6e65 6967 6862 6f72 4d61 783d 6b77 6172  neighborMax=kwar
-0003e170: 6773 5b22 6e65 6967 225d 2c0d 0a20 2020  gs["neig"],..   
-0003e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e1b0: 2020 2020 2070 726f 6261 6269 6c69 7479       probability
-0003e1c0: 3d6b 7761 7267 735b 2270 726f 6261 6269  =kwargs["probabi
-0003e1d0: 6c69 7479 225d 2c20 7665 7262 6f73 653d  lity"], verbose=
-0003e1e0: 7665 7262 6f73 652c 206e 7468 7265 6164  verbose, nthread
-0003e1f0: 7320 3d20 4172 6368 5461 626c 652e 6e63  s = ArchTable.nc
-0003e200: 7075 2c20 7365 6564 3d73 6565 642b 6975  pu, seed=seed+iu
-0003e210: 295b 2269 6d61 6765 225d 2e76 616c 0d0a  )["image"].val..
-0003e220: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003e230: 2020 2020 2020 2020 2020 2323 2320 7265            ### re
-0003e240: 6172 7261 6e67 6520 6461 7461 2069 6e74  arrange data int
-0003e250: 6f20 6120 3244 2061 7272 6179 206f 6620  o a 2D array of 
-0003e260: 7468 6520 7369 6d75 6c61 7469 6f6e 2067  the simulation g
-0003e270: 7269 6420 7369 7a65 2023 2323 0d0a 2020  rid size ###..  
-0003e280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e290: 2020 2020 2020 666f 7220 6972 6561 6c20        for ireal 
-0003e2a0: 696e 2072 616e 6765 286e 7265 616c 293a  in range(nreal):
-0003e2b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003e2c0: 2020 2020 2020 2020 2020 2020 2020 6772                gr
-0003e2d0: 6964 3d73 696d 7573 5b69 7265 616c 5d0d  id=simus[ireal].
-0003e2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e2f0: 2020 2020 2020 2020 2020 2020 2067 7269               gri
-0003e300: 645b 6772 6964 3d3d 305d 3d6e 702e 6e61  d[grid==0]=np.na
-0003e310: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-0003e320: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-0003e330: 7269 645b 6d61 736b 3d3d 305d 3d6e 702e  rid[mask==0]=np.
-0003e340: 6e61 6e20 2023 2065 7874 7261 6374 206f  nan  # extract o
-0003e350: 6e6c 7920 7468 6520 7061 7274 206f 6e20  nly the part on 
-0003e360: 7468 6520 7265 616c 2064 6f6d 6169 6e0d  the real domain.
-0003e370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e380: 2020 2020 2020 2020 2020 2020 2066 6163               fac
-0003e390: 6965 735f 646f 6d61 696e 735b 6975 2c20  ies_domains[iu, 
-0003e3a0: 6972 6561 6c5d 5b6d 6173 6b5d 3d67 7269  ireal][mask]=gri
-0003e3b0: 645b 6d61 736b 5d0d 0a0d 0a20 2020 2020  d[mask]....     
-0003e3c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003e3d0: 6c69 6620 6d65 7468 6f64 2e75 7070 6572  lif method.upper
-0003e3e0: 2829 203d 3d20 224d 5053 223a 0d0a 2020  () == "MPS":..  
+0003e120: 2020 636d 2e61 6c70 6861 3d61 6c0d 0a20    cm.alpha=al.. 
+0003e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e150: 2020 2063 6d2e 6265 7461 3d62 650d 0a20     cm.beta=be.. 
+0003e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e180: 2020 2063 6d2e 6761 6d6d 613d 6761 0d0a     cm.gamma=ga..
+0003e190: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0003e1a0: 2020 2020 2020 2020 2020 2020 234d 6f64              #Mod
+0003e1b0: 6966 7920 7369 6c6c 206f 6620 636f 766d  ify sill of covm
+0003e1c0: 6f64 656c 2069 6620 7468 6572 6520 6973  odel if there is
+0003e1d0: 206f 6e6c 7920 6f6e 650d 0a20 2020 2020   only one..     
+0003e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e1f0: 2020 2069 6620 6c65 6e28 7365 6c66 2e6c     if len(self.l
+0003e200: 6973 745f 665f 636f 766d 6f64 656c 2920  ist_f_covmodel) 
+0003e210: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
+0003e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e230: 2020 2069 6620 4172 6368 5461 626c 652e     if ArchTable.
+0003e240: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
+0003e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e260: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0003e270: 224f 6e6c 7920 6f6e 6520 6661 6369 6573  "Only one facies
+0003e280: 2063 6f76 6d6f 6465 6c73 2066 6f72 206d   covmodels for m
+0003e290: 756c 7469 706c 6573 2066 6163 6965 732c  ultiples facies,
+0003e2a0: 2061 6461 7074 2073 696c 6c20 746f 2072   adapt sill to r
+0003e2b0: 6967 6874 2070 726f 706f 7274 696f 6e73  ight proportions
+0003e2c0: 2229 0d0a 0d0a 2020 2020 2020 2020 2020  ")....          
+0003e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e2e0: 2020 636d 3d73 656c 662e 6c69 7374 5f66    cm=self.list_f
+0003e2f0: 5f63 6f76 6d6f 6465 6c5b 305d 0d0a 0d0a  _covmodel[0]....
+0003e300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e310: 2020 2020 2020 2020 2020 2020 7369 6c6c              sill
+0003e320: 3d63 6d2e 7369 6c6c 2829 2023 6765 7420  =cm.sill() #get 
+0003e330: 7369 6c6c 0d0a 0d0a 2020 2020 2020 2020  sill....        
+0003e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e350: 2020 2020 7365 6c66 2e6c 6973 745f 665f      self.list_f_
+0003e360: 636f 766d 6f64 656c 3d5b 5d20 2372 6573  covmodel=[] #res
+0003e370: 6574 206c 6973 740d 0a0d 0a20 2020 2020  et list....     
+0003e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e390: 2020 2020 2020 2069 6661 3d30 0d0a 2020         ifa=0..  
+0003e3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e3b0: 2020 2020 2020 2020 2020 666f 7220 6661            for fa
+0003e3c0: 2069 6e20 6c69 7374 5f6f 626a 3a20 236c   in list_obj: #l
+0003e3d0: 6f6f 7020 6f76 6572 2066 6163 6965 730d  oop over facies.
+0003e3e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0003e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e400: 2020 2020 2020 2323 2061 7373 6572 7469        ## asserti
-0003e410: 6f6e 7320 2323 0d0a 2020 2020 2020 2020  ons ##..        
-0003e420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e430: 6173 7365 7274 2020 6973 696e 7374 616e  assert  isinstan
-0003e440: 6365 2873 656c 662e 665f 5449 2c20 6765  ce(self.f_TI, ge
-0003e450: 6f6e 652e 696d 672e 496d 6729 2c20 2254  one.img.Img), "T
-0003e460: 4920 6973 206e 6f74 2061 2067 656f 6e65  I is not a geone
-0003e470: 2069 6d61 6765 206f 626a 6563 7422 0d0a   image object"..
-0003e480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003e490: 2020 2020 2020 2020 2020 236c 6f61 6420            #load 
-0003e4a0: 7061 7261 6d65 7465 7273 0d0a 2020 2020  parameters..    
-0003e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e4c0: 2020 2020 5449 3d73 656c 662e 665f 5449      TI=self.f_TI
-0003e4d0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003e4e0: 2020 2020 2020 2020 2020 2020 2366 6163              #fac
-0003e4f0: 6965 7320 4944 730d 0a20 2020 2020 2020  ies IDs..       
-0003e500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e510: 2049 4473 3d6e 702e 756e 6971 7565 2854   IDs=np.unique(T
-0003e520: 492e 7661 6c29 0d0a 2020 2020 2020 2020  I.val)..        
+0003e400: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0003e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e420: 2020 2063 6d5f 636f 7079 3d63 6f70 792e     cm_copy=copy.
+0003e430: 6465 6570 636f 7079 2863 6d29 2023 6d61  deepcopy(cm) #ma
+0003e440: 6b65 2061 2063 6f70 790d 0a0d 0a20 2020  ke a copy....   
+0003e450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e460: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0003e470: 2270 726f 6261 6269 6c69 7479 2220 696e  "probability" in
+0003e480: 206b 7761 7267 732e 6b65 7973 2829 3a0d   kwargs.keys():.
+0003e490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e4b0: 2020 2020 2069 6620 6b77 6172 6773 5b22       if kwargs["
+0003e4c0: 7072 6f62 6162 696c 6974 7922 5d20 6973  probability"] is
+0003e4d0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+0003e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e500: 2020 2020 7020 3d20 6b77 6172 6773 5b22      p = kwargs["
+0003e510: 7072 6f62 6162 696c 6974 7922 5d5b 6966  probability"][if
+0003e520: 615d 0d0a 2020 2020 2020 2020 2020 2020  a]..            
 0003e530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e540: 6e63 6c61 7373 3d6c 656e 2849 4473 290d  nclass=len(IDs).
-0003e550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e560: 2020 2020 2020 2020 2063 6c61 7373 496e           classIn
-0003e570: 7465 7276 616c 3d5b 5d0d 0a20 2020 2020  terval=[]..     
-0003e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e590: 2020 2066 6f72 2063 2069 6e20 4944 733a     for c in IDs:
-0003e5a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003e5b0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-0003e5c0: 6173 7349 6e74 6572 7661 6c2e 6170 7065  assInterval.appe
-0003e5d0: 6e64 285b 632d 302e 352c 2063 2b30 2e35  nd([c-0.5, c+0.5
-0003e5e0: 5d29 0d0a 0d0a 2020 2020 2020 2020 2020  ])....          
-0003e5f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0003e600: 6578 7472 6163 7420 6861 7264 2064 6174  extract hard dat
-0003e610: 610d 0a20 2020 2020 2020 2020 2020 2020  a..             
-0003e620: 2020 2020 2020 2020 2020 2068 643d 6e70             hd=np
-0003e630: 2e6f 6e65 7328 5b34 2c20 315d 290d 0a20  .ones([4, 1]).. 
-0003e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e650: 2020 2020 2020 2066 6f72 2066 6120 696e         for fa in
-0003e660: 206c 6973 745f 6f62 6a3a 2023 6661 6369   list_obj: #faci
-0003e670: 6573 2062 7920 6661 6369 6573 2069 6e20  es by facies in 
-0003e680: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
+0003e540: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0003e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e570: 2020 2020 2020 2070 3d6e 702e 7375 6d28         p=np.sum(
+0003e580: 6661 6369 6573 203d 3d20 6661 2e49 4429  facies == fa.ID)
+0003e590: 2f6c 656e 2866 6163 6965 7320 3d3d 2066  /len(facies == f
+0003e5a0: 612e 4944 2920 2363 616c 6375 6c61 7465  a.ID) #calculate
+0003e5b0: 2070 726f 706f 7274 696f 6e20 6f66 2066   proportion of f
+0003e5c0: 6163 6965 730d 0a20 2020 2020 2020 2020  acies..         
+0003e5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e5e0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0003e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e610: 2020 703d 6e70 2e73 756d 2866 6163 6965    p=np.sum(facie
+0003e620: 7320 3d3d 2066 612e 4944 292f 6c65 6e28  s == fa.ID)/len(
+0003e630: 6661 6369 6573 203d 3d20 6661 2e49 4429  facies == fa.ID)
+0003e640: 2023 6361 6c63 756c 6174 6520 7072 6f70   #calculate prop
+0003e650: 6f72 7469 6f6e 206f 6620 6661 6369 6573  ortion of facies
+0003e660: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0003e670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e680: 2020 2020 6966 2070 203e 2030 3a0d 0a20      if p > 0:.. 
 0003e690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e6a0: 2020 6661 5f78 3d6e 702e 6172 7261 7928    fa_x=np.array(
-0003e6b0: 6661 2e78 290d 0a20 2020 2020 2020 2020  fa.x)..         
-0003e6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e6d0: 2020 2066 615f 793d 6e70 2e61 7272 6179     fa_y=np.array
-0003e6e0: 2866 612e 7929 0d0a 2020 2020 2020 2020  (fa.y)..        
-0003e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e700: 2020 2020 6661 5f7a 3d6e 702e 6172 7261      fa_z=np.arra
-0003e710: 7928 6661 2e7a 290d 0a20 2020 2020 2020  y(fa.z)..       
-0003e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e730: 2020 2020 2068 6469 3d6e 702e 7a65 726f       hdi=np.zero
-0003e740: 7328 5b34 2c20 6661 5f78 2e73 6861 7065  s([4, fa_x.shape
-0003e750: 5b30 5d5d 290d 0a20 2020 2020 2020 2020  [0]])..         
-0003e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e770: 2020 2068 6469 5b30 5d3d 2066 615f 780d     hdi[0]= fa_x.
-0003e780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e790: 2020 2020 2020 2020 2020 2020 2068 6469               hdi
-0003e7a0: 5b31 5d3d 6661 5f79 0d0a 2020 2020 2020  [1]=fa_y..      
-0003e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e7c0: 2020 2020 2020 6864 695b 325d 3d66 615f        hdi[2]=fa_
-0003e7d0: 7a0d 0a20 2020 2020 2020 2020 2020 2020  z..             
-0003e7e0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-0003e7f0: 6469 5b33 5d3d 6e70 2e6f 6e65 7328 6661  di[3]=np.ones(fa
-0003e800: 5f78 2e73 6861 7065 292a 6661 2e49 440d  _x.shape)*fa.ID.
-0003e810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e820: 2020 2020 2020 2020 2020 2020 2068 643d               hd=
-0003e830: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
-0003e840: 6864 2c20 6864 695d 2c20 6178 6973 3d31  hd, hdi], axis=1
-0003e850: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003e860: 2020 2020 2020 2020 2020 2068 643d 6e70             hd=np
-0003e870: 2e64 656c 6574 6528 6864 2c20 302c 2061  .delete(hd, 0, a
-0003e880: 7869 733d 3129 2023 2072 656d 6f76 6520  xis=1) # remove 
-0003e890: 3173 7420 706f 696e 7420 2849 2064 6964  1st point (I did
-0003e8a0: 6e27 7420 6669 6e64 2061 2063 6c65 7665  n't find a cleve
-0003e8b0: 7220 7761 7920 746f 2064 6f20 6974 2e2e  r way to do it..
-0003e8c0: 2e29 0d0a 2020 2020 2020 2020 2020 2020  .)..            
-0003e8d0: 2020 2020 2020 2020 2020 2020 7074 3d69              pt=i
-0003e8e0: 6d67 2e50 6f69 6e74 5365 7428 6e70 743d  mg.PointSet(npt=
-0003e8f0: 6864 2e73 6861 7065 5b31 5d2c 206e 763d  hd.shape[1], nv=
-0003e900: 342c 2076 616c 3d68 6429 0d0a 2020 2020  4, val=hd)..    
-0003e910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e920: 2020 2020 7074 2e73 6574 5f76 6172 6e61      pt.set_varna
-0003e930: 6d65 2822 636f 6465 2229 0d0a 0d0a 2020  me("code")....  
-0003e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e950: 2020 2020 2020 2320 6175 746f 6d61 7469        # automati
-0003e960: 6320 696e 6665 7265 6e63 6520 6f66 206f  c inference of o
-0003e970: 7269 656e 7461 7469 6f6e 730d 0a20 2020  rientations..   
-0003e980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e990: 2020 2020 2069 6620 6b77 6172 6773 5b22       if kwargs["
-0003e9a0: 726f 7441 7a69 225d 203d 3d20 2269 6e66  rotAzi"] == "inf
-0003e9b0: 6572 656e 6365 2220 616e 6420 6b77 6172  erence" and kwar
-0003e9c0: 6773 5b22 726f 7444 6970 225d 203d 3d20  gs["rotDip"] == 
-0003e9d0: 2269 6e66 6572 656e 6365 223a 2020 2320  "inference":  # 
-0003e9e0: 6f6e 6c79 2069 6620 7468 6573 6520 7477  only if these tw
-0003e9f0: 6f20 6172 6520 7365 7420 6f6e 2069 6e66  o are set on inf
-0003ea00: 6572 656e 6365 0d0a 2020 2020 2020 2020  erence..        
-0003ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ea20: 2020 2020 617a 692c 2064 6970 3d41 7263      azi, dip=Arc
-0003ea30: 6854 6162 6c65 2e6f 7269 656e 7461 7469  hTable.orientati
-0003ea40: 6f6e 5f6d 6170 2873 656c 662c 2061 7a69  on_map(self, azi
-0003ea50: 5f74 6f70 203d 206b 7761 7267 735b 2261  _top = kwargs["a
-0003ea60: 7a69 5f74 6f70 225d 2c20 2064 6970 5f74  zi_top"],  dip_t
-0003ea70: 6f70 3d20 6b77 6172 6773 5b22 6469 705f  op= kwargs["dip_
-0003ea80: 746f 7022 5d2c 0d0a 2020 2020 2020 2020  top"],..        
-0003ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eac0: 2020 2020 2020 2061 7a69 5f62 6f74 3d6b         azi_bot=k
-0003ead0: 7761 7267 735b 2261 7a69 5f62 6f74 225d  wargs["azi_bot"]
-0003eae0: 2c20 6469 705f 626f 743d 6b77 6172 6773  , dip_bot=kwargs
-0003eaf0: 5b22 6469 705f 626f 7422 5d2c 2073 6d6f  ["dip_bot"], smo
-0003eb00: 6f74 683d 3229 2020 2320 6765 7420 617a  oth=2)  # get az
-0003eb10: 696d 7574 6820 616e 6420 6469 700d 0a0d  imuth and dip...
-0003eb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003eb30: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-0003eb40: 7267 735b 2272 6f74 417a 6922 5d20 3d20  rgs["rotAzi"] = 
-0003eb50: 617a 690d 0a20 2020 2020 2020 2020 2020  azi..           
-0003eb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eb70: 206b 7761 7267 735b 2272 6f74 4469 7022   kwargs["rotDip"
-0003eb80: 5d20 3d20 6469 700d 0a20 2020 2020 2020  ] = dip..       
-0003eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eba0: 2020 2020 206b 7761 7267 735b 2272 6f74       kwargs["rot
-0003ebb0: 417a 694c 6f63 225d 203d 2054 7275 650d  AziLoc"] = True.
-0003ebc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ebd0: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-0003ebe0: 7267 735b 2272 6f74 4469 704c 6f63 225d  rgs["rotDipLoc"]
-0003ebf0: 203d 2054 7275 650d 0a0d 0a20 2020 2020   = True....     
-0003ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec10: 2020 2023 4453 2072 6573 6561 7263 680d     #DS research.
-0003ec20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ec30: 2020 2020 2020 2020 2073 6e70 3d64 7369           snp=dsi
-0003ec40: 2e53 6561 7263 684e 6569 6768 626f 7268  .SearchNeighborh
-0003ec50: 6f6f 6450 6172 616d 6574 6572 7328 0d0a  oodParameters(..
-0003ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec70: 2020 2020 2020 2020 2020 2020 7261 6469              radi
-0003ec80: 7573 4d6f 6465 3d6b 7761 7267 735b 2272  usMode=kwargs["r
-0003ec90: 6164 6975 734d 6f64 6522 5d2c 2072 783d  adiusMode"], rx=
-0003eca0: 6b77 6172 6773 5b22 7278 225d 2c20 7279  kwargs["rx"], ry
-0003ecb0: 3d6b 7761 7267 735b 2272 7922 5d2c 2072  =kwargs["ry"], r
-0003ecc0: 7a3d 6b77 6172 6773 5b22 727a 225d 2c0d  z=kwargs["rz"],.
-0003ecd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ece0: 2020 2020 2020 2020 2020 2020 2061 6e69               ani
-0003ecf0: 736f 7472 6f70 7952 6174 696f 4d6f 6465  sotropyRatioMode
-0003ed00: 3d6b 7761 7267 735b 2261 6e69 736f 7472  =kwargs["anisotr
-0003ed10: 6f70 7952 6174 696f 4d6f 6465 225d 2c20  opyRatioMode"], 
-0003ed20: 6178 3d6b 7761 7267 735b 2261 7822 5d2c  ax=kwargs["ax"],
-0003ed30: 2061 793d 6b77 6172 6773 5b22 6179 225d   ay=kwargs["ay"]
-0003ed40: 2c20 617a 3d6b 7761 7267 735b 2261 7a22  , az=kwargs["az"
-0003ed50: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0003ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed70: 616e 676c 6531 3d6b 7761 7267 735b 2261  angle1=kwargs["a
-0003ed80: 6e67 6c65 3122 5d2c 2061 6e67 6c65 323d  ngle1"], angle2=
-0003ed90: 6b77 6172 6773 5b22 616e 676c 6532 225d  kwargs["angle2"]
-0003eda0: 2c20 616e 676c 6533 3d6b 7761 7267 735b  , angle3=kwargs[
-0003edb0: 2261 6e67 6c65 3322 5d29 0d0a 0d0a 2020  "angle3"])....  
+0003e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6b0: 2020 2076 6172 3d70 2a28 312d 7029 2023     var=p*(1-p) #
+0003e6c0: 7661 7269 616e 6365 0d0a 2020 2020 2020  variance..      
+0003e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6e0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0003e6f0: 7469 6f3d 7661 722f 7369 6c6c 2020 2372  tio=var/sill  #r
+0003e700: 6174 696f 2062 7477 2063 6f76 6d6f 6465  atio btw covmode
+0003e710: 6c20 616e 6420 7265 616c 2076 6172 6961  l and real varia
+0003e720: 6e63 650d 0a0d 0a20 2020 2020 2020 2020  nce....         
+0003e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e740: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0003e750: 2069 6e20 636d 5f63 6f70 792e 656c 656d   in cm_copy.elem
+0003e760: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e780: 2020 2020 2020 2020 2020 2065 5b31 5d5b             e[1][
+0003e790: 2277 225d 202a 3d20 7261 7469 6f0d 0a20  "w"] *= ratio.. 
+0003e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e7b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003e7c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0003e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e7e0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
+0003e7f0: 696e 2063 6d5f 636f 7079 2e65 6c65 6d3a  in cm_copy.elem:
+0003e800: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e820: 2020 2020 2020 2020 2020 655b 315d 5b22            e[1]["
+0003e830: 7722 5d20 2a3d 2031 0d0a 2020 2020 2020  w"] *= 1..      
+0003e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e850: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+0003e860: 6973 745f 665f 636f 766d 6f64 656c 2e61  ist_f_covmodel.a
+0003e870: 7070 656e 6428 636d 5f63 6f70 7929 0d0a  ppend(cm_copy)..
+0003e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e8a0: 6966 6120 2b3d 2031 0d0a 0d0a 2020 2020  ifa += 1....    
+0003e8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e8c0: 2020 2020 2323 2053 696d 756c 6174 696f      ## Simulatio
+0003e8d0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+0003e8e0: 2020 2020 2020 2020 2020 2073 696d 7573             simus
+0003e8f0: 203d 2067 6369 2e73 696d 756c 6174 6549   = gci.simulateI
+0003e900: 6e64 6963 6174 6f72 3344 2863 6174 5f76  ndicator3D(cat_v
+0003e910: 616c 7565 732c 2073 656c 662e 6c69 7374  alues, self.list
+0003e920: 5f66 5f63 6f76 6d6f 6465 6c2c 2064 696d  _f_covmodel, dim
+0003e930: 656e 7369 6f6e 732c 2073 7061 6369 6e67  ensions, spacing
+0003e940: 2c20 6f72 6967 696e 2c0d 0a20 2020 2020  , origin,..     
+0003e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e980: 2020 206e 7265 616c 3d6e 7265 616c 2c20     nreal=nreal, 
+0003e990: 6d65 7468 6f64 3d22 7369 6d70 6c65 5f6b  method="simple_k
+0003e9a0: 7269 6769 6e67 222c 2078 3d68 642c 2076  riging", x=hd, v
+0003e9b0: 3d66 6163 6965 732c 206d 6173 6b3d 6d61  =facies, mask=ma
+0003e9c0: 736b 2c0d 0a20 2020 2020 2020 2020 2020  sk,..           
+0003e9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9f0: 2020 2020 2020 2020 2020 2020 2073 6561               sea
+0003ea00: 7263 6852 6164 6975 7352 656c 6174 6976  rchRadiusRelativ
+0003ea10: 653d 6b77 6172 6773 5b22 7222 5d2c 206e  e=kwargs["r"], n
+0003ea20: 6e65 6967 6862 6f72 4d61 783d 6b77 6172  neighborMax=kwar
+0003ea30: 6773 5b22 6e65 6967 225d 2c0d 0a20 2020  gs["neig"],..   
+0003ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea70: 2020 2020 2070 726f 6261 6269 6c69 7479       probability
+0003ea80: 3d6b 7761 7267 735b 2270 726f 6261 6269  =kwargs["probabi
+0003ea90: 6c69 7479 225d 2c20 7665 7262 6f73 653d  lity"], verbose=
+0003eaa0: 7665 7262 6f73 652c 206e 7468 7265 6164  verbose, nthread
+0003eab0: 7320 3d20 4172 6368 5461 626c 652e 6e63  s = ArchTable.nc
+0003eac0: 7075 2c20 7365 6564 3d73 6565 642b 6975  pu, seed=seed+iu
+0003ead0: 295b 2269 6d61 6765 225d 2e76 616c 0d0a  )["image"].val..
+0003eae0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003eaf0: 2020 2020 2020 2020 2020 2323 2320 7265            ### re
+0003eb00: 6172 7261 6e67 6520 6461 7461 2069 6e74  arrange data int
+0003eb10: 6f20 6120 3244 2061 7272 6179 206f 6620  o a 2D array of 
+0003eb20: 7468 6520 7369 6d75 6c61 7469 6f6e 2067  the simulation g
+0003eb30: 7269 6420 7369 7a65 2023 2323 0d0a 2020  rid size ###..  
+0003eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eb50: 2020 2020 2020 666f 7220 6972 6561 6c20        for ireal 
+0003eb60: 696e 2072 616e 6765 286e 7265 616c 293a  in range(nreal):
+0003eb70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003eb80: 2020 2020 2020 2020 2020 2020 2020 6772                gr
+0003eb90: 6964 3d73 696d 7573 5b69 7265 616c 5d0d  id=simus[ireal].
+0003eba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ebb0: 2020 2020 2020 2020 2020 2020 2067 7269               gri
+0003ebc0: 645b 6772 6964 3d3d 305d 3d6e 702e 6e61  d[grid==0]=np.na
+0003ebd0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+0003ebe0: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0003ebf0: 7269 645b 6d61 736b 3d3d 305d 3d6e 702e  rid[mask==0]=np.
+0003ec00: 6e61 6e20 2023 2065 7874 7261 6374 206f  nan  # extract o
+0003ec10: 6e6c 7920 7468 6520 7061 7274 206f 6e20  nly the part on 
+0003ec20: 7468 6520 7265 616c 2064 6f6d 6169 6e0d  the real domain.
+0003ec30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ec40: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+0003ec50: 6965 735f 646f 6d61 696e 735b 6975 2c20  ies_domains[iu, 
+0003ec60: 6972 6561 6c5d 5b6d 6173 6b5d 3d67 7269  ireal][mask]=gri
+0003ec70: 645b 6d61 736b 5d0d 0a0d 0a20 2020 2020  d[mask]....     
+0003ec80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003ec90: 6c69 6620 6d65 7468 6f64 2e75 7070 6572  lif method.upper
+0003eca0: 2829 203d 3d20 224d 5053 223a 0d0a 2020  () == "MPS":..  
+0003ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ecc0: 2020 2020 2020 2323 2061 7373 6572 7469        ## asserti
+0003ecd0: 6f6e 7320 2323 0d0a 2020 2020 2020 2020  ons ##..        
+0003ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ecf0: 6173 7365 7274 2020 6973 696e 7374 616e  assert  isinstan
+0003ed00: 6365 2873 656c 662e 665f 5449 2c20 6765  ce(self.f_TI, ge
+0003ed10: 6f6e 652e 696d 672e 496d 6729 2c20 2254  one.img.Img), "T
+0003ed20: 4920 6973 206e 6f74 2061 2067 656f 6e65  I is not a geone
+0003ed30: 2069 6d61 6765 206f 626a 6563 7422 0d0a   image object"..
+0003ed40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ed50: 2020 2020 2020 2020 2020 236c 6f61 6420            #load 
+0003ed60: 7061 7261 6d65 7465 7273 0d0a 2020 2020  parameters..    
+0003ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed80: 2020 2020 5449 3d73 656c 662e 665f 5449      TI=self.f_TI
+0003ed90: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0003eda0: 2020 2020 2020 2020 2020 2020 2366 6163              #fac
+0003edb0: 6965 7320 4944 730d 0a20 2020 2020 2020  ies IDs..       
 0003edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003edd0: 2020 2020 2020 736e 705f 6c20 3d20 5b5d        snp_l = []
-0003ede0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003edf0: 2020 2020 2020 2020 2020 666f 7220 6976            for iv
-0003ee00: 2069 6e20 7261 6e67 6528 6b77 6172 6773   in range(kwargs
-0003ee10: 5b22 6e76 225d 293a 0d0a 2020 2020 2020  ["nv"]):..      
-0003ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee30: 2020 2020 2020 736e 705f 6c2e 6170 7065        snp_l.appe
-0003ee40: 6e64 2873 6e70 290d 0a0d 0a20 2020 2020  nd(snp)....     
-0003ee50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee60: 2020 2023 4453 2073 6f66 7470 726f 6261     #DS softproba
-0003ee70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ee80: 2020 2020 2020 2020 2020 7370 3d64 7369            sp=dsi
-0003ee90: 2e53 6f66 7450 726f 6261 6269 6c69 7479  .SoftProbability
-0003eea0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0003eeb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003eec0: 726f 6261 6269 6c69 7479 436f 6e73 7472  robabilityConstr
-0003eed0: 6169 6e74 5573 6167 653d 6b77 6172 6773  aintUsage=kwargs
-0003eee0: 5b22 7072 6f62 6155 7361 6765 225d 2c20  ["probaUsage"], 
-0003eef0: 2020 2320 7072 6f62 6162 696c 6974 7920    # probability 
-0003ef00: 636f 6e73 7472 6169 6e74 7320 6d65 7468  constraints meth
-0003ef10: 6f64 2028 3120 666f 7220 676c 6f62 612c  od (1 for globa,
-0003ef20: 2032 2066 6f72 206c 6f63 616c 290d 0a20   2 for local).. 
-0003ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef40: 2020 2020 2020 2020 2020 206e 636c 6173             nclas
-0003ef50: 733d 6e63 6c61 7373 2c20 2020 2020 2020  s=nclass,       
-0003ef60: 2020 2020 2020 2020 2020 2023 206e 756d             # num
-0003ef70: 6265 7220 6f66 2063 6c61 7373 6573 206f  ber of classes o
-0003ef80: 6620 7661 6c75 6573 0d0a 2020 2020 2020  f values..      
-0003ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003efa0: 2020 2020 2020 636c 6173 7349 6e74 6572        classInter
-0003efb0: 7661 6c3d 636c 6173 7349 6e74 6572 7661  val=classInterva
-0003efc0: 6c2c 2020 2320 6c69 7374 206f 6620 636c  l,  # list of cl
-0003efd0: 6173 7365 730d 0a20 2020 2020 2020 2020  asses..         
+0003edd0: 2049 4473 3d6e 702e 756e 6971 7565 2854   IDs=np.unique(T
+0003ede0: 492e 7661 6c29 0d0a 2020 2020 2020 2020  I.val)..        
+0003edf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee00: 6e63 6c61 7373 3d6c 656e 2849 4473 290d  nclass=len(IDs).
+0003ee10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ee20: 2020 2020 2020 2020 2063 6c61 7373 496e           classIn
+0003ee30: 7465 7276 616c 3d5b 5d0d 0a20 2020 2020  terval=[]..     
+0003ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee50: 2020 2066 6f72 2063 2069 6e20 4944 733a     for c in IDs:
+0003ee60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ee70: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+0003ee80: 6173 7349 6e74 6572 7661 6c2e 6170 7065  assInterval.appe
+0003ee90: 6e64 285b 632d 302e 352c 2063 2b30 2e35  nd([c-0.5, c+0.5
+0003eea0: 5d29 0d0a 0d0a 2020 2020 2020 2020 2020  ])....          
+0003eeb0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0003eec0: 6578 7472 6163 7420 6861 7264 2064 6174  extract hard dat
+0003eed0: 610d 0a20 2020 2020 2020 2020 2020 2020  a..             
+0003eee0: 2020 2020 2020 2020 2020 2068 643d 6e70             hd=np
+0003eef0: 2e6f 6e65 7328 5b34 2c20 315d 290d 0a20  .ones([4, 1]).. 
+0003ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ef10: 2020 2020 2020 2066 6f72 2066 6120 696e         for fa in
+0003ef20: 206c 6973 745f 6f62 6a3a 2023 6661 6369   list_obj: #faci
+0003ef30: 6573 2062 7920 6661 6369 6573 2069 6e20  es by facies in 
+0003ef40: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
+0003ef50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ef60: 2020 6661 5f78 3d6e 702e 6172 7261 7928    fa_x=np.array(
+0003ef70: 6661 2e78 290d 0a20 2020 2020 2020 2020  fa.x)..         
+0003ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ef90: 2020 2066 615f 793d 6e70 2e61 7272 6179     fa_y=np.array
+0003efa0: 2866 612e 7929 0d0a 2020 2020 2020 2020  (fa.y)..        
+0003efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003efc0: 2020 2020 6661 5f7a 3d6e 702e 6172 7261      fa_z=np.arra
+0003efd0: 7928 6661 2e7a 290d 0a20 2020 2020 2020  y(fa.z)..       
 0003efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eff0: 2020 206c 6f63 616c 5064 663d 206b 7761     localPdf= kwa
-0003f000: 7267 735b 226c 6f63 616c 5064 6622 5d2c  rgs["localPdf"],
-0003f010: 2020 2020 2020 2020 2020 2020 2023 206c               # l
-0003f020: 6f63 616c 2074 6172 6765 7420 5044 460d  ocal target PDF.
-0003f030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f040: 2020 2020 2020 2020 2020 2020 2067 6c6f               glo
-0003f050: 6261 6c50 6466 3d6b 7761 7267 735b 2267  balPdf=kwargs["g
-0003f060: 6c6f 6261 6c50 6466 225d 2c0d 0a20 2020  lobalPdf"],..   
+0003eff0: 2020 2020 2068 6469 3d6e 702e 7a65 726f       hdi=np.zero
+0003f000: 7328 5b34 2c20 6661 5f78 2e73 6861 7065  s([4, fa_x.shape
+0003f010: 5b30 5d5d 290d 0a20 2020 2020 2020 2020  [0]])..         
+0003f020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f030: 2020 2068 6469 5b30 5d3d 2066 615f 780d     hdi[0]= fa_x.
+0003f040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f050: 2020 2020 2020 2020 2020 2020 2068 6469               hdi
+0003f060: 5b31 5d3d 6661 5f79 0d0a 2020 2020 2020  [1]=fa_y..      
 0003f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f080: 2020 2020 2020 2020 206c 6f63 616c 5064           localPd
-0003f090: 6653 7570 706f 7274 5261 6469 7573 3d6b  fSupportRadius=k
-0003f0a0: 7761 7267 735b 226c 6f63 616c 5064 6652  wargs["localPdfR
-0003f0b0: 6164 6975 7322 5d2c 2020 2020 2020 2320  adius"],      # 
-0003f0c0: 7375 7070 6f72 7420 7261 6469 7573 0d0a  support radius..
-0003f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f0e0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0003f0f0: 6172 696e 6750 6466 4d65 7468 6f64 3d35  aringPdfMethod=5
-0003f100: 2c20 2020 2020 2020 2020 2020 2320 6d65  ,           # me
-0003f110: 7468 6f64 2066 6f72 2063 6f6d 7061 7269  thod for compari
-0003f120: 6e67 2050 4446 2773 2028 7365 6520 646f  ng PDF's (see do
-0003f130: 633a 2068 656c 7028 6765 6f6e 652e 6465  c: help(geone.de
-0003f140: 6573 7365 696e 7465 7266 6163 652e 536f  esseinterface.So
-0003f150: 6674 5072 6f62 6162 696c 6974 7929 290d  ftProbability)).
-0003f160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f170: 2020 2020 2020 2020 2020 2020 2064 6561               dea
-0003f180: 6374 6976 6174 696f 6e44 6973 7461 6e63  ctivationDistanc
-0003f190: 653d 6b77 6172 6773 5b22 6465 6163 7469  e=kwargs["deacti
-0003f1a0: 7661 7469 6f6e 4469 7374 616e 6365 225d  vationDistance"]
-0003f1b0: 2c20 2020 2020 2020 2320 6465 6163 7469  ,       # deacti
-0003f1c0: 7661 7469 6f6e 2064 6973 7461 6e63 6520  vation distance 
-0003f1d0: 2863 6865 636b 696e 6720 5044 4620 6973  (checking PDF is
-0003f1e0: 2064 6561 6374 6976 6174 6564 2066 6f72   deactivated for
-0003f1f0: 206e 6172 726f 7720 7061 7474 6572 6e73   narrow patterns
-0003f200: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003f210: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0003f220: 6f6e 7374 616e 7454 6872 6573 686f 6c64  onstantThreshold
-0003f230: 3d6b 7761 7267 735b 2263 6f6e 7374 616e  =kwargs["constan
-0003f240: 7454 6872 6573 686f 6c64 225d 2920 2020  tThreshold"])   
-0003f250: 2020 2020 2023 2061 6363 6570 7461 7469       # acceptati
-0003f260: 6f6e 2074 6872 6573 686f 6c64 0d0a 0d0a  on threshold....
-0003f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f280: 2020 2020 2020 2020 7370 5f6c 203d 205b          sp_l = [
-0003f290: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0003f2a0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0003f2b0: 7620 696e 2072 616e 6765 286b 7761 7267  v in range(kwarg
-0003f2c0: 735b 226e 7622 5d29 3a0d 0a20 2020 2020  s["nv"]):..     
+0003f080: 2020 2020 2020 6864 695b 325d 3d66 615f        hdi[2]=fa_
+0003f090: 7a0d 0a20 2020 2020 2020 2020 2020 2020  z..             
+0003f0a0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+0003f0b0: 6469 5b33 5d3d 6e70 2e6f 6e65 7328 6661  di[3]=np.ones(fa
+0003f0c0: 5f78 2e73 6861 7065 292a 6661 2e49 440d  _x.shape)*fa.ID.
+0003f0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f0e0: 2020 2020 2020 2020 2020 2020 2068 643d               hd=
+0003f0f0: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
+0003f100: 6864 2c20 6864 695d 2c20 6178 6973 3d31  hd, hdi], axis=1
+0003f110: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003f120: 2020 2020 2020 2020 2020 2068 643d 6e70             hd=np
+0003f130: 2e64 656c 6574 6528 6864 2c20 302c 2061  .delete(hd, 0, a
+0003f140: 7869 733d 3129 2023 2072 656d 6f76 6520  xis=1) # remove 
+0003f150: 3173 7420 706f 696e 7420 2849 2064 6964  1st point (I did
+0003f160: 6e27 7420 6669 6e64 2061 2063 6c65 7665  n't find a cleve
+0003f170: 7220 7761 7920 746f 2064 6f20 6974 2e2e  r way to do it..
+0003f180: 2e29 0d0a 2020 2020 2020 2020 2020 2020  .)..            
+0003f190: 2020 2020 2020 2020 2020 2020 7074 3d69              pt=i
+0003f1a0: 6d67 2e50 6f69 6e74 5365 7428 6e70 743d  mg.PointSet(npt=
+0003f1b0: 6864 2e73 6861 7065 5b31 5d2c 206e 763d  hd.shape[1], nv=
+0003f1c0: 342c 2076 616c 3d68 6429 0d0a 2020 2020  4, val=hd)..    
+0003f1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f1e0: 2020 2020 7074 2e73 6574 5f76 6172 6e61      pt.set_varna
+0003f1f0: 6d65 2822 636f 6465 2229 0d0a 0d0a 2020  me("code")....  
+0003f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f210: 2020 2020 2020 2320 6175 746f 6d61 7469        # automati
+0003f220: 6320 696e 6665 7265 6e63 6520 6f66 206f  c inference of o
+0003f230: 7269 656e 7461 7469 6f6e 730d 0a20 2020  rientations..   
+0003f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f250: 2020 2020 2069 6620 6b77 6172 6773 5b22       if kwargs["
+0003f260: 726f 7441 7a69 225d 203d 3d20 2269 6e66  rotAzi"] == "inf
+0003f270: 6572 656e 6365 2220 616e 6420 6b77 6172  erence" and kwar
+0003f280: 6773 5b22 726f 7444 6970 225d 203d 3d20  gs["rotDip"] == 
+0003f290: 2269 6e66 6572 656e 6365 223a 2020 2320  "inference":  # 
+0003f2a0: 6f6e 6c79 2069 6620 7468 6573 6520 7477  only if these tw
+0003f2b0: 6f20 6172 6520 7365 7420 6f6e 2069 6e66  o are set on inf
+0003f2c0: 6572 656e 6365 0d0a 2020 2020 2020 2020  erence..        
 0003f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f2e0: 2020 2020 2020 2073 705f 6c2e 6170 7065         sp_l.appe
-0003f2f0: 6e64 2873 7029 0d0a 0d0a 2020 2020 2020  nd(sp)....      
-0003f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f310: 2020 2344 5320 696e 7075 740d 0a20 2020    #DS input..   
-0003f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f330: 2020 2020 2064 6565 7373 655f 696e 7075       deesse_inpu
-0003f340: 743d 6473 692e 4465 6573 7365 496e 7075  t=dsi.DeesseInpu
-0003f350: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+0003f2e0: 2020 2020 617a 692c 2064 6970 3d41 7263      azi, dip=Arc
+0003f2f0: 6854 6162 6c65 2e6f 7269 656e 7461 7469  hTable.orientati
+0003f300: 6f6e 5f6d 6170 2873 656c 662c 2061 7a69  on_map(self, azi
+0003f310: 5f74 6f70 203d 206b 7761 7267 735b 2261  _top = kwargs["a
+0003f320: 7a69 5f74 6f70 225d 2c20 2064 6970 5f74  zi_top"],  dip_t
+0003f330: 6f70 3d20 6b77 6172 6773 5b22 6469 705f  op= kwargs["dip_
+0003f340: 746f 7022 5d2c 0d0a 2020 2020 2020 2020  top"],..        
+0003f350: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f370: 6e78 3d6e 782c 206e 793d 6e79 2c20 6e7a  nx=nx, ny=ny, nz
-0003f380: 3d6e 7a2c 2020 2020 2020 2023 2064 696d  =nz,       # dim
-0003f390: 656e 7369 6f6e 206f 6620 7468 6520 7369  ension of the si
-0003f3a0: 6d75 6c61 7469 6f6e 2067 7269 6420 286e  mulation grid (n
-0003f3b0: 756d 6265 7220 6f66 2063 656c 6c73 290d  umber of cells).
-0003f3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f3d0: 2020 2020 2020 2020 2020 2020 2073 783d               sx=
-0003f3e0: 7378 2c20 7379 3d73 792c 2073 7a3d 737a  sx, sy=sy, sz=sz
-0003f3f0: 2c20 2020 2020 2320 6365 6c6c 7320 756e  ,     # cells un
-0003f400: 6974 7320 696e 2074 6865 2073 696d 756c  its in the simul
-0003f410: 6174 696f 6e20 6772 6964 2028 6865 7265  ation grid (here
-0003f420: 2061 7265 2074 6865 2064 6566 6175 6c74   are the default
-0003f430: 2076 616c 7565 7329 0d0a 2020 2020 2020   values)..      
-0003f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f450: 2020 2020 2020 6f78 3d6f 782c 206f 793d        ox=ox, oy=
-0003f460: 6f79 2c20 6f7a 3d6f 7a2c 2020 2020 2023  oy, oz=oz,     #
-0003f470: 206f 7269 6769 6e20 6f66 2074 6865 2073   origin of the s
-0003f480: 696d 756c 6174 696f 6e20 6772 6964 2028  imulation grid (
-0003f490: 6865 7265 2061 7265 2074 6865 2064 6566  here are the def
-0003f4a0: 6175 6c74 2076 616c 7565 7329 0d0a 2020  ault values)..  
-0003f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f4c0: 2020 2020 2020 2020 2020 6e76 3d6b 7761            nv=kwa
-0003f4d0: 7267 735b 226e 7622 5d2c 2076 6172 6e61  rgs["nv"], varna
-0003f4e0: 6d65 3d6b 7761 7267 735b 2276 6172 6e61  me=kwargs["varna
-0003f4f0: 6d65 225d 2c20 2020 2020 2020 2320 6e75  me"],       # nu
-0003f500: 6d62 6572 206f 6620 7661 7269 6162 6c65  mber of variable
-0003f510: 2873 292c 206e 616d 6520 6f66 2074 6865  (s), name of the
-0003f520: 2076 6172 6961 626c 6528 7329 0d0a 2020   variable(s)..  
-0003f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f540: 2020 2020 2020 2020 2020 6e54 493d 312c            nTI=1,
-0003f550: 2054 493d 5449 2c20 2020 2020 2020 2020   TI=TI,         
-0003f560: 2020 2020 2320 6e75 6d62 6572 206f 6620      # number of 
-0003f570: 5449 2873 292c 2054 4920 2863 6c61 7373  TI(s), TI (class
-0003f580: 2064 7369 2e49 6d67 290d 0a20 2020 2020   dsi.Img)..     
-0003f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f5a0: 2020 2020 2020 2064 6174 6150 6f69 6e74         dataPoint
-0003f5b0: 5365 743d 7074 2c20 2020 2020 2020 2020  Set=pt,         
-0003f5c0: 2020 2023 2068 6172 6420 6461 7461 2028     # hard data (
-0003f5d0: 6f70 7469 6f6e 616c 290d 0a20 2020 2020  optional)..     
-0003f5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f5f0: 2020 2020 2020 2064 6174 6149 6d61 6765         dataImage
-0003f600: 203d 206b 7761 7267 735b 2264 6174 6149   = kwargs["dataI
-0003f610: 6d61 6765 225d 2c0d 0a20 2020 2020 2020  mage"],..       
+0003f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f380: 2020 2020 2020 2061 7a69 5f62 6f74 3d6b         azi_bot=k
+0003f390: 7761 7267 735b 2261 7a69 5f62 6f74 225d  wargs["azi_bot"]
+0003f3a0: 2c20 6469 705f 626f 743d 6b77 6172 6773  , dip_bot=kwargs
+0003f3b0: 5b22 6469 705f 626f 7422 5d2c 2073 6d6f  ["dip_bot"], smo
+0003f3c0: 6f74 683d 3229 2020 2320 6765 7420 617a  oth=2)  # get az
+0003f3d0: 696d 7574 6820 616e 6420 6469 700d 0a0d  imuth and dip...
+0003f3e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f3f0: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+0003f400: 7267 735b 2272 6f74 417a 6922 5d20 3d20  rgs["rotAzi"] = 
+0003f410: 617a 690d 0a20 2020 2020 2020 2020 2020  azi..           
+0003f420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f430: 206b 7761 7267 735b 2272 6f74 4469 7022   kwargs["rotDip"
+0003f440: 5d20 3d20 6469 700d 0a20 2020 2020 2020  ] = dip..       
+0003f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f460: 2020 2020 206b 7761 7267 735b 2272 6f74       kwargs["rot
+0003f470: 417a 694c 6f63 225d 203d 2054 7275 650d  AziLoc"] = True.
+0003f480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f490: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+0003f4a0: 7267 735b 2272 6f74 4469 704c 6f63 225d  rgs["rotDipLoc"]
+0003f4b0: 203d 2054 7275 650d 0a0d 0a20 2020 2020   = True....     
+0003f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f4d0: 2020 2023 4453 2072 6573 6561 7263 680d     #DS research.
+0003f4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f4f0: 2020 2020 2020 2020 2073 6e70 3d64 7369           snp=dsi
+0003f500: 2e53 6561 7263 684e 6569 6768 626f 7268  .SearchNeighborh
+0003f510: 6f6f 6450 6172 616d 6574 6572 7328 0d0a  oodParameters(..
+0003f520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f530: 2020 2020 2020 2020 2020 2020 7261 6469              radi
+0003f540: 7573 4d6f 6465 3d6b 7761 7267 735b 2272  usMode=kwargs["r
+0003f550: 6164 6975 734d 6f64 6522 5d2c 2072 783d  adiusMode"], rx=
+0003f560: 6b77 6172 6773 5b22 7278 225d 2c20 7279  kwargs["rx"], ry
+0003f570: 3d6b 7761 7267 735b 2272 7922 5d2c 2072  =kwargs["ry"], r
+0003f580: 7a3d 6b77 6172 6773 5b22 727a 225d 2c0d  z=kwargs["rz"],.
+0003f590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f5a0: 2020 2020 2020 2020 2020 2020 2061 6e69               ani
+0003f5b0: 736f 7472 6f70 7952 6174 696f 4d6f 6465  sotropyRatioMode
+0003f5c0: 3d6b 7761 7267 735b 2261 6e69 736f 7472  =kwargs["anisotr
+0003f5d0: 6f70 7952 6174 696f 4d6f 6465 225d 2c20  opyRatioMode"], 
+0003f5e0: 6178 3d6b 7761 7267 735b 2261 7822 5d2c  ax=kwargs["ax"],
+0003f5f0: 2061 793d 6b77 6172 6773 5b22 6179 225d   ay=kwargs["ay"]
+0003f600: 2c20 617a 3d6b 7761 7267 735b 2261 7a22  , az=kwargs["az"
+0003f610: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
 0003f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f630: 2020 2020 206f 7574 7075 7456 6172 466c       outputVarFl
-0003f640: 6167 203d 206b 7761 7267 735b 226f 7574  ag = kwargs["out
-0003f650: 7075 7456 6172 466c 6167 225d 2c0d 0a20  putVarFlag"],.. 
-0003f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f670: 2020 2020 2020 2020 2020 2064 6973 7461             dista
-0003f680: 6e63 6554 7970 6520 3d20 6b77 6172 6773  nceType = kwargs
-0003f690: 5b22 6469 7374 616e 6365 5479 7065 225d  ["distanceType"]
-0003f6a0: 2c20 2023 2064 6973 7461 6e63 6520 7479  ,  # distance ty
-0003f6b0: 7065 3a20 7072 6f70 6f72 7469 6f6e 206f  pe: proportion o
-0003f6c0: 6620 6d69 736d 6174 6368 696e 6720 6e6f  f mismatching no
-0003f6d0: 6465 7320 2863 6174 6567 6f72 6963 616c  des (categorical
-0003f6e0: 2076 6172 2e2c 2064 6566 6175 6c74 290d   var., default).
-0003f6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f700: 2020 2020 2020 2020 2020 2020 2073 6f66               sof
-0003f710: 7450 726f 6261 6269 6c69 7479 3d73 705f  tProbability=sp_
-0003f720: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-0003f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f740: 7365 6172 6368 4e65 6967 6862 6f72 686f  searchNeighborho
-0003f750: 6f64 5061 7261 6d65 7465 7273 3d73 6e70  odParameters=snp
-0003f760: 5f6c 2c0d 0a20 2020 2020 2020 2020 2020  _l,..           
-0003f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f780: 2068 6f6d 6f74 6865 7479 5573 6167 653d   homothetyUsage=
-0003f790: 6b77 6172 6773 5b22 686f 6d6f 5f75 7361  kwargs["homo_usa
-0003f7a0: 6765 225d 2c0d 0a20 2020 2020 2020 2020  ge"],..         
-0003f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7c0: 2020 2068 6f6d 6f74 6865 7479 584c 6f63     homothetyXLoc
-0003f7d0: 616c 3d6b 7761 7267 735b 2278 6c6f 6322  al=kwargs["xloc"
-0003f7e0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+0003f630: 616e 676c 6531 3d6b 7761 7267 735b 2261  angle1=kwargs["a
+0003f640: 6e67 6c65 3122 5d2c 2061 6e67 6c65 323d  ngle1"], angle2=
+0003f650: 6b77 6172 6773 5b22 616e 676c 6532 225d  kwargs["angle2"]
+0003f660: 2c20 616e 676c 6533 3d6b 7761 7267 735b  , angle3=kwargs[
+0003f670: 2261 6e67 6c65 3322 5d29 0d0a 0d0a 2020  "angle3"])....  
+0003f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f690: 2020 2020 2020 736e 705f 6c20 3d20 5b5d        snp_l = []
+0003f6a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003f6b0: 2020 2020 2020 2020 2020 666f 7220 6976            for iv
+0003f6c0: 2069 6e20 7261 6e67 6528 6b77 6172 6773   in range(kwargs
+0003f6d0: 5b22 6e76 225d 293a 0d0a 2020 2020 2020  ["nv"]):..      
+0003f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f6f0: 2020 2020 2020 736e 705f 6c2e 6170 7065        snp_l.appe
+0003f700: 6e64 2873 6e70 290d 0a0d 0a20 2020 2020  nd(snp)....     
+0003f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f720: 2020 2023 4453 2073 6f66 7470 726f 6261     #DS softproba
+0003f730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003f740: 2020 2020 2020 2020 2020 7370 3d64 7369            sp=dsi
+0003f750: 2e53 6f66 7450 726f 6261 6269 6c69 7479  .SoftProbability
+0003f760: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0003f770: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003f780: 726f 6261 6269 6c69 7479 436f 6e73 7472  robabilityConstr
+0003f790: 6169 6e74 5573 6167 653d 6b77 6172 6773  aintUsage=kwargs
+0003f7a0: 5b22 7072 6f62 6155 7361 6765 225d 2c20  ["probaUsage"], 
+0003f7b0: 2020 2320 7072 6f62 6162 696c 6974 7920    # probability 
+0003f7c0: 636f 6e73 7472 6169 6e74 7320 6d65 7468  constraints meth
+0003f7d0: 6f64 2028 3120 666f 7220 676c 6f62 612c  od (1 for globa,
+0003f7e0: 2032 2066 6f72 206c 6f63 616c 290d 0a20   2 for local).. 
 0003f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f800: 686f 6d6f 7468 6574 7958 5261 7469 6f3d  homothetyXRatio=
-0003f810: 6b77 6172 6773 5b22 7872 225d 2c0d 0a20  kwargs["xr"],.. 
-0003f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f830: 2020 2020 2020 2020 2020 2068 6f6d 6f74             homot
-0003f840: 6865 7479 594c 6f63 616c 3d6b 7761 7267  hetyYLocal=kwarg
-0003f850: 735b 2279 6c6f 6322 5d2c 0d0a 2020 2020  s["yloc"],..    
-0003f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f870: 2020 2020 2020 2020 686f 6d6f 7468 6574          homothet
-0003f880: 7959 5261 7469 6f3d 6b77 6172 6773 5b22  yYRatio=kwargs["
-0003f890: 7972 225d 2c0d 0a20 2020 2020 2020 2020  yr"],..         
+0003f800: 2020 2020 2020 2020 2020 206e 636c 6173             nclas
+0003f810: 733d 6e63 6c61 7373 2c20 2020 2020 2020  s=nclass,       
+0003f820: 2020 2020 2020 2020 2020 2023 206e 756d             # num
+0003f830: 6265 7220 6f66 2063 6c61 7373 6573 206f  ber of classes o
+0003f840: 6620 7661 6c75 6573 0d0a 2020 2020 2020  f values..      
+0003f850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f860: 2020 2020 2020 636c 6173 7349 6e74 6572        classInter
+0003f870: 7661 6c3d 636c 6173 7349 6e74 6572 7661  val=classInterva
+0003f880: 6c2c 2020 2320 6c69 7374 206f 6620 636c  l,  # list of cl
+0003f890: 6173 7365 730d 0a20 2020 2020 2020 2020  asses..         
 0003f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8b0: 2020 2068 6f6d 6f74 6865 7479 5a4c 6f63     homothetyZLoc
-0003f8c0: 616c 3d6b 7761 7267 735b 227a 6c6f 6322  al=kwargs["zloc"
-0003f8d0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0003f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8f0: 686f 6d6f 7468 6574 795a 5261 7469 6f3d  homothetyZRatio=
-0003f900: 6b77 6172 6773 5b22 7a72 225d 2c0d 0a20  kwargs["zr"],.. 
-0003f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f920: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
-0003f930: 696f 6e55 7361 6765 3d6b 7761 7267 735b  ionUsage=kwargs[
-0003f940: 2272 6f74 5f75 7361 6765 225d 2c20 2020  "rot_usage"],   
-0003f950: 2020 2020 2020 2020 2023 2074 6f6c 6572           # toler
-0003f960: 616e 6365 206f 7220 6e6f 740d 0a20 2020  ance or not..   
-0003f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f980: 2020 2020 2020 2020 2072 6f74 6174 696f           rotatio
-0003f990: 6e41 7a69 6d75 7468 4c6f 6361 6c3d 6b77  nAzimuthLocal=kw
-0003f9a0: 6172 6773 5b22 726f 7441 7a69 4c6f 6322  args["rotAziLoc"
-0003f9b0: 5d2c 2023 2020 2020 726f 7461 7469 6f6e  ], #    rotation
-0003f9c0: 2061 6363 6f72 6469 6e67 2074 6f20 617a   according to az
-0003f9d0: 696d 7574 683a 2067 6c6f 6261 6c0d 0a20  imuth: global.. 
-0003f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f9f0: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
-0003fa00: 696f 6e41 7a69 6d75 7468 3d6b 7761 7267  ionAzimuth=kwarg
-0003fa10: 735b 2272 6f74 417a 6922 5d2c 0d0a 2020  s["rotAzi"],..  
-0003fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa30: 2020 2020 2020 2020 2020 726f 7461 7469            rotati
-0003fa40: 6f6e 4469 704c 6f63 616c 3d6b 7761 7267  onDipLocal=kwarg
-0003fa50: 735b 2272 6f74 4469 704c 6f63 225d 2c0d  s["rotDipLoc"],.
-0003fa60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003fa70: 2020 2020 2020 2020 2020 2020 2072 6f74               rot
-0003fa80: 6174 696f 6e44 6970 3d6b 7761 7267 735b  ationDip=kwargs[
-0003fa90: 2272 6f74 4469 7022 5d2c 0d0a 2020 2020  "rotDip"],..    
-0003faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fab0: 2020 2020 2020 2020 726f 7461 7469 6f6e          rotation
-0003fac0: 506c 756e 6765 4c6f 6361 6c3d 6b77 6172  PlungeLocal=kwar
-0003fad0: 6773 5b22 726f 7450 6c75 6e67 654c 6f63  gs["rotPlungeLoc
-0003fae0: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
-0003faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb00: 2072 6f74 6174 696f 6e50 6c75 6e67 653d   rotationPlunge=
-0003fb10: 6b77 6172 6773 5b22 726f 7450 6c75 6e67  kwargs["rotPlung
-0003fb20: 6522 5d2c 0d0a 2020 2020 2020 2020 2020  e"],..          
+0003f8b0: 2020 206c 6f63 616c 5064 663d 206b 7761     localPdf= kwa
+0003f8c0: 7267 735b 226c 6f63 616c 5064 6622 5d2c  rgs["localPdf"],
+0003f8d0: 2020 2020 2020 2020 2020 2020 2023 206c               # l
+0003f8e0: 6f63 616c 2074 6172 6765 7420 5044 460d  ocal target PDF.
+0003f8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f900: 2020 2020 2020 2020 2020 2020 2067 6c6f               glo
+0003f910: 6261 6c50 6466 3d6b 7761 7267 735b 2267  balPdf=kwargs["g
+0003f920: 6c6f 6261 6c50 6466 225d 2c0d 0a20 2020  lobalPdf"],..   
+0003f930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f940: 2020 2020 2020 2020 206c 6f63 616c 5064           localPd
+0003f950: 6653 7570 706f 7274 5261 6469 7573 3d6b  fSupportRadius=k
+0003f960: 7761 7267 735b 226c 6f63 616c 5064 6652  wargs["localPdfR
+0003f970: 6164 6975 7322 5d2c 2020 2020 2020 2320  adius"],      # 
+0003f980: 7375 7070 6f72 7420 7261 6469 7573 0d0a  support radius..
+0003f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f9a0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+0003f9b0: 6172 696e 6750 6466 4d65 7468 6f64 3d35  aringPdfMethod=5
+0003f9c0: 2c20 2020 2020 2020 2020 2020 2320 6d65  ,           # me
+0003f9d0: 7468 6f64 2066 6f72 2063 6f6d 7061 7269  thod for compari
+0003f9e0: 6e67 2050 4446 2773 2028 7365 6520 646f  ng PDF's (see do
+0003f9f0: 633a 2068 656c 7028 6765 6f6e 652e 6465  c: help(geone.de
+0003fa00: 6573 7365 696e 7465 7266 6163 652e 536f  esseinterface.So
+0003fa10: 6674 5072 6f62 6162 696c 6974 7929 290d  ftProbability)).
+0003fa20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003fa30: 2020 2020 2020 2020 2020 2020 2064 6561               dea
+0003fa40: 6374 6976 6174 696f 6e44 6973 7461 6e63  ctivationDistanc
+0003fa50: 653d 6b77 6172 6773 5b22 6465 6163 7469  e=kwargs["deacti
+0003fa60: 7661 7469 6f6e 4469 7374 616e 6365 225d  vationDistance"]
+0003fa70: 2c20 2020 2020 2020 2320 6465 6163 7469  ,       # deacti
+0003fa80: 7661 7469 6f6e 2064 6973 7461 6e63 6520  vation distance 
+0003fa90: 2863 6865 636b 696e 6720 5044 4620 6973  (checking PDF is
+0003faa0: 2064 6561 6374 6976 6174 6564 2066 6f72   deactivated for
+0003fab0: 206e 6172 726f 7720 7061 7474 6572 6e73   narrow patterns
+0003fac0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003fad0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003fae0: 6f6e 7374 616e 7454 6872 6573 686f 6c64  onstantThreshold
+0003faf0: 3d6b 7761 7267 735b 2263 6f6e 7374 616e  =kwargs["constan
+0003fb00: 7454 6872 6573 686f 6c64 225d 2920 2020  tThreshold"])   
+0003fb10: 2020 2020 2023 2061 6363 6570 7461 7469       # acceptati
+0003fb20: 6f6e 2074 6872 6573 686f 6c64 0d0a 0d0a  on threshold....
 0003fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb40: 2020 6e6e 6569 6768 626f 7269 6e67 4e6f    nneighboringNo
-0003fb50: 6465 3d6b 7761 7267 735b 226e 6569 6722  de=kwargs["neig"
-0003fb60: 5d2c 2020 2020 2020 2020 2320 6d61 782e  ],        # max.
-0003fb70: 206e 756d 6265 7220 6f66 206e 6569 6768   number of neigh
-0003fb80: 626f 7273 2028 666f 7220 7468 6520 7061  bors (for the pa
-0003fb90: 7474 6572 6e73 290d 0a20 2020 2020 2020  tterns)..       
-0003fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fbb0: 2020 2020 2064 6973 7461 6e63 6554 6872       distanceThr
-0003fbc0: 6573 686f 6c64 3d6b 7761 7267 735b 2274  eshold=kwargs["t
-0003fbd0: 6872 6573 6822 5d2c 2020 2020 2023 2061  hresh"],     # a
-0003fbe0: 6363 6570 7461 7469 6f6e 2074 6872 6573  cceptation thres
-0003fbf0: 686f 6c64 2028 666f 7220 6469 7374 616e  hold (for distan
-0003fc00: 6365 2062 6574 7765 656e 2070 6174 7465  ce between patte
-0003fc10: 726e 7329 0d0a 2020 2020 2020 2020 2020  rns)..          
+0003fb40: 2020 2020 2020 2020 7370 5f6c 203d 205b          sp_l = [
+0003fb50: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0003fb60: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0003fb70: 7620 696e 2072 616e 6765 286b 7761 7267  v in range(kwarg
+0003fb80: 735b 226e 7622 5d29 3a0d 0a20 2020 2020  s["nv"]):..     
+0003fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fba0: 2020 2020 2020 2073 705f 6c2e 6170 7065         sp_l.appe
+0003fbb0: 6e64 2873 7029 0d0a 0d0a 2020 2020 2020  nd(sp)....      
+0003fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fbd0: 2020 2344 5320 696e 7075 740d 0a20 2020    #DS input..   
+0003fbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fbf0: 2020 2020 2064 6565 7373 655f 696e 7075       deesse_inpu
+0003fc00: 743d 6473 692e 4465 6573 7365 496e 7075  t=dsi.DeesseInpu
+0003fc10: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
 0003fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc30: 2020 6d61 7853 6361 6e46 7261 6374 696f    maxScanFractio
-0003fc40: 6e3d 6b77 6172 6773 5b22 6d61 7873 6361  n=kwargs["maxsca
-0003fc50: 6e22 5d2c 2020 2020 2020 2023 206d 6178  n"],       # max
-0003fc60: 2e20 7363 616e 6e65 6420 6672 6163 7469  . scanned fracti
-0003fc70: 6f6e 206f 6620 7468 6520 5449 2028 666f  on of the TI (fo
-0003fc80: 7220 7369 6d75 6c61 7469 6f6e 206f 6620  r simulation of 
-0003fc90: 6561 6368 2063 656c 6c29 0d0a 2020 2020  each cell)..    
-0003fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fcb0: 2020 2020 2020 2020 6e70 6f73 7450 726f          npostPro
-0003fcc0: 6365 7373 696e 6750 6174 684d 6178 3d6b  cessingPathMax=k
-0003fcd0: 7761 7267 735b 226e 706f 7374 225d 2c20  wargs["npost"], 
-0003fce0: 2020 2320 6e75 6d62 6572 206f 6620 706f    # number of po
-0003fcf0: 7374 2d70 726f 6365 7373 696e 6720 7061  st-processing pa
-0003fd00: 7468 2873 290d 0a20 2020 2020 2020 2020  th(s)..         
-0003fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd20: 2020 2073 6565 643d 7365 6564 2c20 2020     seed=seed,   
-0003fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd40: 2320 7365 6564 2028 696e 6974 6961 6c69  # seed (initiali
-0003fd50: 7a61 7469 6f6e 206f 6620 7468 6520 7261  zation of the ra
-0003fd60: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-0003fd70: 7261 746f 7229 0d0a 2020 2020 2020 2020  rator)..        
-0003fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd90: 2020 2020 6e72 6561 6c69 7a61 7469 6f6e      nrealization
-0003fda0: 3d6e 7265 616c 2c20 2020 2020 2020 2020  =nreal,         
-0003fdb0: 2320 6e75 6d62 6572 206f 6620 7265 616c  # number of real
-0003fdc0: 697a 6174 696f 6e28 7329 0d0a 2020 2020  ization(s)..    
-0003fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fde0: 2020 2020 2020 2020 6d61 736b 3d6d 6173          mask=mas
-0003fdf0: 6b29 2020 2020 2020 2020 2020 2020 2020  k)              
-0003fe00: 2020 2023 206e 6370 750d 0a0d 0a20 2020     # ncpu....   
-0003fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fe20: 2020 2020 2064 6565 7373 655f 6f75 7470       deesse_outp
-0003fe30: 7574 3d64 7369 2e64 6565 7373 6552 756e  ut=dsi.deesseRun
-0003fe40: 2864 6565 7373 655f 696e 7075 742c 206e  (deesse_input, n
-0003fe50: 7468 7265 6164 733d 4172 6368 5461 626c  threads=ArchTabl
-0003fe60: 652e 6e63 7075 2c20 7665 7262 6f73 653d  e.ncpu, verbose=
-0003fe70: 7665 7262 6f73 6529 0d0a 0d0a 2020 2020  verbose)....    
-0003fe80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fe90: 2020 2020 7369 6d75 733d 6465 6573 7365      simus=deesse
-0003fea0: 5f6f 7574 7075 745b 2273 696d 225d 0d0a  _output["sim"]..
-0003feb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fec0: 2020 2020 2020 2020 666f 7220 6972 6561          for irea
-0003fed0: 6c20 696e 2072 616e 6765 286e 7265 616c  l in range(nreal
-0003fee0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0003fef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ff00: 7369 6d3d 7369 6d75 735b 6972 6561 6c5d  sim=simus[ireal]
-0003ff10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ff20: 2020 2020 2020 2020 2020 2020 2020 2373                #s
-0003ff30: 656c 662e 6661 6369 6573 5f64 6f6d 6169  elf.facies_domai
-0003ff40: 6e73 5b69 752c 2069 7265 616c 5d3d 7369  ns[iu, ireal]=si
-0003ff50: 6d2e 7661 6c5b 305d 2023 6f75 7470 7574  m.val[0] #output
-0003ff60: 2069 6e20 6661 6369 6573 5f64 6f6d 6169   in facies_domai
-0003ff70: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
-0003ff80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ff90: 6661 6369 6573 5f64 6f6d 6169 6e73 5b69  facies_domains[i
-0003ffa0: 752c 2069 7265 616c 5d5b 6d61 736b 5d3d  u, ireal][mask]=
-0003ffb0: 7369 6d2e 7661 6c5b 305d 5b6d 6173 6b5d  sim.val[0][mask]
-0003ffc0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003ffd0: 2020 2020 2020 2020 656c 6966 206d 6574          elif met
-0003ffe0: 686f 6420 3d3d 2022 5450 4773 223a 2023  hod == "TPGs": #
-0003fff0: 7472 756e 6361 7465 6420 2870 6c75 7269  truncated (pluri
-00040000: 2967 6175 7373 6961 6e0d 0a0d 0a20 2020  )gaussian....   
-00040010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040020: 2020 2020 2023 6c6f 6164 2070 6172 616d       #load param
-00040030: 7323 0d0a 2020 2020 2020 2020 2020 2020  s#..            
-00040040: 2020 2020 2020 2020 2020 2020 666c 6167              flag
-00040050: 3d73 656c 662e 666c 6167 0d0a 2020 2020  =self.flag..    
-00040060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040070: 2020 2020 475f 636d 3d73 656c 662e 475f      G_cm=self.G_
-00040080: 636d 0d0a 2020 2020 2020 2020 2020 2020  cm..            
-00040090: 2020 2020 2020 2020 2020 2020 2323 2064              ## d
-000400a0: 6174 6120 666f 726d 6174 2023 230d 0a20  ata format ##.. 
+0003fc30: 6e78 3d6e 782c 206e 793d 6e79 2c20 6e7a  nx=nx, ny=ny, nz
+0003fc40: 3d6e 7a2c 2020 2020 2020 2023 2064 696d  =nz,       # dim
+0003fc50: 656e 7369 6f6e 206f 6620 7468 6520 7369  ension of the si
+0003fc60: 6d75 6c61 7469 6f6e 2067 7269 6420 286e  mulation grid (n
+0003fc70: 756d 6265 7220 6f66 2063 656c 6c73 290d  umber of cells).
+0003fc80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003fc90: 2020 2020 2020 2020 2020 2020 2073 783d               sx=
+0003fca0: 7378 2c20 7379 3d73 792c 2073 7a3d 737a  sx, sy=sy, sz=sz
+0003fcb0: 2c20 2020 2020 2320 6365 6c6c 7320 756e  ,     # cells un
+0003fcc0: 6974 7320 696e 2074 6865 2073 696d 756c  its in the simul
+0003fcd0: 6174 696f 6e20 6772 6964 2028 6865 7265  ation grid (here
+0003fce0: 2061 7265 2074 6865 2064 6566 6175 6c74   are the default
+0003fcf0: 2076 616c 7565 7329 0d0a 2020 2020 2020   values)..      
+0003fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd10: 2020 2020 2020 6f78 3d6f 782c 206f 793d        ox=ox, oy=
+0003fd20: 6f79 2c20 6f7a 3d6f 7a2c 2020 2020 2023  oy, oz=oz,     #
+0003fd30: 206f 7269 6769 6e20 6f66 2074 6865 2073   origin of the s
+0003fd40: 696d 756c 6174 696f 6e20 6772 6964 2028  imulation grid (
+0003fd50: 6865 7265 2061 7265 2074 6865 2064 6566  here are the def
+0003fd60: 6175 6c74 2076 616c 7565 7329 0d0a 2020  ault values)..  
+0003fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd80: 2020 2020 2020 2020 2020 6e76 3d6b 7761            nv=kwa
+0003fd90: 7267 735b 226e 7622 5d2c 2076 6172 6e61  rgs["nv"], varna
+0003fda0: 6d65 3d6b 7761 7267 735b 2276 6172 6e61  me=kwargs["varna
+0003fdb0: 6d65 225d 2c20 2020 2020 2020 2320 6e75  me"],       # nu
+0003fdc0: 6d62 6572 206f 6620 7661 7269 6162 6c65  mber of variable
+0003fdd0: 2873 292c 206e 616d 6520 6f66 2074 6865  (s), name of the
+0003fde0: 2076 6172 6961 626c 6528 7329 0d0a 2020   variable(s)..  
+0003fdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe00: 2020 2020 2020 2020 2020 6e54 493d 312c            nTI=1,
+0003fe10: 2054 493d 5449 2c20 2020 2020 2020 2020   TI=TI,         
+0003fe20: 2020 2020 2320 6e75 6d62 6572 206f 6620      # number of 
+0003fe30: 5449 2873 292c 2054 4920 2863 6c61 7373  TI(s), TI (class
+0003fe40: 2064 7369 2e49 6d67 290d 0a20 2020 2020   dsi.Img)..     
+0003fe50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe60: 2020 2020 2020 2064 6174 6150 6f69 6e74         dataPoint
+0003fe70: 5365 743d 7074 2c20 2020 2020 2020 2020  Set=pt,         
+0003fe80: 2020 2023 2068 6172 6420 6461 7461 2028     # hard data (
+0003fe90: 6f70 7469 6f6e 616c 290d 0a20 2020 2020  optional)..     
+0003fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003feb0: 2020 2020 2020 2064 6174 6149 6d61 6765         dataImage
+0003fec0: 203d 206b 7761 7267 735b 2264 6174 6149   = kwargs["dataI
+0003fed0: 6d61 6765 225d 2c0d 0a20 2020 2020 2020  mage"],..       
+0003fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fef0: 2020 2020 206f 7574 7075 7456 6172 466c       outputVarFl
+0003ff00: 6167 203d 206b 7761 7267 735b 226f 7574  ag = kwargs["out
+0003ff10: 7075 7456 6172 466c 6167 225d 2c0d 0a20  putVarFlag"],.. 
+0003ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ff30: 2020 2020 2020 2020 2020 2064 6973 7461             dista
+0003ff40: 6e63 6554 7970 6520 3d20 6b77 6172 6773  nceType = kwargs
+0003ff50: 5b22 6469 7374 616e 6365 5479 7065 225d  ["distanceType"]
+0003ff60: 2c20 2023 2064 6973 7461 6e63 6520 7479  ,  # distance ty
+0003ff70: 7065 3a20 7072 6f70 6f72 7469 6f6e 206f  pe: proportion o
+0003ff80: 6620 6d69 736d 6174 6368 696e 6720 6e6f  f mismatching no
+0003ff90: 6465 7320 2863 6174 6567 6f72 6963 616c  des (categorical
+0003ffa0: 2076 6172 2e2c 2064 6566 6175 6c74 290d   var., default).
+0003ffb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ffc0: 2020 2020 2020 2020 2020 2020 2073 6f66               sof
+0003ffd0: 7450 726f 6261 6269 6c69 7479 3d73 705f  tProbability=sp_
+0003ffe0: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
+0003fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040000: 7365 6172 6368 4e65 6967 6862 6f72 686f  searchNeighborho
+00040010: 6f64 5061 7261 6d65 7465 7273 3d73 6e70  odParameters=snp
+00040020: 5f6c 2c0d 0a20 2020 2020 2020 2020 2020  _l,..           
+00040030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040040: 2068 6f6d 6f74 6865 7479 5573 6167 653d   homothetyUsage=
+00040050: 6b77 6172 6773 5b22 686f 6d6f 5f75 7361  kwargs["homo_usa
+00040060: 6765 225d 2c0d 0a20 2020 2020 2020 2020  ge"],..         
+00040070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040080: 2020 2068 6f6d 6f74 6865 7479 584c 6f63     homothetyXLoc
+00040090: 616c 3d6b 7761 7267 735b 2278 6c6f 6322  al=kwargs["xloc"
+000400a0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
 000400b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000400c0: 2020 2020 2020 2023 2064 6174 613d 2878         # data=(x
-000400d0: 2c20 792c 207a 2c20 6731 2c20 6732 2c20  , y, z, g1, g2, 
-000400e0: 7629 2c20 7768 6572 6520 782c 2079 2c20  v), where x, y, 
-000400f0: 7a20 6172 6520 7468 6520 6361 7274 6573  z are the cartes
-00040100: 6961 6e20 636f 6f72 6469 6e61 7465 732c  ian coordinates,
-00040110: 2067 3120 616e 6420 6732 2061 7265 2074   g1 and g2 are t
-00040120: 6865 2076 616c 7565 7320 6f66 200d 0a20  he values of .. 
-00040130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040140: 2020 2020 2020 2023 2066 6972 7374 2f73         # first/s
-00040150: 6563 6f6e 6420 6761 7573 7369 616e 2066  econd gaussian f
-00040160: 6965 6c64 7320 616e 6420 7620 6973 2074  ields and v is t
-00040170: 6865 2066 6163 6965 7320 7661 6c75 650d  he facies value.
-00040180: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00040190: 2020 2020 2020 2020 2020 2023 2320 7365             ## se
-000401a0: 7475 7020 616e 6420 6765 7420 6861 7264  tup and get hard
-000401b0: 2064 6174 610d 0a20 2020 2020 2020 2020   data..         
-000401c0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-000401d0: 643d 6e70 2e61 7272 6179 285b 5d29 0d0a  d=np.array([])..
-000401e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000401f0: 2020 2020 2020 2020 666f 7220 6661 2069          for fa i
-00040200: 6e20 6c69 7374 5f6f 626a 3a0d 0a20 2020  n list_obj:..   
-00040210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040220: 2020 2020 2020 2020 2023 6e64 6172 7261           #ndarra
-00040230: 790d 0a20 2020 2020 2020 2020 2020 2020  y..             
-00040240: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00040250: 643d 6c65 6e28 6661 2e78 290d 0a20 2020  d=len(fa.x)..   
-00040260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040270: 2020 2020 2020 2020 2066 615f 783d 6e70           fa_x=np
-00040280: 2e61 7272 6179 2866 612e 7829 0d0a 2020  .array(fa.x)..  
-00040290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402a0: 2020 2020 2020 2020 2020 6661 5f79 3d6e            fa_y=n
-000402b0: 702e 6172 7261 7928 6661 2e79 290d 0a20  p.array(fa.y).. 
-000402c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402d0: 2020 2020 2020 2020 2020 2066 615f 7a3d             fa_z=
-000402e0: 6e70 2e61 7272 6179 2866 612e 7a29 0d0a  np.array(fa.z)..
-000402f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040300: 2020 2020 2020 2020 2020 2020 6661 6369              faci
-00040310: 6573 3d66 612e 4944 2a6e 702e 6f6e 6573  es=fa.ID*np.ones
-00040320: 286e 6429 2320 6170 7065 6e64 2066 6163  (nd)# append fac
-00040330: 6965 7320 4944 730d 0a0d 0a20 2020 2020  ies IDs....     
-00040340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040350: 2020 2020 2020 2068 643d 6e70 2e63 6f6e         hd=np.con
-00040360: 6361 7465 6e61 7465 285b 6864 2e72 6573  catenate([hd.res
-00040370: 6861 7065 282d 312c 2036 292c 206e 702e  hape(-1, 6), np.
-00040380: 636f 6e63 6174 656e 6174 6528 5b5b 6661  concatenate([[fa
-00040390: 5f78 5d2c 205b 6661 5f79 5d2c 205b 6661  _x], [fa_y], [fa
-000403a0: 5f7a 5d2c 205b 6e70 2e7a 6572 6f73 286e  _z], [np.zeros(n
-000403b0: 6429 5d2c 205b 6e70 2e7a 6572 6f73 286e  d)], [np.zeros(n
-000403c0: 6429 5d2c 205b 6661 6369 6573 5d5d 2c20  d)], [facies]], 
-000403d0: 6178 6973 3d30 292e 545d 2920 2320 6170  axis=0).T]) # ap
-000403e0: 7065 6e64 2064 6174 6120 666f 7220 696e  pend data for in
-000403f0: 7075 7420 5450 4773 0d0a 0d0a 2020 2020  put TPGs....    
-00040400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040410: 2020 2020 6966 2068 642e 7368 6170 655b      if hd.shape[
-00040420: 305d 203d 3d20 303a 0d0a 2020 2020 2020  0] == 0:..      
-00040430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040440: 2020 2020 2020 6864 3d4e 6f6e 650d 0a20        hd=None.. 
-00040450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040460: 2020 2020 2020 2073 696d 7573 3d72 756e         simus=run
-00040470: 5f74 7067 7328 6e72 6561 6c2c 2078 672c  _tpgs(nreal, xg,
-00040480: 2079 672c 207a 672c 2068 642c 2047 5f63   yg, zg, hd, G_c
-00040490: 6d2c 2066 6c61 672c 206e 6d61 783d 6b77  m, flag, nmax=kw
-000404a0: 6172 6773 5b22 6e65 6967 225d 2c20 6772  args["neig"], gr
-000404b0: 665f 6d65 7468 6f64 3d6b 7761 7267 735b  f_method=kwargs[
-000404c0: 2267 7266 5f6d 6574 686f 6422 5d2c 206d  "grf_method"], m
-000404d0: 6173 6b3d 6d61 736b 290d 0a20 2020 2020  ask=mask)..     
+000400c0: 686f 6d6f 7468 6574 7958 5261 7469 6f3d  homothetyXRatio=
+000400d0: 6b77 6172 6773 5b22 7872 225d 2c0d 0a20  kwargs["xr"],.. 
+000400e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000400f0: 2020 2020 2020 2020 2020 2068 6f6d 6f74             homot
+00040100: 6865 7479 594c 6f63 616c 3d6b 7761 7267  hetyYLocal=kwarg
+00040110: 735b 2279 6c6f 6322 5d2c 0d0a 2020 2020  s["yloc"],..    
+00040120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040130: 2020 2020 2020 2020 686f 6d6f 7468 6574          homothet
+00040140: 7959 5261 7469 6f3d 6b77 6172 6773 5b22  yYRatio=kwargs["
+00040150: 7972 225d 2c0d 0a20 2020 2020 2020 2020  yr"],..         
+00040160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040170: 2020 2068 6f6d 6f74 6865 7479 5a4c 6f63     homothetyZLoc
+00040180: 616c 3d6b 7761 7267 735b 227a 6c6f 6322  al=kwargs["zloc"
+00040190: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+000401a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000401b0: 686f 6d6f 7468 6574 795a 5261 7469 6f3d  homothetyZRatio=
+000401c0: 6b77 6172 6773 5b22 7a72 225d 2c0d 0a20  kwargs["zr"],.. 
+000401d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000401e0: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
+000401f0: 696f 6e55 7361 6765 3d6b 7761 7267 735b  ionUsage=kwargs[
+00040200: 2272 6f74 5f75 7361 6765 225d 2c20 2020  "rot_usage"],   
+00040210: 2020 2020 2020 2020 2023 2074 6f6c 6572           # toler
+00040220: 616e 6365 206f 7220 6e6f 740d 0a20 2020  ance or not..   
+00040230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040240: 2020 2020 2020 2020 2072 6f74 6174 696f           rotatio
+00040250: 6e41 7a69 6d75 7468 4c6f 6361 6c3d 6b77  nAzimuthLocal=kw
+00040260: 6172 6773 5b22 726f 7441 7a69 4c6f 6322  args["rotAziLoc"
+00040270: 5d2c 2023 2020 2020 726f 7461 7469 6f6e  ], #    rotation
+00040280: 2061 6363 6f72 6469 6e67 2074 6f20 617a   according to az
+00040290: 696d 7574 683a 2067 6c6f 6261 6c0d 0a20  imuth: global.. 
+000402a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000402b0: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
+000402c0: 696f 6e41 7a69 6d75 7468 3d6b 7761 7267  ionAzimuth=kwarg
+000402d0: 735b 2272 6f74 417a 6922 5d2c 0d0a 2020  s["rotAzi"],..  
+000402e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000402f0: 2020 2020 2020 2020 2020 726f 7461 7469            rotati
+00040300: 6f6e 4469 704c 6f63 616c 3d6b 7761 7267  onDipLocal=kwarg
+00040310: 735b 2272 6f74 4469 704c 6f63 225d 2c0d  s["rotDipLoc"],.
+00040320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040330: 2020 2020 2020 2020 2020 2020 2072 6f74               rot
+00040340: 6174 696f 6e44 6970 3d6b 7761 7267 735b  ationDip=kwargs[
+00040350: 2272 6f74 4469 7022 5d2c 0d0a 2020 2020  "rotDip"],..    
+00040360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040370: 2020 2020 2020 2020 726f 7461 7469 6f6e          rotation
+00040380: 506c 756e 6765 4c6f 6361 6c3d 6b77 6172  PlungeLocal=kwar
+00040390: 6773 5b22 726f 7450 6c75 6e67 654c 6f63  gs["rotPlungeLoc
+000403a0: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
+000403b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000403c0: 2072 6f74 6174 696f 6e50 6c75 6e67 653d   rotationPlunge=
+000403d0: 6b77 6172 6773 5b22 726f 7450 6c75 6e67  kwargs["rotPlung
+000403e0: 6522 5d2c 0d0a 2020 2020 2020 2020 2020  e"],..          
+000403f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040400: 2020 6e6e 6569 6768 626f 7269 6e67 4e6f    nneighboringNo
+00040410: 6465 3d6b 7761 7267 735b 226e 6569 6722  de=kwargs["neig"
+00040420: 5d2c 2020 2020 2020 2020 2320 6d61 782e  ],        # max.
+00040430: 206e 756d 6265 7220 6f66 206e 6569 6768   number of neigh
+00040440: 626f 7273 2028 666f 7220 7468 6520 7061  bors (for the pa
+00040450: 7474 6572 6e73 290d 0a20 2020 2020 2020  tterns)..       
+00040460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040470: 2020 2020 2064 6973 7461 6e63 6554 6872       distanceThr
+00040480: 6573 686f 6c64 3d6b 7761 7267 735b 2274  eshold=kwargs["t
+00040490: 6872 6573 6822 5d2c 2020 2020 2023 2061  hresh"],     # a
+000404a0: 6363 6570 7461 7469 6f6e 2074 6872 6573  cceptation thres
+000404b0: 686f 6c64 2028 666f 7220 6469 7374 616e  hold (for distan
+000404c0: 6365 2062 6574 7765 656e 2070 6174 7465  ce between patte
+000404d0: 726e 7329 0d0a 2020 2020 2020 2020 2020  rns)..          
 000404e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000404f0: 2020 2066 6f72 2069 7265 616c 2069 6e20     for ireal in 
-00040500: 7261 6e67 6528 6e72 6561 6c29 3a0d 0a20  range(nreal):.. 
-00040510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040520: 2020 2020 2020 2020 2020 2067 7269 643d             grid=
-00040530: 7369 6d75 735b 6972 6561 6c5d 0d0a 2020  simus[ireal]..  
-00040540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040550: 2020 2020 2020 2020 2020 6772 6964 5b6d            grid[m
-00040560: 6173 6b3d 3d30 5d3d 6e70 2e6e 616e 2020  ask==0]=np.nan  
-00040570: 2320 6578 7472 6163 7420 6f6e 6c79 2074  # extract only t
-00040580: 6865 2070 6172 7420 6f6e 2074 6865 2072  he part on the r
-00040590: 6561 6c20 646f 6d61 696e 0d0a 2020 2020  eal domain..    
-000405a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000405b0: 2020 2020 2020 2020 6661 6369 6573 5f64          facies_d
-000405c0: 6f6d 6169 6e73 5b69 752c 2069 7265 616c  omains[iu, ireal
-000405d0: 5d5b 6d61 736b 5d3d 6772 6964 5b6d 6173  ][mask]=grid[mas
-000405e0: 6b5d 0d0a 0d0a 2020 2020 2020 2020 2020  k]....          
-000405f0: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
-00040600: 6574 686f 6420 3d3d 2022 6e65 6172 6573  ethod == "neares
-00040610: 7422 3a0d 0a20 2020 2020 2020 2020 2020  t":..           
-00040620: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00040630: 4172 6368 5461 626c 652e 7665 7262 6f73  ArchTable.verbos
-00040640: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00040650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040660: 7072 696e 7428 223c 3d3d 3d4e 6561 7265  print("<===Neare
-00040670: 7374 206e 6569 6768 626f 7273 2069 6e74  st neighbors int
-00040680: 6572 706f 6c61 7469 6f6e 3d3d 3d3e 2229  erpolation===>")
-00040690: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000406a0: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-000406b0: 2073 6b6c 6561 726e 2e6e 6569 6768 626f   sklearn.neighbo
-000406c0: 7273 2069 6d70 6f72 7420 4e65 6172 6573  rs import Neares
-000406d0: 744e 6569 6768 626f 7273 0d0a 0d0a 2020  tNeighbors....  
-000406e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000406f0: 2020 2020 2020 5820 3d20 6e70 2e6f 6e65        X = np.one
-00040700: 7328 5b6e 7a2c 206e 792c 206e 785d 292a  s([nz, ny, nx])*
-00040710: 2041 7263 6854 6162 6c65 2e78 6763 0d0a   ArchTable.xgc..
-00040720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040730: 2020 2020 2020 2020 5920 3d20 6e70 2e6f          Y = np.o
-00040740: 6e65 7328 5b6e 7a2c 206e 792c 206e 785d  nes([nz, ny, nx]
-00040750: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00040760: 2020 2020 2020 2020 2020 2059 5b3a 5d20             Y[:] 
-00040770: 3d20 6e70 2e6f 6e65 7328 5b6e 782c 206e  = np.ones([nx, n
-00040780: 795d 292e 5420 2a20 4172 6368 5461 626c  y]).T * ArchTabl
-00040790: 652e 7967 632e 7265 7368 6170 6528 2d31  e.ygc.reshape(-1
-000407a0: 2c20 3129 0d0a 2020 2020 2020 2020 2020  , 1)..          
-000407b0: 2020 2020 2020 2020 2020 2020 2020 5a20                Z 
-000407c0: 3d20 6e70 2e6f 6e65 7328 5b6e 7a2c 206e  = np.ones([nz, n
-000407d0: 792c 206e 785d 290d 0a20 2020 2020 2020  y, nx])..       
-000407e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000407f0: 205a 5b3a 2c20 3a5d 203d 2820 6e70 2e6f   Z[:, :] =( np.o
-00040800: 6e65 7328 5b6e 7a2c 206e 785d 2920 2a20  nes([nz, nx]) * 
-00040810: 4172 6368 5461 626c 652e 7a67 632e 7265  ArchTable.zgc.re
-00040820: 7368 6170 6528 2d31 2c20 3129 292e 7265  shape(-1, 1)).re
-00040830: 7368 6170 6528 6e7a 2c20 312c 206e 7829  shape(nz, 1, nx)
-00040840: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040850: 2020 2020 2020 2020 2020 7875 3344 203d            xu3D =
-00040860: 206e 702e 6172 7261 7928 5b58 2e66 6c61   np.array([X.fla
-00040870: 7474 656e 2829 2c20 592e 666c 6174 7465  tten(), Y.flatte
-00040880: 6e28 292c 205a 2e66 6c61 7474 656e 2829  n(), Z.flatten()
-00040890: 5d29 2e54 0d0a 0d0a 2020 2020 2020 2020  ]).T....        
-000408a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000408b0: 2320 6765 7420 6861 7264 2064 6174 610d  # get hard data.
-000408c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000408d0: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-000408e0: 203d 3d20 2266 6163 6965 7322 3a0d 0a20   == "facies":.. 
-000408f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040900: 2020 2020 2020 2020 2020 2068 642c 2066             hd, f
-00040910: 6163 6965 7320 3d20 4172 6368 5461 626c  acies = ArchTabl
-00040920: 652e 6864 5f66 615f 696e 5f75 6e69 7428  e.hd_fa_in_unit(
-00040930: 7365 6c66 2c20 6975 3d69 7529 0d0a 2020  self, iu=iu)..  
-00040940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040950: 2020 2020 2020 656c 6966 206d 6f64 6520        elif mode 
-00040960: 3d3d 2022 756e 6974 7322 3a0d 0a20 2020  == "units":..   
+000404f0: 2020 6d61 7853 6361 6e46 7261 6374 696f    maxScanFractio
+00040500: 6e3d 6b77 6172 6773 5b22 6d61 7873 6361  n=kwargs["maxsca
+00040510: 6e22 5d2c 2020 2020 2020 2023 206d 6178  n"],       # max
+00040520: 2e20 7363 616e 6e65 6420 6672 6163 7469  . scanned fracti
+00040530: 6f6e 206f 6620 7468 6520 5449 2028 666f  on of the TI (fo
+00040540: 7220 7369 6d75 6c61 7469 6f6e 206f 6620  r simulation of 
+00040550: 6561 6368 2063 656c 6c29 0d0a 2020 2020  each cell)..    
+00040560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040570: 2020 2020 2020 2020 6e70 6f73 7450 726f          npostPro
+00040580: 6365 7373 696e 6750 6174 684d 6178 3d6b  cessingPathMax=k
+00040590: 7761 7267 735b 226e 706f 7374 225d 2c20  wargs["npost"], 
+000405a0: 2020 2320 6e75 6d62 6572 206f 6620 706f    # number of po
+000405b0: 7374 2d70 726f 6365 7373 696e 6720 7061  st-processing pa
+000405c0: 7468 2873 290d 0a20 2020 2020 2020 2020  th(s)..         
+000405d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000405e0: 2020 2073 6565 643d 7365 6564 2c20 2020     seed=seed,   
+000405f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040600: 2320 7365 6564 2028 696e 6974 6961 6c69  # seed (initiali
+00040610: 7a61 7469 6f6e 206f 6620 7468 6520 7261  zation of the ra
+00040620: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
+00040630: 7261 746f 7229 0d0a 2020 2020 2020 2020  rator)..        
+00040640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040650: 2020 2020 6e72 6561 6c69 7a61 7469 6f6e      nrealization
+00040660: 3d6e 7265 616c 2c20 2020 2020 2020 2020  =nreal,         
+00040670: 2320 6e75 6d62 6572 206f 6620 7265 616c  # number of real
+00040680: 697a 6174 696f 6e28 7329 0d0a 2020 2020  ization(s)..    
+00040690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000406a0: 2020 2020 2020 2020 6d61 736b 3d6d 6173          mask=mas
+000406b0: 6b29 2020 2020 2020 2020 2020 2020 2020  k)              
+000406c0: 2020 2023 206e 6370 750d 0a0d 0a20 2020     # ncpu....   
+000406d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000406e0: 2020 2020 2064 6565 7373 655f 6f75 7470       deesse_outp
+000406f0: 7574 3d64 7369 2e64 6565 7373 6552 756e  ut=dsi.deesseRun
+00040700: 2864 6565 7373 655f 696e 7075 742c 206e  (deesse_input, n
+00040710: 7468 7265 6164 733d 4172 6368 5461 626c  threads=ArchTabl
+00040720: 652e 6e63 7075 2c20 7665 7262 6f73 653d  e.ncpu, verbose=
+00040730: 7665 7262 6f73 6529 0d0a 0d0a 2020 2020  verbose)....    
+00040740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040750: 2020 2020 7369 6d75 733d 6465 6573 7365      simus=deesse
+00040760: 5f6f 7574 7075 745b 2273 696d 225d 0d0a  _output["sim"]..
+00040770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040780: 2020 2020 2020 2020 666f 7220 6972 6561          for irea
+00040790: 6c20 696e 2072 616e 6765 286e 7265 616c  l in range(nreal
+000407a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000407b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000407c0: 7369 6d3d 7369 6d75 735b 6972 6561 6c5d  sim=simus[ireal]
+000407d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000407e0: 2020 2020 2020 2020 2020 2020 2020 2373                #s
+000407f0: 656c 662e 6661 6369 6573 5f64 6f6d 6169  elf.facies_domai
+00040800: 6e73 5b69 752c 2069 7265 616c 5d3d 7369  ns[iu, ireal]=si
+00040810: 6d2e 7661 6c5b 305d 2023 6f75 7470 7574  m.val[0] #output
+00040820: 2069 6e20 6661 6369 6573 5f64 6f6d 6169   in facies_domai
+00040830: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
+00040840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040850: 6661 6369 6573 5f64 6f6d 6169 6e73 5b69  facies_domains[i
+00040860: 752c 2069 7265 616c 5d5b 6d61 736b 5d3d  u, ireal][mask]=
+00040870: 7369 6d2e 7661 6c5b 305d 5b6d 6173 6b5d  sim.val[0][mask]
+00040880: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00040890: 2020 2020 2020 2020 656c 6966 206d 6574          elif met
+000408a0: 686f 6420 3d3d 2022 5450 4773 223a 2023  hod == "TPGs": #
+000408b0: 7472 756e 6361 7465 6420 2870 6c75 7269  truncated (pluri
+000408c0: 2967 6175 7373 6961 6e0d 0a0d 0a20 2020  )gaussian....   
+000408d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000408e0: 2020 2020 2023 6c6f 6164 2070 6172 616d       #load param
+000408f0: 7323 0d0a 2020 2020 2020 2020 2020 2020  s#..            
+00040900: 2020 2020 2020 2020 2020 2020 666c 6167              flag
+00040910: 3d73 656c 662e 666c 6167 0d0a 2020 2020  =self.flag..    
+00040920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040930: 2020 2020 475f 636d 3d73 656c 662e 475f      G_cm=self.G_
+00040940: 636d 0d0a 2020 2020 2020 2020 2020 2020  cm..            
+00040950: 2020 2020 2020 2020 2020 2020 2323 2064              ## d
+00040960: 6174 6120 666f 726d 6174 2023 230d 0a20  ata format ##.. 
 00040970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040980: 2020 2020 2020 2020 2068 642c 2066 6163           hd, fac
-00040990: 6965 7320 3d20 4172 6368 5461 626c 652e  ies = ArchTable.
-000409a0: 6864 5f75 6e5f 696e 5f75 6e69 7428 7365  hd_un_in_unit(se
-000409b0: 6c66 2c20 6975 3d69 7529 0d0a 0d0a 2020  lf, iu=iu)....  
-000409c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000409d0: 2020 2020 2020 6864 3d6e 702e 6172 7261        hd=np.arra
-000409e0: 7928 6864 290d 0a20 2020 2020 2020 2020  y(hd)..         
-000409f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00040a00: 6163 6965 733d 6e70 2e61 7272 6179 2866  acies=np.array(f
-00040a10: 6163 6965 7329 0d0a 0d0a 2020 2020 2020  acies)....      
-00040a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a30: 2020 585f 6669 7420 3d20 6864 0d0a 2020    X_fit = hd..  
-00040a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a50: 2020 2020 2020 795f 6669 7420 3d20 6661        y_fit = fa
-00040a60: 6369 6573 0d0a 0d0a 2020 2020 2020 2020  cies....        
-00040a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a80: 585f 7072 6564 203d 2078 7533 445b 6d61  X_pred = xu3D[ma
-00040a90: 736b 2e66 6c61 7474 656e 2829 5d0d 0a0d  sk.flatten()]...
-00040aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040ab0: 2020 2020 2020 2020 2023 2066 6974 0d0a           # fit..
-00040ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ad0: 2020 2020 2020 2020 6e6e 203d 204e 6561          nn = Nea
-00040ae0: 7265 7374 4e65 6967 6862 6f72 7328 6e5f  restNeighbors(n_
-00040af0: 6e65 6967 6862 6f72 733d 3129 2e66 6974  neighbors=1).fit
-00040b00: 2858 5f66 6974 290d 0a0d 0a20 2020 2020  (X_fit)....     
-00040b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040b20: 2020 2023 7072 6564 0d0a 2020 2020 2020     #pred..      
-00040b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040b40: 2020 7265 7320 3d20 6e6e 2e6b 6e65 6967    res = nn.kneig
-00040b50: 6862 6f72 7328 585f 7072 6564 2c20 7265  hbors(X_pred, re
-00040b60: 7475 726e 5f64 6973 7461 6e63 653d 4661  turn_distance=Fa
-00040b70: 6c73 652c 206e 5f6e 6569 6768 626f 7273  lse, n_neighbors
-00040b80: 3d31 290d 0a0d 0a20 2020 2020 2020 2020  =1)....         
-00040b90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00040ba0: 2061 7373 6967 6e0d 0a20 2020 2020 2020   assign..       
+00040980: 2020 2020 2020 2023 2064 6174 613d 2878         # data=(x
+00040990: 2c20 792c 207a 2c20 6731 2c20 6732 2c20  , y, z, g1, g2, 
+000409a0: 7629 2c20 7768 6572 6520 782c 2079 2c20  v), where x, y, 
+000409b0: 7a20 6172 6520 7468 6520 6361 7274 6573  z are the cartes
+000409c0: 6961 6e20 636f 6f72 6469 6e61 7465 732c  ian coordinates,
+000409d0: 2067 3120 616e 6420 6732 2061 7265 2074   g1 and g2 are t
+000409e0: 6865 2076 616c 7565 7320 6f66 200d 0a20  he values of .. 
+000409f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040a00: 2020 2020 2020 2023 2066 6972 7374 2f73         # first/s
+00040a10: 6563 6f6e 6420 6761 7573 7369 616e 2066  econd gaussian f
+00040a20: 6965 6c64 7320 616e 6420 7620 6973 2074  ields and v is t
+00040a30: 6865 2066 6163 6965 7320 7661 6c75 650d  he facies value.
+00040a40: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00040a50: 2020 2020 2020 2020 2020 2023 2320 7365             ## se
+00040a60: 7475 7020 616e 6420 6765 7420 6861 7264  tup and get hard
+00040a70: 2064 6174 610d 0a20 2020 2020 2020 2020   data..         
+00040a80: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+00040a90: 643d 6e70 2e61 7272 6179 285b 5d29 0d0a  d=np.array([])..
+00040aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ab0: 2020 2020 2020 2020 666f 7220 6661 2069          for fa i
+00040ac0: 6e20 6c69 7374 5f6f 626a 3a0d 0a20 2020  n list_obj:..   
+00040ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ae0: 2020 2020 2020 2020 2023 6e64 6172 7261           #ndarra
+00040af0: 790d 0a20 2020 2020 2020 2020 2020 2020  y..             
+00040b00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00040b10: 643d 6c65 6e28 6661 2e78 290d 0a20 2020  d=len(fa.x)..   
+00040b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040b30: 2020 2020 2020 2020 2066 615f 783d 6e70           fa_x=np
+00040b40: 2e61 7272 6179 2866 612e 7829 0d0a 2020  .array(fa.x)..  
+00040b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040b60: 2020 2020 2020 2020 2020 6661 5f79 3d6e            fa_y=n
+00040b70: 702e 6172 7261 7928 6661 2e79 290d 0a20  p.array(fa.y).. 
+00040b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040b90: 2020 2020 2020 2020 2020 2066 615f 7a3d             fa_z=
+00040ba0: 6e70 2e61 7272 6179 2866 612e 7a29 0d0a  np.array(fa.z)..
 00040bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040bc0: 2079 5f70 7265 6420 3d20 795f 6669 745b   y_pred = y_fit[
-00040bd0: 7265 735d 0d0a 2020 2020 2020 2020 2020  res]..          
-00040be0: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00040bf0: 6d75 7320 3d20 6e70 2e7a 6572 6f73 285b  mus = np.zeros([
-00040c00: 6e7a 2c20 6e79 2c20 6e78 5d29 0d0a 2020  nz, ny, nx])..  
-00040c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040c20: 2020 2020 2020 7369 6d75 735b 6d61 736b        simus[mask
-00040c30: 5d20 3d20 795f 7072 6564 5b3a 2c20 305d  ] = y_pred[:, 0]
-00040c40: 2020 2320 7265 6173 7369 676e 2076 616c    # reassign val
-00040c50: 7565 730d 0a0d 0a20 2020 2020 2020 2020  ues....         
-00040c60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00040c70: 6f72 2069 7265 616c 2069 6e20 7261 6e67  or ireal in rang
-00040c80: 6528 6e72 6561 6c29 3a0d 0a20 2020 2020  e(nreal):..     
-00040c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ca0: 2020 2020 2020 2066 6163 6965 735f 646f         facies_do
-00040cb0: 6d61 696e 735b 6975 2c20 6972 6561 6c5d  mains[iu, ireal]
-00040cc0: 5b6d 6173 6b5d 3d73 696d 7573 5b6d 6173  [mask]=simus[mas
-00040cd0: 6b5d 0d0a 0d0a 0d0a 2020 2020 2020 2020  k]......        
-00040ce0: 2020 2020 2020 2020 6966 206d 6f64 6520          if mode 
-00040cf0: 3d3d 2022 6661 6369 6573 223a 0d0a 2020  == "facies":..  
-00040d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040d10: 2020 4172 6368 5461 626c 652e 4765 6f6c    ArchTable.Geol
-00040d20: 2e66 6163 6965 735f 646f 6d61 696e 735b  .facies_domains[
-00040d30: 6975 2c3a 2c20 6d61 736b 5d3d 6661 6369  iu,:, mask]=faci
-00040d40: 6573 5f64 6f6d 6169 6e73 5b69 752c 3a2c  es_domains[iu,:,
-00040d50: 206d 6173 6b5d 2020 2320 7374 6f72 6520   mask]  # store 
-00040d60: 7265 7375 6c74 730d 0a20 2020 2020 2020  results..       
-00040d70: 2020 2020 2020 2020 2065 6c69 6620 6d6f           elif mo
-00040d80: 6465 203d 3d20 2275 6e69 7473 223a 0d0a  de == "units":..
-00040d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040da0: 2020 2020 4172 6368 5461 626c 652e 4765      ArchTable.Ge
-00040db0: 6f6c 2e75 6e69 7473 5f64 6f6d 6169 6e73  ol.units_domains
-00040dc0: 5b69 752c 206d 6173 6b5d 203d 2066 6163  [iu, mask] = fac
-00040dd0: 6965 735f 646f 6d61 696e 735b 6975 2c20  ies_domains[iu, 
-00040de0: 302c 206d 6173 6b5d 2020 2320 7374 6f72  0, mask]  # stor
-00040df0: 6520 7265 7375 6c74 730d 0a20 2020 2020  e results..     
-00040e00: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
-00040e10: 3d20 2253 7562 5069 6c65 223a 2023 2048  = "SubPile": # H
-00040e20: 6965 7261 7263 6869 6361 6c20 6669 6c6c  ierarchical fill
-00040e30: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
-00040e40: 2069 6620 4172 6368 5461 626c 652e 7665   if ArchTable.ve
-00040e50: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00040e60: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
-00040e70: 7562 5069 6c65 2066 696c 6c69 6e67 206d  ubPile filling m
-00040e80: 6574 686f 642c 206e 6f74 6869 6e67 2068  ethod, nothing h
-00040e90: 6170 7065 6e65 6422 290d 0a20 2020 2020  appened")..     
-00040ea0: 2020 2020 2020 2070 6173 730d 0a0d 0a0d         pass.....
-00040eb0: 0a63 6c61 7373 2053 7572 6661 6365 2829  .class Surface()
-00040ec0: 3a0d 0a0d 0a20 2020 2022 2222 0d0a 2020  :....    """..  
-00040ed0: 2020 436c 6173 7320 5375 7266 6163 652c    Class Surface,
-00040ee0: 206d 7573 7420 6265 206c 696e 6b65 6420   must be linked 
-00040ef0: 746f 2061 203a 636c 6173 733a 6055 6e69  to a :class:`Uni
-00040f00: 7460 206f 626a 6563 740d 0a0d 0a20 2020  t` object....   
-00040f10: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00040f20: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00040f30: 206e 616d 6520 3a20 7374 7269 6e67 0d0a   name : string..
-00040f40: 2020 2020 2020 2020 746f 2069 6465 6e74          to ident
-00040f50: 6966 7920 7468 6520 7375 7266 6163 6520  ify the surface 
-00040f60: 666f 7220 6465 6275 6767 696e 6720 7075  for debugging pu
-00040f70: 7270 6f73 650d 0a20 2020 2063 6f6e 7461  rpose..    conta
-00040f80: 6374 203a 2073 7472 696e 670d 0a20 2020  ct : string..   
-00040f90: 2020 2020 206f 6e6c 6170 206f 7220 6572       onlap or er
-00040fa0: 6f64 652e 204f 6e6c 6170 2069 6e64 6963  ode. Onlap indic
-00040fb0: 6174 6573 2074 6861 7420 7468 6973 2073  ates that this s
-00040fc0: 7572 6661 6365 2063 616e 6e6f 7420 6572  urface cannot er
-00040fd0: 6f64 6520 6f6c 6465 7220 7375 7266 6163  ode older surfac
-00040fe0: 6573 2c0d 0a20 2020 2020 2020 206f 6e20  es,..        on 
-00040ff0: 636f 6e74 7261 7279 2074 6f20 6572 6f64  contrary to erod
-00041000: 6520 7375 7266 6163 6573 0d0a 2020 2020  e surfaces..    
-00041010: 6469 635f 7375 7266 203a 2064 6963 740d  dic_surf : dict.
-00041020: 0a20 2020 2020 2020 2070 6172 616d 6574  .        paramet
-00041030: 6572 7320 666f 7220 7375 7266 6163 6520  ers for surface 
-00041040: 696e 7465 7270 6f6c 6174 696f 6e3a 0d0a  interpolation:..
-00041050: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00041060: 696e 745f 6d65 7468 6f64 203a 2073 7472  int_method : str
-00041070: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
-00041080: 2020 2020 206d 6574 686f 6420 6f66 2069       method of i
-00041090: 6e74 6572 706f 6c61 7469 6f6e 2c20 706f  nterpolation, po
-000410a0: 7373 6962 6c65 206d 6574 686f 6473 2061  ssible methods a
-000410b0: 7265 3a0d 0a20 2020 2020 2020 2020 2020  re:..           
-000410c0: 2020 2020 206b 7269 6769 6e67 2c20 4d50       kriging, MP
-000410d0: 532c 2067 7266 2c20 6772 665f 696e 6571  S, grf, grf_ineq
-000410e0: 2c20 6c69 6e65 6172 2c20 6e65 6172 6573  , linear, neares
-000410f0: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
-00041100: 2d20 636f 766d 6f64 656c 203a 2073 7472  - covmodel : str
-00041110: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
-00041120: 2020 2020 2067 656f 6e65 2063 6f76 6172       geone covar
-00041130: 6961 6e63 6520 6d6f 6465 6c20 2873 6565  iance model (see
-00041140: 2064 6f63 2047 656f 6e65 2066 6f72 206d   doc Geone for m
-00041150: 6f72 6520 696e 666f 726d 6174 696f 6e29  ore information)
-00041160: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041170: 2020 6966 2061 206d 756c 7469 2d67 6175    if a multi-gau
-00041180: 7373 6961 6e20 6d65 7468 6f64 2069 7320  ssian method is 
-00041190: 7573 6564 0d0a 2020 2020 2020 2020 2020  used..          
-000411a0: 2020 2d20 4e5f 7472 616e 7366 6f20 3a20    - N_transfo : 
-000411b0: 626f 6f6c 0d0a 2020 2020 2020 2020 2020  bool..          
-000411c0: 2020 2020 2020 4e6f 726d 616c 2d73 636f        Normal-sco
-000411d0: 7265 2074 7261 6e73 666f 726d 2e20 466c  re transform. Fl
-000411e0: 6167 2074 6f20 6170 706c 7920 6f72 206e  ag to apply or n
-000411f0: 6f74 2061 204e 6f72 6d61 6c20 5363 6f72  ot a Normal Scor
-00041200: 6520 6f6e 2074 6865 2064 6174 6120 666f  e on the data fo
-00041210: 7220 7468 6520 696e 7465 7270 6f6c 6174  r the interpolat
-00041220: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-00041230: 202d 2055 6e69 7473 206b 7761 7267 7320   - Units kwargs 
-00041240: 2028 7061 7373 6564 2069 6e20 6469 635f   (passed in dic_
-00041250: 7375 7266 2064 6972 6563 746c 7929 3a0d  surf directly):.
-00041260: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
-00041270: 6f72 2074 6865 2073 6561 7263 6820 656c  or the search el
-00041280: 6c69 7073 6f69 6420 286b 7269 6769 6e67  lipsoid (kriging
-00041290: 2c20 6772 662c 202e 2e2e 293a 0d0a 2020  , grf, ...):..  
-000412a0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000412b0: 2020 2020 2020 2020 2020 2020 2d20 722c              - r,
-000412c0: 2072 656c 6174 6976 6520 2874 6f20 636f   relative (to co
-000412d0: 7661 7269 616e 6365 206d 6f64 656c 2920  variance model) 
-000412e0: 7261 6469 7573 206f 6620 7265 7365 6172  radius of resear
-000412f0: 6368 2028 6465 6661 756c 7420 6973 2031  ch (default is 1
-00041300: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00041310: 2020 202d 206e 6569 672c 206e 756d 6265     - neig, numbe
-00041320: 7220 6f66 206e 6569 6768 626f 7572 730d  r of neighbours.
-00041330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041340: 202d 206b 7269 675f 7479 7065 3a20 7374   - krig_type: st
-00041350: 7269 6e67 2c20 6b72 6967 696e 6720 6d65  ring, kriging me
-00041360: 7468 6f64 2028 6f72 6469 6e61 7279 5f6b  thod (ordinary_k
-00041370: 7269 6769 6e67 2c20 7369 6d70 6c65 5f6b  riging, simple_k
-00041380: 7269 6769 6e67 290d 0a20 2020 2020 2020  riging)..       
-00041390: 2020 2020 2066 6f72 204d 5053 3a0d 0a20       for MPS:.. 
-000413a0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-000413b0: 2020 2020 2020 2020 2020 2020 202d 2054               - T
-000413c0: 490d 0a20 2020 2020 2020 2020 2020 2020  I..             
-000413d0: 2020 202d 2076 6172 696f 7573 204d 5053     - various MPS
-000413e0: 2070 6172 616d 6574 6572 732c 2073 6565   parameters, see
-000413f0: 2067 656f 6e65 2064 6f63 756d 656e 7461   geone documenta
-00041400: 7469 6f6e 0d0a 0d0a 2020 2020 2222 220d  tion....    """.
-00041410: 0a0d 0a20 2020 2064 6566 205f 5f69 6e69  ...    def __ini
-00041420: 745f 5f28 7365 6c66 2c20 6e61 6d65 3d22  t__(self, name="
-00041430: 5375 7266 6163 655f 3122 2c0d 0a20 2020  Surface_1",..   
-00041440: 2020 2020 2020 2020 2020 2020 2064 6963               dic
-00041450: 5f73 7572 663d 7b22 696e 745f 6d65 7468  _surf={"int_meth
-00041460: 6f64 223a 2022 6e65 6172 6573 7422 2c20  od": "nearest", 
-00041470: 2263 6f76 6d6f 6465 6c22 3a20 4e6f 6e65  "covmodel": None
-00041480: 2c20 224e 5f74 7261 6e73 666f 223a 2046  , "N_transfo": F
-00041490: 616c 7365 7d2c 0d0a 2020 2020 2020 2020  alse},..        
-000414a0: 2020 2020 2020 2020 636f 6e74 6163 743d          contact=
-000414b0: 226f 6e6c 6170 2229 3a0d 0a0d 0a20 2020  "onlap"):....   
-000414c0: 2020 2020 2061 7373 6572 7420 636f 6e74       assert cont
-000414d0: 6163 7420 696e 205b 2265 726f 6465 222c  act in ["erode",
-000414e0: 2022 6f6e 6c61 7022 2c20 2263 6f6d 6622   "onlap", "comf"
-000414f0: 5d2c 2022 636f 6e74 6163 7420 6d75 7374  ], "contact must
-00041500: 2062 6520 6572 6f64 6520 6f72 206f 6e6c   be erode or onl
-00041510: 6170 206f 7220 636f 6d66 220d 0a20 2020  ap or comf"..   
-00041520: 2020 2020 2061 7373 6572 7420 6469 635f       assert dic_
-00041530: 7375 7266 5b22 696e 745f 6d65 7468 6f64  surf["int_method
-00041540: 225d 2069 7320 6e6f 7420 4e6f 6e65 2c20  "] is not None, 
-00041550: 2241 6e20 696e 7465 7270 6f6c 6174 696f  "An interpolatio
-00041560: 6e20 6d65 7468 6f64 206d 7573 7420 6265  n method must be
-00041570: 2070 726f 7669 6465 6422 0d0a 2020 2020   provided"..    
-00041580: 2020 2020 6173 7365 7274 2064 6963 5f73      assert dic_s
-00041590: 7572 665b 2269 6e74 5f6d 6574 686f 6422  urf["int_method"
-000415a0: 5d20 696e 205b 226c 696e 6561 7222 2c20  ] in ["linear", 
-000415b0: 2263 7562 6963 222c 2022 6e65 6172 6573  "cubic", "neares
-000415c0: 7422 2c20 226b 7269 6769 6e67 222c 2022  t", "kriging", "
-000415d0: 6772 6622 2c20 2267 7266 5f69 6e65 7122  grf", "grf_ineq"
-000415e0: 2c20 224d 5053 225d 2c20 2255 6e6b 6e6f  , "MPS"], "Unkno
-000415f0: 776e 2069 6e74 6572 706f 6c61 7469 6f6e  wn interpolation
-00041600: 206d 6574 686f 6422 0d0a 0d0a 2020 2020   method"....    
-00041610: 2020 2020 2364 6566 6175 6c74 2076 616c      #default val
-00041620: 7565 7320 6469 6320 7375 7266 0d0a 2020  ues dic surf..  
-00041630: 2020 2020 2020 6b77 6172 6773 5f64 6566        kwargs_def
-00041640: 5f73 7572 6661 6365 3d7b 2263 6f76 6d6f  _surface={"covmo
-00041650: 6465 6c22 3a20 4e6f 6e65 2c20 224e 5f74  del": None, "N_t
-00041660: 7261 6e73 666f 223a 2046 616c 7365 2c20  ransfo": False, 
-00041670: 2262 616e 6477 6964 7468 5f6d 756c 7422  "bandwidth_mult"
-00041680: 3a20 312c 2022 7461 7522 3a20 307d 0d0a  : 1, "tau": 0}..
-00041690: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-000416a0: 2069 6e20 6b77 6172 6773 5f64 6566 5f73   in kwargs_def_s
-000416b0: 7572 6661 6365 2e69 7465 6d73 2829 3a0d  urface.items():.
-000416c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000416d0: 6b20 6e6f 7420 696e 2064 6963 5f73 7572  k not in dic_sur
-000416e0: 662e 6b65 7973 2829 3a0d 0a20 2020 2020  f.keys():..     
-000416f0: 2020 2020 2020 2020 2020 2064 6963 5f73             dic_s
-00041700: 7572 665b 6b5d 3d76 0d0a 0d0a 2020 2020  urf[k]=v....    
-00041710: 2020 2020 7365 6c66 2e6e 616d 653d 6e61      self.name=na
-00041720: 6d65 0d0a 2020 2020 2020 2020 7365 6c66  me..        self
-00041730: 2e78 3d5b 5d0d 0a20 2020 2020 2020 2073  .x=[]..        s
-00041740: 656c 662e 793d 5b5d 0d0a 2020 2020 2020  elf.y=[]..      
-00041750: 2020 7365 6c66 2e7a 3d5b 5d0d 0a20 2020    self.z=[]..   
-00041760: 2020 2020 2073 656c 662e 696e 6571 3d5b       self.ineq=[
-00041770: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-00041780: 696e 745f 6d65 7468 6f64 3d64 6963 5f73  int_method=dic_s
-00041790: 7572 665b 2269 6e74 5f6d 6574 686f 6422  urf["int_method"
-000417a0: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-000417b0: 4e5f 7472 616e 7366 6f3d 6469 635f 7375  N_transfo=dic_su
-000417c0: 7266 5b22 4e5f 7472 616e 7366 6f22 5d0d  rf["N_transfo"].
-000417d0: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-000417e0: 766d 6f64 656c 3d64 6963 5f73 7572 665b  vmodel=dic_surf[
-000417f0: 2263 6f76 6d6f 6465 6c22 5d0d 0a20 2020  "covmodel"]..   
-00041800: 2020 2020 2073 656c 662e 636f 6e74 6163       self.contac
-00041810: 743d 636f 6e74 6163 740d 0a0d 0a20 2020  t=contact....   
-00041820: 2020 2020 2023 6368 6563 6b20 696e 7075       #check inpu
-00041830: 7473 2066 6f72 2073 7572 6661 6365 206d  ts for surface m
-00041840: 6574 686f 6473 0d0a 2020 2020 2020 2020  ethods..        
-00041850: 6966 2073 656c 662e 696e 745f 6d65 7468  if self.int_meth
-00041860: 6f64 2069 6e20 5b22 6b72 6967 696e 6722  od in ["kriging"
-00041870: 2c20 2267 7266 222c 2022 6772 665f 696e  , "grf", "grf_in
-00041880: 6571 225d 3a0d 0a20 2020 2020 2020 2020  eq"]:..         
-00041890: 2020 2073 656c 662e 6765 745f 7375 7266     self.get_surf
-000418a0: 6163 655f 636f 766d 6f64 656c 2829 0d0a  ace_covmodel()..
-000418b0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000418c0: 662e 636f 766d 6f64 656c 2069 7320 6e6f  f.covmodel is no
-000418d0: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
-000418e0: 4e5f 7472 616e 7366 6f20 616e 6420 7365  N_transfo and se
-000418f0: 6c66 2e69 6e74 5f6d 6574 686f 6420 696e  lf.int_method in
-00041900: 205b 226b 7269 6769 6e67 222c 2022 6772   ["kriging", "gr
-00041910: 6622 2c20 2267 7266 5f69 6e65 7122 5d3a  f", "grf_ineq"]:
-00041920: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00041930: 2073 656c 662e 6765 745f 7375 7266 6163   self.get_surfac
-00041940: 655f 636f 766d 6f64 656c 2829 2e73 696c  e_covmodel().sil
-00041950: 6c28 2920 213d 2031 3a0d 0a20 2020 2020  l() != 1:..     
-00041960: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00041970: 2822 556e 6974 207b 7d3a 2021 2120 4e6f  ("Unit {}: !! No
-00041980: 726d 616c 2074 7261 6e73 666f 726d 6174  rmal transformat
-00041990: 696f 6e20 6973 2061 7070 6c69 6564 2062  ion is applied b
-000419a0: 7574 2074 6865 2076 6172 6961 6e63 6520  ut the variance 
-000419b0: 6f66 2074 6865 2043 6f76 6172 6961 6e63  of the Covarianc
-000419c0: 6520 6d6f 6465 6c20 6973 206e 6f74 2065  e model is not e
-000419d0: 7175 616c 2074 6f20 3120 2121 222e 666f  qual to 1 !!".fo
-000419e0: 726d 6174 2873 656c 662e 6e61 6d65 2929  rmat(self.name))
-000419f0: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00041a00: 2e64 6963 5f73 7572 663d 6469 635f 7375  .dic_surf=dic_su
-00041a10: 7266 0d0a 0d0a 2020 2020 6465 6620 636f  rf....    def co
-00041a20: 7079 2873 656c 6629 3a0d 0a20 2020 2020  py(self):..     
-00041a30: 2020 2072 6574 7572 6e20 636f 7079 2e64     return copy.d
-00041a40: 6565 7063 6f70 7928 7365 6c66 290d 0a0d  eepcopy(self)...
-00041a50: 0a20 2020 2064 6566 2073 6574 5f63 6f76  .    def set_cov
-00041a60: 6d6f 6465 6c28 7365 6c66 2c20 636f 766d  model(self, covm
-00041a70: 6f64 656c 293a 0d0a 0d0a 2020 2020 2020  odel):....      
-00041a80: 2020 2222 220d 0a20 2020 2020 2020 2063    """..        c
-00041a90: 6861 6e67 6520 6f72 2061 6464 2061 2063  hange or add a c
-00041aa0: 6f76 6d6f 6465 6c20 666f 7220 7375 7266  ovmodel for surf
-00041ab0: 6163 6520 696e 7465 7270 6f6c 6174 696f  ace interpolatio
-00041ac0: 6e20 6f66 2073 656c 6620 756e 6974 2e0d  n of self unit..
-00041ad0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00041ae0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00041af0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00041b00: 2020 2063 6f76 6d6f 6465 6c20 3a20 6765     covmodel : ge
-00041b10: 6f6e 652e 636f 764d 6f64 656c 2e43 6f76  one.covModel.Cov
-00041b20: 4d6f 6465 6c32 440d 0a20 2020 2020 2020  Model2D..       
-00041b30: 2020 2020 2063 6f76 6172 6961 6e63 6520       covariance 
-00041b40: 6d6f 6465 6c20 746f 2062 6520 7573 6564  model to be used
-00041b50: 2066 6f72 2073 7572 6661 6365 2069 6e74   for surface int
-00041b60: 6572 706f 6c61 7469 6f6e 0d0a 2020 2020  erpolation..    
-00041b70: 2020 2020 2020 2020 6966 2074 6865 2063          if the c
-00041b80: 686f 7365 6e20 6d65 7468 6f64 2069 7320  hosen method is 
-00041b90: 6772 662c 2067 7266 2069 6e65 7120 6f72  grf, grf ineq or
-00041ba0: 206b 7269 6769 6e67 0d0a 2020 2020 2020   kriging..      
-00041bb0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-00041bc0: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
-00041bd0: 6f76 6d6f 6465 6c2c 2067 656f 6e65 2e63  ovmodel, geone.c
-00041be0: 6f76 4d6f 6465 6c2e 436f 764d 6f64 656c  ovModel.CovModel
-00041bf0: 3244 293a 0d0a 2020 2020 2020 2020 2020  2D):..          
-00041c00: 2020 7365 6c66 2e63 6f76 6d6f 6465 6c3d    self.covmodel=
-00041c10: 636f 766d 6f64 656c 0d0a 2020 2020 2020  covmodel..      
-00041c20: 2020 2020 2020 2320 7365 6c66 2e64 6963        # self.dic
-00041c30: 5f73 7572 665b 2263 6f76 6d6f 6465 6c22  _surf["covmodel"
-00041c40: 5d3d 636f 766d 6f64 656c 0d0a 2020 2020  ]=covmodel..    
-00041c50: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
-00041c60: 7572 6661 6365 207b 7d3a 2063 6f76 6d6f  urface {}: covmo
-00041c70: 6465 6c20 6164 6465 6422 2e66 6f72 6d61  del added".forma
-00041c80: 7428 7365 6c66 2e6e 616d 6529 290d 0a20  t(self.name)).. 
-00041c90: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00041ca0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00041cb0: 2253 7572 6661 6365 207b 7d3a 2063 6f76  "Surface {}: cov
-00041cc0: 6d6f 6465 6c20 6e6f 7420 6120 6765 6f6e  model not a geon
-00041cd0: 6520 3244 2063 6f76 6d6f 6465 6c22 2e66  e 2D covmodel".f
-00041ce0: 6f72 6d61 7428 7365 6c66 2e6e 616d 6529  ormat(self.name)
-00041cf0: 290d 0a0d 0a20 2020 2064 6566 2067 6574  )....    def get
-00041d00: 5f73 7572 6661 6365 5f63 6f76 6d6f 6465  _surface_covmode
-00041d10: 6c28 7365 6c66 2c20 7662 3d31 293a 0d0a  l(self, vb=1):..
-00041d20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00041d30: 636f 766d 6f64 656c 2069 7320 4e6f 6e65  covmodel is None
-00041d40: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00041d50: 6620 7662 3a0d 0a20 2020 2020 2020 2020  f vb:..         
-00041d60: 2020 2020 2020 2070 7269 6e74 2028 2257         print ("W
-00041d70: 6172 6e69 6e67 3a20 556e 6974 2027 7b7d  arning: Unit '{}
-00041d80: 2720 6861 7665 206e 6f20 436f 766d 6f64  ' have no Covmod
-00041d90: 656c 2066 6f72 2073 7572 6661 6365 2069  el for surface i
-00041da0: 6e74 6572 706f 6c61 7469 6f6e 222e 666f  nterpolation".fo
-00041db0: 726d 6174 2873 656c 662e 6e61 6d65 2929  rmat(self.name))
-00041dc0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00041dd0: 7475 726e 204e 6f6e 650d 0a20 2020 2020  turn None..     
-00041de0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00041df0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00041e00: 662e 636f 766d 6f64 656c 0d0a 0d0a 636c  f.covmodel....cl
-00041e10: 6173 7320 4661 6369 6573 2829 3a0d 0a0d  ass Facies():...
-00041e20: 0a20 2020 2022 2222 0d0a 2020 2020 636c  .    """..    cl
-00041e30: 6173 7320 666f 7220 6661 6369 6573 2028  ass for facies (
-00041e40: 326e 6420 6c65 7665 6c20 6f66 2068 6965  2nd level of hie
-00041e50: 7261 7263 6879 290d 0a0d 0a20 2020 2050  rarchy)....    P
-00041e60: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
-00041e70: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2049  ---------..    I
-00041e80: 4420 3a20 696e 740d 0a20 2020 2020 2020  D : int..       
-00041e90: 2066 6163 6965 7320 4944 2074 6861 7420   facies ID that 
-00041ea0: 6973 2075 7365 6420 696e 2074 6865 2072  is used in the r
-00041eb0: 6573 756c 7473 0d0a 2020 2020 6e61 6d65  esults..    name
-00041ec0: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
-00041ed0: 2020 2066 6163 6965 7320 6e61 6d65 2c20     facies name, 
-00041ee0: 7573 6564 2061 7320 616e 2069 6465 6e74  used as an ident
-00041ef0: 6966 6965 720d 0a20 2020 2063 6f6c 6f72  ifier..    color
-00041f00: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
-00041f10: 2020 2063 6f6c 6f72 206f 6620 7468 6520     color of the 
-00041f20: 6661 6369 6573 2c20 7573 6564 2066 6f72  facies, used for
-00041f30: 2070 6c6f 7474 696e 670d 0a20 2020 2022   plotting..    "
-00041f40: 2222 0d0a 0d0a 2020 2020 6465 6620 5f5f  ""....    def __
-00041f50: 696e 6974 5f5f 2873 656c 662c 2049 442c  init__(self, ID,
-00041f60: 206e 616d 652c 2063 6f6c 6f72 293a 0d0a   name, color):..
-00041f70: 0d0a 2020 2020 2020 2020 7365 6c66 2e78  ..        self.x
-00041f80: 3d5b 5d0d 0a20 2020 2020 2020 2073 656c  =[]..        sel
-00041f90: 662e 793d 5b5d 0d0a 2020 2020 2020 2020  f.y=[]..        
-00041fa0: 7365 6c66 2e7a 3d5b 5d0d 0a20 2020 2020  self.z=[]..     
-00041fb0: 2020 2069 6620 4944 2021 3d20 303a 0d0a     if ID != 0:..
-00041fc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00041fd0: 2e49 443d 4944 0d0a 2020 2020 2020 2020  .ID=ID..        
-00041fe0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00041ff0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00042000: 726f 7228 2249 4420 6661 6369 6573 2063  ror("ID facies c
-00042010: 616e 6e6f 7420 6265 2065 7175 616c 2074  annot be equal t
-00042020: 6f20 3022 290d 0a20 2020 2020 2020 2073  o 0")..        s
-00042030: 656c 662e 6e61 6d65 3d6e 616d 650d 0a20  elf.name=name.. 
-00042040: 2020 2020 2020 2073 656c 662e 633d 636f         self.c=co
-00042050: 6c6f 720d 0a0d 0a20 2020 2064 6566 205f  lor....    def _
-00042060: 5f65 715f 5f28 7365 6c66 2c20 6f74 6865  _eq__(self, othe
-00042070: 7229 3a0d 0a20 2020 2020 2020 2069 6620  r):..        if 
-00042080: 2873 656c 662e 6e61 6d65 203d 3d20 6f74  (self.name == ot
-00042090: 6865 722e 6e61 6d65 2920 2620 2873 656c  her.name) & (sel
-000420a0: 662e 4944 203d 3d20 6f74 6865 722e 4944  f.ID == other.ID
-000420b0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000420c0: 7265 7475 726e 2054 7275 650d 0a20 2020  return True..   
-000420d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000420e0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-000420f0: 616c 7365 0d0a 0d0a 2020 2020 6465 6620  alse....    def 
-00042100: 5f5f 7374 725f 5f28 7365 6c66 293a 0d0a  __str__(self):..
-00042110: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00042120: 656c 662e 6e61 6d65 0d0a 0d0a 2020 2020  elf.name....    
-00042130: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
-00042140: 6629 3a0d 0a20 2020 2020 2020 2072 6574  f):..        ret
-00042150: 7572 6e20 7365 6c66 2e6e 616d 650d 0a0d  urn self.name...
-00042160: 0a63 6c61 7373 2050 726f 7028 293a 0d0a  .class Prop():..
-00042170: 0d0a 2020 2020 2222 220d 0a20 2020 2043  ..    """..    C
-00042180: 6c61 7373 2066 6f72 2064 6566 696e 696e  lass for definin
-00042190: 6720 6120 7072 6f70 7269 6574 7920 746f  g a propriety to
-000421a0: 2073 696d 756c 6174 6520 2833 7264 206c   simulate (3rd l
-000421b0: 6576 656c 290d 0a0d 0a20 2020 2050 6172  evel)....    Par
-000421c0: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
-000421d0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 206e 616d  -------..    nam
-000421e0: 6520 3a20 7374 7269 6e67 0d0a 2020 2020  e : string..    
-000421f0: 2020 2020 5072 6f70 6572 7479 206e 616d      Property nam
-00042200: 650d 0a20 2020 2066 6163 6965 7320 3a20  e..    facies : 
-00042210: 6c69 7374 206f 6620 3a63 6c61 7373 3a60  list of :class:`
-00042220: 4661 6369 6573 6020 6f62 6a65 6374 730d  Facies` objects.
-00042230: 0a20 2020 2020 2020 2066 6163 6965 7320  .        facies 
-00042240: 696e 2077 6869 6368 2077 6520 7761 6e74  in which we want
-00042250: 2074 6f20 7369 6d75 6c61 7465 2074 6865   to simulate the
-00042260: 2070 726f 7065 7274 790d 0a20 2020 2020   property..     
-00042270: 2020 2028 696e 2074 6865 206f 7468 6572     (in the other
-00042280: 7320 7468 6520 7072 6f70 7269 6574 7920  s the propriety 
-00042290: 7769 6c6c 2062 6520 7365 7420 686f 6d6f  will be set homo
-000422a0: 6765 6e6f 7573 2077 6974 6820 6120 6465  genous with a de
-000422b0: 6661 756c 7420 7661 6c75 6529 0d0a 2020  fault value)..  
-000422c0: 2020 636f 766d 6f64 656c 7320 3a20 6c69    covmodels : li
-000422d0: 7374 206f 6620 3a63 6c61 7373 3a60 6765  st of :class:`ge
-000422e0: 6f6e 652e 636f 764d 6f64 656c 2e43 6f76  one.covModel.Cov
-000422f0: 4d6f 6465 6c32 4460 206f 626a 6563 7473  Model2D` objects
-00042300: 0d0a 2020 2020 2020 2020 636f 766d 6f64  ..        covmod
-00042310: 656c 7320 666f 7220 7468 6520 7369 6d75  els for the simu
-00042320: 6c61 7469 6f6e 2028 7361 6d65 2073 697a  lation (same siz
-00042330: 6520 6f66 2066 6163 6965 7320 6f72 206f  e of facies or o
-00042340: 6e6c 7920 3129 0d0a 2020 2020 6d65 616e  nly 1)..    mean
-00042350: 7320 3a20 6c69 7374 206f 6620 666c 6f61  s : list of floa
-00042360: 7473 0d0a 2020 2020 2020 2020 6d65 616e  ts..        mean
-00042370: 206f 6620 7468 6520 7072 6f70 6572 7479   of the property
-00042380: 2069 6e20 6561 6368 2066 6163 6965 7320   in each facies 
-00042390: 2873 616d 6520 7369 7a65 206f 6620 6661  (same size of fa
-000423a0: 6369 6573 290d 0a20 2020 2069 6e74 5f6d  cies)..    int_m
-000423b0: 6574 686f 6420 3a20 7374 7269 6e67 0d0a  ethod : string..
-000423c0: 2020 2020 2020 2020 6d65 7468 6f64 206f          method o
-000423d0: 6620 696e 7465 7270 6f6c 6174 696f 6e2c  f interpolation,
-000423e0: 2070 6f73 7369 626c 6520 6d65 7468 6f64   possible method
-000423f0: 7320 6172 653a 0d0a 2020 2020 2020 2020  s are:..        
-00042400: 2d20 7367 732c 2064 6566 6175 6c74 0d0a  - sgs, default..
-00042410: 2020 2020 2020 2020 2d20 6666 740d 0a20          - fft.. 
-00042420: 2020 2020 2020 202d 2068 6f6d 6f67 656e         - homogen
-00042430: 6f75 730d 0a20 2020 2064 6566 5f6d 6561  ous..    def_mea
-00042440: 6e20 3a20 666c 6f61 740d 0a20 2020 2020  n : float..     
-00042450: 2020 2064 6566 6175 6c74 206d 6561 6e20     default mean 
-00042460: 746f 2075 7365 6420 6966 206e 6f6e 6520  to used if none 
-00042470: 6973 2070 6173 7365 6420 696e 206d 6561  is passed in mea
-00042480: 6e73 2061 7272 6179 0d0a 2020 2020 766d  ns array..    vm
-00042490: 696e 2c20 766d 6178 203a 2066 6c6f 6174  in, vmax : float
-000424a0: 0d0a 2020 2020 2020 2020 6d69 6e20 7265  ..        min re
-000424b0: 7370 2e20 6d61 7820 7661 6c75 6520 6f66  sp. max value of
-000424c0: 2074 6865 2070 726f 7065 7274 790d 0a20   the property.. 
-000424d0: 2020 2078 203a 206e 6461 7272 6179 206f     x : ndarray o
-000424e0: 6620 7369 7a65 2028 6e2c 2032 202d 2d3e  f size (n, 2 -->
-000424f0: 2078 2c20 7929 0d0a 2020 2020 2020 2020   x, y)..        
-00042500: 706f 7369 7469 6f6e 206f 6620 6861 7264  position of hard
-00042510: 2064 6174 6120 0d0a 2020 2020 7620 3a20   data ..    v : 
-00042520: 6e64 6172 7261 7920 6f66 2073 697a 6520  ndarray of size 
-00042530: 286e 2c20 3120 2d2d 3e20 7661 6c75 6529  (n, 1 --> value)
-00042540: 0d0a 2020 2020 2020 2020 7661 6c75 6520  ..        value 
-00042550: 6f66 2068 6172 6420 6461 7461 0d0a 2020  of hard data..  
-00042560: 2020 2222 220d 0a0d 0a20 2020 2064 6566    """....    def
-00042570: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00042580: 6e61 6d65 2c20 6661 6369 6573 2c20 636f  name, facies, co
-00042590: 766d 6f64 656c 732c 206d 6561 6e73 2c20  vmodels, means, 
-000425a0: 696e 745f 6d65 7468 6f64 3d22 7367 7322  int_method="sgs"
-000425b0: 2c20 783d 4e6f 6e65 2c20 763d 204e 6f6e  , x=None, v= Non
-000425c0: 652c 2064 6566 5f6d 6561 6e3d 312c 2076  e, def_mean=1, v
-000425d0: 6d69 6e3d 4e6f 6e65 2c20 766d 6178 3d4e  min=None, vmax=N
-000425e0: 6f6e 6529 3a0d 0a0d 0a0d 0a20 2020 2020  one):......     
-000425f0: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
-00042600: 616e 6365 2866 6163 6965 732c 206c 6973  ance(facies, lis
-00042610: 7429 2c20 2246 6163 6965 7320 6d75 7374  t), "Facies must
-00042620: 2062 6520 6120 6c69 7374 206f 6620 6661   be a list of fa
-00042630: 6369 6573 2c20 6576 656e 2074 6865 7265  cies, even there
-00042640: 2069 7320 6f6e 6c79 206f 6e65 220d 0a20   is only one".. 
-00042650: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00042660: 696e 7374 616e 6365 2876 6d69 6e2c 2066  instance(vmin, f
-00042670: 6c6f 6174 2920 6f72 2069 7369 6e73 7461  loat) or isinsta
-00042680: 6e63 6528 766d 696e 2c20 696e 7429 206f  nce(vmin, int) o
-00042690: 7220 766d 696e 2069 7320 4e6f 6e65 2c20  r vmin is None, 
-000426a0: 2256 6d69 6e20 6572 726f 7222 0d0a 2020  "Vmin error"..  
-000426b0: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-000426c0: 6e73 7461 6e63 6528 766d 6178 2c20 666c  nstance(vmax, fl
-000426d0: 6f61 7429 206f 7220 6973 696e 7374 616e  oat) or isinstan
-000426e0: 6365 2876 6d61 782c 2069 6e74 2920 6f72  ce(vmax, int) or
-000426f0: 2076 6d61 7820 6973 204e 6f6e 652c 2022   vmax is None, "
-00042700: 566d 6178 2065 7272 6f72 220d 0a0d 0a20  Vmax error".... 
-00042710: 2020 2020 2020 2073 656c 662e 6e61 6d65         self.name
-00042720: 3d6e 616d 650d 0a20 2020 2020 2020 2073  =name..        s
-00042730: 656c 662e 6661 6369 6573 3d66 6163 6965  elf.facies=facie
-00042740: 730d 0a20 2020 2020 2020 206e 5f66 6163  s..        n_fac
-00042750: 6965 733d 6c65 6e28 6661 6369 6573 290d  ies=len(facies).
-00042760: 0a20 2020 2020 2020 2073 656c 662e 6e5f  .        self.n_
-00042770: 6661 6369 6573 3d6e 5f66 6163 6965 730d  facies=n_facies.
-00042780: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00042790: 766d 696e 3d76 6d69 6e0d 0a20 2020 2020  vmin=vmin..     
-000427a0: 2020 2073 656c 662e 766d 6178 3d76 6d61     self.vmax=vma
-000427b0: 780d 0a20 2020 2020 2020 2073 656c 662e  x..        self.
-000427c0: 783d 780d 0a20 2020 2020 2020 2073 656c  x=x..        sel
-000427d0: 662e 763d 760d 0a0d 0a20 2020 2020 2020  f.v=v....       
-000427e0: 2023 636f 766d 6f64 656c 730d 0a20 2020   #covmodels..   
-000427f0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00042800: 2020 2020 2020 2066 6f72 2063 6d20 696e         for cm in
-00042810: 2063 6f76 6d6f 6465 6c73 3a0d 0a20 2020   covmodels:..   
-00042820: 2020 2020 2020 2020 2020 2020 2070 6173               pas
-00042830: 730d 0a20 2020 2020 2020 2020 2020 2073  s..            s
-00042840: 656c 662e 636f 766d 6f64 656c 733d 636f  elf.covmodels=co
-00042850: 766d 6f64 656c 730d 0a20 2020 2020 2020  vmodels..       
-00042860: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00042870: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00042880: 6e63 6528 636f 766d 6f64 656c 732c 2067  nce(covmodels, g
-00042890: 636d 2e43 6f76 4d6f 6465 6c33 4429 3a0d  cm.CovModel3D):.
-000428a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000428b0: 2073 656c 662e 636f 766d 6f64 656c 733d   self.covmodels=
-000428c0: 5b63 6f76 6d6f 6465 6c73 5d2a 6e5f 6661  [covmodels]*n_fa
-000428d0: 6369 6573 0d0a 2020 2020 2020 2020 2020  cies..          
-000428e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000428f0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00042900: 616c 7565 4572 726f 7228 227b 7d20 6973  alueError("{} is
-00042910: 206e 6f74 2061 2076 616c 6964 2043 6f76   not a valid Cov
-00042920: 4d6f 6465 6c33 4422 2e66 6f72 6d61 7428  Model3D".format(
-00042930: 636d 2929 0d0a 0d0a 2020 2020 2020 2020  cm))....        
-00042940: 236d 6561 6e73 0d0a 2020 2020 2020 2020  #means..        
-00042950: 7365 6c66 2e6d 6561 6e73 3d6d 6561 6e73  self.means=means
-00042960: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-00042970: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00042980: 6d20 696e 206d 6561 6e73 3a0d 0a20 2020  m in means:..   
-00042990: 2020 2020 2020 2020 2020 2020 2070 6173               pas
-000429a0: 730d 0a20 2020 2020 2020 2065 7863 6570  s..        excep
-000429b0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-000429c0: 7365 6c66 2e6d 6561 6e73 3d5b 6d65 616e  self.means=[mean
-000429d0: 735d 2a6e 5f66 6163 6965 730d 0a0d 0a20  s]*n_facies.... 
-000429e0: 2020 2020 2020 2023 696e 7465 7270 6f6c         #interpol
-000429f0: 6174 696f 6e20 6d65 7468 6f64 730d 0a20  ation methods.. 
-00042a00: 2020 2020 2020 2073 656c 662e 696e 743d         self.int=
-00042a10: 696e 745f 6d65 7468 6f64 0d0a 2020 2020  int_method..    
-00042a20: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-00042a30: 2020 2020 2020 666f 7220 695f 6d65 7468        for i_meth
-00042a40: 6f64 2069 6e20 696e 745f 6d65 7468 6f64  od in int_method
-00042a50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00042a60: 2020 2069 6620 695f 6d65 7468 6f64 2069     if i_method i
-00042a70: 6e20 2822 7367 7322 2c20 2266 6674 222c  n ("sgs", "fft",
-00042a80: 2022 686f 6d6f 6765 6e6f 7573 222c 2022   "homogenous", "
-00042a90: 6d70 7322 2c20 2268 6f6d 6f67 656e 6f75  mps", "homogenou
-00042aa0: 735f 756e 6966 6f72 6d22 293a 0d0a 2020  s_uniform"):..  
-00042ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ac0: 2020 7061 7373 0d0a 2020 2020 2020 2020    pass..        
-00042ad0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00042ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042af0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00042b00: 726f 7228 227b 7d20 6973 206e 6f74 2061  ror("{} is not a
-00042b10: 2076 616c 6964 2069 6e74 6570 726f 6c61   valid inteprola
-00042b20: 7469 6f6e 206d 6574 686f 6422 2e66 6f72  tion method".for
-00042b30: 6d61 7428 695f 6d65 7468 6f64 2929 0d0a  mat(i_method))..
-00042b40: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-00042b50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00042b60: 696e 745f 6d65 7468 6f64 2069 6e20 2822  int_method in ("
-00042b70: 7367 7322 2c20 2266 6674 222c 2022 686f  sgs", "fft", "ho
-00042b80: 6d6f 6765 6e6f 7573 222c 2022 6d70 7322  mogenous", "mps"
-00042b90: 2c22 686f 6d6f 6765 6e6f 7573 5f75 6e69  ,"homogenous_uni
-00042ba0: 666f 726d 2229 3a0d 0a20 2020 2020 2020  form"):..       
-00042bb0: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
-00042bc0: 743d 5b69 6e74 5f6d 6574 686f 645d 2a6e  t=[int_method]*n
-00042bd0: 5f66 6163 6965 730d 0a20 2020 2020 2020  _facies..       
-00042be0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00042bf0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00042c00: 6520 5661 6c75 6545 7272 6f72 2822 7b7d  e ValueError("{}
-00042c10: 2069 7320 6e6f 7420 6120 7661 6c69 6420   is not a valid 
-00042c20: 696e 7465 7072 6f6c 6174 696f 6e20 6d65  inteprolation me
-00042c30: 7468 6f64 222e 666f 726d 6174 2869 5f6d  thod".format(i_m
-00042c40: 6574 686f 6429 290d 0a0d 0a20 2020 2020  ethod))....     
-00042c50: 2020 2073 656c 662e 6465 665f 6d65 616e     self.def_mean
-00042c60: 3d64 6566 5f6d 6561 6e0d 0a0d 0a20 2020  =def_mean....   
-00042c70: 2020 2020 2064 6566 205f 5f65 715f 5f28       def __eq__(
-00042c80: 7365 6c66 2c20 6f74 6865 7229 3a0d 0a20  self, other):.. 
-00042c90: 2020 2020 2020 2020 2020 2069 6620 2873             if (s
-00042ca0: 656c 662e 6e61 6d65 203d 3d20 6f74 6865  elf.name == othe
-00042cb0: 722e 6e61 6d65 293a 0d0a 2020 2020 2020  r.name):..      
-00042cc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00042cd0: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
-00042ce0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00042cf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00042d00: 2046 616c 7365 0d0a 0d0a 2020 2020 2020   False....      
-00042d10: 2020 6465 6620 5f5f 7265 7072 5f5f 2873    def __repr__(s
-00042d20: 656c 6629 3a0d 0a20 2020 2020 2020 2020  elf):..         
-00042d30: 2020 2072 6574 7572 6e20 7365 6c66 2e6e     return self.n
-00042d40: 616d 650d 0a0d 0a0d 0a20 2020 2064 6566  ame......    def
-00042d50: 2061 6464 5f68 6428 7365 6c66 2c20 782c   add_hd(self, x,
-00042d60: 7629 3a0d 0a0d 0a20 2020 2020 2020 2022  v):....        "
-00042d70: 2222 0d0a 2020 2020 2020 2020 6164 6420  ""..        add 
-00042d80: 6861 7264 2064 6174 6120 746f 2074 6865  hard data to the
-00042d90: 2070 726f 7065 7274 790d 0a0d 0a20 2020   property....   
-00042da0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00042db0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00042dc0: 2d2d 2d0d 0a20 2020 2020 2020 2078 203a  ---..        x :
-00042dd0: 206e 6461 7272 6179 206f 6620 7369 7a65   ndarray of size
-00042de0: 2028 6e2c 2032 202d 2d3e 2078 2c20 7929   (n, 2 --> x, y)
-00042df0: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
-00042e00: 7369 7469 6f6e 206f 6620 6861 7264 2064  sition of hard d
-00042e10: 6174 610d 0a20 2020 2020 2020 2076 203a  ata..        v :
-00042e20: 206e 6461 7272 6179 206f 6620 7369 7a65   ndarray of size
-00042e30: 2028 6e2c 2031 202d 2d3e 2076 616c 7565   (n, 1 --> value
-00042e40: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
-00042e50: 616c 7565 206f 6620 6861 7264 2064 6174  alue of hard dat
-00042e60: 610d 0a20 2020 2020 2020 2022 2222 0d0a  a..        """..
-00042e70: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-00042e80: 2078 2e73 6861 7065 5b31 5d20 3d3d 2033   x.shape[1] == 3
-00042e90: 2c20 2269 6e76 616c 6964 2073 6861 7065  , "invalid shape
-00042ea0: 2066 6f72 2068 6420 706f 7369 7469 6f6e   for hd position
-00042eb0: 2028 7829 2c20 6d75 7374 2062 6520 286e   (x), must be (n
-00042ec0: 6461 7461 2c20 3329 220d 0a20 2020 2020  data, 3)"..     
-00042ed0: 2020 2061 7373 6572 7420 762e 7368 6170     assert v.shap
-00042ee0: 655b 305d 203d 3d20 782e 7368 6170 655b  e[0] == x.shape[
-00042ef0: 305d 2c20 2269 6e76 616c 6964 206e 756d  0], "invalid num
-00042f00: 6265 7220 6f66 2064 6174 6120 706f 696e  ber of data poin
-00042f10: 7473 2062 6574 7765 656e 2076 2061 6e64  ts between v and
-00042f20: 2078 220d 0a0d 0a20 2020 2020 2020 2073   x"....        s
-00042f30: 656c 662e 783d 780d 0a20 2020 2020 2020  elf.x=x..       
-00042f40: 2073 656c 662e 763d 760d 0a0d 0a0d 0a63   self.v=v......c
-00042f50: 6c61 7373 2062 6f72 6568 6f6c 6528 293a  lass borehole():
-00042f60: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
-00042f70: 2043 6c61 7373 2074 6f20 6372 6561 7465   Class to create
-00042f80: 2061 2062 6f72 6568 6f6c 6520 6f62 6a65   a borehole obje
-00042f90: 6374 2e20 0d0a 2020 2020 426f 7265 686f  ct. ..    Boreho
-00042fa0: 6c65 2061 7265 2075 7365 6420 746f 2064  le are used to d
-00042fb0: 6566 696e 6520 7468 6520 6c69 7468 6f6c  efine the lithol
-00042fc0: 6f67 7920 616e 6420 6164 6420 636f 6e64  ogy and add cond
-00042fd0: 6974 696f 6e69 6e67 2064 6174 6120 696e  itioning data in
-00042fe0: 746f 2041 7263 6850 7920 6d6f 6465 6c73  to ArchPy models
-00042ff0: 0d0a 0d0a 2020 2020 5061 7261 6d65 7465  ....    Paramete
-00043000: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
-00043010: 2d2d 0d0a 2020 2020 6e61 6d65 203a 2073  --..    name : s
-00043020: 7472 696e 670d 0a20 2020 2020 2020 206e  tring..        n
-00043030: 616d 6520 6f66 2074 6865 2062 6f72 6568  ame of the boreh
-00043040: 6f6c 652c 206e 6f74 2075 7365 640d 0a20  ole, not used.. 
-00043050: 2020 2049 4420 3a20 696e 740d 0a20 2020     ID : int..   
-00043060: 2020 2020 2049 4420 6f66 2074 6865 2062       ID of the b
-00043070: 6f72 6568 6f6c 650d 0a20 2020 2078 2c20  orehole..    x, 
-00043080: 792c 207a 203a 2066 6c6f 6174 0d0a 2020  y, z : float..  
-00043090: 2020 2020 2020 782c 2079 2c20 7a20 636f        x, y, z co
-000430a0: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-000430b0: 2074 6f70 206f 6620 7468 6520 626f 7265   top of the bore
-000430c0: 686f 6c65 0d0a 2020 2020 6465 7074 6820  hole..    depth 
-000430d0: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
-000430e0: 2064 6570 7468 206f 6620 7468 6520 626f   depth of the bo
-000430f0: 7265 686f 6c65 0d0a 2020 2020 6c6f 675f  rehole..    log_
-00043100: 7374 7261 7469 203a 206c 6973 7420 6f66  strati : list of
-00043110: 2074 7570 6c65 730d 0a20 2020 2020 2020   tuples..       
-00043120: 206c 6f67 5f73 7472 6174 6920 636f 6e74   log_strati cont
-00043130: 6169 6e73 2074 6865 2067 656f 6c6f 6769  ains the geologi
-00043140: 6361 6c20 696e 666f 726d 6174 696f 6e20  cal information 
-00043150: 6162 6f75 7420 7468 6520 756e 6974 7320  about the units 
-00043160: 696e 2074 6865 2062 6f72 6568 6f6c 650d  in the borehole.
-00043170: 0a20 2020 2020 2020 2069 6e66 6f72 6d61  .        informa
-00043180: 7469 6f6e 2069 7320 6769 7665 6e20 6279  tion is given by
-00043190: 2069 6e74 6572 7661 6c73 206f 6620 7468   intervals of th
-000431a0: 6520 666f 726d 2028 7374 7261 7469 2c20  e form (strati, 
-000431b0: 746f 7029 2077 6865 7265 2073 7472 6174  top) where strat
-000431c0: 6920 6973 2061 203a 636c 6173 733a 6055  i is a :class:`U
-000431d0: 6e69 7460 206f 626a 6563 740d 0a20 2020  nit` object..   
-000431e0: 2020 2020 2061 6e64 2074 6f70 2069 7320       and top is 
-000431f0: 7468 6520 746f 7020 616c 7469 7475 6465  the top altitude
-00043200: 206f 6620 756e 6974 2069 6e74 6572 7661   of unit interva
-00043210: 6c0d 0a20 2020 206c 6f67 5f66 6163 6965  l..    log_facie
-00043220: 7320 3a20 6c69 7374 206f 6620 7475 706c  s : list of tupl
-00043230: 6573 0d0a 2020 2020 2020 2020 6c6f 675f  es..        log_
-00043240: 6661 6369 6573 2063 6f6e 7461 696e 7320  facies contains 
-00043250: 7468 6520 6661 6369 6573 2069 6e66 6f72  the facies infor
-00043260: 6d61 7469 6f6e 2061 626f 7574 2074 6865  mation about the
-00043270: 2062 6f72 6568 6f6c 650d 0a20 2020 2020   borehole..     
-00043280: 2020 2069 6e66 6f72 6d61 7469 6f6e 2069     information i
-00043290: 7320 6769 7665 6e20 6279 2069 6e74 6572  s given by inter
-000432a0: 7661 6c73 206f 6620 7468 6520 666f 726d  vals of the form
-000432b0: 2028 6661 6369 6573 2c20 746f 7029 2077   (facies, top) w
-000432c0: 6865 7265 2066 6163 6965 7320 6973 2061  here facies is a
-000432d0: 203a 636c 6173 733a 6046 6163 6965 7360   :class:`Facies`
-000432e0: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-000432f0: 2061 6e64 2074 6f70 2069 7320 7468 6520   and top is the 
-00043300: 746f 7020 616c 7469 7475 6465 206f 6620  top altitude of 
-00043310: 6661 6369 6573 2069 6e74 6572 7661 6c0d  facies interval.
-00043320: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
-00043330: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00043340: 662c 206e 616d 652c 2049 442c 2078 2c20  f, name, ID, x, 
-00043350: 792c 207a 2c20 6465 7074 682c 206c 6f67  y, z, depth, log
-00043360: 5f73 7472 6174 692c 206c 6f67 5f66 6163  _strati, log_fac
-00043370: 6965 733d 4e6f 6e65 293a 0d0a 0d0a 2020  ies=None):....  
-00043380: 2020 2020 2020 7365 6c66 2e6e 616d 653d        self.name=
-00043390: 6e61 6d65 2020 2320 6e61 6d65 206f 6620  name  # name of 
-000433a0: 6c69 7468 6f6c 6f67 790d 0a20 2020 2020  lithology..     
-000433b0: 2020 2073 656c 662e 4944 3d49 4420 2023     self.ID=ID  #
-000433c0: 2049 4420 6f66 2074 6865 2062 6f72 6568   ID of the boreh
-000433d0: 6f6c 6573 0d0a 2020 2020 2020 2020 7365  oles..        se
-000433e0: 6c66 2e78 3d78 2020 2320 7820 636f 6f72  lf.x=x  # x coor
-000433f0: 6469 6e61 7465 206f 6620 626f 7265 686f  dinate of boreho
-00043400: 6c65 0d0a 2020 2020 2020 2020 7365 6c66  le..        self
-00043410: 2e79 3d79 2020 2320 7920 636f 6f72 6469  .y=y  # y coordi
-00043420: 6e61 7465 206f 6620 626f 7265 686f 6c65  nate of borehole
-00043430: 0d0a 2020 2020 2020 2020 7365 6c66 2e7a  ..        self.z
-00043440: 3d7a 2020 2320 616c 7469 7475 6465 206f  =z  # altitude o
-00043450: 6620 7468 6520 6268 2028 63c3 b474 6520  f the bh (c..te 
-00043460: 7465 7272 6169 6e29 0d0a 2020 2020 2020  terrain)..      
-00043470: 2020 7365 6c66 2e64 6570 7468 3d64 6570    self.depth=dep
-00043480: 7468 0d0a 2020 2020 2020 2020 7365 6c66  th..        self
-00043490: 2e6c 6f67 5f73 7472 6174 693d 6c6f 675f  .log_strati=log_
-000434a0: 7374 7261 7469 0d0a 2020 2020 2020 2020  strati..        
-000434b0: 7365 6c66 2e6c 6f67 5f66 6163 6965 733d  self.log_facies=
-000434c0: 6c6f 675f 6661 6369 6573 0d0a 0d0a 2020  log_facies....  
-000434d0: 2020 2020 2020 6966 206c 6f67 5f73 7472        if log_str
-000434e0: 6174 6920 6973 206e 6f74 204e 6f6e 653a  ati is not None:
-000434f0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00043500: 6c66 2e6c 6973 745f 7374 7261 7469 733d  lf.list_stratis=
-00043510: 5b73 2066 6f72 2073 2c20 6420 696e 2073  [s for s, d in s
-00043520: 656c 662e 6c6f 675f 7374 7261 7469 5d0d  elf.log_strati].
-00043530: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00043540: 6c65 6e28 7365 6c66 2e6c 6973 745f 7374  len(self.list_st
-00043550: 7261 7469 7329 203d 3d20 303a 0d0a 2020  ratis) == 0:..  
-00043560: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00043570: 6c66 2e6c 6f67 5f73 7472 6174 693d 4e6f  lf.log_strati=No
-00043580: 6e65 0d0a 0d0a 2020 2020 2020 2020 6966  ne....        if
-00043590: 206c 6f67 5f66 6163 6965 7320 6973 206e   log_facies is n
-000435a0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-000435b0: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
-000435c0: 6661 6369 6573 203d 5b73 2066 6f72 2073  facies =[s for s
-000435d0: 2c20 6420 696e 2073 656c 662e 6c6f 675f  , d in self.log_
-000435e0: 6661 6369 6573 5d0d 0a20 2020 2020 2020  facies]..       
-000435f0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-00043600: 2e6c 6f67 5f66 6163 6965 7329 203d 3d20  .log_facies) == 
-00043610: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00043620: 2020 2020 7365 6c66 2e6c 6f67 5f66 6163      self.log_fac
-00043630: 6965 733d 4e6f 6e65 0d0a 0d0a 0d0a 2020  ies=None......  
-00043640: 2020 6465 6620 6765 745f 6c69 7374 5f73    def get_list_s
-00043650: 7472 6174 6973 2873 656c 6629 3a0d 0a20  tratis(self):.. 
-00043660: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
-00043670: 5f73 7472 6174 6973 3d5b 7320 666f 7220  _stratis=[s for 
-00043680: 732c 2064 2069 6e20 7365 6c66 2e6c 6f67  s, d in self.log
-00043690: 5f73 7472 6174 695d 0d0a 2020 2020 2020  _strati]..      
-000436a0: 2020 7265 7475 726e 2073 656c 662e 6c69    return self.li
-000436b0: 7374 5f73 7472 6174 6973 0d0a 0d0a 2020  st_stratis....  
-000436c0: 2020 6465 6620 6765 745f 6c69 7374 5f66    def get_list_f
-000436d0: 6163 6965 7328 7365 6c66 293a 0d0a 2020  acies(self):..  
-000436e0: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
-000436f0: 6661 6369 6573 203d 5b73 2066 6f72 2073  facies =[s for s
-00043700: 2c20 6420 696e 2073 656c 662e 6c6f 675f  , d in self.log_
-00043710: 6661 6369 6573 5d0d 0a20 2020 2020 2020  facies]..       
-00043720: 2072 6574 7572 6e20 7365 6c66 2e6c 6973   return self.lis
-00043730: 745f 6661 6369 6573 0d0a 0d0a 2020 2020  t_facies....    
-00043740: 6465 6620 5f5f 6571 5f5f 2873 656c 662c  def __eq__(self,
-00043750: 206f 7468 6572 293a 0d0a 2020 2020 2020   other):..      
-00043760: 2020 6966 2020 2873 656c 662e 4944 203d    if  (self.ID =
-00043770: 3d20 6f74 6865 722e 4944 2920 2620 5c0d  = other.ID) & \.
-00043780: 0a20 2020 2020 2020 2028 7365 6c66 2e78  .        (self.x
-00043790: 203d 3d20 6f74 6865 722e 7829 2026 2028   == other.x) & (
-000437a0: 7365 6c66 2e79 203d 3d20 6f74 6865 722e  self.y == other.
-000437b0: 7929 2026 2028 7365 6c66 2e7a 203d 3d20  y) & (self.z == 
-000437c0: 6f74 6865 722e 7a29 3a0d 0a20 2020 2020  other.z):..     
-000437d0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-000437e0: 7565 0d0a 2020 2020 2020 2020 656c 7365  ue..        else
-000437f0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00043800: 6574 7572 6e20 4661 6c73 650d 0a0d 0a20  eturn False.... 
-00043810: 2020 2064 6566 2070 726f 705f 756e 6974     def prop_unit
-00043820: 7328 7365 6c66 293a 0d0a 0d0a 2020 2020  s(self):....    
-00043830: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00043840: 2052 6574 7572 6e20 6120 6469 6374 696f   Return a dictio
-00043850: 6e6e 6172 7920 6f66 2074 6865 2070 726f  nnary of the pro
-00043860: 706f 7274 696f 6e20 6f66 2074 6865 2075  portion of the u
-00043870: 6e69 7473 2069 6e20 7468 6520 626f 7265  nits in the bore
-00043880: 686f 6c65 0d0a 2020 2020 2020 2020 2222  hole..        ""
-00043890: 220d 0a0d 0a20 2020 2020 2020 2064 203d  "....        d =
-000438a0: 207b 7d0d 0a0d 0a20 2020 2020 2020 2061   {}....        a
-000438b0: 6c74 5f70 7265 7620 3d20 7365 6c66 2e7a  lt_prev = self.z
-000438c0: 0d0a 2020 2020 2020 2020 756e 6974 5f70  ..        unit_p
-000438d0: 7265 7620 3d20 4e6f 6e65 0d0a 2020 2020  rev = None..    
-000438e0: 2020 2020 666f 7220 7320 696e 2073 656c      for s in sel
-000438f0: 662e 6c6f 675f 7374 7261 7469 3a0d 0a20  f.log_strati:.. 
-00043900: 2020 2020 2020 2020 2020 2069 6620 735b             if s[
-00043910: 305d 2069 7320 6e6f 7420 4e6f 6e65 3a0d  0] is not None:.
-00043920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043930: 2069 6620 735b 305d 2e6e 616d 6520 6e6f   if s[0].name no
-00043940: 7420 696e 2064 2e6b 6579 7328 293a 0d0a  t in d.keys():..
-00043950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043960: 2020 2020 645b 735b 305d 2e6e 616d 655d      d[s[0].name]
-00043970: 203d 2030 0d0a 2020 2020 2020 2020 2020   = 0..          
-00043980: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00043990: 2020 2020 2020 2020 6966 2075 6e69 745f          if unit_
-000439a0: 7072 6576 2069 7320 6e6f 7420 4e6f 6e65  prev is not None
-000439b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000439c0: 2020 2020 2020 2074 686b 203d 2075 6e69         thk = uni
-000439d0: 745f 7072 6576 5b31 5d20 2d20 735b 315d  t_prev[1] - s[1]
-000439e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000439f0: 2020 2020 2020 645b 756e 6974 5f70 7265        d[unit_pre
-00043a00: 765b 305d 2e6e 616d 655d 202b 3d20 7468  v[0].name] += th
-00043a10: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
-00043a20: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00043a30: 2020 2020 2020 2020 2075 6e69 745f 7072           unit_pr
-00043a40: 6576 203d 2073 0d0a 2020 2020 2020 2020  ev = s..        
-00043a50: 7468 6b20 3d20 756e 6974 5f70 7265 765b  thk = unit_prev[
-00043a60: 315d 202d 2028 7365 6c66 2e7a 202d 2073  1] - (self.z - s
-00043a70: 656c 662e 6465 7074 6829 0d0a 2020 2020  elf.depth)..    
-00043a80: 2020 2020 645b 756e 6974 5f70 7265 765b      d[unit_prev[
-00043a90: 305d 2e6e 616d 655d 202b 3d20 7468 6b20  0].name] += thk 
-00043aa0: 0d0a 0d0a 2020 2020 2020 2020 666f 7220  ....        for 
-00043ab0: 6b2c 7620 696e 2064 2e69 7465 6d73 2829  k,v in d.items()
-00043ac0: 3a20 2023 206d 6561 6e0d 0a20 2020 2020  :  # mean..     
-00043ad0: 2020 2020 2020 2064 5b6b 5d20 2f3d 2073         d[k] /= s
-00043ae0: 656c 662e 6465 7074 680d 0a0d 0a20 2020  elf.depth....   
-00043af0: 2020 2020 2072 6574 7572 6e20 640d 0a0d       return d...
-00043b00: 0a20 2020 2064 6566 2065 7874 7261 6374  .    def extract
-00043b10: 2873 656c 662c 207a 2c20 7662 3d31 293a  (self, z, vb=1):
-00043b20: 0d0a 0d0a 2020 2020 2020 2020 2222 2265  ....        """e
-00043b30: 7874 7261 6374 2074 6865 2075 6e69 7473  xtract the units
-00043b40: 2061 6e64 2066 6163 6965 7320 696e 666f   and facies info
-00043b50: 726d 6174 696f 6e20 6174 2073 7065 6369  rmation at speci
-00043b60: 6669 6564 2061 6c74 6974 7564 6520 7a22  fied altitude z"
-00043b70: 2222 0d0a 0d0a 2020 2020 2020 2020 6c73  ""....        ls
-00043b80: 3d46 616c 7365 0d0a 2020 2020 2020 2020  =False..        
-00043b90: 6c66 3d46 616c 7365 0d0a 2020 2020 2020  lf=False..      
-00043ba0: 2020 756e 6974 3d4e 6f6e 650d 0a20 2020    unit=None..   
-00043bb0: 2020 2020 2066 6163 6965 733d 4e6f 6e65       facies=None
-00043bc0: 0d0a 0d0a 2020 2020 2020 2020 6966 207a  ....        if z
-00043bd0: 203e 2073 656c 662e 7a20 6f72 207a 203c   > self.z or z <
-00043be0: 2073 656c 662e 7a20 2d20 7365 6c66 2e64   self.z - self.d
-00043bf0: 6570 7468 3a0d 0a20 2020 2020 2020 2020  epth:..         
-00043c00: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
-00043c10: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00043c20: 2822 626f 7265 686f 6c65 2068 6176 6520  ("borehole have 
-00043c30: 6e6f 2069 6e66 6f72 6d61 7469 6f6e 2061  no information a
-00043c40: 7420 7468 6973 2061 6c74 6974 7564 6522  t this altitude"
-00043c50: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00043c60: 6574 7572 6e20 4e6f 6e65 0d0a 0d0a 2020  eturn None....  
-00043c70: 2020 2020 2020 6966 2073 656c 662e 6c6f        if self.lo
-00043c80: 675f 7374 7261 7469 2069 7320 6e6f 7420  g_strati is not 
-00043c90: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00043ca0: 2020 206c 733d 5472 7565 0d0a 2020 2020     ls=True..    
-00043cb0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00043cc0: 2072 616e 6765 286c 656e 2873 656c 662e   range(len(self.
-00043cd0: 6c6f 675f 7374 7261 7469 2929 3a0d 0a20  log_strati)):.. 
-00043ce0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00043cf0: 6620 6920 3c20 6c65 6e28 7365 6c66 2e6c  f i < len(self.l
-00043d00: 6f67 5f73 7472 6174 6929 202d 2031 3a0d  og_strati) - 1:.
-00043d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043d20: 2020 2020 2073 3120 3d20 7365 6c66 2e6c       s1 = self.l
-00043d30: 6f67 5f73 7472 6174 695b 695d 0d0a 2020  og_strati[i]..  
-00043d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d50: 2020 7332 203d 2073 656c 662e 6c6f 675f    s2 = self.log_
-00043d60: 7374 7261 7469 5b69 2b31 5d0d 0a20 2020  strati[i+1]..   
-00043d70: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00043d80: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00043d90: 2020 2020 2020 2020 7331 203d 2073 656c          s1 = sel
-00043da0: 662e 6c6f 675f 7374 7261 7469 5b69 5d0d  f.log_strati[i].
-00043db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043dc0: 2020 2020 2073 3220 3d20 284e 6f6e 652c       s2 = (None,
-00043dd0: 2073 656c 662e 7a20 2d20 7365 6c66 2e64   self.z - self.d
-00043de0: 6570 7468 290d 0a20 2020 2020 2020 2020  epth)..         
-00043df0: 2020 2020 2020 2069 6620 7331 5b31 5d20         if s1[1] 
-00043e00: 3e3d 207a 2061 6e64 2073 325b 315d 203c  >= z and s2[1] <
-00043e10: 207a 3a0d 0a20 2020 2020 2020 2020 2020   z:..           
-00043e20: 2020 2020 2020 2020 2075 6e69 743d 7331           unit=s1
-00043e30: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-00043e40: 2020 2020 2020 2020 2062 7265 616b 0d0a           break..
-00043e50: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
-00043e60: 656c 662e 6c6f 675f 6661 6369 6573 2069  elf.log_facies i
-00043e70: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-00043e80: 2020 2020 2020 2020 206c 663d 5472 7565           lf=True
-00043e90: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00043ea0: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
-00043eb0: 2873 656c 662e 6c6f 675f 6661 6369 6573  (self.log_facies
-00043ec0: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00043ed0: 2020 2020 2069 6620 6920 3c20 6c65 6e28       if i < len(
-00043ee0: 7365 6c66 2e6c 6f67 5f66 6163 6965 7329  self.log_facies)
-00043ef0: 202d 2031 3a0d 0a20 2020 2020 2020 2020   - 1:..         
-00043f00: 2020 2020 2020 2020 2020 2066 3120 3d20             f1 = 
-00043f10: 7365 6c66 2e6c 6f67 5f66 6163 6965 735b  self.log_facies[
-00043f20: 695d 0d0a 2020 2020 2020 2020 2020 2020  i]..            
-00043f30: 2020 2020 2020 2020 6632 203d 2073 656c          f2 = sel
-00043f40: 662e 6c6f 675f 6661 6369 6573 5b69 2b31  f.log_facies[i+1
-00043f50: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00043f60: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00043f70: 2020 2020 2020 2020 2020 2020 2020 6631                f1
-00043f80: 203d 2073 656c 662e 6c6f 675f 6661 6369   = self.log_faci
-00043f90: 6573 5b69 5d0d 0a20 2020 2020 2020 2020  es[i]..         
-00043fa0: 2020 2020 2020 2020 2020 2066 3220 3d20             f2 = 
-00043fb0: 284e 6f6e 652c 2073 656c 662e 7a20 2d20  (None, self.z - 
-00043fc0: 7365 6c66 2e64 6570 7468 290d 0a20 2020  self.depth)..   
-00043fd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00043fe0: 6631 5b31 5d20 3e3d 207a 2061 6e64 2066  f1[1] >= z and f
-00043ff0: 325b 315d 203c 207a 3a0d 0a20 2020 2020  2[1] < z:..     
-00044000: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00044010: 6163 6965 733d 6631 5b30 5d0d 0a20 2020  acies=f1[0]..   
-00044020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044030: 2062 7265 616b 0d0a 2020 2020 2020 2020   break..        
-00044040: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
-00044050: 6966 206c 7320 616e 6420 6c66 3a0d 0a20  if ls and lf:.. 
-00044060: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00044070: 6e20 2875 6e69 742c 2066 6163 6965 7329  n (unit, facies)
-00044080: 0d0a 2020 2020 2020 2020 656c 6966 206c  ..        elif l
-00044090: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-000440a0: 7265 7475 726e 2075 6e69 740d 0a20 2020  return unit..   
-000440b0: 2020 2020 2065 6c69 6620 6c66 3a0d 0a20       elif lf:.. 
-000440c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000440d0: 6e20 6661 6369 6573 0d0a 0d0a 0d0a 636c  n facies......cl
-000440e0: 6173 7320 4765 6f6c 2829 3a0d 0a0d 0a20  ass Geol():.... 
-000440f0: 2020 2022 2222 0d0a 2020 2020 4172 6368     """..    Arch
-00044100: 5079 206f 7574 7075 7420 636c 6173 7320  Py output class 
-00044110: 7768 6963 6820 636f 6e74 6169 6e20 7468  which contain th
-00044120: 6520 7265 7375 6c74 7320 666f 7220 7468  e results for th
-00044130: 6520 6765 6f6c 6f67 6963 616c 2073 696d  e geological sim
-00044140: 756c 6174 696f 6e73 0d0a 2020 2020 2222  ulations..    ""
-00044150: 220d 0a0d 0a20 2020 2064 6566 205f 5f69  "....    def __i
-00044160: 6e69 745f 5f28 7365 6c66 293a 0d0a 0d0a  nit__(self):....
-00044170: 2020 2020 2020 2020 7365 6c66 2e73 7572          self.sur
-00044180: 6661 6365 733d 4e6f 6e65 0d0a 2020 2020  faces=None..    
-00044190: 2020 2020 7365 6c66 2e73 7572 6661 6365      self.surface
-000441a0: 735f 626f 743d 4e6f 6e65 0d0a 2020 2020  s_bot=None..    
-000441b0: 2020 2020 7365 6c66 2e6f 7267 5f73 7572      self.org_sur
-000441c0: 6661 6365 733d 4e6f 6e65 0d0a 2020 2020  faces=None..    
-000441d0: 2020 2020 7365 6c66 2e73 7572 6661 6365      self.surface
-000441e0: 735f 6279 5f70 696c 6573 3d7b 7d0d 0a20  s_by_piles={}.. 
-000441f0: 2020 2020 2020 2073 656c 662e 7375 7266         self.surf
-00044200: 6163 6573 5f62 6f74 5f62 795f 7069 6c65  aces_bot_by_pile
-00044210: 733d 7b7d 0d0a 2020 2020 2020 2020 7365  s={}..        se
-00044220: 6c66 2e6f 7267 5f73 7572 6661 6365 735f  lf.org_surfaces_
-00044230: 6279 5f70 696c 6573 3d7b 7d0d 0a         by_piles={}..
+00040bc0: 2020 2020 2020 2020 2020 2020 6661 6369              faci
+00040bd0: 6573 3d66 612e 4944 2a6e 702e 6f6e 6573  es=fa.ID*np.ones
+00040be0: 286e 6429 2320 6170 7065 6e64 2066 6163  (nd)# append fac
+00040bf0: 6965 7320 4944 730d 0a0d 0a20 2020 2020  ies IDs....     
+00040c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c10: 2020 2020 2020 2068 643d 6e70 2e63 6f6e         hd=np.con
+00040c20: 6361 7465 6e61 7465 285b 6864 2e72 6573  catenate([hd.res
+00040c30: 6861 7065 282d 312c 2036 292c 206e 702e  hape(-1, 6), np.
+00040c40: 636f 6e63 6174 656e 6174 6528 5b5b 6661  concatenate([[fa
+00040c50: 5f78 5d2c 205b 6661 5f79 5d2c 205b 6661  _x], [fa_y], [fa
+00040c60: 5f7a 5d2c 205b 6e70 2e7a 6572 6f73 286e  _z], [np.zeros(n
+00040c70: 6429 5d2c 205b 6e70 2e7a 6572 6f73 286e  d)], [np.zeros(n
+00040c80: 6429 5d2c 205b 6661 6369 6573 5d5d 2c20  d)], [facies]], 
+00040c90: 6178 6973 3d30 292e 545d 2920 2320 6170  axis=0).T]) # ap
+00040ca0: 7065 6e64 2064 6174 6120 666f 7220 696e  pend data for in
+00040cb0: 7075 7420 5450 4773 0d0a 0d0a 2020 2020  put TPGs....    
+00040cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040cd0: 2020 2020 6966 2068 642e 7368 6170 655b      if hd.shape[
+00040ce0: 305d 203d 3d20 303a 0d0a 2020 2020 2020  0] == 0:..      
+00040cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d00: 2020 2020 2020 6864 3d4e 6f6e 650d 0a20        hd=None.. 
+00040d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d20: 2020 2020 2020 2073 696d 7573 3d72 756e         simus=run
+00040d30: 5f74 7067 7328 6e72 6561 6c2c 2078 672c  _tpgs(nreal, xg,
+00040d40: 2079 672c 207a 672c 2068 642c 2047 5f63   yg, zg, hd, G_c
+00040d50: 6d2c 2066 6c61 672c 206e 6d61 783d 6b77  m, flag, nmax=kw
+00040d60: 6172 6773 5b22 6e65 6967 225d 2c20 6772  args["neig"], gr
+00040d70: 665f 6d65 7468 6f64 3d6b 7761 7267 735b  f_method=kwargs[
+00040d80: 2267 7266 5f6d 6574 686f 6422 5d2c 206d  "grf_method"], m
+00040d90: 6173 6b3d 6d61 736b 290d 0a20 2020 2020  ask=mask)..     
+00040da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040db0: 2020 2066 6f72 2069 7265 616c 2069 6e20     for ireal in 
+00040dc0: 7261 6e67 6528 6e72 6561 6c29 3a0d 0a20  range(nreal):.. 
+00040dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040de0: 2020 2020 2020 2020 2020 2067 7269 643d             grid=
+00040df0: 7369 6d75 735b 6972 6561 6c5d 0d0a 2020  simus[ireal]..  
+00040e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e10: 2020 2020 2020 2020 2020 6772 6964 5b6d            grid[m
+00040e20: 6173 6b3d 3d30 5d3d 6e70 2e6e 616e 2020  ask==0]=np.nan  
+00040e30: 2320 6578 7472 6163 7420 6f6e 6c79 2074  # extract only t
+00040e40: 6865 2070 6172 7420 6f6e 2074 6865 2072  he part on the r
+00040e50: 6561 6c20 646f 6d61 696e 0d0a 2020 2020  eal domain..    
+00040e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e70: 2020 2020 2020 2020 6661 6369 6573 5f64          facies_d
+00040e80: 6f6d 6169 6e73 5b69 752c 2069 7265 616c  omains[iu, ireal
+00040e90: 5d5b 6d61 736b 5d3d 6772 6964 5b6d 6173  ][mask]=grid[mas
+00040ea0: 6b5d 0d0a 0d0a 2020 2020 2020 2020 2020  k]....          
+00040eb0: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
+00040ec0: 6574 686f 6420 3d3d 2022 6e65 6172 6573  ethod == "neares
+00040ed0: 7422 3a0d 0a20 2020 2020 2020 2020 2020  t":..           
+00040ee0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00040ef0: 4172 6368 5461 626c 652e 7665 7262 6f73  ArchTable.verbos
+00040f00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00040f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f20: 7072 696e 7428 223c 3d3d 3d4e 6561 7265  print("<===Neare
+00040f30: 7374 206e 6569 6768 626f 7273 2069 6e74  st neighbors int
+00040f40: 6572 706f 6c61 7469 6f6e 3d3d 3d3e 2229  erpolation===>")
+00040f50: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00040f60: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+00040f70: 2073 6b6c 6561 726e 2e6e 6569 6768 626f   sklearn.neighbo
+00040f80: 7273 2069 6d70 6f72 7420 4e65 6172 6573  rs import Neares
+00040f90: 744e 6569 6768 626f 7273 0d0a 0d0a 2020  tNeighbors....  
+00040fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040fb0: 2020 2020 2020 5820 3d20 6e70 2e6f 6e65        X = np.one
+00040fc0: 7328 5b6e 7a2c 206e 792c 206e 785d 292a  s([nz, ny, nx])*
+00040fd0: 2041 7263 6854 6162 6c65 2e78 6763 0d0a   ArchTable.xgc..
+00040fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ff0: 2020 2020 2020 2020 5920 3d20 6e70 2e6f          Y = np.o
+00041000: 6e65 7328 5b6e 7a2c 206e 792c 206e 785d  nes([nz, ny, nx]
+00041010: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00041020: 2020 2020 2020 2020 2020 2059 5b3a 5d20             Y[:] 
+00041030: 3d20 6e70 2e6f 6e65 7328 5b6e 782c 206e  = np.ones([nx, n
+00041040: 795d 292e 5420 2a20 4172 6368 5461 626c  y]).T * ArchTabl
+00041050: 652e 7967 632e 7265 7368 6170 6528 2d31  e.ygc.reshape(-1
+00041060: 2c20 3129 0d0a 2020 2020 2020 2020 2020  , 1)..          
+00041070: 2020 2020 2020 2020 2020 2020 2020 5a20                Z 
+00041080: 3d20 6e70 2e6f 6e65 7328 5b6e 7a2c 206e  = np.ones([nz, n
+00041090: 792c 206e 785d 290d 0a20 2020 2020 2020  y, nx])..       
+000410a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000410b0: 205a 5b3a 2c20 3a5d 203d 2820 6e70 2e6f   Z[:, :] =( np.o
+000410c0: 6e65 7328 5b6e 7a2c 206e 785d 2920 2a20  nes([nz, nx]) * 
+000410d0: 4172 6368 5461 626c 652e 7a67 632e 7265  ArchTable.zgc.re
+000410e0: 7368 6170 6528 2d31 2c20 3129 292e 7265  shape(-1, 1)).re
+000410f0: 7368 6170 6528 6e7a 2c20 312c 206e 7829  shape(nz, 1, nx)
+00041100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041110: 2020 2020 2020 2020 2020 7875 3344 203d            xu3D =
+00041120: 206e 702e 6172 7261 7928 5b58 2e66 6c61   np.array([X.fla
+00041130: 7474 656e 2829 2c20 592e 666c 6174 7465  tten(), Y.flatte
+00041140: 6e28 292c 205a 2e66 6c61 7474 656e 2829  n(), Z.flatten()
+00041150: 5d29 2e54 0d0a 0d0a 2020 2020 2020 2020  ]).T....        
+00041160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041170: 2320 6765 7420 6861 7264 2064 6174 610d  # get hard data.
+00041180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041190: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+000411a0: 203d 3d20 2266 6163 6965 7322 3a0d 0a20   == "facies":.. 
+000411b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000411c0: 2020 2020 2020 2020 2020 2068 642c 2066             hd, f
+000411d0: 6163 6965 7320 3d20 4172 6368 5461 626c  acies = ArchTabl
+000411e0: 652e 6864 5f66 615f 696e 5f75 6e69 7428  e.hd_fa_in_unit(
+000411f0: 7365 6c66 2c20 6975 3d69 7529 0d0a 2020  self, iu=iu)..  
+00041200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041210: 2020 2020 2020 656c 6966 206d 6f64 6520        elif mode 
+00041220: 3d3d 2022 756e 6974 7322 3a0d 0a20 2020  == "units":..   
+00041230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041240: 2020 2020 2020 2020 2068 642c 2066 6163           hd, fac
+00041250: 6965 7320 3d20 4172 6368 5461 626c 652e  ies = ArchTable.
+00041260: 6864 5f75 6e5f 696e 5f75 6e69 7428 7365  hd_un_in_unit(se
+00041270: 6c66 2c20 6975 3d69 7529 0d0a 0d0a 2020  lf, iu=iu)....  
+00041280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041290: 2020 2020 2020 6864 3d6e 702e 6172 7261        hd=np.arra
+000412a0: 7928 6864 290d 0a20 2020 2020 2020 2020  y(hd)..         
+000412b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000412c0: 6163 6965 733d 6e70 2e61 7272 6179 2866  acies=np.array(f
+000412d0: 6163 6965 7329 0d0a 0d0a 2020 2020 2020  acies)....      
+000412e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000412f0: 2020 585f 6669 7420 3d20 6864 0d0a 2020    X_fit = hd..  
+00041300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041310: 2020 2020 2020 795f 6669 7420 3d20 6661        y_fit = fa
+00041320: 6369 6573 0d0a 0d0a 2020 2020 2020 2020  cies....        
+00041330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041340: 585f 7072 6564 203d 2078 7533 445b 6d61  X_pred = xu3D[ma
+00041350: 736b 2e66 6c61 7474 656e 2829 5d0d 0a0d  sk.flatten()]...
+00041360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041370: 2020 2020 2020 2020 2023 2066 6974 0d0a           # fit..
+00041380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041390: 2020 2020 2020 2020 6e6e 203d 204e 6561          nn = Nea
+000413a0: 7265 7374 4e65 6967 6862 6f72 7328 6e5f  restNeighbors(n_
+000413b0: 6e65 6967 6862 6f72 733d 3129 2e66 6974  neighbors=1).fit
+000413c0: 2858 5f66 6974 290d 0a0d 0a20 2020 2020  (X_fit)....     
+000413d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000413e0: 2020 2023 7072 6564 0d0a 2020 2020 2020     #pred..      
+000413f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041400: 2020 7265 7320 3d20 6e6e 2e6b 6e65 6967    res = nn.kneig
+00041410: 6862 6f72 7328 585f 7072 6564 2c20 7265  hbors(X_pred, re
+00041420: 7475 726e 5f64 6973 7461 6e63 653d 4661  turn_distance=Fa
+00041430: 6c73 652c 206e 5f6e 6569 6768 626f 7273  lse, n_neighbors
+00041440: 3d31 290d 0a0d 0a20 2020 2020 2020 2020  =1)....         
+00041450: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00041460: 2061 7373 6967 6e0d 0a20 2020 2020 2020   assign..       
+00041470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041480: 2079 5f70 7265 6420 3d20 795f 6669 745b   y_pred = y_fit[
+00041490: 7265 735d 0d0a 2020 2020 2020 2020 2020  res]..          
+000414a0: 2020 2020 2020 2020 2020 2020 2020 7369                si
+000414b0: 6d75 7320 3d20 6e70 2e7a 6572 6f73 285b  mus = np.zeros([
+000414c0: 6e7a 2c20 6e79 2c20 6e78 5d29 0d0a 2020  nz, ny, nx])..  
+000414d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000414e0: 2020 2020 2020 7369 6d75 735b 6d61 736b        simus[mask
+000414f0: 5d20 3d20 795f 7072 6564 5b3a 2c20 305d  ] = y_pred[:, 0]
+00041500: 2020 2320 7265 6173 7369 676e 2076 616c    # reassign val
+00041510: 7565 730d 0a0d 0a20 2020 2020 2020 2020  ues....         
+00041520: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00041530: 6f72 2069 7265 616c 2069 6e20 7261 6e67  or ireal in rang
+00041540: 6528 6e72 6561 6c29 3a0d 0a20 2020 2020  e(nreal):..     
+00041550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041560: 2020 2020 2020 2066 6163 6965 735f 646f         facies_do
+00041570: 6d61 696e 735b 6975 2c20 6972 6561 6c5d  mains[iu, ireal]
+00041580: 5b6d 6173 6b5d 3d73 696d 7573 5b6d 6173  [mask]=simus[mas
+00041590: 6b5d 0d0a 0d0a 0d0a 2020 2020 2020 2020  k]......        
+000415a0: 2020 2020 2020 2020 6966 206d 6f64 6520          if mode 
+000415b0: 3d3d 2022 6661 6369 6573 223a 0d0a 2020  == "facies":..  
+000415c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000415d0: 2020 4172 6368 5461 626c 652e 4765 6f6c    ArchTable.Geol
+000415e0: 2e66 6163 6965 735f 646f 6d61 696e 735b  .facies_domains[
+000415f0: 6975 2c3a 2c20 6d61 736b 5d3d 6661 6369  iu,:, mask]=faci
+00041600: 6573 5f64 6f6d 6169 6e73 5b69 752c 3a2c  es_domains[iu,:,
+00041610: 206d 6173 6b5d 2020 2320 7374 6f72 6520   mask]  # store 
+00041620: 7265 7375 6c74 730d 0a20 2020 2020 2020  results..       
+00041630: 2020 2020 2020 2020 2065 6c69 6620 6d6f           elif mo
+00041640: 6465 203d 3d20 2275 6e69 7473 223a 0d0a  de == "units":..
+00041650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041660: 2020 2020 4172 6368 5461 626c 652e 4765      ArchTable.Ge
+00041670: 6f6c 2e75 6e69 7473 5f64 6f6d 6169 6e73  ol.units_domains
+00041680: 5b69 752c 206d 6173 6b5d 203d 2066 6163  [iu, mask] = fac
+00041690: 6965 735f 646f 6d61 696e 735b 6975 2c20  ies_domains[iu, 
+000416a0: 302c 206d 6173 6b5d 2020 2320 7374 6f72  0, mask]  # stor
+000416b0: 6520 7265 7375 6c74 730d 0a20 2020 2020  e results..     
+000416c0: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
+000416d0: 3d20 2253 7562 5069 6c65 223a 2023 2048  = "SubPile": # H
+000416e0: 6965 7261 7263 6869 6361 6c20 6669 6c6c  ierarchical fill
+000416f0: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
+00041700: 2069 6620 4172 6368 5461 626c 652e 7665   if ArchTable.ve
+00041710: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
+00041720: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
+00041730: 7562 5069 6c65 2066 696c 6c69 6e67 206d  ubPile filling m
+00041740: 6574 686f 642c 206e 6f74 6869 6e67 2068  ethod, nothing h
+00041750: 6170 7065 6e65 6422 290d 0a20 2020 2020  appened")..     
+00041760: 2020 2020 2020 2070 6173 730d 0a0d 0a0d         pass.....
+00041770: 0a63 6c61 7373 2053 7572 6661 6365 2829  .class Surface()
+00041780: 3a0d 0a0d 0a20 2020 2022 2222 0d0a 2020  :....    """..  
+00041790: 2020 436c 6173 7320 5375 7266 6163 652c    Class Surface,
+000417a0: 206d 7573 7420 6265 206c 696e 6b65 6420   must be linked 
+000417b0: 746f 2061 203a 636c 6173 733a 6055 6e69  to a :class:`Uni
+000417c0: 7460 206f 626a 6563 740d 0a0d 0a20 2020  t` object....   
+000417d0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+000417e0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+000417f0: 206e 616d 6520 3a20 7374 7269 6e67 0d0a   name : string..
+00041800: 2020 2020 2020 2020 746f 2069 6465 6e74          to ident
+00041810: 6966 7920 7468 6520 7375 7266 6163 6520  ify the surface 
+00041820: 666f 7220 6465 6275 6767 696e 6720 7075  for debugging pu
+00041830: 7270 6f73 650d 0a20 2020 2063 6f6e 7461  rpose..    conta
+00041840: 6374 203a 2073 7472 696e 670d 0a20 2020  ct : string..   
+00041850: 2020 2020 206f 6e6c 6170 206f 7220 6572       onlap or er
+00041860: 6f64 652e 204f 6e6c 6170 2069 6e64 6963  ode. Onlap indic
+00041870: 6174 6573 2074 6861 7420 7468 6973 2073  ates that this s
+00041880: 7572 6661 6365 2063 616e 6e6f 7420 6572  urface cannot er
+00041890: 6f64 6520 6f6c 6465 7220 7375 7266 6163  ode older surfac
+000418a0: 6573 2c0d 0a20 2020 2020 2020 206f 6e20  es,..        on 
+000418b0: 636f 6e74 7261 7279 2074 6f20 6572 6f64  contrary to erod
+000418c0: 6520 7375 7266 6163 6573 0d0a 2020 2020  e surfaces..    
+000418d0: 6469 635f 7375 7266 203a 2064 6963 740d  dic_surf : dict.
+000418e0: 0a20 2020 2020 2020 2070 6172 616d 6574  .        paramet
+000418f0: 6572 7320 666f 7220 7375 7266 6163 6520  ers for surface 
+00041900: 696e 7465 7270 6f6c 6174 696f 6e3a 0d0a  interpolation:..
+00041910: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+00041920: 696e 745f 6d65 7468 6f64 203a 2073 7472  int_method : str
+00041930: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
+00041940: 2020 2020 206d 6574 686f 6420 6f66 2069       method of i
+00041950: 6e74 6572 706f 6c61 7469 6f6e 2c20 706f  nterpolation, po
+00041960: 7373 6962 6c65 206d 6574 686f 6473 2061  ssible methods a
+00041970: 7265 3a0d 0a20 2020 2020 2020 2020 2020  re:..           
+00041980: 2020 2020 206b 7269 6769 6e67 2c20 4d50       kriging, MP
+00041990: 532c 2067 7266 2c20 6772 665f 696e 6571  S, grf, grf_ineq
+000419a0: 2c20 6c69 6e65 6172 2c20 6e65 6172 6573  , linear, neares
+000419b0: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+000419c0: 2d20 636f 766d 6f64 656c 203a 2073 7472  - covmodel : str
+000419d0: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
+000419e0: 2020 2020 2067 656f 6e65 2063 6f76 6172       geone covar
+000419f0: 6961 6e63 6520 6d6f 6465 6c20 2873 6565  iance model (see
+00041a00: 2064 6f63 2047 656f 6e65 2066 6f72 206d   doc Geone for m
+00041a10: 6f72 6520 696e 666f 726d 6174 696f 6e29  ore information)
+00041a20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041a30: 2020 6966 2061 206d 756c 7469 2d67 6175    if a multi-gau
+00041a40: 7373 6961 6e20 6d65 7468 6f64 2069 7320  ssian method is 
+00041a50: 7573 6564 0d0a 2020 2020 2020 2020 2020  used..          
+00041a60: 2020 2d20 4e5f 7472 616e 7366 6f20 3a20    - N_transfo : 
+00041a70: 626f 6f6c 0d0a 2020 2020 2020 2020 2020  bool..          
+00041a80: 2020 2020 2020 4e6f 726d 616c 2d73 636f        Normal-sco
+00041a90: 7265 2074 7261 6e73 666f 726d 2e20 466c  re transform. Fl
+00041aa0: 6167 2074 6f20 6170 706c 7920 6f72 206e  ag to apply or n
+00041ab0: 6f74 2061 204e 6f72 6d61 6c20 5363 6f72  ot a Normal Scor
+00041ac0: 6520 6f6e 2074 6865 2064 6174 6120 666f  e on the data fo
+00041ad0: 7220 7468 6520 696e 7465 7270 6f6c 6174  r the interpolat
+00041ae0: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
+00041af0: 202d 2055 6e69 7473 206b 7761 7267 7320   - Units kwargs 
+00041b00: 2028 7061 7373 6564 2069 6e20 6469 635f   (passed in dic_
+00041b10: 7375 7266 2064 6972 6563 746c 7929 3a0d  surf directly):.
+00041b20: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
+00041b30: 6f72 2074 6865 2073 6561 7263 6820 656c  or the search el
+00041b40: 6c69 7073 6f69 6420 286b 7269 6769 6e67  lipsoid (kriging
+00041b50: 2c20 6772 662c 202e 2e2e 293a 0d0a 2020  , grf, ...):..  
+00041b60: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00041b70: 2020 2020 2020 2020 2020 2020 2d20 722c              - r,
+00041b80: 2072 656c 6174 6976 6520 2874 6f20 636f   relative (to co
+00041b90: 7661 7269 616e 6365 206d 6f64 656c 2920  variance model) 
+00041ba0: 7261 6469 7573 206f 6620 7265 7365 6172  radius of resear
+00041bb0: 6368 2028 6465 6661 756c 7420 6973 2031  ch (default is 1
+00041bc0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00041bd0: 2020 202d 206e 6569 672c 206e 756d 6265     - neig, numbe
+00041be0: 7220 6f66 206e 6569 6768 626f 7572 730d  r of neighbours.
+00041bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041c00: 202d 206b 7269 675f 7479 7065 3a20 7374   - krig_type: st
+00041c10: 7269 6e67 2c20 6b72 6967 696e 6720 6d65  ring, kriging me
+00041c20: 7468 6f64 2028 6f72 6469 6e61 7279 5f6b  thod (ordinary_k
+00041c30: 7269 6769 6e67 2c20 7369 6d70 6c65 5f6b  riging, simple_k
+00041c40: 7269 6769 6e67 290d 0a20 2020 2020 2020  riging)..       
+00041c50: 2020 2020 2066 6f72 204d 5053 3a0d 0a20       for MPS:.. 
+00041c60: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00041c70: 2020 2020 2020 2020 2020 2020 202d 2054               - T
+00041c80: 490d 0a20 2020 2020 2020 2020 2020 2020  I..             
+00041c90: 2020 202d 2076 6172 696f 7573 204d 5053     - various MPS
+00041ca0: 2070 6172 616d 6574 6572 732c 2073 6565   parameters, see
+00041cb0: 2067 656f 6e65 2064 6f63 756d 656e 7461   geone documenta
+00041cc0: 7469 6f6e 0d0a 0d0a 2020 2020 2222 220d  tion....    """.
+00041cd0: 0a0d 0a20 2020 2064 6566 205f 5f69 6e69  ...    def __ini
+00041ce0: 745f 5f28 7365 6c66 2c20 6e61 6d65 3d22  t__(self, name="
+00041cf0: 5375 7266 6163 655f 3122 2c0d 0a20 2020  Surface_1",..   
+00041d00: 2020 2020 2020 2020 2020 2020 2064 6963               dic
+00041d10: 5f73 7572 663d 7b22 696e 745f 6d65 7468  _surf={"int_meth
+00041d20: 6f64 223a 2022 6e65 6172 6573 7422 2c20  od": "nearest", 
+00041d30: 2263 6f76 6d6f 6465 6c22 3a20 4e6f 6e65  "covmodel": None
+00041d40: 2c20 224e 5f74 7261 6e73 666f 223a 2046  , "N_transfo": F
+00041d50: 616c 7365 7d2c 0d0a 2020 2020 2020 2020  alse},..        
+00041d60: 2020 2020 2020 2020 636f 6e74 6163 743d          contact=
+00041d70: 226f 6e6c 6170 2229 3a0d 0a0d 0a20 2020  "onlap"):....   
+00041d80: 2020 2020 2061 7373 6572 7420 636f 6e74       assert cont
+00041d90: 6163 7420 696e 205b 2265 726f 6465 222c  act in ["erode",
+00041da0: 2022 6f6e 6c61 7022 2c20 2263 6f6d 6622   "onlap", "comf"
+00041db0: 5d2c 2022 636f 6e74 6163 7420 6d75 7374  ], "contact must
+00041dc0: 2062 6520 6572 6f64 6520 6f72 206f 6e6c   be erode or onl
+00041dd0: 6170 206f 7220 636f 6d66 220d 0a20 2020  ap or comf"..   
+00041de0: 2020 2020 2061 7373 6572 7420 6469 635f       assert dic_
+00041df0: 7375 7266 5b22 696e 745f 6d65 7468 6f64  surf["int_method
+00041e00: 225d 2069 7320 6e6f 7420 4e6f 6e65 2c20  "] is not None, 
+00041e10: 2241 6e20 696e 7465 7270 6f6c 6174 696f  "An interpolatio
+00041e20: 6e20 6d65 7468 6f64 206d 7573 7420 6265  n method must be
+00041e30: 2070 726f 7669 6465 6422 0d0a 2020 2020   provided"..    
+00041e40: 2020 2020 6173 7365 7274 2064 6963 5f73      assert dic_s
+00041e50: 7572 665b 2269 6e74 5f6d 6574 686f 6422  urf["int_method"
+00041e60: 5d20 696e 205b 226c 696e 6561 7222 2c20  ] in ["linear", 
+00041e70: 2263 7562 6963 222c 2022 6e65 6172 6573  "cubic", "neares
+00041e80: 7422 2c20 226b 7269 6769 6e67 222c 2022  t", "kriging", "
+00041e90: 6772 6622 2c20 2267 7266 5f69 6e65 7122  grf", "grf_ineq"
+00041ea0: 2c20 224d 5053 225d 2c20 2255 6e6b 6e6f  , "MPS"], "Unkno
+00041eb0: 776e 2069 6e74 6572 706f 6c61 7469 6f6e  wn interpolation
+00041ec0: 206d 6574 686f 6422 0d0a 0d0a 2020 2020   method"....    
+00041ed0: 2020 2020 2364 6566 6175 6c74 2076 616c      #default val
+00041ee0: 7565 7320 6469 6320 7375 7266 0d0a 2020  ues dic surf..  
+00041ef0: 2020 2020 2020 6b77 6172 6773 5f64 6566        kwargs_def
+00041f00: 5f73 7572 6661 6365 3d7b 2263 6f76 6d6f  _surface={"covmo
+00041f10: 6465 6c22 3a20 4e6f 6e65 2c20 224e 5f74  del": None, "N_t
+00041f20: 7261 6e73 666f 223a 2046 616c 7365 2c20  ransfo": False, 
+00041f30: 2262 616e 6477 6964 7468 5f6d 756c 7422  "bandwidth_mult"
+00041f40: 3a20 312c 2022 7461 7522 3a20 307d 0d0a  : 1, "tau": 0}..
+00041f50: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+00041f60: 2069 6e20 6b77 6172 6773 5f64 6566 5f73   in kwargs_def_s
+00041f70: 7572 6661 6365 2e69 7465 6d73 2829 3a0d  urface.items():.
+00041f80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00041f90: 6b20 6e6f 7420 696e 2064 6963 5f73 7572  k not in dic_sur
+00041fa0: 662e 6b65 7973 2829 3a0d 0a20 2020 2020  f.keys():..     
+00041fb0: 2020 2020 2020 2020 2020 2064 6963 5f73             dic_s
+00041fc0: 7572 665b 6b5d 3d76 0d0a 0d0a 2020 2020  urf[k]=v....    
+00041fd0: 2020 2020 7365 6c66 2e6e 616d 653d 6e61      self.name=na
+00041fe0: 6d65 0d0a 2020 2020 2020 2020 7365 6c66  me..        self
+00041ff0: 2e78 3d5b 5d0d 0a20 2020 2020 2020 2073  .x=[]..        s
+00042000: 656c 662e 793d 5b5d 0d0a 2020 2020 2020  elf.y=[]..      
+00042010: 2020 7365 6c66 2e7a 3d5b 5d0d 0a20 2020    self.z=[]..   
+00042020: 2020 2020 2073 656c 662e 696e 6571 3d5b       self.ineq=[
+00042030: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+00042040: 696e 745f 6d65 7468 6f64 3d64 6963 5f73  int_method=dic_s
+00042050: 7572 665b 2269 6e74 5f6d 6574 686f 6422  urf["int_method"
+00042060: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+00042070: 4e5f 7472 616e 7366 6f3d 6469 635f 7375  N_transfo=dic_su
+00042080: 7266 5b22 4e5f 7472 616e 7366 6f22 5d0d  rf["N_transfo"].
+00042090: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+000420a0: 766d 6f64 656c 3d64 6963 5f73 7572 665b  vmodel=dic_surf[
+000420b0: 2263 6f76 6d6f 6465 6c22 5d0d 0a20 2020  "covmodel"]..   
+000420c0: 2020 2020 2073 656c 662e 636f 6e74 6163       self.contac
+000420d0: 743d 636f 6e74 6163 740d 0a0d 0a20 2020  t=contact....   
+000420e0: 2020 2020 2023 6368 6563 6b20 696e 7075       #check inpu
+000420f0: 7473 2066 6f72 2073 7572 6661 6365 206d  ts for surface m
+00042100: 6574 686f 6473 0d0a 2020 2020 2020 2020  ethods..        
+00042110: 6966 2073 656c 662e 696e 745f 6d65 7468  if self.int_meth
+00042120: 6f64 2069 6e20 5b22 6b72 6967 696e 6722  od in ["kriging"
+00042130: 2c20 2267 7266 222c 2022 6772 665f 696e  , "grf", "grf_in
+00042140: 6571 225d 3a0d 0a20 2020 2020 2020 2020  eq"]:..         
+00042150: 2020 2073 656c 662e 6765 745f 7375 7266     self.get_surf
+00042160: 6163 655f 636f 766d 6f64 656c 2829 0d0a  ace_covmodel()..
+00042170: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00042180: 662e 636f 766d 6f64 656c 2069 7320 6e6f  f.covmodel is no
+00042190: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
+000421a0: 4e5f 7472 616e 7366 6f20 616e 6420 7365  N_transfo and se
+000421b0: 6c66 2e69 6e74 5f6d 6574 686f 6420 696e  lf.int_method in
+000421c0: 205b 226b 7269 6769 6e67 222c 2022 6772   ["kriging", "gr
+000421d0: 6622 2c20 2267 7266 5f69 6e65 7122 5d3a  f", "grf_ineq"]:
+000421e0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000421f0: 2073 656c 662e 6765 745f 7375 7266 6163   self.get_surfac
+00042200: 655f 636f 766d 6f64 656c 2829 2e73 696c  e_covmodel().sil
+00042210: 6c28 2920 213d 2031 3a0d 0a20 2020 2020  l() != 1:..     
+00042220: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00042230: 2822 556e 6974 207b 7d3a 2021 2120 4e6f  ("Unit {}: !! No
+00042240: 726d 616c 2074 7261 6e73 666f 726d 6174  rmal transformat
+00042250: 696f 6e20 6973 2061 7070 6c69 6564 2062  ion is applied b
+00042260: 7574 2074 6865 2076 6172 6961 6e63 6520  ut the variance 
+00042270: 6f66 2074 6865 2043 6f76 6172 6961 6e63  of the Covarianc
+00042280: 6520 6d6f 6465 6c20 6973 206e 6f74 2065  e model is not e
+00042290: 7175 616c 2074 6f20 3120 2121 222e 666f  qual to 1 !!".fo
+000422a0: 726d 6174 2873 656c 662e 6e61 6d65 2929  rmat(self.name))
+000422b0: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+000422c0: 2e64 6963 5f73 7572 663d 6469 635f 7375  .dic_surf=dic_su
+000422d0: 7266 0d0a 0d0a 2020 2020 6465 6620 636f  rf....    def co
+000422e0: 7079 2873 656c 6629 3a0d 0a20 2020 2020  py(self):..     
+000422f0: 2020 2072 6574 7572 6e20 636f 7079 2e64     return copy.d
+00042300: 6565 7063 6f70 7928 7365 6c66 290d 0a0d  eepcopy(self)...
+00042310: 0a20 2020 2064 6566 2073 6574 5f63 6f76  .    def set_cov
+00042320: 6d6f 6465 6c28 7365 6c66 2c20 636f 766d  model(self, covm
+00042330: 6f64 656c 293a 0d0a 0d0a 2020 2020 2020  odel):....      
+00042340: 2020 2222 220d 0a20 2020 2020 2020 2063    """..        c
+00042350: 6861 6e67 6520 6f72 2061 6464 2061 2063  hange or add a c
+00042360: 6f76 6d6f 6465 6c20 666f 7220 7375 7266  ovmodel for surf
+00042370: 6163 6520 696e 7465 7270 6f6c 6174 696f  ace interpolatio
+00042380: 6e20 6f66 2073 656c 6620 756e 6974 2e0d  n of self unit..
+00042390: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+000423a0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+000423b0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+000423c0: 2020 2063 6f76 6d6f 6465 6c20 3a20 6765     covmodel : ge
+000423d0: 6f6e 652e 636f 764d 6f64 656c 2e43 6f76  one.covModel.Cov
+000423e0: 4d6f 6465 6c32 440d 0a20 2020 2020 2020  Model2D..       
+000423f0: 2020 2020 2063 6f76 6172 6961 6e63 6520       covariance 
+00042400: 6d6f 6465 6c20 746f 2062 6520 7573 6564  model to be used
+00042410: 2066 6f72 2073 7572 6661 6365 2069 6e74   for surface int
+00042420: 6572 706f 6c61 7469 6f6e 0d0a 2020 2020  erpolation..    
+00042430: 2020 2020 2020 2020 6966 2074 6865 2063          if the c
+00042440: 686f 7365 6e20 6d65 7468 6f64 2069 7320  hosen method is 
+00042450: 6772 662c 2067 7266 2069 6e65 7120 6f72  grf, grf ineq or
+00042460: 206b 7269 6769 6e67 0d0a 2020 2020 2020   kriging..      
+00042470: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+00042480: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+00042490: 6f76 6d6f 6465 6c2c 2067 656f 6e65 2e63  ovmodel, geone.c
+000424a0: 6f76 4d6f 6465 6c2e 436f 764d 6f64 656c  ovModel.CovModel
+000424b0: 3244 293a 0d0a 2020 2020 2020 2020 2020  2D):..          
+000424c0: 2020 7365 6c66 2e63 6f76 6d6f 6465 6c3d    self.covmodel=
+000424d0: 636f 766d 6f64 656c 0d0a 2020 2020 2020  covmodel..      
+000424e0: 2020 2020 2020 2320 7365 6c66 2e64 6963        # self.dic
+000424f0: 5f73 7572 665b 2263 6f76 6d6f 6465 6c22  _surf["covmodel"
+00042500: 5d3d 636f 766d 6f64 656c 0d0a 2020 2020  ]=covmodel..    
+00042510: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
+00042520: 7572 6661 6365 207b 7d3a 2063 6f76 6d6f  urface {}: covmo
+00042530: 6465 6c20 6164 6465 6422 2e66 6f72 6d61  del added".forma
+00042540: 7428 7365 6c66 2e6e 616d 6529 290d 0a20  t(self.name)).. 
+00042550: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00042560: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00042570: 2253 7572 6661 6365 207b 7d3a 2063 6f76  "Surface {}: cov
+00042580: 6d6f 6465 6c20 6e6f 7420 6120 6765 6f6e  model not a geon
+00042590: 6520 3244 2063 6f76 6d6f 6465 6c22 2e66  e 2D covmodel".f
+000425a0: 6f72 6d61 7428 7365 6c66 2e6e 616d 6529  ormat(self.name)
+000425b0: 290d 0a0d 0a20 2020 2064 6566 2067 6574  )....    def get
+000425c0: 5f73 7572 6661 6365 5f63 6f76 6d6f 6465  _surface_covmode
+000425d0: 6c28 7365 6c66 2c20 7662 3d31 293a 0d0a  l(self, vb=1):..
+000425e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000425f0: 636f 766d 6f64 656c 2069 7320 4e6f 6e65  covmodel is None
+00042600: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00042610: 6620 7662 3a0d 0a20 2020 2020 2020 2020  f vb:..         
+00042620: 2020 2020 2020 2070 7269 6e74 2028 2257         print ("W
+00042630: 6172 6e69 6e67 3a20 556e 6974 2027 7b7d  arning: Unit '{}
+00042640: 2720 6861 7665 206e 6f20 436f 766d 6f64  ' have no Covmod
+00042650: 656c 2066 6f72 2073 7572 6661 6365 2069  el for surface i
+00042660: 6e74 6572 706f 6c61 7469 6f6e 222e 666f  nterpolation".fo
+00042670: 726d 6174 2873 656c 662e 6e61 6d65 2929  rmat(self.name))
+00042680: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00042690: 7475 726e 204e 6f6e 650d 0a20 2020 2020  turn None..     
+000426a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000426b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000426c0: 662e 636f 766d 6f64 656c 0d0a 0d0a 636c  f.covmodel....cl
+000426d0: 6173 7320 4661 6369 6573 2829 3a0d 0a0d  ass Facies():...
+000426e0: 0a20 2020 2022 2222 0d0a 2020 2020 636c  .    """..    cl
+000426f0: 6173 7320 666f 7220 6661 6369 6573 2028  ass for facies (
+00042700: 326e 6420 6c65 7665 6c20 6f66 2068 6965  2nd level of hie
+00042710: 7261 7263 6879 290d 0a0d 0a20 2020 2050  rarchy)....    P
+00042720: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
+00042730: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2049  ---------..    I
+00042740: 4420 3a20 696e 740d 0a20 2020 2020 2020  D : int..       
+00042750: 2066 6163 6965 7320 4944 2074 6861 7420   facies ID that 
+00042760: 6973 2075 7365 6420 696e 2074 6865 2072  is used in the r
+00042770: 6573 756c 7473 0d0a 2020 2020 6e61 6d65  esults..    name
+00042780: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
+00042790: 2020 2066 6163 6965 7320 6e61 6d65 2c20     facies name, 
+000427a0: 7573 6564 2061 7320 616e 2069 6465 6e74  used as an ident
+000427b0: 6966 6965 720d 0a20 2020 2063 6f6c 6f72  ifier..    color
+000427c0: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
+000427d0: 2020 2063 6f6c 6f72 206f 6620 7468 6520     color of the 
+000427e0: 6661 6369 6573 2c20 7573 6564 2066 6f72  facies, used for
+000427f0: 2070 6c6f 7474 696e 670d 0a20 2020 2022   plotting..    "
+00042800: 2222 0d0a 0d0a 2020 2020 6465 6620 5f5f  ""....    def __
+00042810: 696e 6974 5f5f 2873 656c 662c 2049 442c  init__(self, ID,
+00042820: 206e 616d 652c 2063 6f6c 6f72 293a 0d0a   name, color):..
+00042830: 0d0a 2020 2020 2020 2020 7365 6c66 2e78  ..        self.x
+00042840: 3d5b 5d0d 0a20 2020 2020 2020 2073 656c  =[]..        sel
+00042850: 662e 793d 5b5d 0d0a 2020 2020 2020 2020  f.y=[]..        
+00042860: 7365 6c66 2e7a 3d5b 5d0d 0a20 2020 2020  self.z=[]..     
+00042870: 2020 2069 6620 4944 2021 3d20 303a 0d0a     if ID != 0:..
+00042880: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00042890: 2e49 443d 4944 0d0a 2020 2020 2020 2020  .ID=ID..        
+000428a0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000428b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000428c0: 726f 7228 2249 4420 6661 6369 6573 2063  ror("ID facies c
+000428d0: 616e 6e6f 7420 6265 2065 7175 616c 2074  annot be equal t
+000428e0: 6f20 3022 290d 0a20 2020 2020 2020 2073  o 0")..        s
+000428f0: 656c 662e 6e61 6d65 3d6e 616d 650d 0a20  elf.name=name.. 
+00042900: 2020 2020 2020 2073 656c 662e 633d 636f         self.c=co
+00042910: 6c6f 720d 0a0d 0a20 2020 2064 6566 205f  lor....    def _
+00042920: 5f65 715f 5f28 7365 6c66 2c20 6f74 6865  _eq__(self, othe
+00042930: 7229 3a0d 0a20 2020 2020 2020 2069 6620  r):..        if 
+00042940: 2873 656c 662e 6e61 6d65 203d 3d20 6f74  (self.name == ot
+00042950: 6865 722e 6e61 6d65 2920 2620 2873 656c  her.name) & (sel
+00042960: 662e 4944 203d 3d20 6f74 6865 722e 4944  f.ID == other.ID
+00042970: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00042980: 7265 7475 726e 2054 7275 650d 0a20 2020  return True..   
+00042990: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000429a0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+000429b0: 616c 7365 0d0a 0d0a 2020 2020 6465 6620  alse....    def 
+000429c0: 5f5f 7374 725f 5f28 7365 6c66 293a 0d0a  __str__(self):..
+000429d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000429e0: 656c 662e 6e61 6d65 0d0a 0d0a 2020 2020  elf.name....    
+000429f0: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
+00042a00: 6629 3a0d 0a20 2020 2020 2020 2072 6574  f):..        ret
+00042a10: 7572 6e20 7365 6c66 2e6e 616d 650d 0a0d  urn self.name...
+00042a20: 0a63 6c61 7373 2050 726f 7028 293a 0d0a  .class Prop():..
+00042a30: 0d0a 2020 2020 2222 220d 0a20 2020 2043  ..    """..    C
+00042a40: 6c61 7373 2066 6f72 2064 6566 696e 696e  lass for definin
+00042a50: 6720 6120 7072 6f70 7269 6574 7920 746f  g a propriety to
+00042a60: 2073 696d 756c 6174 6520 2833 7264 206c   simulate (3rd l
+00042a70: 6576 656c 290d 0a0d 0a20 2020 2050 6172  evel)....    Par
+00042a80: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
+00042a90: 2d2d 2d2d 2d2d 2d0d 0a20 2020 206e 616d  -------..    nam
+00042aa0: 6520 3a20 7374 7269 6e67 0d0a 2020 2020  e : string..    
+00042ab0: 2020 2020 5072 6f70 6572 7479 206e 616d      Property nam
+00042ac0: 650d 0a20 2020 2066 6163 6965 7320 3a20  e..    facies : 
+00042ad0: 6c69 7374 206f 6620 3a63 6c61 7373 3a60  list of :class:`
+00042ae0: 4661 6369 6573 6020 6f62 6a65 6374 730d  Facies` objects.
+00042af0: 0a20 2020 2020 2020 2066 6163 6965 7320  .        facies 
+00042b00: 696e 2077 6869 6368 2077 6520 7761 6e74  in which we want
+00042b10: 2074 6f20 7369 6d75 6c61 7465 2074 6865   to simulate the
+00042b20: 2070 726f 7065 7274 790d 0a20 2020 2020   property..     
+00042b30: 2020 2028 696e 2074 6865 206f 7468 6572     (in the other
+00042b40: 7320 7468 6520 7072 6f70 7269 6574 7920  s the propriety 
+00042b50: 7769 6c6c 2062 6520 7365 7420 686f 6d6f  will be set homo
+00042b60: 6765 6e6f 7573 2077 6974 6820 6120 6465  genous with a de
+00042b70: 6661 756c 7420 7661 6c75 6529 0d0a 2020  fault value)..  
+00042b80: 2020 636f 766d 6f64 656c 7320 3a20 6c69    covmodels : li
+00042b90: 7374 206f 6620 3a63 6c61 7373 3a60 6765  st of :class:`ge
+00042ba0: 6f6e 652e 636f 764d 6f64 656c 2e43 6f76  one.covModel.Cov
+00042bb0: 4d6f 6465 6c32 4460 206f 626a 6563 7473  Model2D` objects
+00042bc0: 0d0a 2020 2020 2020 2020 636f 766d 6f64  ..        covmod
+00042bd0: 656c 7320 666f 7220 7468 6520 7369 6d75  els for the simu
+00042be0: 6c61 7469 6f6e 2028 7361 6d65 2073 697a  lation (same siz
+00042bf0: 6520 6f66 2066 6163 6965 7320 6f72 206f  e of facies or o
+00042c00: 6e6c 7920 3129 0d0a 2020 2020 6d65 616e  nly 1)..    mean
+00042c10: 7320 3a20 6c69 7374 206f 6620 666c 6f61  s : list of floa
+00042c20: 7473 0d0a 2020 2020 2020 2020 6d65 616e  ts..        mean
+00042c30: 206f 6620 7468 6520 7072 6f70 6572 7479   of the property
+00042c40: 2069 6e20 6561 6368 2066 6163 6965 7320   in each facies 
+00042c50: 2873 616d 6520 7369 7a65 206f 6620 6661  (same size of fa
+00042c60: 6369 6573 290d 0a20 2020 2069 6e74 5f6d  cies)..    int_m
+00042c70: 6574 686f 6420 3a20 7374 7269 6e67 0d0a  ethod : string..
+00042c80: 2020 2020 2020 2020 6d65 7468 6f64 206f          method o
+00042c90: 6620 696e 7465 7270 6f6c 6174 696f 6e2c  f interpolation,
+00042ca0: 2070 6f73 7369 626c 6520 6d65 7468 6f64   possible method
+00042cb0: 7320 6172 653a 0d0a 2020 2020 2020 2020  s are:..        
+00042cc0: 2d20 7367 732c 2064 6566 6175 6c74 0d0a  - sgs, default..
+00042cd0: 2020 2020 2020 2020 2d20 6666 740d 0a20          - fft.. 
+00042ce0: 2020 2020 2020 202d 2068 6f6d 6f67 656e         - homogen
+00042cf0: 6f75 730d 0a20 2020 2064 6566 5f6d 6561  ous..    def_mea
+00042d00: 6e20 3a20 666c 6f61 740d 0a20 2020 2020  n : float..     
+00042d10: 2020 2064 6566 6175 6c74 206d 6561 6e20     default mean 
+00042d20: 746f 2075 7365 6420 6966 206e 6f6e 6520  to used if none 
+00042d30: 6973 2070 6173 7365 6420 696e 206d 6561  is passed in mea
+00042d40: 6e73 2061 7272 6179 0d0a 2020 2020 766d  ns array..    vm
+00042d50: 696e 2c20 766d 6178 203a 2066 6c6f 6174  in, vmax : float
+00042d60: 0d0a 2020 2020 2020 2020 6d69 6e20 7265  ..        min re
+00042d70: 7370 2e20 6d61 7820 7661 6c75 6520 6f66  sp. max value of
+00042d80: 2074 6865 2070 726f 7065 7274 790d 0a20   the property.. 
+00042d90: 2020 2078 203a 206e 6461 7272 6179 206f     x : ndarray o
+00042da0: 6620 7369 7a65 2028 6e2c 2032 202d 2d3e  f size (n, 2 -->
+00042db0: 2078 2c20 7929 0d0a 2020 2020 2020 2020   x, y)..        
+00042dc0: 706f 7369 7469 6f6e 206f 6620 6861 7264  position of hard
+00042dd0: 2064 6174 6120 0d0a 2020 2020 7620 3a20   data ..    v : 
+00042de0: 6e64 6172 7261 7920 6f66 2073 697a 6520  ndarray of size 
+00042df0: 286e 2c20 3120 2d2d 3e20 7661 6c75 6529  (n, 1 --> value)
+00042e00: 0d0a 2020 2020 2020 2020 7661 6c75 6520  ..        value 
+00042e10: 6f66 2068 6172 6420 6461 7461 0d0a 2020  of hard data..  
+00042e20: 2020 2222 220d 0a0d 0a20 2020 2064 6566    """....    def
+00042e30: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00042e40: 6e61 6d65 2c20 6661 6369 6573 2c20 636f  name, facies, co
+00042e50: 766d 6f64 656c 732c 206d 6561 6e73 2c20  vmodels, means, 
+00042e60: 696e 745f 6d65 7468 6f64 3d22 7367 7322  int_method="sgs"
+00042e70: 2c20 783d 4e6f 6e65 2c20 763d 204e 6f6e  , x=None, v= Non
+00042e80: 652c 2064 6566 5f6d 6561 6e3d 312c 2076  e, def_mean=1, v
+00042e90: 6d69 6e3d 4e6f 6e65 2c20 766d 6178 3d4e  min=None, vmax=N
+00042ea0: 6f6e 6529 3a0d 0a0d 0a0d 0a20 2020 2020  one):......     
+00042eb0: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
+00042ec0: 616e 6365 2866 6163 6965 732c 206c 6973  ance(facies, lis
+00042ed0: 7429 2c20 2246 6163 6965 7320 6d75 7374  t), "Facies must
+00042ee0: 2062 6520 6120 6c69 7374 206f 6620 6661   be a list of fa
+00042ef0: 6369 6573 2c20 6576 656e 2074 6865 7265  cies, even there
+00042f00: 2069 7320 6f6e 6c79 206f 6e65 220d 0a20   is only one".. 
+00042f10: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+00042f20: 696e 7374 616e 6365 2876 6d69 6e2c 2066  instance(vmin, f
+00042f30: 6c6f 6174 2920 6f72 2069 7369 6e73 7461  loat) or isinsta
+00042f40: 6e63 6528 766d 696e 2c20 696e 7429 206f  nce(vmin, int) o
+00042f50: 7220 766d 696e 2069 7320 4e6f 6e65 2c20  r vmin is None, 
+00042f60: 2256 6d69 6e20 6572 726f 7222 0d0a 2020  "Vmin error"..  
+00042f70: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
+00042f80: 6e73 7461 6e63 6528 766d 6178 2c20 666c  nstance(vmax, fl
+00042f90: 6f61 7429 206f 7220 6973 696e 7374 616e  oat) or isinstan
+00042fa0: 6365 2876 6d61 782c 2069 6e74 2920 6f72  ce(vmax, int) or
+00042fb0: 2076 6d61 7820 6973 204e 6f6e 652c 2022   vmax is None, "
+00042fc0: 566d 6178 2065 7272 6f72 220d 0a0d 0a20  Vmax error".... 
+00042fd0: 2020 2020 2020 2073 656c 662e 6e61 6d65         self.name
+00042fe0: 3d6e 616d 650d 0a20 2020 2020 2020 2073  =name..        s
+00042ff0: 656c 662e 6661 6369 6573 3d66 6163 6965  elf.facies=facie
+00043000: 730d 0a20 2020 2020 2020 206e 5f66 6163  s..        n_fac
+00043010: 6965 733d 6c65 6e28 6661 6369 6573 290d  ies=len(facies).
+00043020: 0a20 2020 2020 2020 2073 656c 662e 6e5f  .        self.n_
+00043030: 6661 6369 6573 3d6e 5f66 6163 6965 730d  facies=n_facies.
+00043040: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00043050: 766d 696e 3d76 6d69 6e0d 0a20 2020 2020  vmin=vmin..     
+00043060: 2020 2073 656c 662e 766d 6178 3d76 6d61     self.vmax=vma
+00043070: 780d 0a20 2020 2020 2020 2073 656c 662e  x..        self.
+00043080: 783d 780d 0a20 2020 2020 2020 2073 656c  x=x..        sel
+00043090: 662e 763d 760d 0a0d 0a20 2020 2020 2020  f.v=v....       
+000430a0: 2023 636f 766d 6f64 656c 730d 0a20 2020   #covmodels..   
+000430b0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+000430c0: 2020 2020 2020 2066 6f72 2063 6d20 696e         for cm in
+000430d0: 2063 6f76 6d6f 6465 6c73 3a0d 0a20 2020   covmodels:..   
+000430e0: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+000430f0: 730d 0a20 2020 2020 2020 2020 2020 2073  s..            s
+00043100: 656c 662e 636f 766d 6f64 656c 733d 636f  elf.covmodels=co
+00043110: 766d 6f64 656c 730d 0a20 2020 2020 2020  vmodels..       
+00043120: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00043130: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00043140: 6e63 6528 636f 766d 6f64 656c 732c 2067  nce(covmodels, g
+00043150: 636d 2e43 6f76 4d6f 6465 6c33 4429 3a0d  cm.CovModel3D):.
+00043160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043170: 2073 656c 662e 636f 766d 6f64 656c 733d   self.covmodels=
+00043180: 5b63 6f76 6d6f 6465 6c73 5d2a 6e5f 6661  [covmodels]*n_fa
+00043190: 6369 6573 0d0a 2020 2020 2020 2020 2020  cies..          
+000431a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000431b0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000431c0: 616c 7565 4572 726f 7228 227b 7d20 6973  alueError("{} is
+000431d0: 206e 6f74 2061 2076 616c 6964 2043 6f76   not a valid Cov
+000431e0: 4d6f 6465 6c33 4422 2e66 6f72 6d61 7428  Model3D".format(
+000431f0: 636d 2929 0d0a 0d0a 2020 2020 2020 2020  cm))....        
+00043200: 236d 6561 6e73 0d0a 2020 2020 2020 2020  #means..        
+00043210: 7365 6c66 2e6d 6561 6e73 3d6d 6561 6e73  self.means=means
+00043220: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+00043230: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00043240: 6d20 696e 206d 6561 6e73 3a0d 0a20 2020  m in means:..   
+00043250: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+00043260: 730d 0a20 2020 2020 2020 2065 7863 6570  s..        excep
+00043270: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+00043280: 7365 6c66 2e6d 6561 6e73 3d5b 6d65 616e  self.means=[mean
+00043290: 735d 2a6e 5f66 6163 6965 730d 0a0d 0a20  s]*n_facies.... 
+000432a0: 2020 2020 2020 2023 696e 7465 7270 6f6c         #interpol
+000432b0: 6174 696f 6e20 6d65 7468 6f64 730d 0a20  ation methods.. 
+000432c0: 2020 2020 2020 2073 656c 662e 696e 743d         self.int=
+000432d0: 696e 745f 6d65 7468 6f64 0d0a 2020 2020  int_method..    
+000432e0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+000432f0: 2020 2020 2020 666f 7220 695f 6d65 7468        for i_meth
+00043300: 6f64 2069 6e20 696e 745f 6d65 7468 6f64  od in int_method
+00043310: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00043320: 2020 2069 6620 695f 6d65 7468 6f64 2069     if i_method i
+00043330: 6e20 2822 7367 7322 2c20 2266 6674 222c  n ("sgs", "fft",
+00043340: 2022 686f 6d6f 6765 6e6f 7573 222c 2022   "homogenous", "
+00043350: 6d70 7322 2c20 2268 6f6d 6f67 656e 6f75  mps", "homogenou
+00043360: 735f 756e 6966 6f72 6d22 293a 0d0a 2020  s_uniform"):..  
+00043370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043380: 2020 7061 7373 0d0a 2020 2020 2020 2020    pass..        
+00043390: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000433a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000433b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000433c0: 726f 7228 227b 7d20 6973 206e 6f74 2061  ror("{} is not a
+000433d0: 2076 616c 6964 2069 6e74 6570 726f 6c61   valid inteprola
+000433e0: 7469 6f6e 206d 6574 686f 6422 2e66 6f72  tion method".for
+000433f0: 6d61 7428 695f 6d65 7468 6f64 2929 0d0a  mat(i_method))..
+00043400: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+00043410: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00043420: 696e 745f 6d65 7468 6f64 2069 6e20 2822  int_method in ("
+00043430: 7367 7322 2c20 2266 6674 222c 2022 686f  sgs", "fft", "ho
+00043440: 6d6f 6765 6e6f 7573 222c 2022 6d70 7322  mogenous", "mps"
+00043450: 2c22 686f 6d6f 6765 6e6f 7573 5f75 6e69  ,"homogenous_uni
+00043460: 666f 726d 2229 3a0d 0a20 2020 2020 2020  form"):..       
+00043470: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
+00043480: 743d 5b69 6e74 5f6d 6574 686f 645d 2a6e  t=[int_method]*n
+00043490: 5f66 6163 6965 730d 0a20 2020 2020 2020  _facies..       
+000434a0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000434b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000434c0: 6520 5661 6c75 6545 7272 6f72 2822 7b7d  e ValueError("{}
+000434d0: 2069 7320 6e6f 7420 6120 7661 6c69 6420   is not a valid 
+000434e0: 696e 7465 7072 6f6c 6174 696f 6e20 6d65  inteprolation me
+000434f0: 7468 6f64 222e 666f 726d 6174 2869 5f6d  thod".format(i_m
+00043500: 6574 686f 6429 290d 0a0d 0a20 2020 2020  ethod))....     
+00043510: 2020 2073 656c 662e 6465 665f 6d65 616e     self.def_mean
+00043520: 3d64 6566 5f6d 6561 6e0d 0a0d 0a20 2020  =def_mean....   
+00043530: 2020 2020 2064 6566 205f 5f65 715f 5f28       def __eq__(
+00043540: 7365 6c66 2c20 6f74 6865 7229 3a0d 0a20  self, other):.. 
+00043550: 2020 2020 2020 2020 2020 2069 6620 2873             if (s
+00043560: 656c 662e 6e61 6d65 203d 3d20 6f74 6865  elf.name == othe
+00043570: 722e 6e61 6d65 293a 0d0a 2020 2020 2020  r.name):..      
+00043580: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00043590: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
+000435a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000435b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000435c0: 2046 616c 7365 0d0a 0d0a 2020 2020 2020   False....      
+000435d0: 2020 6465 6620 5f5f 7265 7072 5f5f 2873    def __repr__(s
+000435e0: 656c 6629 3a0d 0a20 2020 2020 2020 2020  elf):..         
+000435f0: 2020 2072 6574 7572 6e20 7365 6c66 2e6e     return self.n
+00043600: 616d 650d 0a0d 0a0d 0a20 2020 2064 6566  ame......    def
+00043610: 2061 6464 5f68 6428 7365 6c66 2c20 782c   add_hd(self, x,
+00043620: 7629 3a0d 0a0d 0a20 2020 2020 2020 2022  v):....        "
+00043630: 2222 0d0a 2020 2020 2020 2020 6164 6420  ""..        add 
+00043640: 6861 7264 2064 6174 6120 746f 2074 6865  hard data to the
+00043650: 2070 726f 7065 7274 790d 0a0d 0a20 2020   property....   
+00043660: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00043670: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00043680: 2d2d 2d0d 0a20 2020 2020 2020 2078 203a  ---..        x :
+00043690: 206e 6461 7272 6179 206f 6620 7369 7a65   ndarray of size
+000436a0: 2028 6e2c 2032 202d 2d3e 2078 2c20 7929   (n, 2 --> x, y)
+000436b0: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+000436c0: 7369 7469 6f6e 206f 6620 6861 7264 2064  sition of hard d
+000436d0: 6174 610d 0a20 2020 2020 2020 2076 203a  ata..        v :
+000436e0: 206e 6461 7272 6179 206f 6620 7369 7a65   ndarray of size
+000436f0: 2028 6e2c 2031 202d 2d3e 2076 616c 7565   (n, 1 --> value
+00043700: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+00043710: 616c 7565 206f 6620 6861 7264 2064 6174  alue of hard dat
+00043720: 610d 0a20 2020 2020 2020 2022 2222 0d0a  a..        """..
+00043730: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00043740: 2078 2e73 6861 7065 5b31 5d20 3d3d 2033   x.shape[1] == 3
+00043750: 2c20 2269 6e76 616c 6964 2073 6861 7065  , "invalid shape
+00043760: 2066 6f72 2068 6420 706f 7369 7469 6f6e   for hd position
+00043770: 2028 7829 2c20 6d75 7374 2062 6520 286e   (x), must be (n
+00043780: 6461 7461 2c20 3329 220d 0a20 2020 2020  data, 3)"..     
+00043790: 2020 2061 7373 6572 7420 762e 7368 6170     assert v.shap
+000437a0: 655b 305d 203d 3d20 782e 7368 6170 655b  e[0] == x.shape[
+000437b0: 305d 2c20 2269 6e76 616c 6964 206e 756d  0], "invalid num
+000437c0: 6265 7220 6f66 2064 6174 6120 706f 696e  ber of data poin
+000437d0: 7473 2062 6574 7765 656e 2076 2061 6e64  ts between v and
+000437e0: 2078 220d 0a0d 0a20 2020 2020 2020 2073   x"....        s
+000437f0: 656c 662e 783d 780d 0a20 2020 2020 2020  elf.x=x..       
+00043800: 2073 656c 662e 763d 760d 0a0d 0a0d 0a63   self.v=v......c
+00043810: 6c61 7373 2062 6f72 6568 6f6c 6528 293a  lass borehole():
+00043820: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
+00043830: 2043 6c61 7373 2074 6f20 6372 6561 7465   Class to create
+00043840: 2061 2062 6f72 6568 6f6c 6520 6f62 6a65   a borehole obje
+00043850: 6374 2e20 0d0a 2020 2020 426f 7265 686f  ct. ..    Boreho
+00043860: 6c65 2061 7265 2075 7365 6420 746f 2064  le are used to d
+00043870: 6566 696e 6520 7468 6520 6c69 7468 6f6c  efine the lithol
+00043880: 6f67 7920 616e 6420 6164 6420 636f 6e64  ogy and add cond
+00043890: 6974 696f 6e69 6e67 2064 6174 6120 696e  itioning data in
+000438a0: 746f 2041 7263 6850 7920 6d6f 6465 6c73  to ArchPy models
+000438b0: 0d0a 0d0a 2020 2020 5061 7261 6d65 7465  ....    Paramete
+000438c0: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
+000438d0: 2d2d 0d0a 2020 2020 6e61 6d65 203a 2073  --..    name : s
+000438e0: 7472 696e 670d 0a20 2020 2020 2020 206e  tring..        n
+000438f0: 616d 6520 6f66 2074 6865 2062 6f72 6568  ame of the boreh
+00043900: 6f6c 652c 206e 6f74 2075 7365 640d 0a20  ole, not used.. 
+00043910: 2020 2049 4420 3a20 696e 740d 0a20 2020     ID : int..   
+00043920: 2020 2020 2049 4420 6f66 2074 6865 2062       ID of the b
+00043930: 6f72 6568 6f6c 650d 0a20 2020 2078 2c20  orehole..    x, 
+00043940: 792c 207a 203a 2066 6c6f 6174 0d0a 2020  y, z : float..  
+00043950: 2020 2020 2020 782c 2079 2c20 7a20 636f        x, y, z co
+00043960: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
+00043970: 2074 6f70 206f 6620 7468 6520 626f 7265   top of the bore
+00043980: 686f 6c65 0d0a 2020 2020 6465 7074 6820  hole..    depth 
+00043990: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
+000439a0: 2064 6570 7468 206f 6620 7468 6520 626f   depth of the bo
+000439b0: 7265 686f 6c65 0d0a 2020 2020 6c6f 675f  rehole..    log_
+000439c0: 7374 7261 7469 203a 206c 6973 7420 6f66  strati : list of
+000439d0: 2074 7570 6c65 730d 0a20 2020 2020 2020   tuples..       
+000439e0: 206c 6f67 5f73 7472 6174 6920 636f 6e74   log_strati cont
+000439f0: 6169 6e73 2074 6865 2067 656f 6c6f 6769  ains the geologi
+00043a00: 6361 6c20 696e 666f 726d 6174 696f 6e20  cal information 
+00043a10: 6162 6f75 7420 7468 6520 756e 6974 7320  about the units 
+00043a20: 696e 2074 6865 2062 6f72 6568 6f6c 650d  in the borehole.
+00043a30: 0a20 2020 2020 2020 2069 6e66 6f72 6d61  .        informa
+00043a40: 7469 6f6e 2069 7320 6769 7665 6e20 6279  tion is given by
+00043a50: 2069 6e74 6572 7661 6c73 206f 6620 7468   intervals of th
+00043a60: 6520 666f 726d 2028 7374 7261 7469 2c20  e form (strati, 
+00043a70: 746f 7029 2077 6865 7265 2073 7472 6174  top) where strat
+00043a80: 6920 6973 2061 203a 636c 6173 733a 6055  i is a :class:`U
+00043a90: 6e69 7460 206f 626a 6563 740d 0a20 2020  nit` object..   
+00043aa0: 2020 2020 2061 6e64 2074 6f70 2069 7320       and top is 
+00043ab0: 7468 6520 746f 7020 616c 7469 7475 6465  the top altitude
+00043ac0: 206f 6620 756e 6974 2069 6e74 6572 7661   of unit interva
+00043ad0: 6c0d 0a20 2020 206c 6f67 5f66 6163 6965  l..    log_facie
+00043ae0: 7320 3a20 6c69 7374 206f 6620 7475 706c  s : list of tupl
+00043af0: 6573 0d0a 2020 2020 2020 2020 6c6f 675f  es..        log_
+00043b00: 6661 6369 6573 2063 6f6e 7461 696e 7320  facies contains 
+00043b10: 7468 6520 6661 6369 6573 2069 6e66 6f72  the facies infor
+00043b20: 6d61 7469 6f6e 2061 626f 7574 2074 6865  mation about the
+00043b30: 2062 6f72 6568 6f6c 650d 0a20 2020 2020   borehole..     
+00043b40: 2020 2069 6e66 6f72 6d61 7469 6f6e 2069     information i
+00043b50: 7320 6769 7665 6e20 6279 2069 6e74 6572  s given by inter
+00043b60: 7661 6c73 206f 6620 7468 6520 666f 726d  vals of the form
+00043b70: 2028 6661 6369 6573 2c20 746f 7029 2077   (facies, top) w
+00043b80: 6865 7265 2066 6163 6965 7320 6973 2061  here facies is a
+00043b90: 203a 636c 6173 733a 6046 6163 6965 7360   :class:`Facies`
+00043ba0: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+00043bb0: 2061 6e64 2074 6f70 2069 7320 7468 6520   and top is the 
+00043bc0: 746f 7020 616c 7469 7475 6465 206f 6620  top altitude of 
+00043bd0: 6661 6369 6573 2069 6e74 6572 7661 6c0d  facies interval.
+00043be0: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
+00043bf0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00043c00: 662c 206e 616d 652c 2049 442c 2078 2c20  f, name, ID, x, 
+00043c10: 792c 207a 2c20 6465 7074 682c 206c 6f67  y, z, depth, log
+00043c20: 5f73 7472 6174 692c 206c 6f67 5f66 6163  _strati, log_fac
+00043c30: 6965 733d 4e6f 6e65 293a 0d0a 0d0a 2020  ies=None):....  
+00043c40: 2020 2020 2020 7365 6c66 2e6e 616d 653d        self.name=
+00043c50: 6e61 6d65 2020 2320 6e61 6d65 206f 6620  name  # name of 
+00043c60: 6c69 7468 6f6c 6f67 790d 0a20 2020 2020  lithology..     
+00043c70: 2020 2073 656c 662e 4944 3d49 4420 2023     self.ID=ID  #
+00043c80: 2049 4420 6f66 2074 6865 2062 6f72 6568   ID of the boreh
+00043c90: 6f6c 6573 0d0a 2020 2020 2020 2020 7365  oles..        se
+00043ca0: 6c66 2e78 3d78 2020 2320 7820 636f 6f72  lf.x=x  # x coor
+00043cb0: 6469 6e61 7465 206f 6620 626f 7265 686f  dinate of boreho
+00043cc0: 6c65 0d0a 2020 2020 2020 2020 7365 6c66  le..        self
+00043cd0: 2e79 3d79 2020 2320 7920 636f 6f72 6469  .y=y  # y coordi
+00043ce0: 6e61 7465 206f 6620 626f 7265 686f 6c65  nate of borehole
+00043cf0: 0d0a 2020 2020 2020 2020 7365 6c66 2e7a  ..        self.z
+00043d00: 3d7a 2020 2320 616c 7469 7475 6465 206f  =z  # altitude o
+00043d10: 6620 7468 6520 6268 2028 63c3 b474 6520  f the bh (c..te 
+00043d20: 7465 7272 6169 6e29 0d0a 2020 2020 2020  terrain)..      
+00043d30: 2020 7365 6c66 2e64 6570 7468 3d64 6570    self.depth=dep
+00043d40: 7468 0d0a 2020 2020 2020 2020 7365 6c66  th..        self
+00043d50: 2e6c 6f67 5f73 7472 6174 693d 6c6f 675f  .log_strati=log_
+00043d60: 7374 7261 7469 0d0a 2020 2020 2020 2020  strati..        
+00043d70: 7365 6c66 2e6c 6f67 5f66 6163 6965 733d  self.log_facies=
+00043d80: 6c6f 675f 6661 6369 6573 0d0a 0d0a 2020  log_facies....  
+00043d90: 2020 2020 2020 6966 206c 6f67 5f73 7472        if log_str
+00043da0: 6174 6920 6973 206e 6f74 204e 6f6e 653a  ati is not None:
+00043db0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00043dc0: 6c66 2e6c 6973 745f 7374 7261 7469 733d  lf.list_stratis=
+00043dd0: 5b73 2066 6f72 2073 2c20 6420 696e 2073  [s for s, d in s
+00043de0: 656c 662e 6c6f 675f 7374 7261 7469 5d0d  elf.log_strati].
+00043df0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00043e00: 6c65 6e28 7365 6c66 2e6c 6973 745f 7374  len(self.list_st
+00043e10: 7261 7469 7329 203d 3d20 303a 0d0a 2020  ratis) == 0:..  
+00043e20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00043e30: 6c66 2e6c 6f67 5f73 7472 6174 693d 4e6f  lf.log_strati=No
+00043e40: 6e65 0d0a 0d0a 2020 2020 2020 2020 6966  ne....        if
+00043e50: 206c 6f67 5f66 6163 6965 7320 6973 206e   log_facies is n
+00043e60: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+00043e70: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
+00043e80: 6661 6369 6573 203d 5b73 2066 6f72 2073  facies =[s for s
+00043e90: 2c20 6420 696e 2073 656c 662e 6c6f 675f  , d in self.log_
+00043ea0: 6661 6369 6573 5d0d 0a20 2020 2020 2020  facies]..       
+00043eb0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+00043ec0: 2e6c 6f67 5f66 6163 6965 7329 203d 3d20  .log_facies) == 
+00043ed0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+00043ee0: 2020 2020 7365 6c66 2e6c 6f67 5f66 6163      self.log_fac
+00043ef0: 6965 733d 4e6f 6e65 0d0a 0d0a 0d0a 2020  ies=None......  
+00043f00: 2020 6465 6620 6765 745f 6c69 7374 5f73    def get_list_s
+00043f10: 7472 6174 6973 2873 656c 6629 3a0d 0a20  tratis(self):.. 
+00043f20: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
+00043f30: 5f73 7472 6174 6973 3d5b 7320 666f 7220  _stratis=[s for 
+00043f40: 732c 2064 2069 6e20 7365 6c66 2e6c 6f67  s, d in self.log
+00043f50: 5f73 7472 6174 695d 0d0a 2020 2020 2020  _strati]..      
+00043f60: 2020 7265 7475 726e 2073 656c 662e 6c69    return self.li
+00043f70: 7374 5f73 7472 6174 6973 0d0a 0d0a 2020  st_stratis....  
+00043f80: 2020 6465 6620 6765 745f 6c69 7374 5f66    def get_list_f
+00043f90: 6163 6965 7328 7365 6c66 293a 0d0a 2020  acies(self):..  
+00043fa0: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
+00043fb0: 6661 6369 6573 203d 5b73 2066 6f72 2073  facies =[s for s
+00043fc0: 2c20 6420 696e 2073 656c 662e 6c6f 675f  , d in self.log_
+00043fd0: 6661 6369 6573 5d0d 0a20 2020 2020 2020  facies]..       
+00043fe0: 2072 6574 7572 6e20 7365 6c66 2e6c 6973   return self.lis
+00043ff0: 745f 6661 6369 6573 0d0a 0d0a 2020 2020  t_facies....    
+00044000: 6465 6620 5f5f 6571 5f5f 2873 656c 662c  def __eq__(self,
+00044010: 206f 7468 6572 293a 0d0a 2020 2020 2020   other):..      
+00044020: 2020 6966 2020 2873 656c 662e 4944 203d    if  (self.ID =
+00044030: 3d20 6f74 6865 722e 4944 2920 2620 5c0d  = other.ID) & \.
+00044040: 0a20 2020 2020 2020 2028 7365 6c66 2e78  .        (self.x
+00044050: 203d 3d20 6f74 6865 722e 7829 2026 2028   == other.x) & (
+00044060: 7365 6c66 2e79 203d 3d20 6f74 6865 722e  self.y == other.
+00044070: 7929 2026 2028 7365 6c66 2e7a 203d 3d20  y) & (self.z == 
+00044080: 6f74 6865 722e 7a29 3a0d 0a20 2020 2020  other.z):..     
+00044090: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+000440a0: 7565 0d0a 2020 2020 2020 2020 656c 7365  ue..        else
+000440b0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+000440c0: 6574 7572 6e20 4661 6c73 650d 0a0d 0a20  eturn False.... 
+000440d0: 2020 2064 6566 2070 726f 705f 756e 6974     def prop_unit
+000440e0: 7328 7365 6c66 293a 0d0a 0d0a 2020 2020  s(self):....    
+000440f0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00044100: 2052 6574 7572 6e20 6120 6469 6374 696f   Return a dictio
+00044110: 6e6e 6172 7920 6f66 2074 6865 2070 726f  nnary of the pro
+00044120: 706f 7274 696f 6e20 6f66 2074 6865 2075  portion of the u
+00044130: 6e69 7473 2069 6e20 7468 6520 626f 7265  nits in the bore
+00044140: 686f 6c65 0d0a 2020 2020 2020 2020 2222  hole..        ""
+00044150: 220d 0a0d 0a20 2020 2020 2020 2064 203d  "....        d =
+00044160: 207b 7d0d 0a0d 0a20 2020 2020 2020 2061   {}....        a
+00044170: 6c74 5f70 7265 7620 3d20 7365 6c66 2e7a  lt_prev = self.z
+00044180: 0d0a 2020 2020 2020 2020 756e 6974 5f70  ..        unit_p
+00044190: 7265 7620 3d20 4e6f 6e65 0d0a 2020 2020  rev = None..    
+000441a0: 2020 2020 666f 7220 7320 696e 2073 656c      for s in sel
+000441b0: 662e 6c6f 675f 7374 7261 7469 3a0d 0a20  f.log_strati:.. 
+000441c0: 2020 2020 2020 2020 2020 2069 6620 735b             if s[
+000441d0: 305d 2069 7320 6e6f 7420 4e6f 6e65 3a0d  0] is not None:.
+000441e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000441f0: 2069 6620 735b 305d 2e6e 616d 6520 6e6f   if s[0].name no
+00044200: 7420 696e 2064 2e6b 6579 7328 293a 0d0a  t in d.keys():..
+00044210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044220: 2020 2020 645b 735b 305d 2e6e 616d 655d      d[s[0].name]
+00044230: 203d 2030 0d0a 2020 2020 2020 2020 2020   = 0..          
+00044240: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00044250: 2020 2020 2020 2020 6966 2075 6e69 745f          if unit_
+00044260: 7072 6576 2069 7320 6e6f 7420 4e6f 6e65  prev is not None
+00044270: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00044280: 2020 2020 2020 2074 686b 203d 2075 6e69         thk = uni
+00044290: 745f 7072 6576 5b31 5d20 2d20 735b 315d  t_prev[1] - s[1]
+000442a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000442b0: 2020 2020 2020 645b 756e 6974 5f70 7265        d[unit_pre
+000442c0: 765b 305d 2e6e 616d 655d 202b 3d20 7468  v[0].name] += th
+000442d0: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
+000442e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000442f0: 2020 2020 2020 2020 2075 6e69 745f 7072           unit_pr
+00044300: 6576 203d 2073 0d0a 2020 2020 2020 2020  ev = s..        
+00044310: 7468 6b20 3d20 756e 6974 5f70 7265 765b  thk = unit_prev[
+00044320: 315d 202d 2028 7365 6c66 2e7a 202d 2073  1] - (self.z - s
+00044330: 656c 662e 6465 7074 6829 0d0a 2020 2020  elf.depth)..    
+00044340: 2020 2020 645b 756e 6974 5f70 7265 765b      d[unit_prev[
+00044350: 305d 2e6e 616d 655d 202b 3d20 7468 6b20  0].name] += thk 
+00044360: 0d0a 0d0a 2020 2020 2020 2020 666f 7220  ....        for 
+00044370: 6b2c 7620 696e 2064 2e69 7465 6d73 2829  k,v in d.items()
+00044380: 3a20 2023 206d 6561 6e0d 0a20 2020 2020  :  # mean..     
+00044390: 2020 2020 2020 2064 5b6b 5d20 2f3d 2073         d[k] /= s
+000443a0: 656c 662e 6465 7074 680d 0a0d 0a20 2020  elf.depth....   
+000443b0: 2020 2020 2072 6574 7572 6e20 640d 0a0d       return d...
+000443c0: 0a20 2020 2064 6566 2065 7874 7261 6374  .    def extract
+000443d0: 2873 656c 662c 207a 2c20 7662 3d31 293a  (self, z, vb=1):
+000443e0: 0d0a 0d0a 2020 2020 2020 2020 2222 2265  ....        """e
+000443f0: 7874 7261 6374 2074 6865 2075 6e69 7473  xtract the units
+00044400: 2061 6e64 2066 6163 6965 7320 696e 666f   and facies info
+00044410: 726d 6174 696f 6e20 6174 2073 7065 6369  rmation at speci
+00044420: 6669 6564 2061 6c74 6974 7564 6520 7a22  fied altitude z"
+00044430: 2222 0d0a 0d0a 2020 2020 2020 2020 6c73  ""....        ls
+00044440: 3d46 616c 7365 0d0a 2020 2020 2020 2020  =False..        
+00044450: 6c66 3d46 616c 7365 0d0a 2020 2020 2020  lf=False..      
+00044460: 2020 756e 6974 3d4e 6f6e 650d 0a20 2020    unit=None..   
+00044470: 2020 2020 2066 6163 6965 733d 4e6f 6e65       facies=None
+00044480: 0d0a 0d0a 2020 2020 2020 2020 6966 207a  ....        if z
+00044490: 203e 2073 656c 662e 7a20 6f72 207a 203c   > self.z or z <
+000444a0: 2073 656c 662e 7a20 2d20 7365 6c66 2e64   self.z - self.d
+000444b0: 6570 7468 3a0d 0a20 2020 2020 2020 2020  epth:..         
+000444c0: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
+000444d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000444e0: 2822 626f 7265 686f 6c65 2068 6176 6520  ("borehole have 
+000444f0: 6e6f 2069 6e66 6f72 6d61 7469 6f6e 2061  no information a
+00044500: 7420 7468 6973 2061 6c74 6974 7564 6522  t this altitude"
+00044510: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00044520: 6574 7572 6e20 4e6f 6e65 0d0a 0d0a 2020  eturn None....  
+00044530: 2020 2020 2020 6966 2073 656c 662e 6c6f        if self.lo
+00044540: 675f 7374 7261 7469 2069 7320 6e6f 7420  g_strati is not 
+00044550: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00044560: 2020 206c 733d 5472 7565 0d0a 2020 2020     ls=True..    
+00044570: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00044580: 2072 616e 6765 286c 656e 2873 656c 662e   range(len(self.
+00044590: 6c6f 675f 7374 7261 7469 2929 3a0d 0a20  log_strati)):.. 
+000445a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000445b0: 6620 6920 3c20 6c65 6e28 7365 6c66 2e6c  f i < len(self.l
+000445c0: 6f67 5f73 7472 6174 6929 202d 2031 3a0d  og_strati) - 1:.
+000445d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000445e0: 2020 2020 2073 3120 3d20 7365 6c66 2e6c       s1 = self.l
+000445f0: 6f67 5f73 7472 6174 695b 695d 0d0a 2020  og_strati[i]..  
+00044600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044610: 2020 7332 203d 2073 656c 662e 6c6f 675f    s2 = self.log_
+00044620: 7374 7261 7469 5b69 2b31 5d0d 0a20 2020  strati[i+1]..   
+00044630: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00044640: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00044650: 2020 2020 2020 2020 7331 203d 2073 656c          s1 = sel
+00044660: 662e 6c6f 675f 7374 7261 7469 5b69 5d0d  f.log_strati[i].
+00044670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044680: 2020 2020 2073 3220 3d20 284e 6f6e 652c       s2 = (None,
+00044690: 2073 656c 662e 7a20 2d20 7365 6c66 2e64   self.z - self.d
+000446a0: 6570 7468 290d 0a20 2020 2020 2020 2020  epth)..         
+000446b0: 2020 2020 2020 2069 6620 7331 5b31 5d20         if s1[1] 
+000446c0: 3e3d 207a 2061 6e64 2073 325b 315d 203c  >= z and s2[1] <
+000446d0: 207a 3a0d 0a20 2020 2020 2020 2020 2020   z:..           
+000446e0: 2020 2020 2020 2020 2075 6e69 743d 7331           unit=s1
+000446f0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+00044700: 2020 2020 2020 2020 2062 7265 616b 0d0a           break..
+00044710: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
+00044720: 656c 662e 6c6f 675f 6661 6369 6573 2069  elf.log_facies i
+00044730: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+00044740: 2020 2020 2020 2020 206c 663d 5472 7565           lf=True
+00044750: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00044760: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+00044770: 2873 656c 662e 6c6f 675f 6661 6369 6573  (self.log_facies
+00044780: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+00044790: 2020 2020 2069 6620 6920 3c20 6c65 6e28       if i < len(
+000447a0: 7365 6c66 2e6c 6f67 5f66 6163 6965 7329  self.log_facies)
+000447b0: 202d 2031 3a0d 0a20 2020 2020 2020 2020   - 1:..         
+000447c0: 2020 2020 2020 2020 2020 2066 3120 3d20             f1 = 
+000447d0: 7365 6c66 2e6c 6f67 5f66 6163 6965 735b  self.log_facies[
+000447e0: 695d 0d0a 2020 2020 2020 2020 2020 2020  i]..            
+000447f0: 2020 2020 2020 2020 6632 203d 2073 656c          f2 = sel
+00044800: 662e 6c6f 675f 6661 6369 6573 5b69 2b31  f.log_facies[i+1
+00044810: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00044820: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00044830: 2020 2020 2020 2020 2020 2020 2020 6631                f1
+00044840: 203d 2073 656c 662e 6c6f 675f 6661 6369   = self.log_faci
+00044850: 6573 5b69 5d0d 0a20 2020 2020 2020 2020  es[i]..         
+00044860: 2020 2020 2020 2020 2020 2066 3220 3d20             f2 = 
+00044870: 284e 6f6e 652c 2073 656c 662e 7a20 2d20  (None, self.z - 
+00044880: 7365 6c66 2e64 6570 7468 290d 0a20 2020  self.depth)..   
+00044890: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000448a0: 6631 5b31 5d20 3e3d 207a 2061 6e64 2066  f1[1] >= z and f
+000448b0: 325b 315d 203c 207a 3a0d 0a20 2020 2020  2[1] < z:..     
+000448c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000448d0: 6163 6965 733d 6631 5b30 5d0d 0a20 2020  acies=f1[0]..   
+000448e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000448f0: 2062 7265 616b 0d0a 2020 2020 2020 2020   break..        
+00044900: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
+00044910: 6966 206c 7320 616e 6420 6c66 3a0d 0a20  if ls and lf:.. 
+00044920: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00044930: 6e20 2875 6e69 742c 2066 6163 6965 7329  n (unit, facies)
+00044940: 0d0a 2020 2020 2020 2020 656c 6966 206c  ..        elif l
+00044950: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00044960: 7265 7475 726e 2075 6e69 740d 0a20 2020  return unit..   
+00044970: 2020 2020 2065 6c69 6620 6c66 3a0d 0a20       elif lf:.. 
+00044980: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00044990: 6e20 6661 6369 6573 0d0a 0d0a 0d0a 636c  n facies......cl
+000449a0: 6173 7320 4765 6f6c 2829 3a0d 0a0d 0a20  ass Geol():.... 
+000449b0: 2020 2022 2222 0d0a 2020 2020 4172 6368     """..    Arch
+000449c0: 5079 206f 7574 7075 7420 636c 6173 7320  Py output class 
+000449d0: 7768 6963 6820 636f 6e74 6169 6e20 7468  which contain th
+000449e0: 6520 7265 7375 6c74 7320 666f 7220 7468  e results for th
+000449f0: 6520 6765 6f6c 6f67 6963 616c 2073 696d  e geological sim
+00044a00: 756c 6174 696f 6e73 0d0a 2020 2020 2222  ulations..    ""
+00044a10: 220d 0a0d 0a20 2020 2064 6566 205f 5f69  "....    def __i
+00044a20: 6e69 745f 5f28 7365 6c66 293a 0d0a 0d0a  nit__(self):....
+00044a30: 2020 2020 2020 2020 7365 6c66 2e73 7572          self.sur
+00044a40: 6661 6365 733d 4e6f 6e65 0d0a 2020 2020  faces=None..    
+00044a50: 2020 2020 7365 6c66 2e73 7572 6661 6365      self.surface
+00044a60: 735f 626f 743d 4e6f 6e65 0d0a 2020 2020  s_bot=None..    
+00044a70: 2020 2020 7365 6c66 2e6f 7267 5f73 7572      self.org_sur
+00044a80: 6661 6365 733d 4e6f 6e65 0d0a 2020 2020  faces=None..    
+00044a90: 2020 2020 7365 6c66 2e73 7572 6661 6365      self.surface
+00044aa0: 735f 6279 5f70 696c 6573 3d7b 7d0d 0a20  s_by_piles={}.. 
+00044ab0: 2020 2020 2020 2073 656c 662e 7375 7266         self.surf
+00044ac0: 6163 6573 5f62 6f74 5f62 795f 7069 6c65  aces_bot_by_pile
+00044ad0: 733d 7b7d 0d0a 2020 2020 2020 2020 7365  s={}..        se
+00044ae0: 6c66 2e6f 7267 5f73 7572 6661 6365 735f  lf.org_surfaces_
+00044af0: 6279 5f70 696c 6573 3d7b 7d0d 0a         by_piles={}..
```

### Comparing `Geoarchpy-1.0.0/ArchPy/data_transfo.py` & `Geoarchpy-1.0.1/ArchPy/data_transfo.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/ArchPy/ineq.py` & `Geoarchpy-1.0.1/ArchPy/ineq.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/ArchPy/infer.py` & `Geoarchpy-1.0.1/ArchPy/infer.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/ArchPy/inputs.py` & `Geoarchpy-1.0.1/ArchPy/inputs.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/ArchPy/tpgs.py` & `Geoarchpy-1.0.1/ArchPy/tpgs.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/ArchPy/x_valid.py` & `Geoarchpy-1.0.1/ArchPy/x_valid.py`

 * *Files 0% similar despite different names*

```diff
@@ -811,15 +811,15 @@
         figsize = (int(df_conf_norm.shape[0]/3), int(df_conf_norm.shape[0]/3))
         plt.figure(figsize=figsize)
         plot_confusion_matrix(df_conf_norm, title="Normalized Confusion matrix")
         df_conf_norm_fa = df_conf_norm.copy()
 
 # other things to add ?
 
-    return (np.array(score_folds), df_conf_norm_un, df_conf_norm_fa)
+    return (np.array(score_folds, dtype="object"), df_conf_norm_un, df_conf_norm_fa)
 
 def plot_confusion_matrix(df, title='Confusion matrix', cmap="plasma"):
 
     plt.imshow(df, cmap=cmap) # imshow
     plt.title("Confusion matrix")
     plt.colorbar()
     tick_marks = np.arange(len(df.columns))
```

### Comparing `Geoarchpy-1.0.0/Geoarchpy.egg-info/PKG-INFO` & `Geoarchpy-1.0.1/Geoarchpy.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Geoarchpy
-Version: 1.0.0
+Version: 1.0.1
 Summary: Simpler geological and property models
 Home-page: https://github.com/randlab/ArchPy
 Author: Ludovic Schorpp
 Author-email: ludovic.schorpp@unine.ch
 License:                     GNU GENERAL PUBLIC LICENSE
                                Version 3, 29 June 2007
```

### Comparing `Geoarchpy-1.0.0/LICENSE` & `Geoarchpy-1.0.1/LICENSE`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/PKG-INFO` & `Geoarchpy-1.0.1/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Geoarchpy
-Version: 1.0.0
+Version: 1.0.1
 Summary: Simpler geological and property models
 Home-page: https://github.com/randlab/ArchPy
 Author: Ludovic Schorpp
 Author-email: ludovic.schorpp@unine.ch
 License:                     GNU GENERAL PUBLIC LICENSE
                                Version 3, 29 June 2007
```

### Comparing `Geoarchpy-1.0.0/README.md` & `Geoarchpy-1.0.1/README.md`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.0/setup.py` & `Geoarchpy-1.0.1/setup.py`

 * *Files 3% similar despite different names*

```diff
@@ -2,26 +2,25 @@
 import setuptools
 
 with open("README.md", "r") as file:
     long_desc = file.read()
 
 setuptools.setup(
     name='Geoarchpy',
-    version='1.0.0',
+    version='1.0.1',
     author="Ludovic Schorpp",
     author_email="ludovic.schorpp@unine.ch",
     description="Simpler geological and property models",
     long_description=long_desc,
     long_description_content_type='text/markdown',
     url = "https://github.com/randlab/ArchPy",
     install_requires=['matplotlib',
                       'numpy',
-                      'pyvista==0.37.0',
+                      'pyvista',
                       'scipy',
-                      'numba',
                       'scikit-learn',
                       'pyyaml',
                       'pandas',
                       'shapely < 2.0',
                        'rasterio',
                        'geopandas'],  # download geone
     packages=setuptools.find_packages(),
```

