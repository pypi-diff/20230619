# Comparing `tmp/primawera-0.4.1-py3-none-any.whl.zip` & `tmp/primawera-0.5.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,28 @@
-Zip file size: 44180 bytes, number of entries: 25
--rw-r--r--  2.0 unx      981 b- defN 23-Apr-27 12:15 primawera/HighlightScrollArea.py
--rw-r--r--  2.0 unx      332 b- defN 23-Apr-27 12:15 primawera/__init__.py
--rw-r--r--  2.0 unx    14890 b- defN 23-Apr-27 12:15 primawera/app.py
--rw-r--r--  2.0 unx     6460 b- defN 23-Apr-27 12:18 primawera/canvas2d.py
--rw-r--r--  2.0 unx     9339 b- defN 23-Apr-27 12:18 primawera/canvas3d.py
--rw-r--r--  2.0 unx    16521 b- defN 23-Apr-27 12:18 primawera/canvasbase.py
--rw-r--r--  2.0 unx     7096 b- defN 23-Apr-27 12:15 primawera/canvascomplex.py
--rw-r--r--  2.0 unx     1427 b- defN 23-Apr-27 12:15 primawera/filters.py
--rw-r--r--  2.0 unx     1514 b- defN 23-Apr-27 12:15 primawera/html_codes.py
--rw-r--r--  2.0 unx     2982 b- defN 23-Apr-27 12:15 primawera/informationwindow.py
--rw-r--r--  2.0 unx     3731 b- defN 23-Apr-27 12:15 primawera/loading.py
--rw-r--r--  2.0 unx     2183 b- defN 23-Apr-27 12:15 primawera/lut.py
--rw-r--r--  2.0 unx     1387 b- defN 23-Apr-27 12:15 primawera/modeutils.py
--rw-r--r--  2.0 unx     3041 b- defN 23-Apr-27 12:15 primawera/pixmaplabel.py
--rw-r--r--  2.0 unx     4774 b- defN 23-Apr-27 12:15 primawera/previewwindow.py
--rw-r--r--  2.0 unx    10154 b- defN 23-Apr-27 12:15 primawera/visualiser.py
--rw-rw-rw-  2.0 unx     3656 b- defN 23-Apr-27 12:15 primawera/luts/grayscale.lut
--rw-rw-rw-  2.0 unx     3366 b- defN 23-Apr-27 12:15 primawera/luts/jet.lut
--rw-rw-rw-  2.0 unx     3767 b- defN 23-Apr-27 12:15 primawera/luts/sepia.lut
--rw-rw-rw-  2.0 unx    35149 b- defN 23-Apr-27 12:25 primawera-0.4.1.dist-info/COPYING.txt
--rw-r--r--  2.0 unx     2821 b- defN 23-Apr-27 12:25 primawera-0.4.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-27 12:25 primawera-0.4.1.dist-info/WHEEL
--rw-r--r--  2.0 unx       46 b- defN 23-Apr-27 12:25 primawera-0.4.1.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       10 b- defN 23-Apr-27 12:25 primawera-0.4.1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2020 b- defN 23-Apr-27 12:25 primawera-0.4.1.dist-info/RECORD
-25 files, 137739 bytes uncompressed, 40952 bytes compressed:  70.3%
+Zip file size: 45166 bytes, number of entries: 26
+-rw-r--r--  2.0 unx      332 b- defN 23-Jun-19 20:02 primawera/__init__.py
+-rw-r--r--  2.0 unx    16496 b- defN 23-Jun-19 20:02 primawera/app.py
+-rw-r--r--  2.0 unx     1427 b- defN 23-Jun-19 20:02 primawera/filters.py
+-rw-r--r--  2.0 unx     1514 b- defN 23-Jun-19 20:02 primawera/html_codes.py
+-rw-r--r--  2.0 unx     4363 b- defN 23-Jun-19 20:02 primawera/loading.py
+-rw-r--r--  2.0 unx     2183 b- defN 23-Jun-19 20:02 primawera/lut.py
+-rw-r--r--  2.0 unx     1387 b- defN 23-Jun-19 20:02 primawera/modeutils.py
+-rw-rw-rw-  2.0 unx     3656 b- defN 23-Jun-19 20:02 primawera/luts/grayscale.lut
+-rw-rw-rw-  2.0 unx     3366 b- defN 23-Jun-19 20:02 primawera/luts/jet.lut
+-rw-rw-rw-  2.0 unx     3767 b- defN 23-Jun-19 20:02 primawera/luts/sepia.lut
+-rw-r--r--  2.0 unx      981 b- defN 23-Jun-19 20:02 primawera/widgets/HighlightScrollArea.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-19 20:02 primawera/widgets/__init__.py
+-rw-r--r--  2.0 unx     6476 b- defN 23-Jun-19 20:02 primawera/widgets/canvas2d.py
+-rw-r--r--  2.0 unx     9303 b- defN 23-Jun-19 20:02 primawera/widgets/canvas3d.py
+-rw-r--r--  2.0 unx    16407 b- defN 23-Jun-19 20:02 primawera/widgets/canvasbase.py
+-rw-r--r--  2.0 unx     7073 b- defN 23-Jun-19 20:02 primawera/widgets/canvascomplex.py
+-rw-r--r--  2.0 unx     2981 b- defN 23-Jun-19 20:02 primawera/widgets/informationwindow.py
+-rw-r--r--  2.0 unx     2948 b- defN 23-Jun-19 20:02 primawera/widgets/pixmaplabel.py
+-rw-r--r--  2.0 unx     4782 b- defN 23-Jun-19 20:02 primawera/widgets/previewwindow.py
+-rw-r--r--  2.0 unx    10156 b- defN 23-Jun-19 20:02 primawera/widgets/visualiser.py
+-rw-rw-rw-  2.0 unx    35149 b- defN 23-Jun-19 20:06 primawera-0.5.0.dist-info/COPYING.txt
+-rw-r--r--  2.0 unx     2967 b- defN 23-Jun-19 20:06 primawera-0.5.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-19 20:06 primawera-0.5.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       46 b- defN 23-Jun-19 20:06 primawera-0.5.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       10 b- defN 23-Jun-19 20:06 primawera-0.5.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2175 b- defN 23-Jun-19 20:06 primawera-0.5.0.dist-info/RECORD
+26 files, 140037 bytes uncompressed, 41660 bytes compressed:  70.3%
```

## zipnote {}

```diff
@@ -1,76 +1,79 @@
-Filename: primawera/HighlightScrollArea.py
-Comment: 
-
 Filename: primawera/__init__.py
 Comment: 
 
 Filename: primawera/app.py
 Comment: 
 
-Filename: primawera/canvas2d.py
+Filename: primawera/filters.py
 Comment: 
 
-Filename: primawera/canvas3d.py
+Filename: primawera/html_codes.py
 Comment: 
 
-Filename: primawera/canvasbase.py
+Filename: primawera/loading.py
 Comment: 
 
-Filename: primawera/canvascomplex.py
+Filename: primawera/lut.py
 Comment: 
 
-Filename: primawera/filters.py
+Filename: primawera/modeutils.py
 Comment: 
 
-Filename: primawera/html_codes.py
+Filename: primawera/luts/grayscale.lut
+Comment: 
+
+Filename: primawera/luts/jet.lut
 Comment: 
 
-Filename: primawera/informationwindow.py
+Filename: primawera/luts/sepia.lut
 Comment: 
 
-Filename: primawera/loading.py
+Filename: primawera/widgets/HighlightScrollArea.py
 Comment: 
 
-Filename: primawera/lut.py
+Filename: primawera/widgets/__init__.py
 Comment: 
 
-Filename: primawera/modeutils.py
+Filename: primawera/widgets/canvas2d.py
 Comment: 
 
-Filename: primawera/pixmaplabel.py
+Filename: primawera/widgets/canvas3d.py
 Comment: 
 
-Filename: primawera/previewwindow.py
+Filename: primawera/widgets/canvasbase.py
 Comment: 
 
-Filename: primawera/visualiser.py
+Filename: primawera/widgets/canvascomplex.py
 Comment: 
 
-Filename: primawera/luts/grayscale.lut
+Filename: primawera/widgets/informationwindow.py
 Comment: 
 
-Filename: primawera/luts/jet.lut
+Filename: primawera/widgets/pixmaplabel.py
 Comment: 
 
-Filename: primawera/luts/sepia.lut
+Filename: primawera/widgets/previewwindow.py
+Comment: 
+
+Filename: primawera/widgets/visualiser.py
 Comment: 
 
-Filename: primawera-0.4.1.dist-info/COPYING.txt
+Filename: primawera-0.5.0.dist-info/COPYING.txt
 Comment: 
 
-Filename: primawera-0.4.1.dist-info/METADATA
+Filename: primawera-0.5.0.dist-info/METADATA
 Comment: 
 
-Filename: primawera-0.4.1.dist-info/WHEEL
+Filename: primawera-0.5.0.dist-info/WHEEL
 Comment: 
 
-Filename: primawera-0.4.1.dist-info/entry_points.txt
+Filename: primawera-0.5.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: primawera-0.4.1.dist-info/top_level.txt
+Filename: primawera-0.5.0.dist-info/top_level.txt
 Comment: 
 
-Filename: primawera-0.4.1.dist-info/RECORD
+Filename: primawera-0.5.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## primawera/app.py

```diff
@@ -1,37 +1,41 @@
 import sys
+from os.path import dirname
 from typing import Optional, Union
 
 import numpy as np
 from PIL import UnidentifiedImageError
 from PyQt5 import QtCore, QtWidgets
 from PyQt5.QtCore import pyqtSlot
 from PyQt5.QtGui import QFont
 from PyQt5.QtWidgets import QApplication, QAction, QFileDialog, QLabel, \
     QActionGroup, QMessageBox, QMainWindow
 from numpy.typing import ArrayLike, NDArray
 
 from primawera import lut
-from primawera.canvas2d import Canvas2D
-from primawera.canvas3d import Canvas3D
-from primawera.canvascomplex import CanvasComplex
 from primawera.html_codes import about_page_content, command_page_content
 from primawera.loading import load_data, UnsupportedFormatError
 from primawera.modeutils import translate_mode
+from primawera.widgets.canvas2d import Canvas2D
+from primawera.widgets.canvas3d import Canvas3D
+from primawera.widgets.canvascomplex import CanvasComplex
 
 
 class MainWindow(QtWidgets.QMainWindow):
     def __init__(self, filepath: Optional[str] = None,
                  data: Optional[ArrayLike] = None, mode: Optional[str] = None,
                  title: Optional[str] = "Primawera",
                  overlay_data: Optional[NDArray[int]] = None,
                  overlay_is_grayscale: bool = True):
         super(MainWindow, self).__init__()
         # TODO: rework
 
+        self.last_accessed_file_path = "."
+        self.last_accessed_folder_path = "."
+
         if data is not None:
             data = np.asanyarray(data)
 
         if mode is not None:
             mode = mode.strip()
             if filepath is not None:
                 QMessageBox \
@@ -65,15 +69,17 @@
                                      "manually.",
                                      buttons=QMessageBox.Ok,
                                      defaultButton=QMessageBox.Ok)
                 raise RuntimeError("The mode of the image data could not be"
                                    "automatically decided.")
 
         self.setWindowTitle(title)
-        # self.setMinimumSize(300, 300)
+
+        # Set up central widget
+        self.central_widget = None
 
         # Set up fonts
         self.main_font = QFont("Noto Sans")
         self.setFont(self.main_font)
 
         # Set up LUTs
         lut.fill_luts()
@@ -140,14 +146,17 @@
         return None
 
     def _start_visualiser(self, data: ArrayLike, mode: str,
                           overlay_data: Optional[NDArray[int]] = None,
                           overlay_is_grayscale: bool = False) -> None:
         if self.canvas is not None:
             self.canvas.close()
+            self.canvas = None
+        if self.central_widget is not None:
+            self.central_widget.deleteLater()
 
         data = np.asanyarray(data)
 
         if mode == "C":
             # Complex data
             self.canvas = CanvasComplex(data, mode,
                                         self.desktop_height,
@@ -161,15 +170,29 @@
         else:
             self.canvas = Canvas3D(data, mode,
                                    self.desktop_height,
                                    self.desktop_width, {},
                                    {}, overlay_data=overlay_data,
                                    overlay_is_grayscale=overlay_is_grayscale)
         self.canvas.menus_changed_signal.connect(self._refresh_menu_bar)
-        self.setCentralWidget(self.canvas)
+
+        layout = QtWidgets.QVBoxLayout()
+        # NOTE: This is a terrible hack to keep the widget's width to at least
+        # 300. For some internal and quite shady reason, if you set the minimum
+        # size of the canvas widget directly, the geometry calculations break,
+        # causing the whole layout to stop working properly when the user zooms
+        # in. Also, for some smart reason, the minimum size of the menubar
+        # is completely ignored...
+        spacer = QtWidgets.QWidget()
+        spacer.setFixedSize(QtCore.QSize(300, 10))
+        layout.addWidget(spacer)
+        layout.addWidget(self.canvas)
+        self.central_widget = QtWidgets.QWidget()
+        self.central_widget.setLayout(layout)
+        self.setCentralWidget(self.central_widget)
         self._refresh_menu_bar()
 
     @pyqtSlot()
     def _refresh_menu_bar(self) -> None:
         # Clear menubar
         self._create_menu_bar()
 
@@ -231,30 +254,39 @@
     def closeEvent(self, event) -> None:
         self.canvas.closeEvent(event)
         if self._help_window is not None:
             self._help_window.close()
         event.accept()
 
     def open_file(self) -> None:
-        file_name, _ = QFileDialog.getOpenFileName(self, "Open file", ".",
-                                                   "Image file (*.jpg *.png"
-                                                   " *.h5 *.tif *.tiff)")
+        file_name, _ = QFileDialog. \
+            getOpenFileName(self, "Open file",
+                            self.last_accessed_file_path,
+                            "Image file (*.jpg *.png"
+                            " *.h5 *.tif *.tiff)")
         if file_name == "":
             # User did not select a file
             return
+
+        parent_path = dirname(file_name)  # path to the parent directory
+        if file_name != "":
+            self.last_accessed_file_path = parent_path
+
         self._open(file_name)
 
     def open_folder(self) -> None:
-        folder_name = QFileDialog.getExistingDirectory(self, "Open folder",
-                                                       ".",
-                                                       QFileDialog.ShowDirsOnly
-                                                       )
+        folder_name = QFileDialog. \
+            getExistingDirectory(self, "Open folder",
+                                 self.last_accessed_folder_path,
+                                 QFileDialog.ShowDirsOnly
+                                 )
         if folder_name == "":
             # No folder was selected
             return
+        self.last_accessed_folder_path = folder_name
         self._open(folder_name)
 
     def _open(self, path: str) -> None:
         try:
             data, mode = load_data(path)
             self._start_visualiser(data, mode)
         except UnsupportedFormatError as err:
@@ -276,14 +308,22 @@
     def about_command(self) -> None:
         self._help_window = QLabel(about_page_content)
         self._help_window.setWindowTitle("Primawera - About window.")
         self._help_window.setFont(self.main_font)
         self._help_window.setMargin(10)
         self._help_window.show()
 
+    def paintEvent(self, event) -> None:
+        super().paintEvent(event)
+        # NOTE: According to the documentation, the resizeEvent should be
+        # called when the window's size changes; however, when the user zooms
+        # in, the event is not always called. This function ensures that the
+        # new size is calculated properly.
+        self.adjustSize()
+
 
 def print_help(name: str) -> None:
     print(f"Usage: {name} FILEPATH\n"
           f"-----\n"
           f"Filepath specifies path to an image file. It is optional.\n\n")
```

## primawera/loading.py

```diff
@@ -11,16 +11,23 @@
 class UnsupportedFormatError(Exception):
     pass
 
 
 def tiff_to_array(image) -> ArrayLike:
     """
     Takes a Tiff image and returns the raw data as a numpy array.
-    :param image: Tiff image (PIL).
-    :return: Numpy array with data.
+
+    Parameters
+    ----------
+    image: tiff image object
+
+    Returns
+    -------
+    ndarray with the same data
+
     """
     result = []
     for i in range(image.n_frames):
         image.seek(i)
         current_frame = np.array(image)
         result.append(current_frame)
     return np.array(result)
@@ -53,14 +60,31 @@
     else:
         raise RuntimeError(
             f"'{data_path}' is neither a regular file nor a directory!")
     return raw_data, mode
 
 
 def load_folder(path_to_dir: str):
+    """
+    Loads all PNG images in the given folder. All images must have the same
+    mode and dimensions.
+
+    The images are loaded in sorted order (sorting is done by the built-in
+    sorted() function on top of listdir).
+
+    Parameters
+    ----------
+    path_to_dir: string
+        Path to the directory.
+
+    Returns
+    -------
+    All images inside a single 3D stack.
+
+    """
     raw_data = []
     mode = ""
     for file in sorted(listdir(path_to_dir)):
         if file.endswith(".png"):
             file_data, file_mode = load_file(
                 path.join(path_to_dir, file))
 
@@ -75,55 +99,67 @@
             if mode == "":
                 mode = file_mode
 
             raw_data.append(file_data[0])
     return np.array(raw_data), mode
 
 
-def load_file(file_path: str):
-    # TODO: decompose this if else
+def load_file(file_path):
+    """
+    Load a file on the given path to a 3D numpy array. The array has the
+    following shape: frame, width, height.
+
+    Parameters
+    ----------
+    file_path: string
+        Path to the file.
+
+    Returns
+    -------
+    numpy array filled with the image data and the image mode as string.
+
+    """
     if file_path.endswith((".tif", ".tiff")):
         with Image.open(file_path) as tiff_file:
             mode = tiff_file.mode
             raw_data = tiff_to_array(tiff_file)
+
     elif file_path.endswith(".h5"):
         with h5py.File(file_path) as h5_file:
             h5_dataset = h5_file["Image"]
             type = h5_dataset.dtype
             if type in [np.float64, np.double, np.float32, np.float16,
                         np.single]:
                 mode = "F"
             elif type == np.complex128:
                 mode = "C"
             else:
-                mode = "L"
+                mode = "L"  # Grayscale
             raw_data = np.zeros(h5_dataset.shape, dtype=type)
             h5_dataset.read_direct(raw_data)
+
     elif file_path.endswith((".jpg", ".png")):
         with Image.open(file_path) as image_file:
             raw_data = np.array(image_file, dtype=np.uint8).copy()
             mode = image_file.mode
         if mode == "RGB":
             raw_data = np.array([raw_data])
     else:
         raise UnsupportedFormatError("Unsupported file format!")
 
+    # Convert various file modes to a unified mode.
     if mode == "I;16" or mode == "I;16B":
         mode = "grayscale"
     elif mode == "L":
         mode = "grayscale"
     elif mode == "RGB":
         mode = "rgb"
     elif mode == "1" or mode == "F" or mode == "C":
         pass
     else:
-        err = UnsupportedFormatError(f"Mode: \"{mode}\" is not implemented.")
-        err.add_note(
-            "See: https://pillow.readthedocs.io/en/stable/handbook/"
-            "concepts.html")
-        raise err
+        raise UnsupportedFormatError(f"Mode: \"{mode}\" is not implemented.")
 
     # grayscale single frame data
     if len(raw_data.shape) == 2:
         raw_data = np.array([raw_data])
 
     return raw_data, mode
```

## Comparing `primawera/HighlightScrollArea.py` & `primawera/widgets/HighlightScrollArea.py`

 * *Files identical despite different names*

## Comparing `primawera/canvas2d.py` & `primawera/widgets/canvas2d.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 from typing import Dict, List, Tuple, Optional
 
 import numpy as np
 from PyQt5.QtCore import Qt, pyqtSignal
 from PyQt5.QtWidgets import QAction
 from numpy.typing import ArrayLike, NDArray
 
-from primawera.canvasbase import CanvasBase
 from primawera.filters import linear_stretch, gamma_correction, \
     linear_contrast, logarithm_stretch
 from primawera.lut import apply_lut
-from primawera.visualiser import Visualiser
+from primawera.widgets.canvasbase import CanvasBase
+from primawera.widgets.visualiser import Visualiser
 
 
 class Canvas2D(CanvasBase):
     menus_changed_signal = pyqtSignal()
 
     def __init__(self, data: ArrayLike, mode: str,
                  desktop_height: int, desktop_width: int,
```

## Comparing `primawera/canvas3d.py` & `primawera/widgets/canvas3d.py`

 * *Files 0% similar despite different names*

```diff
@@ -2,19 +2,19 @@
 
 import numpy as np
 from PyQt5 import QtCore
 from PyQt5.QtCore import Qt
 from PyQt5.QtWidgets import QGridLayout
 from numpy.typing import ArrayLike, NDArray
 
-from primawera.canvasbase import CanvasBase
 from primawera.filters import linear_stretch, gamma_correction, \
     linear_contrast, logarithm_stretch
 from primawera.lut import apply_lut
-from primawera.visualiser import Visualiser
+from primawera.widgets.canvasbase import CanvasBase
+from primawera.widgets.visualiser import Visualiser
 
 
 class Canvas3D(CanvasBase):
     def __init__(self, data: ArrayLike, mode: str,
                  desktop_height: int, desktop_width: int,
                  filters: Optional[Dict[str, bool]] = None,
                  filters_options: Optional[Dict[str, int]] = None,
@@ -60,15 +60,14 @@
                                        maximum_width, False)
         self.view_layout.addWidget(self.vis_main_window, 0, 0, Qt.AlignTop)
         self.view_layout.addWidget(self.vis_row_time, 1, 0, Qt.AlignTop)
         self.view_layout.addWidget(self.vis_col_time, 0, 1, Qt.AlignTop)
 
         self.main_layout.addLayout(self.view_layout, 1)
 
-        # TODO: consider if it is useful any longer
         # Set up scaling factors, so that all extra space is filled using
         # spacers.
         self.view_layout.setColumnStretch(2, 1)
         self.view_layout.setRowStretch(2, 1)
 
         self.setLayout(self.main_layout)
```

## Comparing `primawera/canvasbase.py` & `primawera/widgets/canvasbase.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,18 +7,18 @@
 from PyQt5.QtGui import QKeyEvent
 from PyQt5.QtWidgets import QWidget, QVBoxLayout, QGridLayout, QAction, \
     QFileDialog, QMessageBox
 from numpy.typing import ArrayLike, NDArray
 
 import primawera.lut as lut
 from primawera.filters import linear_contrast, gamma_correction, linear_stretch
-from primawera.informationwindow import InformationWindow
 from primawera.loading import load_data
 from primawera.modeutils import is_mode_color, is_mode_grayscale
-from primawera.previewwindow import PreviewDialog
+from primawera.widgets.informationwindow import InformationWindow
+from primawera.widgets.previewwindow import PreviewDialog
 
 
 class CanvasBase(QWidget):
     menus_changed_signal = pyqtSignal()
     signal_changed_filter = pyqtSignal(str)
     signal_changed_coordinates = pyqtSignal(int, int, int, object, object,
                                             object)
@@ -171,15 +171,14 @@
             # We can linearly stretch it later
             return np.can_cast(overlay.dtype, int)
 
         # Overlay contains RGB data
         return np.can_cast(overlay.dtype, np.uint8)
 
     def _add_overlay_io(self) -> Optional[Tuple[ArrayLike, bool]]:
-        # TODO: duplicate in app.py
         file_name, _ = QFileDialog.getOpenFileName(self, "Open file", ".",
                                                    "Image file (*.jpg *.png"
                                                    " *.h5 *.tif *.tiff)")
         if file_name == "":
             # User did not select a file
             return
         try:
@@ -266,15 +265,14 @@
                 f"The shape {overlay_original.shape} is not compatible "
                 f"with underlying image {self.data.shape}. It was "
                 f"automatically reshaped to {overlay_reshaped.shape}",
                 buttons=QMessageBox.Ok,
                 defaultButton=QMessageBox.Ok)
             return
 
-        # TODO: right now the opacity is fixed
         opacity_mask_shape = list(overlay_reshaped.shape)
         opacity_mask_shape[-1] = 1
         opacity_mask = np.zeros(shape=tuple(opacity_mask_shape)).astype(
             np.uint8)
         opacity_mask[overlay_reshaped[:, :, :, 0] != 0] = 255
 
         # Add opacity (alpha channel) to the overlay data
@@ -345,15 +343,14 @@
         ]
 
     def _process_data(self):
         if self.current_filter_name is not None:
             self.signal_changed_filter.emit(self.current_filter_name)
 
     def update_desktop_size(self, width: int, height: int) -> None:
-        # TODO: this does not affect anything.
         self.desktop_width = width
         self.desktop_height = height
 
     @pyqtSlot(list)
     def preview_dialog_slot(self, data: List[Union[int, float]]) -> None:
         self.preview_dialog_value = data[0]
```

## Comparing `primawera/canvascomplex.py` & `primawera/widgets/canvascomplex.py`

 * *Files 2% similar despite different names*

```diff
@@ -2,18 +2,18 @@
 from typing import Dict, Optional
 
 import numpy as np
 from PyQt5.QtCore import Qt
 from PyQt5.QtWidgets import QAction
 from numpy.typing import ArrayLike
 
-from primawera.canvasbase import CanvasBase
 from primawera.filters import logarithm_stretch, linear_stretch
 from primawera.lut import apply_lut
-from primawera.visualiser import Visualiser
+from primawera.widgets.canvasbase import CanvasBase
+from primawera.widgets.visualiser import Visualiser
 
 
 class ShowEnum(Enum):
     MAGNITUDE = auto()
     PHASE = auto()
     REAL_PART = auto()
     IMAG_PART = auto()
@@ -23,16 +23,15 @@
 
     def __init__(self, data: ArrayLike, mode: str,
                  desktop_height: int, desktop_width: int,
                  filters: Optional[Dict[str, bool]] = None,
                  filters_options: Optional[Dict[str, int]] = None, *args,
                  **kwargs) -> None:
         super().__init__(data, mode, desktop_height, desktop_width,
-                         filters, filters_options, *args, **kwargs).__init__(
-            *args, **kwargs)
+                         filters, filters_options, *args, **kwargs)
         if self.mode != "C":
             raise RuntimeError("CanvasComplex expects complex data!")
 
         if filters:
             self.filters = filters
         else:
             self.filters = {"linear_stretch": True}
```

## Comparing `primawera/informationwindow.py` & `primawera/widgets/informationwindow.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,11 +1,10 @@
 from typing import Tuple
 
 import numpy as np
-
 from PyQt5.QtCore import pyqtSlot, Qt
 from PyQt5.QtWidgets import QWidget, QVBoxLayout, QLabel, QHBoxLayout
 from numpy.typing import DTypeLike, ArrayLike
 
 from primawera.modeutils import print_mode
```

## Comparing `primawera/pixmaplabel.py` & `primawera/widgets/pixmaplabel.py`

 * *Files 8% similar despite different names*

```diff
@@ -4,33 +4,29 @@
 from PyQt5.QtWidgets import QLabel
 
 
 class CompositionError(Exception):
     pass
 
 
-# TODO: rename
 class PixmapLabel(QLabel):
     mouse_position_signal = pyqtSignal(float, float)
 
     def __init__(self):
         super().__init__()
         self.handle_mouse_movement = False
         self._overlay_pixmap = None
         self._background_pixmap = None
         self._hide_overlay = False
 
     def setPixmap(self, pixmap: QPixmap) -> None:
         self.handle_mouse_movement = True
         self.setMouseTracking(True)
         self._background_pixmap = pixmap
-        # TODO: remove
-        # super().setPixmap(pixmap)
 
-    # TODO: rename
     def setOverlay(self, image: QImage) -> None:
         if self._background_pixmap is None:
             raise CompositionError("Cannot overlay data when background is "
                                    "equal to None!")
         if self._background_pixmap.height() != image.size().height():
             raise CompositionError(
                 f"Height mismatch! bg: {self._background_pixmap.height()} "
```

## Comparing `primawera/previewwindow.py` & `primawera/widgets/previewwindow.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,15 +2,15 @@
 
 import numpy as np
 from PyQt5.QtCore import pyqtSignal, pyqtSlot
 from PyQt5.QtWidgets import QDialog, QVBoxLayout, QLabel, QSpinBox, \
     QDoubleSpinBox, QMessageBox, QHBoxLayout, QPushButton, QCheckBox
 from numpy.typing import ArrayLike
 
-from primawera.visualiser import Visualiser
+from primawera.widgets.visualiser import Visualiser
 
 ConstraintType = Union[int, float]
 Bound = Union[int, float]
 Constraint = Tuple[str, ConstraintType, Bound, Bound, float]
 
 
 class PreviewDialog(QDialog):
```

## Comparing `primawera/visualiser.py` & `primawera/widgets/visualiser.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,17 +1,17 @@
 import numpy as np
 from PIL import ImageQt
 from PyQt5.QtCore import pyqtSignal, Qt, QSize, pyqtSlot
 from PyQt5.QtGui import QPixmap, QImage, QPalette
 from PyQt5.QtWidgets import QVBoxLayout, QWidget
 from numpy.typing import NDArray
 
-from primawera.HighlightScrollArea import HighlightScrollArea
 from primawera.loading import UnsupportedFormatError
-from primawera.pixmaplabel import PixmapLabel
+from primawera.widgets.HighlightScrollArea import HighlightScrollArea
+from primawera.widgets.pixmaplabel import PixmapLabel
 
 
 class Visualiser(QWidget):
     signal_position = pyqtSignal(int, int, int, list)
     value_change_emitter_vertical = pyqtSignal(int)
     value_change_emitter_horizontal = pyqtSignal(int)
 
@@ -138,15 +138,14 @@
             # TODO: This isn't handled in Canvas objects.
             raise UnsupportedFormatError(
                 f"Combination of mode='{self.mode}' with Canvas is not"
                 f" supported.")
         return QPixmap.fromImage(qimage)
 
     def _generate_overlay(self, frame: int) -> QPixmap:
-        # TODO: change to PREMULTIPLIED format
         assert self.overlay_data is not None
         assert np.issubdtype(self.overlay_data.dtype, np.uint8)
         overlay_image = ImageQt.QImage(self.overlay_data[frame, :, :],
                                        self.width, self.height, 4 * self.width,
                                        QImage.Format_RGBA8888)
         return QPixmap.fromImage(overlay_image)
 
@@ -198,20 +197,19 @@
                 height += 10
         if label_height >= self.MAXIMUM_HEIGHT:
             if self.main_window:
                 self.scroll_area.verticalScrollBar().setStyleSheet(
                     "QScrollBar {width:10px;}")
                 width += 10
 
+        # I am really not sure why it is needed to add the 2 pixels; otherwise,
+        # it breaks on *some* machines running Windows.
         self.scroll_area.setMaximumSize(width + 2, height + 2)
         self.scroll_area.setMinimumSize(width + 2, height + 2)
 
-        self.setMinimumSize(width + 2, height + 2)
-        self.setMaximumSize(width + 2, height + 2)
-
     def next_frame(self) -> None:
         self.choose_frame(self.frame + 1)
 
     def previous_frame(self) -> None:
         self.choose_frame(self.frame - 1)
 
     def decrease_zoom_level(self) -> None:
```

## Comparing `primawera-0.4.1.dist-info/COPYING.txt` & `primawera-0.5.0.dist-info/COPYING.txt`

 * *Files identical despite different names*

## Comparing `primawera-0.4.1.dist-info/METADATA` & `primawera-0.5.0.dist-info/METADATA`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: primawera
-Version: 0.4.1
+Version: 0.5.0
 Summary: Simple image viewer with 3D, complex and floating images support.
 Author-email: Bruno Petrus <xpetrus@fi.muni.cz>
 Project-URL: Source, https://gitlab.fi.muni.cz/xpetrus/primawera
 Project-URL: Bug tracker, https://gitlab.fi.muni.cz/xpetrus/primawera/-/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
 Classifier: Development Status :: 3 - Alpha
@@ -56,34 +56,38 @@
 The command should build a wheel file inside the `dist` folder. To install it run:
 ```bash
 pip install <PATH TO WHEEL FILE>
 ```
 
 # Usage
 
-## Start without any data
+## Open empty window
 
 It is possible to run the viewer without any data.
 ```python
 from primawera.app import create_window
 create_window()
 ```
 
 ## Visualise numpy data
 
 If you want to visualise data inside a numpy array, you will have to import the function `run_app`. Sometimes it is not
 possible to automatically infer the mode (see [Pillow image modes](https://pillow.readthedocs.io/en/stable/handbook/concepts.html)).
-in which case it has to be provided it manually.
+in which case it has to be provided manually.
 ```python
 from primawera.app import run_app
 import numpy as np
 data = np.random.random((10, 10, 10))
 run_app(data)
 # Or
 run_app(data, mode="float")
+
+# You can also add overlay data
+overlay_data = np.random.random(data.shape)  # same shape as data
+run_app(data, mode="float", overlay_data=overlay_data)
 ```
 
 ## Run from terminal
 
 Simply run
 
 ```bash
```

## Comparing `primawera-0.4.1.dist-info/RECORD` & `primawera-0.5.0.dist-info/RECORD`

 * *Files 21% similar despite different names*

```diff
@@ -1,25 +1,26 @@
-primawera/HighlightScrollArea.py,sha256=FjoXNUa36PtJPWIgw8vHibsqGDmAPoD60lO1TeObkp8,981
 primawera/__init__.py,sha256=ePNs-xclORfBJ8nLZgrfvKuIIf1sLWozhTxGNaSNnzI,332
-primawera/app.py,sha256=QREEhslogJCN4NOzq0Cg-BpH1dTT4HD8OzlLlOPPSCk,14890
-primawera/canvas2d.py,sha256=2ZuA4w9cho_5NYoj7txR7uK-DUF_Ycyxk3mzMPwkVMk,6460
-primawera/canvas3d.py,sha256=6mTlMh_pxMIBMr4rFgsNQ-uz8RvpbXVxOpjbRRpgbC8,9339
-primawera/canvasbase.py,sha256=UPLCtINirBU9S4uDv7M30kPeKYt8zi8LMdlEi6BszWc,16521
-primawera/canvascomplex.py,sha256=rcRXAqs885xjBpll_SYKrSGlcO4zTPjPo3wKaCBK66c,7096
+primawera/app.py,sha256=Gg_BuvUoKXtdFlDrcl7jTCAoKX65xJLkWIEqpXq5Hs0,16496
 primawera/filters.py,sha256=0wFr0q9vcRfOj-2SdIu0YTfxH6oZF4YJY3DCunpdW6g,1427
 primawera/html_codes.py,sha256=p-Ra6YLqApfh0OSXzU4SsE-LbsDGIs5dfaQEFMM76Nw,1514
-primawera/informationwindow.py,sha256=Gs_rGah_pzlaDPW00b2joo0TsHWSv9n8QMLtgmGWPLs,2982
-primawera/loading.py,sha256=tp54p9psiz7-CR_FvL39PG2TYQWQjZ6_U5sDlC26gbg,3731
+primawera/loading.py,sha256=Tsbf553JP5hmOD7hdP9iOtQiUENewqaD1IJ7En7YMQk,4363
 primawera/lut.py,sha256=rbCygkEOB1d3CpBRi_Xga9JgorZmy7rOcWPzps8ejyI,2183
 primawera/modeutils.py,sha256=btbc18qjTfw-DfBxe-pFzeX0iNMUrFHyyJZ48lVceaI,1387
-primawera/pixmaplabel.py,sha256=_nG8d1eihS9DR-L6GccLqAjpOz1kfp51t4Db__vU6Wk,3041
-primawera/previewwindow.py,sha256=yKtnPf1TQdfQ_UmC10PVIHw3bh60M5jKinrlE_uRuvY,4774
-primawera/visualiser.py,sha256=BLxHGu_R8lpA2wNyq3OIiQCPw0vx2cYieJPjG3KUtUk,10154
 primawera/luts/grayscale.lut,sha256=9TVO_IhYWXtn1vI99RX8Gp8zrnYMnCW_KzOi4DFGOxs,3656
 primawera/luts/jet.lut,sha256=o1TAkAO-Xz47WpeSn2KZW_-4_vRXugmVQ5esJtbscSo,3366
 primawera/luts/sepia.lut,sha256=uDHATW9-t3ArAtYN6s0Wh8yFl7Tu1MllKPaGC8i4YtU,3767
-primawera-0.4.1.dist-info/COPYING.txt,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
-primawera-0.4.1.dist-info/METADATA,sha256=THL7D17z-jJ5WRVUFQBC2clcnjKuApq2ZsDgTVrV_gw,2821
-primawera-0.4.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-primawera-0.4.1.dist-info/entry_points.txt,sha256=45CSMKGMvbRZAWyosbH0DNWMqhkX32T4egoJrlKzOdM,46
-primawera-0.4.1.dist-info/top_level.txt,sha256=JYh4fep6QQlzXuAbJxUllSjnupXyTh-7MshyywqRPZg,10
-primawera-0.4.1.dist-info/RECORD,,
+primawera/widgets/HighlightScrollArea.py,sha256=FjoXNUa36PtJPWIgw8vHibsqGDmAPoD60lO1TeObkp8,981
+primawera/widgets/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+primawera/widgets/canvas2d.py,sha256=mSVJYe--bjsD9gK1PHAWyItVKFT6FlKdzbr82KtaDhI,6476
+primawera/widgets/canvas3d.py,sha256=2vdTH3znxswoQRGBOVW0kLWSUCQFBBbdEtcVFlMS5BI,9303
+primawera/widgets/canvasbase.py,sha256=3UZ8A1cOXJMp2CZFNN49VjU_xClSbWNpCiOP2pw-u9M,16407
+primawera/widgets/canvascomplex.py,sha256=DjWjPE-4QJms3oZFFq2lPtmt1CUDc1xxr8nxY5t0u5Q,7073
+primawera/widgets/informationwindow.py,sha256=PJlz-kZqdqF_fXZzfJIFcYg0GFAd-SNgOH2JtqpkpT8,2981
+primawera/widgets/pixmaplabel.py,sha256=Hj264rwqzgF82DCGznztp6qecOqbiGb4AOZ3gk-Va1g,2948
+primawera/widgets/previewwindow.py,sha256=iq9GUhx75kbhi2HZTqbRsGC82nXR4SPvLzWAdld04tg,4782
+primawera/widgets/visualiser.py,sha256=LdkvinqJ3DftKN6Yajj0yjyZquFTJdprP-5vDddxOTM,10156
+primawera-0.5.0.dist-info/COPYING.txt,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
+primawera-0.5.0.dist-info/METADATA,sha256=lxICoFCkYbHemYuv9YyD9ldwZSMavQIESMVPb7k_Vj4,2967
+primawera-0.5.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+primawera-0.5.0.dist-info/entry_points.txt,sha256=45CSMKGMvbRZAWyosbH0DNWMqhkX32T4egoJrlKzOdM,46
+primawera-0.5.0.dist-info/top_level.txt,sha256=JYh4fep6QQlzXuAbJxUllSjnupXyTh-7MshyywqRPZg,10
+primawera-0.5.0.dist-info/RECORD,,
```

