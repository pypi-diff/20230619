# Comparing `tmp/drift_cli-0.6.0-py3-none-any.whl.zip` & `tmp/drift_cli-0.6.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,20 +1,20 @@
-Zip file size: 23417 bytes, number of entries: 18
--rw-r--r--  2.0 unx      192 b- defN 23-Apr-12 10:47 drift_cli/__init__.py
--rw-r--r--  2.0 unx       84 b- defN 23-Apr-12 10:47 drift_cli/__main__.py
--rw-r--r--  2.0 unx     2344 b- defN 23-Apr-12 10:47 drift_cli/alias.py
--rw-r--r--  2.0 unx     1216 b- defN 23-Apr-12 10:47 drift_cli/cli.py
--rw-r--r--  2.0 unx      829 b- defN 23-Apr-12 10:47 drift_cli/config.py
--rw-r--r--  2.0 unx     2715 b- defN 23-Apr-12 10:47 drift_cli/export.py
--rw-r--r--  2.0 unx     7325 b- defN 23-Apr-12 10:47 drift_cli/export_impl/raw.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-12 10:47 drift_cli/utils/__init__.py
--rw-r--r--  2.0 unx      129 b- defN 23-Apr-12 10:47 drift_cli/utils/consoles.py
--rw-r--r--  2.0 unx      513 b- defN 23-Apr-12 10:47 drift_cli/utils/error.py
--rw-r--r--  2.0 unx     5060 b- defN 23-Apr-12 10:47 drift_cli/utils/helpers.py
--rw-r--r--  2.0 unx     2280 b- defN 23-Apr-12 10:47 drift_cli/utils/humanize.py
--rw-r--r--  2.0 unx    16725 b- defN 23-Apr-12 10:47 drift_cli-0.6.0.dist-info/LICENSE
--rw-r--r--  2.0 unx    22526 b- defN 23-Apr-12 10:47 drift_cli-0.6.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-12 10:47 drift_cli-0.6.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       45 b- defN 23-Apr-12 10:47 drift_cli-0.6.0.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       10 b- defN 23-Apr-12 10:47 drift_cli-0.6.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1443 b- defN 23-Apr-12 10:47 drift_cli-0.6.0.dist-info/RECORD
-18 files, 63528 bytes uncompressed, 21059 bytes compressed:  66.9%
+Zip file size: 23345 bytes, number of entries: 18
+-rw-r--r--  2.0 unx      192 b- defN 23-Jun-19 09:37 drift_cli/__init__.py
+-rw-r--r--  2.0 unx       84 b- defN 23-Jun-19 09:37 drift_cli/__main__.py
+-rw-r--r--  2.0 unx     2344 b- defN 23-Jun-19 09:37 drift_cli/alias.py
+-rw-r--r--  2.0 unx     1216 b- defN 23-Jun-19 09:37 drift_cli/cli.py
+-rw-r--r--  2.0 unx      829 b- defN 23-Jun-19 09:37 drift_cli/config.py
+-rw-r--r--  2.0 unx     2716 b- defN 23-Jun-19 09:37 drift_cli/export.py
+-rw-r--r--  2.0 unx     7359 b- defN 23-Jun-19 09:37 drift_cli/export_impl/raw.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-19 09:37 drift_cli/utils/__init__.py
+-rw-r--r--  2.0 unx      129 b- defN 23-Jun-19 09:37 drift_cli/utils/consoles.py
+-rw-r--r--  2.0 unx      513 b- defN 23-Jun-19 09:37 drift_cli/utils/error.py
+-rw-r--r--  2.0 unx     4726 b- defN 23-Jun-19 09:37 drift_cli/utils/helpers.py
+-rw-r--r--  2.0 unx     2280 b- defN 23-Jun-19 09:37 drift_cli/utils/humanize.py
+-rw-r--r--  2.0 unx    16725 b- defN 23-Jun-19 09:37 drift_cli-0.6.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx    22526 b- defN 23-Jun-19 09:37 drift_cli-0.6.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-19 09:37 drift_cli-0.6.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       45 b- defN 23-Jun-19 09:37 drift_cli-0.6.1.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       10 b- defN 23-Jun-19 09:37 drift_cli-0.6.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1443 b- defN 23-Jun-19 09:37 drift_cli-0.6.1.dist-info/RECORD
+18 files, 63229 bytes uncompressed, 20987 bytes compressed:  66.8%
```

## zipnote {}

```diff
@@ -30,26 +30,26 @@
 
 Filename: drift_cli/utils/helpers.py
 Comment: 
 
 Filename: drift_cli/utils/humanize.py
 Comment: 
 
-Filename: drift_cli-0.6.0.dist-info/LICENSE
+Filename: drift_cli-0.6.1.dist-info/LICENSE
 Comment: 
 
-Filename: drift_cli-0.6.0.dist-info/METADATA
+Filename: drift_cli-0.6.1.dist-info/METADATA
 Comment: 
 
-Filename: drift_cli-0.6.0.dist-info/WHEEL
+Filename: drift_cli-0.6.1.dist-info/WHEEL
 Comment: 
 
-Filename: drift_cli-0.6.0.dist-info/entry_points.txt
+Filename: drift_cli-0.6.1.dist-info/entry_points.txt
 Comment: 
 
-Filename: drift_cli-0.6.0.dist-info/top_level.txt
+Filename: drift_cli-0.6.1.dist-info/top_level.txt
 Comment: 
 
-Filename: drift_cli-0.6.0.dist-info/RECORD
+Filename: drift_cli-0.6.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## drift_cli/export.py

```diff
@@ -85,14 +85,15 @@
         raise Abort()
 
     alias_name, _ = parse_path(src)
     alias: Alias = read_config(ctx.obj["config_path"]).aliases[alias_name]
 
     loop = asyncio.get_event_loop()
     run = loop.run_until_complete
+
     client = DriftClient(alias.address, alias.password, loop=loop)
 
     with error_handle(ctx.obj["debug"]):
         run(
             export_raw(
                 client,
                 dest,
```

## drift_cli/export_impl/raw.py

```diff
@@ -1,10 +1,10 @@
 """Export data"""
 import asyncio
-from concurrent.futures import ThreadPoolExecutor, Executor
+from concurrent.futures import ThreadPoolExecutor, Executor, ProcessPoolExecutor
 from pathlib import Path
 from typing import Optional, List, Tuple
 
 import numpy as np
 from drift_client import DriftClient
 from drift_protocol.common import StatusCode
 from drift_protocol.meta import MetaInfo
@@ -205,15 +205,15 @@
         stop: Export records  with timestamps older than this time point in ISO format
         csv: Export data as CSV instead of raw data
         topics: Export only 5
         hese topics, separated by comma. You can use * as a wildcard
     """
     sem = asyncio.Semaphore(parallel)
     with Progress() as progress:
-        with ThreadPoolExecutor() as pool:
+        with ThreadPoolExecutor(max_workers=8) as pool:
             topics = filter_topics(client.get_topics(), kwargs.pop("topics", ""))
             task = _export_csv if kwargs.pop("csv", False) else _export_topic
             task = _export_jpeg if kwargs.pop("jpeg", False) else task
 
             tasks = [
                 task(
                     pool,
```

## drift_cli/utils/helpers.py

```diff
@@ -6,15 +6,14 @@
 from concurrent.futures import Executor
 from datetime import datetime
 from pathlib import Path
 from typing import Tuple, List
 
 from click import Abort
 from drift_client import DriftClient
-from drift_client.error import DriftClientError
 from rich.progress import Progress
 
 from drift_cli.config import read_config, Alias
 from drift_cli.utils.consoles import error_console
 from drift_cli.utils.humanize import pretty_size
 
 signal_queue = Queue()
@@ -79,47 +78,40 @@
     task = progress.add_task(f"Topic '{topic}' waiting", total=stop - start)
 
     exported_size = 0
     count = 0
     stats = []
     speed = 0
 
-    loop = asyncio.get_running_loop()
+    async with sem:
+        loop = asyncio.get_running_loop()
 
-    def stop_signal():
-        signal_queue.put_nowait("stop")
+        def stop_signal():
+            signal_queue.put_nowait("stop")
 
-    try:
-        loop.add_signal_handler(signal.SIGINT, stop_signal)
-        loop.add_signal_handler(signal.SIGTERM, stop_signal)
-    except NotImplementedError:
-        error_console.print(
-            "Signals are not supported on this platform. No graceful shutdown possible."
-        )
+        try:
+            loop.add_signal_handler(signal.SIGINT, stop_signal)
+            loop.add_signal_handler(signal.SIGTERM, stop_signal)
+        except NotImplementedError:
+            error_console.print(
+                "Signals are not supported on this platform. No graceful shutdown possible."
+            )
 
-    packages = await loop.run_in_executor(
-        pool, client.get_package_names, topic, start, stop
-    )
+        it = client.walk(topic, start=start, stop=stop)
 
-    async def _read_package(pkg):
-        async with sem:
+        def _next():
             try:
-                return await loop.run_in_executor(pool, client.get_item, pkg)
-            except DriftClientError as exc:
-                error_console.print(f"Error: {exc}")
+                return next(it)
+            except StopIteration:
                 return None
 
-    packages = sorted(packages)
-    for i in range(0, len(packages), parallel):
-        tasks = [_read_package(p) for p in packages[i : i + parallel]]
-        results = await asyncio.gather(*tasks)
-
-        for drift_pkg in results:
+        while True:
+            drift_pkg = await loop.run_in_executor(pool, _next)
             if drift_pkg is None:
-                continue
+                break
 
             if signal_queue.qsize() > 0:
                 # stop signal received
                 progress.update(
                     task,
                     description=f"Topic '{topic}' "
                     f"(copied {count} packages ({pretty_size(exported_size)}), stopped",
@@ -146,15 +138,15 @@
                 advance=timestamp - last_time,
                 refresh=True,
             )
 
             yield drift_pkg, task
             last_time = timestamp
 
-    progress.update(task, total=1, completed=True)
+        progress.update(task, total=1, completed=True)
 
 
 def filter_topics(topics: List[str], names: List[str]) -> List[str]:
     """Filter entries by names"""
     if not names or len(names) == 0:
         return topics
```

## Comparing `drift_cli-0.6.0.dist-info/LICENSE` & `drift_cli-0.6.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `drift_cli-0.6.0.dist-info/METADATA` & `drift_cli-0.6.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: drift-cli
-Version: 0.6.0
+Version: 0.6.1
 Summary: CLI client for PANDA | Drift Platform
 Author-email: Alexey Timin <atimin@gmail.com>
 Maintainer-email: Alexey Timin <atimin@gmail.com>
 License: Mozilla Public License Version 2.0
         ==================================
         
         1. Definitions
@@ -390,15 +390,15 @@
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: System Administrators
 Classifier: Operating System :: OS Independent
 Classifier: Topic :: Database :: Front-Ends
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
-Requires-Dist: drift-python-client (~=0.5.0)
+Requires-Dist: drift-python-client (~=0.6.0)
 Requires-Dist: click (~=8.1)
 Requires-Dist: tomlkit (~=0.11)
 Requires-Dist: rich (~=12.6)
 Provides-Extra: docs
 Requires-Dist: mkdocs (~=1.3) ; extra == 'docs'
 Requires-Dist: mkdocs-material (~=8.3) ; extra == 'docs'
 Requires-Dist: plantuml-markdown (~=3.5) ; extra == 'docs'
```

